!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e6996a43-bd04-4d1f-a6dc-0e74d259d756",e._sentryDebugIdIdentifier="sentry-dbid-e6996a43-bd04-4d1f-a6dc-0e74d259d756")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"master@ddccc84b0b1636d4d27861e58700e0e34ba1ba6f"},(self.webpackChunk_torn_sendbird_chat=self.webpackChunk_torn_sendbird_chat||[]).push([[96],{4196:function(e,t,n){var r;!function(){var i=function(){this.init()};i.prototype={init:function(){var e=this||o;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||o;if(e=parseFloat(e),t.ctx||f(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,o.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),i=0;i<r.length;i++){var s=t._howls[n]._soundById(r[i]);s&&s._node&&(s._node.volume=s._volume*e)}return t}return t._volume},mute:function(e){var t=this||o;t.ctx||f(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,o.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),i=0;i<r.length;i++){var s=t._howls[n]._soundById(r[i]);s&&s._node&&(s._node.muted=!!e||s._muted)}return t},stop:function(){for(var e=this||o,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||o,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,f()),e},codecs:function(e){return(this||o)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||o;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||o,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator?e._navigator.userAgent:"",i=r.match(/OPR\/(\d+)/g),s=i&&parseInt(i[0].split("/")[1],10)<33,a=-1!==r.indexOf("Safari")&&-1===r.indexOf("Chrome"),u=r.match(/Version\/(.*?) /),c=a&&u&&parseInt(u[1],10)<15;return e._codecs={mp3:!(s||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(c||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(c||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||o;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,e._releaseHtml5Audio(r)}catch(n){e.noAudio=!0;break}for(var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var o=e._howls[i]._getSoundIds(),s=0;s<o.length;s++){var a=e._howls[i]._soundById(o[s]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}e._autoResume();var u=e.ctx.createBufferSource();u.buffer=e._scratchBuffer,u.connect(e.ctx.destination),void 0===u.start?u.noteOn(0):u.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),u.onended=function(){u.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||o;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||o;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&o.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&o.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var o=new i,s=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};s.prototype={init:function(e){var t=this;return o.ctx||f(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=o.usingWebAudio&&!t._html5,void 0!==o.ctx&&o.ctx&&o.autoUnlock&&o._unlockAudio(),o._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(o.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var r,i;if(e._format&&e._format[n])r=e._format[n];else{if("string"!=typeof(i=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(i))||(r=/\.([^.]+)$/.exec(i.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&o.codecs(r)){t=e._src[n];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new a(e),e._webAudio&&c(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var n=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e&&(e="__default",!n._playLock)){for(var i=0,s=0;s<n._sounds.length;s++)n._sounds[s]._paused&&!n._sounds[s]._ended&&(i++,r=n._sounds[s]._id);1===i?e=null:r=null}}var a=r?n._soundById(r):n._inactiveSound();if(!a)return null;if(r&&!e&&(e=a._sprite||"__default"),"loaded"!==n._state){a._sprite=e,a._ended=!1;var u=a._id;return n._queue.push({event:"play",action:function(){n.play(u)}}),u}if(r&&!a._paused)return t||n._loadQueue("play"),a._id;n._webAudio&&o._autoResume();var c=Math.max(0,a._seek>0?a._seek:n._sprite[e][0]/1e3),l=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-c),d=1e3*l/Math.abs(a._rate),h=n._sprite[e][0]/1e3,f=(n._sprite[e][0]+n._sprite[e][1])/1e3;a._sprite=e,a._ended=!1;var p=function(){a._paused=!1,a._seek=c,a._start=h,a._stop=f,a._loop=!(!a._loop&&!n._sprite[e][2])};if(!(c>=f)){var _=a._node;if(n._webAudio){var v=function(){n._playLock=!1,p(),n._refreshBuffer(a);var e=a._muted||n._muted?0:a._volume;_.gain.setValueAtTime(e,o.ctx.currentTime),a._playStart=o.ctx.currentTime,void 0===_.bufferSource.start?a._loop?_.bufferSource.noteGrainOn(0,c,86400):_.bufferSource.noteGrainOn(0,c,l):a._loop?_.bufferSource.start(0,c,86400):_.bufferSource.start(0,c,l),d!==1/0&&(n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),d)),t||setTimeout((function(){n._emit("play",a._id),n._loadQueue()}),0)};"running"===o.state&&"interrupted"!==o.ctx.state?v():(n._playLock=!0,n.once("resume",v),n._clearTimer(a._id))}else{var m=function(){_.currentTime=c,_.muted=a._muted||n._muted||o._muted||_.muted,_.volume=a._volume*o.volume(),_.playbackRate=a._rate;try{var r=_.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(n._playLock=!0,p(),r.then((function(){n._playLock=!1,_._unlocked=!0,t?n._loadQueue():n._emit("play",a._id)})).catch((function(){n._playLock=!1,n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):t||(n._playLock=!1,p(),n._emit("play",a._id)),_.playbackRate=a._rate,_.paused)return void n._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||a._loop?n._endTimers[a._id]=setTimeout(n._ended.bind(n,a),d):(n._endTimers[a._id]=function(){n._ended(a),_.removeEventListener("ended",n._endTimers[a._id],!1)},_.addEventListener("ended",n._endTimers[a._id],!1))}catch(e){n._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===_.src&&(_.src=n._src,_.load());var g=window&&window.ejecta||!_.readyState&&o._navigator.isCocoonJS;if(_.readyState>=3||g)m();else{n._playLock=!0,n._state="loading";var y=function(){n._state="loaded",m(),_.removeEventListener(o._canPlayEvent,y,!1)};_.addEventListener(o._canPlayEvent,y,!1),n._clearTimer(a._id)}}return a._id}n._ended(a)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),r=0;r<n.length;r++){t._clearTimer(n[r]);var i=t._soundById(n[r]);if(i&&!i._paused&&(i._seek=t.seek(n[r]),i._rateSeek=0,i._paused=!0,t._stopFade(n[r]),i._node))if(t._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),t._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||t._emit("pause",i?i._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var r=n._getSoundIds(e),i=0;i<r.length;i++){n._clearTimer(r[i]);var o=n._soundById(r[i]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,n._stopFade(r[i]),o._node&&(n._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),n._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause(),o._node.duration===1/0&&n._clearSound(o._node))),t||n._emit("stop",o._id))}return n},mute:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var r=n._getSoundIds(t),i=0;i<r.length;i++){var s=n._soundById(r[i]);s&&(s._muted=e,s._interval&&n._stopFade(s._id),n._webAudio&&s._node?s._node.gain.setValueAtTime(e?0:s._volume,o.ctx.currentTime):s._node&&(s._node.muted=!!o._muted||e),n._emit("mute",s._id))}return n},volume:function(){var e,t,n,r=this,i=arguments;if(0===i.length)return r._volume;if(1===i.length||2===i.length&&void 0===i[1]?r._getSoundIds().indexOf(i[0])>=0?t=parseInt(i[0],10):e=parseFloat(i[0]):i.length>=2&&(e=parseFloat(i[0]),t=parseInt(i[1],10)),!(void 0!==e&&e>=0&&e<=1))return(n=t?r._soundById(t):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,i)}}),r;void 0===t&&(r._volume=e),t=r._getSoundIds(t);for(var s=0;s<t.length;s++)(n=r._soundById(t[s]))&&(n._volume=e,i[2]||r._stopFade(t[s]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e,o.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=e*o.volume()),r._emit("volume",n._id));return r},fade:function(e,t,n,r){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"fade",action:function(){i.fade(e,t,n,r)}}),i;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),i.volume(e,r);for(var s=i._getSoundIds(r),a=0;a<s.length;a++){var u=i._soundById(s[a]);if(u){if(r||i._stopFade(s[a]),i._webAudio&&!u._muted){var c=o.ctx.currentTime,l=c+n/1e3;u._volume=e,u._node.gain.setValueAtTime(e,c),u._node.gain.linearRampToValueAtTime(t,l)}i._startFadeInterval(u,e,t,n,s[a],void 0===r)}}return i},_startFadeInterval:function(e,t,n,r,i,o){var s=this,a=t,u=n-t,c=Math.abs(u/.01),l=Math.max(4,c>0?r/c:r),d=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var i=(Date.now()-d)/r;d=Date.now(),a+=u*i,a=Math.round(100*a)/100,a=u<0?Math.max(n,a):Math.min(n,a),s._webAudio?e._volume=a:s.volume(a,e._id,!0),o&&(s._volume=a),(n<t&&a<=n||n>t&&a>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,s.volume(n,e._id),s._emit("fade",e._id))}),l)},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(o.ctx.currentTime),clearInterval(n._interval),n._interval=null,t.volume(n._fadeTo,e),n._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,n,r=this,i=arguments;if(0===i.length)return r._loop;if(1===i.length){if("boolean"!=typeof i[0])return!!(n=r._soundById(parseInt(i[0],10)))&&n._loop;e=i[0],r._loop=e}else 2===i.length&&(e=i[0],t=parseInt(i[1],10));for(var o=r._getSoundIds(t),s=0;s<o.length;s++)(n=r._soundById(o[s]))&&(n._loop=e,r._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,r.playing(o[s])&&(r.pause(o[s],!0),r.play(o[s],!0)))));return r},rate:function(){var e,t,n,r=this,i=arguments;if(0===i.length)t=r._sounds[0]._id;else if(1===i.length){r._getSoundIds().indexOf(i[0])>=0?t=parseInt(i[0],10):e=parseFloat(i[0])}else 2===i.length&&(e=parseFloat(i[0]),t=parseInt(i[1],10));if("number"!=typeof e)return(n=r._soundById(t))?n._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,i)}}),r;void 0===t&&(r._rate=e),t=r._getSoundIds(t);for(var s=0;s<t.length;s++)if(n=r._soundById(t[s])){r.playing(t[s])&&(n._rateSeek=r.seek(t[s]),n._playStart=r._webAudio?o.ctx.currentTime:n._playStart),n._rate=e,r._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(e,o.ctx.currentTime):n._node&&(n._node.playbackRate=e);var a=r.seek(t[s]),u=1e3*((r._sprite[n._sprite][0]+r._sprite[n._sprite][1])/1e3-a)/Math.abs(n._rate);!r._endTimers[t[s]]&&n._paused||(r._clearTimer(t[s]),r._endTimers[t[s]]=setTimeout(r._ended.bind(r,n),u)),r._emit("rate",n._id)}return r},seek:function(){var e,t,n=this,r=arguments;if(0===r.length)n._sounds.length&&(t=n._sounds[0]._id);else if(1===r.length){n._getSoundIds().indexOf(r[0])>=0?t=parseInt(r[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return 0;if("number"==typeof e&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}}),n;var i=n._soundById(t);if(i){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var s=n.playing(t)?o.ctx.currentTime-i._playStart:0,a=i._rateSeek?i._rateSeek-i._seek:0;return i._seek+(a+s*Math.abs(i._rate))}return i._node.currentTime}var u=n.playing(t);u&&n.pause(t,!0),i._seek=e,i._ended=!1,n._clearTimer(t),n._webAudio||!i._node||isNaN(i._node.duration)||(i._node.currentTime=e);var c=function(){u&&n.play(t,!0),n._emit("seek",t)};if(u&&!n._webAudio){var l=function(){n._playLock?setTimeout(l,0):c()};setTimeout(l,0)}else c()}return n},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var r=0;r<t._sounds.length;r++)if(!t._sounds[r]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,r=t._soundById(e);return r&&(n=t._sprite[r._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(o._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),o._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var r=o._howls.indexOf(e);r>=0&&o._howls.splice(r,1);var i=!0;for(n=0;n<o._howls.length;n++)if(o._howls[n]._src===e._src||e._src.indexOf(o._howls[n]._src)>=0){i=!1;break}return u&&i&&delete u[e._src],o.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,r){var i=this["_on"+e];return"function"==typeof t&&i.push(r?{id:n,fn:t,once:r}:{id:n,fn:t}),this},off:function(e,t,n){var r=this,i=r["_on"+e],o=0;if("number"==typeof t&&(n=t,t=null),t||n)for(o=0;o<i.length;o++){var s=n===i[o].id;if(t===i[o].fn&&s||!t&&s){i.splice(o,1);break}}else if(e)r["_on"+e]=[];else{var a=Object.keys(r);for(o=0;o<a.length;o++)0===a[o].indexOf("_on")&&Array.isArray(r[a[o]])&&(r[a[o]]=[])}return r},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var r=this,i=r["_on"+e],o=i.length-1;o>=0;o--)i[o].id&&i[o].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(r,i[o].fn),0),i[o].once&&r.off(e,i[o].fn,i[o].id));return r._loadQueue(e),r},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=o.ctx.currentTime;var i=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),i)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),o._autoSuspend()),t._webAudio||r||t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new a(e)},_drain:function(){var e=this,t=e._pool,n=0,r=0;if(!(e._sounds.length<t)){for(r=0;r<e._sounds.length;r++)e._sounds[r]._ended&&n++;for(r=e._sounds.length-1;r>=0;r--){if(n<=t)return;e._sounds[r]._ended&&(e._webAudio&&e._sounds[r]._node&&e._sounds[r]._node.disconnect(0),e._sounds.splice(r,1),n--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=o.ctx.createBufferSource(),e._node.bufferSource.buffer=u[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,o.ctx.currentTime),this},_cleanBuffer:function(e){var t=o._navigator&&o._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return this;if(o._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=o._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(o._navigator&&o._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var a=function(e){this._parent=e,this.init()};a.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++o._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=o._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),e._node.gain.setValueAtTime(n,o.ctx.currentTime),e._node.paused=!0,e._node.connect(o.masterGain)):o.noAudio||(e._node=o._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(o._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=n*o.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++o._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(o._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var u={},c=function(e){var t=e._src;if(u[t])return e._duration=u[t].duration,void h(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);d(r.buffer,e)}else{var o=new XMLHttpRequest;o.open(e._xhr.method,t,!0),o.withCredentials=e._xhr.withCredentials,o.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){o.setRequestHeader(t,e._xhr.headers[t])})),o.onload=function(){var t=(o.status+"")[0];"0"===t||"2"===t||"3"===t?d(o.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+o.status+".")},o.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete u[t],e.load())},l(o)}},l=function(e){try{e.send()}catch(t){e.onerror()}},d=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},r=function(e){e&&t._sounds.length>0?(u[t._src]=e,h(t,e)):n()};"undefined"!=typeof Promise&&1===o.ctx.decodeAudioData.length?o.ctx.decodeAudioData(e).then(r).catch(n):o.ctx.decodeAudioData(e,r,n)},h=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},f=function(){if(o.usingWebAudio){try{"undefined"!=typeof AudioContext?o.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?o.ctx=new webkitAudioContext:o.usingWebAudio=!1}catch(e){o.usingWebAudio=!1}o.ctx||(o.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(o._navigator&&o._navigator.platform),t=o._navigator&&o._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var r=/safari/.test(o._navigator&&o._navigator.userAgent.toLowerCase());o._navigator&&!r&&(o.usingWebAudio=!1)}o.usingWebAudio&&(o.masterGain=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),o.masterGain.gain.setValueAtTime(o._muted?0:o._volume,o.ctx.currentTime),o.masterGain.connect(o.ctx.destination)),o._setup()}};void 0===(r=function(){return{Howler:o,Howl:s}}.apply(t,[]))||(e.exports=r),t.Howler=o,t.Howl=s,void 0!==n.g?(n.g.HowlerGlobal=i,n.g.Howler=o,n.g.Howl=s,n.g.Sound=a):"undefined"!=typeof window&&(window.HowlerGlobal=i,window.Howler=o,window.Howl=s,window.Sound=a)}(),function(){var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var r=this;return r.ctx&&r.ctx.listener?(t="number"!=typeof t?r._pos[1]:t,n="number"!=typeof n?r._pos[2]:n,"number"!=typeof e?r._pos:(r._pos=[e,t,n],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(e,t,n,r,i,o){var s=this;if(!s.ctx||!s.ctx.listener)return s;var a=s._orientation;return t="number"!=typeof t?a[1]:t,n="number"!=typeof n?a[2]:n,r="number"!=typeof r?a[3]:r,i="number"!=typeof i?a[4]:i,o="number"!=typeof o?a[5]:o,"number"!=typeof e?a:(s._orientation=[e,t,n,r,i,o],void 0!==s.ctx.listener.forwardX?(s.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),s.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),s.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),s.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),s.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),s.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):s.ctx.listener.setOrientation(e,t,n,r,i,o),s)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,n){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(e,n)}}),r;var i=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return r._stereo;r._stereo=e,r._pos=[e,0,0]}for(var o=r._getSoundIds(n),s=0;s<o.length;s++){var a=r._soundById(o[s]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||t(a,i),"spatial"===i?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",a._id)}}return r},Howl.prototype.pos=function(e,n,r,i){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(e,n,r,i)}}),o;if(n="number"!=typeof n?0:n,r="number"!=typeof r?-.5:r,void 0===i){if("number"!=typeof e)return o._pos;o._pos=[e,n,r]}for(var s=o._getSoundIds(i),a=0;a<s.length;a++){var u=o._soundById(s[a]);if(u){if("number"!=typeof e)return u._pos;u._pos=[e,n,r],u._node&&(u._panner&&!u._panner.pan||t(u,"spatial"),void 0!==u._panner.positionX?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setPosition(e,n,r)),o._emit("pos",u._id)}}return o},Howl.prototype.orientation=function(e,n,r,i){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(e,n,r,i)}}),o;if(n="number"!=typeof n?o._orientation[1]:n,r="number"!=typeof r?o._orientation[2]:r,void 0===i){if("number"!=typeof e)return o._orientation;o._orientation=[e,n,r]}for(var s=o._getSoundIds(i),a=0;a<s.length;a++){var u=o._soundById(s[a]);if(u){if("number"!=typeof e)return u._orientation;u._orientation=[e,n,r],u._node&&(u._panner||(u._pos||(u._pos=o._pos||[0,0,-.5]),t(u,"spatial")),void 0!==u._panner.orientationX?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setOrientation(e,n,r)),o._emit("orientation",u._id)}}return o},Howl.prototype.pannerAttr=function(){var e,n,r,i=this,o=arguments;if(!i._webAudio)return i;if(0===o.length)return i._pannerAttr;if(1===o.length){if("object"!=typeof o[0])return(r=i._soundById(parseInt(o[0],10)))?r._pannerAttr:i._pannerAttr;e=o[0],void 0===n&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),i._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:i._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:i._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:i._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:i._panningModel})}else 2===o.length&&(e=o[0],n=parseInt(o[1],10));for(var s=i._getSoundIds(n),a=0;a<s.length;a++)if(r=i._soundById(s[a])){var u=r._pannerAttr;u={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:u.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:u.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:u.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:u.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:u.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:u.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:u.panningModel};var c=r._panner;c||(r._pos||(r._pos=i._pos||[0,0,-.5]),t(r,"spatial"),c=r._panner),c.coneInnerAngle=u.coneInnerAngle,c.coneOuterAngle=u.coneOuterAngle,c.coneOuterGain=u.coneOuterGain,c.distanceModel=u.distanceModel,c.maxDistance=u.maxDistance,c.refDistance=u.refDistance,c.rolloffFactor=u.rolloffFactor,c.panningModel=u.panningModel}return i},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()},258:function(e,t,n){n.d(t,{$:function(){return Y},A:function(){return D},B:function(){return I},C:function(){return L},D:function(){return m},E:function(){return b},F:function(){return F},G:function(){return G},H:function(){return c},J:function(){return j},L:function(){return Q},M:function(){return ee},N:function(){return te},O:function(){return J},P:function(){return R},Q:function(){return re},R:function(){return U},S:function(){return H},T:function(){return M},W:function(){return $},Z:function(){return Z},a:function(){return P},a4:function(){return ne},b:function(){return q},d:function(){return V},e:function(){return O},f:function(){return B},g:function(){return z},h:function(){return W},i:function(){return g},j:function(){return A},k:function(){return a},l:function(){return T},m:function(){return y},n:function(){return x},o:function(){return f},p:function(){return l},q:function(){return v},r:function(){return h},s:function(){return C},t:function(){return u},u:function(){return d},v:function(){return S},y:function(){return w},z:function(){return E}});var r=n(3068),i=n(9575),o=n(4860);var s=function(e,t){var n;void 0===t&&(t=!0);var i=new Promise((function(r){n=setTimeout(r,Math.min(2147483647,e),t)}));return i[r.bO]=function(){clearTimeout(n)},i},a=function(e){return function(){return e}}(!0),u=function(){};var c=function(e){return e};"function"==typeof Symbol&&Symbol.asyncIterator&&Symbol.asyncIterator;var l=function(e,t){(0,i.A)(e,t),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach((function(n){e[n]=t[n]}))},d=function(e,t){var n;return(n=[]).concat.apply(n,t.map(e))};function h(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}function f(e){var t=!1;return function(){t||(t=!0,e())}}var p=function(e){throw e},_=function(e){return{value:e,done:!0}};function v(e,t,n){void 0===t&&(t=p),void 0===n&&(n="iterator");var r={meta:{name:n},next:e,throw:t,return:_,isSagaIterator:!0};return"undefined"!=typeof Symbol&&(r[Symbol.iterator]=function(){return r}),r}function m(e,t){var n=t.sagaStack;console.error(e),console.error(n)}var g=function(e){return new Error("\n  redux-saga: Error checking hooks detected an inconsistent state. This is likely a bug\n  in redux-saga code and not yours. Thanks for reporting this in the project's github repo.\n  Error: "+e+"\n")},y=function(e){return Array.apply(null,new Array(e))},b=function(e){return function(t){return e(Object.defineProperty(t,r.q8,{value:!0}))}},E=function(e){return e===r.a6},w=function(e){return e===r.nm},C=function(e){return E(e)||w(e)};function T(e,t){var n=Object.keys(e),r=n.length;var i,s=0,a=(0,o.YO)(e)?y(r):{},c={};return n.forEach((function(e){var n=function(n,o){i||(o||C(n)?(t.cancel(),t(n,o)):(a[e]=n,++s===r&&(i=!0,t(a))))};n.cancel=u,c[e]=n})),t.cancel=function(){i||(i=!0,n.forEach((function(e){return c[e].cancel()})))},c}function A(e){return{name:e.name||"anonymous",location:S(e)}}function S(e){return e[r.x2]}function I(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var N={isEmpty:a,put:u,take:u};function k(e,t){void 0===e&&(e=10);var n=new Array(e),r=0,i=0,o=0,s=function(t){n[i]=t,i=(i+1)%e,r++},a=function(){if(0!=r){var t=n[o];return n[o]=null,r--,o=(o+1)%e,t}},u=function(){for(var e=[];r;)e.push(a());return e};return{isEmpty:function(){return 0==r},put:function(a){var c;if(r<e)s(a);else switch(t){case 1:throw new Error("Channel's Buffer overflow!");case 3:n[i]=a,o=i=(i+1)%e;break;case 4:c=2*e,n=u(),r=n.length,i=n.length,o=0,n.length=c,e=c,s(a)}},take:a,flush:u}}var x=function(){return N},O=function(e){return k(e,4)},M="TAKE",R="PUT",D="ALL",U="RACE",L="CALL",P="CPS",F="FORK",j="JOIN",q="CANCEL",H="SELECT",V="ACTION_CHANNEL",B="CANCELLED",z="FLUSH",G="GET_CONTEXT",W="SET_CONTEXT",K=function(e,t){var n;return(n={})[r.IO]=!0,n.combinator=!1,n.type=e,n.payload=t,n};function Q(e,t){return void 0===e&&(e="*"),(0,o.T1)(e)?((0,o.uQ)(t)&&console.warn("take(pattern) takes one argument but two were provided. Consider passing an array for listening to several action types"),K(M,{pattern:e})):(0,o.fD)(e)&&(0,o.uQ)(t)&&(0,o.T1)(t)?K(M,{channel:e,pattern:t}):(0,o.Ix)(e)?((0,o.uQ)(t)&&console.warn("take(channel) takes one argument but two were provided. Second argument is ignored."),K(M,{channel:e})):void 0}function Z(e,t){return(0,o.vD)(t)&&(t=e,e=void 0),K(R,{channel:e,action:t})}function Y(e){var t=K(D,e);return t.combinator=!0,t}function $(e){var t=K(U,e);return t.combinator=!0,t}function X(e,t){var n,r=null;return(0,o.Pc)(e)?n=e:((0,o.YO)(e)?(r=e[0],n=e[1]):(r=e.context,n=e.fn),r&&(0,o.Yj)(n)&&(0,o.Pc)(r[n])&&(n=r[n])),{context:r,fn:n,args:t}}function J(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return K(L,X(e,n))}function ee(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return K(F,X(e,n))}function te(e){return void 0===e&&(e=r.Pe),K(q,e)}function ne(e){void 0===e&&(e=c);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return K(H,{selector:e,args:n})}var re=J.bind(null,s)},4860:function(e,t,n){n.d(t,{HR:function(){return p},Ix:function(){return h},Pc:function(){return s},T1:function(){return d},YO:function(){return u},Yj:function(){return a},fD:function(){return _},iv:function(){return c},lJ:function(){return l},mr:function(){return f},uQ:function(){return o},vD:function(){return i}});var r=n(3068),i=function(e){return null==e},o=function(e){return null!=e},s=function(e){return"function"==typeof e},a=function(e){return"string"==typeof e},u=Array.isArray,c=function(e){return e&&s(e.then)},l=function(e){return e&&s(e.next)&&s(e.throw)},d=function e(t){return t&&(a(t)||p(t)||s(t)||u(t)&&t.every(e))},h=function(e){return e&&s(e.take)&&s(e.close)},f=function(e){return s(e)&&e.hasOwnProperty("toString")},p=function(e){return Boolean(e)&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype},_=function(e){return h(e)&&e[r.Xl]}},3068:function(e,t,n){n.d(t,{E_:function(){return a},IO:function(){return s},Pe:function(){return l},Xl:function(){return u},a6:function(){return f},bO:function(){return i},nm:function(){return h},q8:function(){return c},wn:function(){return d},x2:function(){return p},x7:function(){return o}});var r=function(e){return"@@redux-saga/"+e},i=r("CANCEL_PROMISE"),o=r("CHANNEL_END"),s=r("IO"),a=r("MATCH"),u=r("MULTICAST"),c=r("SAGA_ACTION"),l=r("SELF_CANCELLATION"),d=r("TASK"),h=r("TASK_CANCEL"),f=r("TERMINATE"),p=r("LOCATION")},718:function(e,t,n){var r,i,o;o=n(6338),i=n(9232),r=function(){class e{constructor(e={}){this.options=e,o.load(this.options,this.defaults,this),this.Events=new i(this),this._arr=[],this._resetPromise(),this._lastFlush=Date.now()}_resetPromise(){return this._promise=new this.Promise(((e,t)=>this._resolve=e))}_flush(){return clearTimeout(this._timeout),this._lastFlush=Date.now(),this._resolve(),this.Events.trigger("batch",this._arr),this._arr=[],this._resetPromise()}add(e){var t;return this._arr.push(e),t=this._promise,this._arr.length===this.maxSize?this._flush():null!=this.maxTime&&1===this._arr.length&&(this._timeout=setTimeout((()=>this._flush()),this.maxTime)),t}}return e.prototype.defaults={maxTime:null,maxSize:null,Promise:Promise},e}.call(void 0),e.exports=r},4230:function(e,t,n){function r(e,t){return s(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||o()}function i(e){return s(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function s(e){if(Array.isArray(e))return e}function a(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,u,"next",e)}function u(e){a(o,r,i,s,u,"throw",e)}s(void 0)}))}}var c,l,d,h,f,p,_,v,m,g=[].splice;m=n(6338),f=n(3969),d=n(1778),h=n(5073),p=n(9497),l=n(9232),_=n(8975),v=n(622),c=function(){class e{constructor(t={},...n){var r,i;this._addToQueue=this._addToQueue.bind(this),this._validateOptions(t,n),m.load(t,this.instanceDefaults,this),this._queues=new f(10),this._scheduled={},this._states=new _(["RECEIVED","QUEUED","RUNNING","EXECUTING"].concat(this.trackDoneStatus?["DONE"]:[])),this._limiter=null,this.Events=new l(this),this._submitLock=new v("submit",this.Promise),this._registerLock=new v("register",this.Promise),i=m.load(t,this.storeDefaults,{}),this._store=function(){if("redis"===this.datastore||"ioredis"===this.datastore||null!=this.connection)return r=m.load(t,this.redisStoreDefaults,{}),new p(this,i,r);if("local"===this.datastore)return r=m.load(t,this.localStoreDefaults,{}),new h(this,i,r);throw new e.prototype.BottleneckError(`Invalid datastore type: ${this.datastore}`)}.call(this),this._queues.on("leftzero",(()=>{var e;return null!=(e=this._store.heartbeat)&&"function"==typeof e.ref?e.ref():void 0})),this._queues.on("zero",(()=>{var e;return null!=(e=this._store.heartbeat)&&"function"==typeof e.unref?e.unref():void 0}))}_validateOptions(t,n){if(null==t||"object"!=typeof t||0!==n.length)throw new e.prototype.BottleneckError("Bottleneck v2 takes a single object argument. Refer to https://github.com/SGrondin/bottleneck#upgrading-to-v2 if you're upgrading from Bottleneck v1.")}ready(){return this._store.ready}clients(){return this._store.clients}channel(){return`b_${this.id}`}channel_client(){return`b_${this.id}_${this._store.clientId}`}publish(e){return this._store.__publish__(e)}disconnect(e=!0){return this._store.__disconnect__(e)}chain(e){return this._limiter=e,this}queued(e){return this._queues.queued(e)}clusterQueued(){return this._store.__queued__()}empty(){return 0===this.queued()&&this._submitLock.isEmpty()}running(){return this._store.__running__()}done(){return this._store.__done__()}jobStatus(e){return this._states.jobStatus(e)}jobs(e){return this._states.statusJobs(e)}counts(){return this._states.statusCounts()}_randomIndex(){return Math.random().toString(36).slice(2)}check(e=1){return this._store.__check__(e)}_clearGlobalState(e){return null!=this._scheduled[e]&&(clearTimeout(this._scheduled[e].expiration),delete this._scheduled[e],!0)}_free(e,t,n,r){var i=this;return u((function*(){var t,o;try{if(o=(yield i._store.__free__(e,n.weight)).running,i.Events.trigger("debug",`Freed ${n.id}`,r),0===o&&i.empty())return i.Events.trigger("idle")}catch(e){return t=e,i.Events.trigger("error",t)}}))()}_run(e,t,n){var r,i,o;return t.doRun(),r=this._clearGlobalState.bind(this,e),o=this._run.bind(this,e,t),i=this._free.bind(this,e,t),this._scheduled[e]={timeout:setTimeout((()=>t.doExecute(this._limiter,r,o,i)),n),expiration:null!=t.options.expiration?setTimeout((function(){return t.doExpire(r,o,i)}),n+t.options.expiration):void 0,job:t}}_drainOne(e){return this._registerLock.schedule((()=>{var t,n,r,i,o;if(0===this.queued())return this.Promise.resolve(null);o=this._queues.getFirst();var s=r=o.first();return i=s.options,t=s.args,null!=e&&i.weight>e?this.Promise.resolve(null):(this.Events.trigger("debug",`Draining ${i.id}`,{args:t,options:i}),n=this._randomIndex(),this._store.__register__(n,i.weight,i.expiration).then((({success:e,wait:s,reservoir:a})=>{var u;return this.Events.trigger("debug",`Drained ${i.id}`,{success:e,args:t,options:i}),e?(o.shift(),(u=this.empty())&&this.Events.trigger("empty"),0===a&&this.Events.trigger("depleted",u),this._run(n,r,s),this.Promise.resolve(i.weight)):this.Promise.resolve(null)})))}))}_drainAll(e,t=0){return this._drainOne(e).then((n=>{var r;return null!=n?(r=null!=e?e-n:e,this._drainAll(r,t+n)):this.Promise.resolve(t)})).catch((e=>this.Events.trigger("error",e)))}_dropAllQueued(e){return this._queues.shiftAll((function(t){return t.doDrop({message:e})}))}stop(t={}){var n,r;return t=m.load(t,this.stopDefaults),r=e=>{var t;return t=()=>{var t;return(t=this._states.counts)[0]+t[1]+t[2]+t[3]===e},new this.Promise(((e,n)=>t()?e():this.on("done",(()=>{if(t())return this.removeAllListeners("done"),e()}))))},n=t.dropWaitingJobs?(this._run=function(e,n){return n.doDrop({message:t.dropErrorMessage})},this._drainOne=()=>this.Promise.resolve(null),this._registerLock.schedule((()=>this._submitLock.schedule((()=>{var e,n,i;for(e in n=this._scheduled)i=n[e],"RUNNING"===this.jobStatus(i.job.options.id)&&(clearTimeout(i.timeout),clearTimeout(i.expiration),i.job.doDrop({message:t.dropErrorMessage}));return this._dropAllQueued(t.dropErrorMessage),r(0)}))))):this.schedule({priority:9,weight:0},(()=>r(1))),this._receive=function(n){return n._reject(new e.prototype.BottleneckError(t.enqueueErrorMessage))},this.stop=()=>this.Promise.reject(new e.prototype.BottleneckError("stop() has already been called")),n}_addToQueue(t){var n=this;return u((function*(){var r,i,o,s,a,u,c;r=t.args,s=t.options;try{var l=yield n._store.__submit__(n.queued(),s.weight);a=l.reachedHWM,i=l.blocked,c=l.strategy}catch(e){return o=e,n.Events.trigger("debug",`Could not queue ${s.id}`,{args:r,options:s,error:o}),t.doDrop({error:o}),!1}return i?(t.doDrop(),!0):a&&(null!=(u=c===e.prototype.strategy.LEAK?n._queues.shiftLastFrom(s.priority):c===e.prototype.strategy.OVERFLOW_PRIORITY?n._queues.shiftLastFrom(s.priority+1):c===e.prototype.strategy.OVERFLOW?t:void 0)&&u.doDrop(),null==u||c===e.prototype.strategy.OVERFLOW)?(null==u&&t.doDrop(),a):(t.doQueue(a,i),n._queues.push(t),yield n._drainAll(),a)}))()}_receive(t){return null!=this._states.jobStatus(t.options.id)?(t._reject(new e.prototype.BottleneckError(`A job with the same id already exists (id=${t.options.id})`)),!1):(t.doReceive(),this._submitLock.schedule(this._addToQueue,t))}submit(...e){var t,n,o,s,a,u,c,l,h;"function"==typeof e[0]?(u=i(e),n=u[0],e=u.slice(1),c=r(g.call(e,-1),1),t=c[0],s=m.load({},this.jobDefaults)):(s=(l=i(e))[0],n=l[1],e=l.slice(2),h=r(g.call(e,-1),1),t=h[0],s=m.load(s,this.jobDefaults));return a=(...e)=>new this.Promise((function(t,r){return n(...e,(function(...e){return(null!=e[0]?r:t)(e)}))})),(o=new d(a,e,s,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise)).promise.then((function(e){return"function"==typeof t?t(...e):void 0})).catch((function(e){return Array.isArray(e)?"function"==typeof t?t(...e):void 0:"function"==typeof t?t(e):void 0})),this._receive(o)}schedule(...e){var t,n,r;if("function"==typeof e[0]){var o=i(e);r=o[0],e=o.slice(1),n={}}else{var s=i(e);n=s[0],r=s[1],e=s.slice(2)}return t=new d(r,e,n,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise),this._receive(t),t.promise}wrap(e){var t,n;return t=this.schedule.bind(this),(n=function(...n){return t(e.bind(this),...n)}).withOptions=function(n,...r){return t(n,e,...r)},n}updateSettings(e={}){var t=this;return u((function*(){return yield t._store.__updateSettings__(m.overwrite(e,t.storeDefaults)),m.overwrite(e,t.instanceDefaults,t),t}))()}currentReservoir(){return this._store.__currentReservoir__()}incrementReservoir(e=0){return this._store.__incrementReservoir__(e)}}return e.default=e,e.Events=l,e.version=e.prototype.version=n(7444).version,e.strategy=e.prototype.strategy={LEAK:1,OVERFLOW:2,OVERFLOW_PRIORITY:4,BLOCK:3},e.BottleneckError=e.prototype.BottleneckError=n(1650),e.Group=e.prototype.Group=n(4418),e.RedisConnection=e.prototype.RedisConnection=n(7146),e.IORedisConnection=e.prototype.IORedisConnection=n(5746),e.Batcher=e.prototype.Batcher=n(718),e.prototype.jobDefaults={priority:5,weight:1,expiration:null,id:"<no-id>"},e.prototype.storeDefaults={maxConcurrent:null,minTime:0,highWater:null,strategy:e.prototype.strategy.LEAK,penalty:null,reservoir:null,reservoirRefreshInterval:null,reservoirRefreshAmount:null,reservoirIncreaseInterval:null,reservoirIncreaseAmount:null,reservoirIncreaseMaximum:null},e.prototype.localStoreDefaults={Promise:Promise,timeout:null,heartbeatInterval:250},e.prototype.redisStoreDefaults={Promise:Promise,timeout:null,heartbeatInterval:5e3,clientTimeout:1e4,Redis:null,clientOptions:{},clusterNodes:null,clearDatastore:!1,connection:null},e.prototype.instanceDefaults={datastore:"local",connection:null,id:"<no-id>",rejectOnDrop:!0,trackDoneStatus:!1,Promise:Promise},e.prototype.stopDefaults={enqueueErrorMessage:"This limiter has been stopped and cannot accept new jobs.",dropWaitingJobs:!0,dropErrorMessage:"This limiter has been stopped."},e}.call(void 0),e.exports=c},1650:function(e){var t;t=class extends Error{},e.exports=t},1085:function(e){var t;t=class{constructor(e,t){this.incr=e,this.decr=t,this._first=null,this._last=null,this.length=0}push(e){var t;this.length++,"function"==typeof this.incr&&this.incr(),t={value:e,prev:this._last,next:null},null!=this._last?(this._last.next=t,this._last=t):this._first=this._last=t}shift(){var e;if(null!=this._first)return this.length--,"function"==typeof this.decr&&this.decr(),e=this._first.value,null!=(this._first=this._first.next)?this._first.prev=null:this._last=null,e}first(){if(null!=this._first)return this._first.value}getArray(){var e,t,n;for(e=this._first,n=[];null!=e;)n.push((t=e,e=e.next,t.value));return n}forEachShift(e){var t;for(t=this.shift();null!=t;)e(t),t=this.shift()}debug(){var e,t,n,r,i;for(e=this._first,i=[];null!=e;)i.push((t=e,e=e.next,{value:t.value,prev:null!=(n=t.prev)?n.value:void 0,next:null!=(r=t.next)?r.value:void 0}));return i}},e.exports=t},9232:function(e){function t(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function n(e){return function(){var n=this,r=arguments;return new Promise((function(i,o){var s=e.apply(n,r);function a(e){t(s,i,o,a,u,"next",e)}function u(e){t(s,i,o,a,u,"throw",e)}a(void 0)}))}}var r;r=class{constructor(e){if(this.instance=e,this._events={},null!=this.instance.on||null!=this.instance.once||null!=this.instance.removeAllListeners)throw new Error("An Emitter already exists for this object");this.instance.on=(e,t)=>this._addListener(e,"many",t),this.instance.once=(e,t)=>this._addListener(e,"once",t),this.instance.removeAllListeners=(e=null)=>null!=e?delete this._events[e]:this._events={}}_addListener(e,t,n){var r;return null==(r=this._events)[e]&&(r[e]=[]),this._events[e].push({cb:n,status:t}),this.instance}listenerCount(e){return null!=this._events[e]?this._events[e].length:0}trigger(e,...t){var r=this;return n((function*(){var i,o;try{if("debug"!==e&&r.trigger("debug",`Event triggered: ${e}`,t),null==r._events[e])return;return r._events[e]=r._events[e].filter((function(e){return"none"!==e.status})),o=r._events[e].map(function(){var e=n((function*(e){var n,i;if("none"!==e.status){"once"===e.status&&(e.status="none");try{return"function"==typeof(null!=(i="function"==typeof e.cb?e.cb(...t):void 0)?i.then:void 0)?yield i:i}catch(e){return n=e,r.trigger("error",n),null}}}));return function(t){return e.apply(this,arguments)}}()),(yield Promise.all(o)).find((function(e){return null!=e}))}catch(e){return i=e,r.trigger("error",i),null}}))()}},e.exports=r},4418:function(e,t,n){function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function a(e){i(s,r,o,a,u,"next",e)}function u(e){i(s,r,o,a,u,"throw",e)}a(void 0)}))}}var s,a,u,c,l,d;d=n(6338),s=n(9232),c=n(7146),u=n(5746),l=n(8885),a=function(){class e{constructor(e={}){this.deleteKey=this.deleteKey.bind(this),this.limiterOptions=e,d.load(this.limiterOptions,this.defaults,this),this.Events=new s(this),this.instances={},this.Bottleneck=n(4230),this._startAutoCleanup(),this.sharedConnection=null!=this.connection,null==this.connection&&("redis"===this.limiterOptions.datastore?this.connection=new c(Object.assign({},this.limiterOptions,{Events:this.Events})):"ioredis"===this.limiterOptions.datastore&&(this.connection=new u(Object.assign({},this.limiterOptions,{Events:this.Events}))))}key(e=""){var t;return null!=(t=this.instances[e])?t:(()=>{var t;return t=this.instances[e]=new this.Bottleneck(Object.assign(this.limiterOptions,{id:`${this.id}-${e}`,timeout:this.timeout,connection:this.connection})),this.Events.trigger("created",t,e),t})()}deleteKey(e=""){var t=this;return o((function*(){var n,r;return r=t.instances[e],t.connection&&(n=yield t.connection.__runCommand__(["del",...l.allKeys(`${t.id}-${e}`)])),null!=r&&(delete t.instances[e],yield r.disconnect()),null!=r||n>0}))()}limiters(){var e,t,n,r;for(e in n=[],t=this.instances)r=t[e],n.push({key:e,limiter:r});return n}keys(){return Object.keys(this.instances)}clusterKeys(){var e=this;return o((function*(){var t,n,i,o,s,a,u;if(null==e.connection)return e.Promise.resolve(e.keys());for(s=[],t=null,u=`b_${e.id}-`.length,9;0!==t;){var c=r(yield e.connection.__runCommand__(["scan",null!=t?t:0,"match",`b_${e.id}-*_settings`,"count",1e4]),2);for(t=~~c[0],i=0,a=(n=c[1]).length;i<a;i++)o=n[i],s.push(o.slice(u,-9))}return s}))()}_startAutoCleanup(){var e,t=this;return clearInterval(this.interval),"function"==typeof(e=this.interval=setInterval(o((function*(){var e,n,r,i,o,s;for(n in o=Date.now(),i=[],r=t.instances){s=r[n];try{(yield s._store.__groupCheck__(o))?i.push(t.deleteKey(n)):i.push(void 0)}catch(t){e=t,i.push(s.Events.trigger("error",e))}}return i})),this.timeout/2)).unref?e.unref():void 0}updateSettings(e={}){if(d.overwrite(e,this.defaults,this),d.overwrite(e,e,this.limiterOptions),null!=e.timeout)return this._startAutoCleanup()}disconnect(e=!0){var t;if(!this.sharedConnection)return null!=(t=this.connection)?t.disconnect(e):void 0}}return e.prototype.defaults={timeout:3e5,connection:null,Promise:Promise,id:"group-key"},e}.call(void 0),e.exports=a},5746:function(module,__unused_webpack_exports,__webpack_require__){function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){asyncGeneratorStep(o,r,i,s,a,"next",e)}function a(e){asyncGeneratorStep(o,r,i,s,a,"throw",e)}s(void 0)}))}}var Events,IORedisConnection,Scripts,parser;parser=__webpack_require__(6338),Events=__webpack_require__(9232),Scripts=__webpack_require__(8885),IORedisConnection=function(){class IORedisConnection{constructor(options={}){parser.load(options,this.defaults,this),null==this.Redis&&(this.Redis=eval("require")("ioredis")),null==this.Events&&(this.Events=new Events(this)),this.terminated=!1,null!=this.clusterNodes?(this.client=new this.Redis.Cluster(this.clusterNodes,this.clientOptions),this.subscriber=new this.Redis.Cluster(this.clusterNodes,this.clientOptions)):null!=this.client&&null==this.client.duplicate?this.subscriber=new this.Redis.Cluster(this.client.startupNodes,this.client.options):(null==this.client&&(this.client=new this.Redis(this.clientOptions)),this.subscriber=this.client.duplicate()),this.limiters={},this.ready=this.Promise.all([this._setup(this.client,!1),this._setup(this.subscriber,!0)]).then((()=>(this._loadScripts(),{client:this.client,subscriber:this.subscriber})))}_setup(e,t){return e.setMaxListeners(0),new this.Promise(((n,r)=>(e.on("error",(e=>this.Events.trigger("error",e))),t&&e.on("message",((e,t)=>{var n;return null!=(n=this.limiters[e])?n._store.onMessage(e,t):void 0})),"ready"===e.status?n():e.once("ready",n))))}_loadScripts(){return Scripts.names.forEach((e=>this.client.defineCommand(e,{lua:Scripts.payload(e)})))}__runCommand__(e){var t=this;return _asyncToGenerator((function*(){yield t.ready;var n=_slicedToArray(yield t.client.pipeline([e]).exec(),1),r=_slicedToArray(n[0],2);return r[0],r[1]}))()}__addLimiter__(e){return this.Promise.all([e.channel(),e.channel_client()].map((t=>new this.Promise(((n,r)=>this.subscriber.subscribe(t,(()=>(this.limiters[t]=e,n()))))))))}__removeLimiter__(e){var t=this;return[e.channel(),e.channel_client()].forEach(function(){var e=_asyncToGenerator((function*(e){return t.terminated||(yield t.subscriber.unsubscribe(e)),delete t.limiters[e]}));return function(t){return e.apply(this,arguments)}}())}__scriptArgs__(e,t,n,r){var i;return[(i=Scripts.keys(e,t)).length].concat(i,n,r)}__scriptFn__(e){return this.client[e].bind(this.client)}disconnect(e=!0){var t,n,r,i;for(t=0,r=(i=Object.keys(this.limiters)).length;t<r;t++)n=i[t],clearInterval(this.limiters[n]._store.heartbeat);return this.limiters={},this.terminated=!0,e?this.Promise.all([this.client.quit(),this.subscriber.quit()]):(this.client.disconnect(),this.subscriber.disconnect(),this.Promise.resolve())}}return IORedisConnection.prototype.datastore="ioredis",IORedisConnection.prototype.defaults={Redis:null,clientOptions:{},clusterNodes:null,client:null,Promise:Promise,Events:null},IORedisConnection}.call(void 0),module.exports=IORedisConnection},1778:function(e,t,n){function r(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){r(s,i,o,a,u,"next",e)}function u(e){r(s,i,o,a,u,"throw",e)}a(void 0)}))}}var o,s,a;a=n(6338),o=n(1650),s=class{constructor(e,t,n,r,i,o,s,u){this.task=e,this.args=t,this.rejectOnDrop=i,this.Events=o,this._states=s,this.Promise=u,this.options=a.load(n,r),this.options.priority=this._sanitizePriority(this.options.priority),this.options.id===r.id&&(this.options.id=`${this.options.id}-${this._randomIndex()}`),this.promise=new this.Promise(((e,t)=>{this._resolve=e,this._reject=t})),this.retryCount=0}_sanitizePriority(e){var t;return(t=~~e!==e?5:e)<0?0:t>9?9:t}_randomIndex(){return Math.random().toString(36).slice(2)}doDrop({error:e,message:t="This job has been dropped by Bottleneck"}={}){return!!this._states.remove(this.options.id)&&(this.rejectOnDrop&&this._reject(null!=e?e:new o(t)),this.Events.trigger("dropped",{args:this.args,options:this.options,task:this.task,promise:this.promise}),!0)}_assertStatus(e){var t;if((t=this._states.jobStatus(this.options.id))!==e&&("DONE"!==e||null!==t))throw new o(`Invalid job status ${t}, expected ${e}. Please open an issue at https://github.com/SGrondin/bottleneck/issues`)}doReceive(){return this._states.start(this.options.id),this.Events.trigger("received",{args:this.args,options:this.options})}doQueue(e,t){return this._assertStatus("RECEIVED"),this._states.next(this.options.id),this.Events.trigger("queued",{args:this.args,options:this.options,reachedHWM:e,blocked:t})}doRun(){return 0===this.retryCount?(this._assertStatus("QUEUED"),this._states.next(this.options.id)):this._assertStatus("EXECUTING"),this.Events.trigger("scheduled",{args:this.args,options:this.options})}doExecute(e,t,n,r){var o=this;return i((function*(){var i,s,a;0===o.retryCount?(o._assertStatus("RUNNING"),o._states.next(o.options.id)):o._assertStatus("EXECUTING"),s={args:o.args,options:o.options,retryCount:o.retryCount},o.Events.trigger("executing",s);try{if(a=yield null!=e?e.schedule(o.options,o.task,...o.args):o.task(...o.args),t())return o.doDone(s),yield r(o.options,s),o._assertStatus("DONE"),o._resolve(a)}catch(e){return i=e,o._onFailure(i,s,t,n,r)}}))()}doExpire(e,t,n){var r,i;return this._states.jobStatus("RUNNING"===this.options.id)&&this._states.next(this.options.id),this._assertStatus("EXECUTING"),i={args:this.args,options:this.options,retryCount:this.retryCount},r=new o(`This job timed out after ${this.options.expiration} ms.`),this._onFailure(r,i,e,t,n)}_onFailure(e,t,n,r,o){var s=this;return i((function*(){var i,a;if(n())return null!=(i=yield s.Events.trigger("failed",e,t))?(a=~~i,s.Events.trigger("retry",`Retrying ${s.options.id} after ${a} ms`,t),s.retryCount++,r(a)):(s.doDone(t),yield o(s.options,t),s._assertStatus("DONE"),s._reject(e))}))()}doDone(e){return this._assertStatus("EXECUTING"),this._states.next(this.options.id),this.Events.trigger("done",e)}},e.exports=s},5073:function(e,t,n){function r(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){r(s,i,o,a,u,"next",e)}function u(e){r(s,i,o,a,u,"throw",e)}a(void 0)}))}}var o,s,a;a=n(6338),o=n(1650),s=class{constructor(e,t,n){this.instance=e,this.storeOptions=t,this.clientId=this.instance._randomIndex(),a.load(n,n,this),this._nextRequest=this._lastReservoirRefresh=this._lastReservoirIncrease=Date.now(),this._running=0,this._done=0,this._unblockTime=0,this.ready=this.Promise.resolve(),this.clients={},this._startHeartbeat()}_startHeartbeat(){var e;return null==this.heartbeat&&(null!=this.storeOptions.reservoirRefreshInterval&&null!=this.storeOptions.reservoirRefreshAmount||null!=this.storeOptions.reservoirIncreaseInterval&&null!=this.storeOptions.reservoirIncreaseAmount)?"function"==typeof(e=this.heartbeat=setInterval((()=>{var e,t,n,r,i;if(r=Date.now(),null!=this.storeOptions.reservoirRefreshInterval&&r>=this._lastReservoirRefresh+this.storeOptions.reservoirRefreshInterval&&(this._lastReservoirRefresh=r,this.storeOptions.reservoir=this.storeOptions.reservoirRefreshAmount,this.instance._drainAll(this.computeCapacity())),null!=this.storeOptions.reservoirIncreaseInterval&&r>=this._lastReservoirIncrease+this.storeOptions.reservoirIncreaseInterval){var o=this.storeOptions;if(e=o.reservoirIncreaseAmount,n=o.reservoirIncreaseMaximum,i=o.reservoir,this._lastReservoirIncrease=r,(t=null!=n?Math.min(e,n-i):e)>0)return this.storeOptions.reservoir+=t,this.instance._drainAll(this.computeCapacity())}}),this.heartbeatInterval)).unref?e.unref():void 0:clearInterval(this.heartbeat)}__publish__(e){var t=this;return i((function*(){return yield t.yieldLoop(),t.instance.Events.trigger("message",e.toString())}))()}__disconnect__(e){var t=this;return i((function*(){return yield t.yieldLoop(),clearInterval(t.heartbeat),t.Promise.resolve()}))()}yieldLoop(e=0){return new this.Promise((function(t,n){return setTimeout(t,e)}))}computePenalty(){var e;return null!=(e=this.storeOptions.penalty)?e:15*this.storeOptions.minTime||5e3}__updateSettings__(e){var t=this;return i((function*(){return yield t.yieldLoop(),a.overwrite(e,e,t.storeOptions),t._startHeartbeat(),t.instance._drainAll(t.computeCapacity()),!0}))()}__running__(){var e=this;return i((function*(){return yield e.yieldLoop(),e._running}))()}__queued__(){var e=this;return i((function*(){return yield e.yieldLoop(),e.instance.queued()}))()}__done__(){var e=this;return i((function*(){return yield e.yieldLoop(),e._done}))()}__groupCheck__(e){var t=this;return i((function*(){return yield t.yieldLoop(),t._nextRequest+t.timeout<e}))()}computeCapacity(){var e,t,n=this.storeOptions;return e=n.maxConcurrent,t=n.reservoir,null!=e&&null!=t?Math.min(e-this._running,t):null!=e?e-this._running:null!=t?t:null}conditionsCheck(e){var t;return null==(t=this.computeCapacity())||e<=t}__incrementReservoir__(e){var t=this;return i((function*(){var n;return yield t.yieldLoop(),n=t.storeOptions.reservoir+=e,t.instance._drainAll(t.computeCapacity()),n}))()}__currentReservoir__(){var e=this;return i((function*(){return yield e.yieldLoop(),e.storeOptions.reservoir}))()}isBlocked(e){return this._unblockTime>=e}check(e,t){return this.conditionsCheck(e)&&this._nextRequest-t<=0}__check__(e){var t=this;return i((function*(){var n;return yield t.yieldLoop(),n=Date.now(),t.check(e,n)}))()}__register__(e,t,n){var r=this;return i((function*(){var e,n;return yield r.yieldLoop(),e=Date.now(),r.conditionsCheck(t)?(r._running+=t,null!=r.storeOptions.reservoir&&(r.storeOptions.reservoir-=t),n=Math.max(r._nextRequest-e,0),r._nextRequest=e+n+r.storeOptions.minTime,{success:!0,wait:n,reservoir:r.storeOptions.reservoir}):{success:!1}}))()}strategyIsBlock(){return 3===this.storeOptions.strategy}__submit__(e,t){var n=this;return i((function*(){var r,i,s;if(yield n.yieldLoop(),null!=n.storeOptions.maxConcurrent&&t>n.storeOptions.maxConcurrent)throw new o(`Impossible to add a job having a weight of ${t} to a limiter having a maxConcurrent setting of ${n.storeOptions.maxConcurrent}`);return i=Date.now(),s=null!=n.storeOptions.highWater&&e===n.storeOptions.highWater&&!n.check(t,i),(r=n.strategyIsBlock()&&(s||n.isBlocked(i)))&&(n._unblockTime=i+n.computePenalty(),n._nextRequest=n._unblockTime+n.storeOptions.minTime,n.instance._dropAllQueued()),{reachedHWM:s,blocked:r,strategy:n.storeOptions.strategy}}))()}__free__(e,t){var n=this;return i((function*(){return yield n.yieldLoop(),n._running-=t,n._done+=t,n.instance._drainAll(n.computeCapacity()),{running:n._running}}))()}},e.exports=s},3969:function(e,t,n){var r,i,o;r=n(1085),i=n(9232),o=class{constructor(e){this.Events=new i(this),this._length=0,this._lists=function(){var t,n,i;for(i=[],t=1,n=e;1<=n?t<=n:t>=n;1<=n?++t:--t)i.push(new r((()=>this.incr()),(()=>this.decr())));return i}.call(this)}incr(){if(0==this._length++)return this.Events.trigger("leftzero")}decr(){if(0==--this._length)return this.Events.trigger("zero")}push(e){return this._lists[e.options.priority].push(e)}queued(e){return null!=e?this._lists[e].length:this._length}shiftAll(e){return this._lists.forEach((function(t){return t.forEachShift(e)}))}getFirst(e=this._lists){var t,n,r;for(t=0,n=e.length;t<n;t++)if((r=e[t]).length>0)return r;return[]}shiftLastFrom(e){return this.getFirst(this._lists.slice(e).reverse()).shift()}},e.exports=o},7146:function(module,__unused_webpack_exports,__webpack_require__){function asyncGeneratorStep(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){asyncGeneratorStep(o,r,i,s,a,"next",e)}function a(e){asyncGeneratorStep(o,r,i,s,a,"throw",e)}s(void 0)}))}}var Events,RedisConnection,Scripts,parser;parser=__webpack_require__(6338),Events=__webpack_require__(9232),Scripts=__webpack_require__(8885),RedisConnection=function(){class RedisConnection{constructor(options={}){parser.load(options,this.defaults,this),null==this.Redis&&(this.Redis=eval("require")("redis")),null==this.Events&&(this.Events=new Events(this)),this.terminated=!1,null==this.client&&(this.client=this.Redis.createClient(this.clientOptions)),this.subscriber=this.client.duplicate(),this.limiters={},this.shas={},this.ready=this.Promise.all([this._setup(this.client,!1),this._setup(this.subscriber,!0)]).then((()=>this._loadScripts())).then((()=>({client:this.client,subscriber:this.subscriber})))}_setup(e,t){return e.setMaxListeners(0),new this.Promise(((n,r)=>(e.on("error",(e=>this.Events.trigger("error",e))),t&&e.on("message",((e,t)=>{var n;return null!=(n=this.limiters[e])?n._store.onMessage(e,t):void 0})),e.ready?n():e.once("ready",n))))}_loadScript(e){return new this.Promise(((t,n)=>{var r;return r=Scripts.payload(e),this.client.multi([["script","load",r]]).exec(((r,i)=>null!=r?n(r):(this.shas[e]=i[0],t(i[0]))))}))}_loadScripts(){return this.Promise.all(Scripts.names.map((e=>this._loadScript(e))))}__runCommand__(e){var t=this;return _asyncToGenerator((function*(){return yield t.ready,new t.Promise(((n,r)=>t.client.multi([e]).exec_atomic((function(e,t){return null!=e?r(e):n(t[0])}))))}))()}__addLimiter__(e){return this.Promise.all([e.channel(),e.channel_client()].map((t=>new this.Promise(((n,r)=>{var i;return i=r=>{if(r===t)return this.subscriber.removeListener("subscribe",i),this.limiters[t]=e,n()},this.subscriber.on("subscribe",i),this.subscriber.subscribe(t)})))))}__removeLimiter__(e){var t=this;return this.Promise.all([e.channel(),e.channel_client()].map(function(){var e=_asyncToGenerator((function*(e){return t.terminated||(yield new t.Promise(((n,r)=>t.subscriber.unsubscribe(e,(function(t,i){return null!=t?r(t):i===e?n():void 0}))))),delete t.limiters[e]}));return function(t){return e.apply(this,arguments)}}()))}__scriptArgs__(e,t,n,r){var i;return i=Scripts.keys(e,t),[this.shas[e],i.length].concat(i,n,r)}__scriptFn__(e){return this.client.evalsha.bind(this.client)}disconnect(e=!0){var t,n,r,i;for(t=0,r=(i=Object.keys(this.limiters)).length;t<r;t++)n=i[t],clearInterval(this.limiters[n]._store.heartbeat);return this.limiters={},this.terminated=!0,this.client.end(e),this.subscriber.end(e),this.Promise.resolve()}}return RedisConnection.prototype.datastore="redis",RedisConnection.prototype.defaults={Redis:null,clientOptions:{},client:null,Promise:Promise,Events:null},RedisConnection}.call(void 0),module.exports=RedisConnection},9497:function(e,t,n){function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function a(e){i(s,r,o,a,u,"next",e)}function u(e){i(s,r,o,a,u,"throw",e)}a(void 0)}))}}var s,a,u,c,l;l=n(6338),s=n(1650),u=n(7146),a=n(5746),c=class{constructor(e,t,n){this.instance=e,this.storeOptions=t,this.originalId=this.instance.id,this.clientId=this.instance._randomIndex(),l.load(n,n,this),this.clients={},this.capacityPriorityCounters={},this.sharedConnection=null!=this.connection,null==this.connection&&(this.connection="redis"===this.instance.datastore?new u({Redis:this.Redis,clientOptions:this.clientOptions,Promise:this.Promise,Events:this.instance.Events}):"ioredis"===this.instance.datastore?new a({Redis:this.Redis,clientOptions:this.clientOptions,clusterNodes:this.clusterNodes,Promise:this.Promise,Events:this.instance.Events}):void 0),this.instance.connection=this.connection,this.instance.datastore=this.connection.datastore,this.ready=this.connection.ready.then((e=>(this.clients=e,this.runScript("init",this.prepareInitSettings(this.clearDatastore))))).then((()=>this.connection.__addLimiter__(this.instance))).then((()=>this.runScript("register_client",[this.instance.queued()]))).then((()=>{var e;return"function"==typeof(e=this.heartbeat=setInterval((()=>this.runScript("heartbeat",[]).catch((e=>this.instance.Events.trigger("error",e)))),this.heartbeatInterval)).unref&&e.unref(),this.clients}))}__publish__(e){var t=this;return o((function*(){return(yield t.ready).client.publish(t.instance.channel(),`message:${e.toString()}`)}))()}onMessage(e,t){var n=this;return o((function*(){var e,i,s,a,u,c,l,d,h,f;try{l=t.indexOf(":");var p=[t.slice(0,l),t.slice(l+1)];if(s=p[1],"capacity"===(f=p[0]))return yield n.instance._drainAll(s.length>0?~~s:void 0);if("capacity-priority"===f){var _=r(s.split(":"),3);return h=_[0],d=_[1],i=_[2],e=h.length>0?~~h:void 0,d===n.clientId?(a=yield n.instance._drainAll(e),c=null!=e?e-(a||0):"",yield n.clients.client.publish(n.instance.channel(),`capacity-priority:${c}::${i}`)):""===d?(clearTimeout(n.capacityPriorityCounters[i]),delete n.capacityPriorityCounters[i],n.instance._drainAll(e)):n.capacityPriorityCounters[i]=setTimeout(o((function*(){var t;try{return delete n.capacityPriorityCounters[i],yield n.runScript("blacklist_client",[d]),yield n.instance._drainAll(e)}catch(e){return t=e,n.instance.Events.trigger("error",t)}})),1e3)}if("message"===f)return n.instance.Events.trigger("message",s);if("blocked"===f)return yield n.instance._dropAllQueued()}catch(e){return u=e,n.instance.Events.trigger("error",u)}}))()}__disconnect__(e){return clearInterval(this.heartbeat),this.sharedConnection?this.connection.__removeLimiter__(this.instance):this.connection.disconnect(e)}runScript(e,t){var n=this;return o((function*(){return"init"!==e&&"register_client"!==e&&(yield n.ready),new n.Promise(((r,i)=>{var o,s;return o=[Date.now(),n.clientId].concat(t),n.instance.Events.trigger("debug",`Calling Redis script: ${e}.lua`,o),s=n.connection.__scriptArgs__(e,n.originalId,o,(function(e,t){return null!=e?i(e):r(t)})),n.connection.__scriptFn__(e)(...s)})).catch((r=>"SETTINGS_KEY_NOT_FOUND"===r.message?"heartbeat"===e?n.Promise.resolve():n.runScript("init",n.prepareInitSettings(!1)).then((()=>n.runScript(e,t))):"UNKNOWN_CLIENT"===r.message?n.runScript("register_client",[n.instance.queued()]).then((()=>n.runScript(e,t))):n.Promise.reject(r)))}))()}prepareArray(e){var t,n,r,i;for(r=[],t=0,n=e.length;t<n;t++)i=e[t],r.push(null!=i?i.toString():"");return r}prepareObject(e){var t,n,r;for(n in t=[],e)r=e[n],t.push(n,null!=r?r.toString():"");return t}prepareInitSettings(e){var t;return(t=this.prepareObject(Object.assign({},this.storeOptions,{id:this.originalId,version:this.instance.version,groupTimeout:this.timeout,clientTimeout:this.clientTimeout}))).unshift(e?1:0,this.instance.version),t}convertBool(e){return!!e}__updateSettings__(e){var t=this;return o((function*(){return yield t.runScript("update_settings",t.prepareObject(e)),l.overwrite(e,e,t.storeOptions)}))()}__running__(){return this.runScript("running",[])}__queued__(){return this.runScript("queued",[])}__done__(){return this.runScript("done",[])}__groupCheck__(){var e=this;return o((function*(){return e.convertBool(yield e.runScript("group_check",[]))}))()}__incrementReservoir__(e){return this.runScript("increment_reservoir",[e])}__currentReservoir__(){return this.runScript("current_reservoir",[])}__check__(e){var t=this;return o((function*(){return t.convertBool(yield t.runScript("check",t.prepareArray([e])))}))()}__register__(e,t,n){var i=this;return o((function*(){var o,s,a,u=r(yield i.runScript("register",i.prepareArray([e,t,n])),3);return s=u[0],a=u[1],o=u[2],{success:i.convertBool(s),wait:a,reservoir:o}}))()}__submit__(e,t){var n=this;return o((function*(){var i,o,a,u,c;try{var l=r(yield n.runScript("submit",n.prepareArray([e,t])),3);return u=l[0],i=l[1],c=l[2],{reachedHWM:n.convertBool(u),blocked:n.convertBool(i),strategy:c}}catch(e){if(0===(o=e).message.indexOf("OVERWEIGHT")){var d=r(o.message.split(":"),3);throw d[0],t=d[1],a=d[2],new s(`Impossible to add a job having a weight of ${t} to a limiter having a maxConcurrent setting of ${a}`)}throw o}}))()}__free__(e,t){var n=this;return o((function*(){return{running:yield n.runScript("free",n.prepareArray([e]))}}))()}},e.exports=c},8885:function(e,t,n){var r,i,o;i=n(5730),r={refs:i["refs.lua"],validate_keys:i["validate_keys.lua"],validate_client:i["validate_client.lua"],refresh_expiration:i["refresh_expiration.lua"],process_tick:i["process_tick.lua"],conditions_check:i["conditions_check.lua"],get_time:i["get_time.lua"]},t.allKeys=function(e){return[`b_${e}_settings`,`b_${e}_job_weights`,`b_${e}_job_expirations`,`b_${e}_job_clients`,`b_${e}_client_running`,`b_${e}_client_num_queued`,`b_${e}_client_last_registered`,`b_${e}_client_last_seen`]},o={init:{keys:t.allKeys,headers:["process_tick"],refresh_expiration:!0,code:i["init.lua"]},group_check:{keys:t.allKeys,headers:[],refresh_expiration:!1,code:i["group_check.lua"]},register_client:{keys:t.allKeys,headers:["validate_keys"],refresh_expiration:!1,code:i["register_client.lua"]},blacklist_client:{keys:t.allKeys,headers:["validate_keys","validate_client"],refresh_expiration:!1,code:i["blacklist_client.lua"]},heartbeat:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:i["heartbeat.lua"]},update_settings:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:i["update_settings.lua"]},running:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:i["running.lua"]},queued:{keys:t.allKeys,headers:["validate_keys","validate_client"],refresh_expiration:!1,code:i["queued.lua"]},done:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:i["done.lua"]},check:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!1,code:i["check.lua"]},submit:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!0,code:i["submit.lua"]},register:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!0,code:i["register.lua"]},free:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:i["free.lua"]},current_reservoir:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:i["current_reservoir.lua"]},increment_reservoir:{keys:t.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:i["increment_reservoir.lua"]}},t.names=Object.keys(o),t.keys=function(e,t){return o[e].keys(t)},t.payload=function(e){var t;return t=o[e],Array.prototype.concat(r.refs,t.headers.map((function(e){return r[e]})),t.refresh_expiration?r.refresh_expiration:"",t.code).join("\n")}},8975:function(e,t,n){var r,i;r=n(1650),i=class{constructor(e){this.status=e,this._jobs={},this.counts=this.status.map((function(){return 0}))}next(e){var t,n;return n=(t=this._jobs[e])+1,null!=t&&n<this.status.length?(this.counts[t]--,this.counts[n]++,this._jobs[e]++):null!=t?(this.counts[t]--,delete this._jobs[e]):void 0}start(e){return 0,this._jobs[e]=0,this.counts[0]++}remove(e){var t;return null!=(t=this._jobs[e])&&(this.counts[t]--,delete this._jobs[e]),null!=t}jobStatus(e){var t;return null!=(t=this.status[this._jobs[e]])?t:null}statusJobs(e){var t,n,i,o;if(null!=e){if((n=this.status.indexOf(e))<0)throw new r(`status must be one of ${this.status.join(", ")}`);for(t in o=[],i=this._jobs)i[t]===n&&o.push(t);return o}return Object.keys(this._jobs)}statusCounts(){return this.counts.reduce(((e,t,n)=>(e[this.status[n]]=t,e)),{})}},e.exports=i},622:function(e,t,n){function r(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){r(s,i,o,a,u,"next",e)}function u(e){r(s,i,o,a,u,"throw",e)}a(void 0)}))}}var o,s;o=n(1085),s=class{constructor(e,t){this.schedule=this.schedule.bind(this),this.name=e,this.Promise=t,this._running=0,this._queue=new o}isEmpty(){return 0===this._queue.length}_tryToRun(){var e=this;return i((function*(){var t,n,r,o,s,a,u;if(e._running<1&&e._queue.length>0){e._running++;var c=e._queue.shift();return u=c.task,t=c.args,s=c.resolve,o=c.reject,n=yield i((function*(){try{return a=yield u(...t),function(){return s(a)}}catch(e){return r=e,function(){return o(r)}}}))(),e._running--,e._tryToRun(),n()}}))()}schedule(e,...t){var n,r,i;return i=r=null,n=new this.Promise((function(e,t){return i=e,r=t})),this._queue.push({task:e,args:t,resolve:i,reject:r}),this._tryToRun(),n}},e.exports=s},2541:function(e,t,n){e.exports=n(4230)},6338:function(e,t){t.load=function(e,t,n={}){var r,i,o;for(r in t)o=t[r],n[r]=null!=(i=e[r])?i:o;return n},t.overwrite=function(e,t,n={}){var r,i;for(r in e)i=e[r],void 0!==t[r]&&(n[r]=i);return n}},9870:function(e,t){var n;!function(){var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var s=i.apply(null,n);s&&e.push(s)}}else if("object"===o)if(n.toString===Object.prototype.toString)for(var a in n)r.call(n,a)&&n[a]&&e.push(a);else e.push(n.toString())}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},3464:function(e){e.exports=function(){var e=1e3,t=6e4,n=36e5,r="millisecond",i="second",o="minute",s="hour",a="day",u="week",c="month",l="quarter",d="year",h="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},m=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},g={s:m,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+m(r,2,"0")+":"+m(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,c),o=n-i<0,s=t.clone().add(r+(o?-1:1),c);return+(-(r+(n-i)/(o?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:u,d:a,D:h,h:s,m:o,s:i,ms:r,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=v;var E=function(e){return e instanceof A},w=function e(t,n,r){var i;if(!t)return y;if("string"==typeof t){var o=t.toLowerCase();b[o]&&(i=o),n&&(b[o]=n,i=o);var s=t.split("-");if(!i&&s.length>1)return e(s[0])}else{var a=t.name;b[a]=t,i=a}return!r&&i&&(y=i),i||!r&&y},C=function(e,t){if(E(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new A(n)},T=g;T.l=w,T.i=E,T.w=function(e,t){return C(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var A=function(){function v(e){this.$L=w(e.locale,null,!0),this.parse(e)}var m=v.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(T.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(p);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return T},m.isValid=function(){return!(this.$d.toString()===f)},m.isSame=function(e,t){var n=C(e);return this.startOf(t)<=n&&n<=this.endOf(t)},m.isAfter=function(e,t){return C(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<C(e)},m.$g=function(e,t,n){return T.u(e)?this[t]:this.set(n,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,t){var n=this,r=!!T.u(t)||t,l=T.p(e),f=function(e,t){var i=T.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?i:i.endOf(a)},p=function(e,t){return T.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},_=this.$W,v=this.$M,m=this.$D,g="set"+(this.$u?"UTC":"");switch(l){case d:return r?f(1,0):f(31,11);case c:return r?f(1,v):f(0,v+1);case u:var y=this.$locale().weekStart||0,b=(_<y?_+7:_)-y;return f(r?m-b:m+(6-b),v);case a:case h:return p(g+"Hours",0);case s:return p(g+"Minutes",1);case o:return p(g+"Seconds",2);case i:return p(g+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(e,t){var n,u=T.p(e),l="set"+(this.$u?"UTC":""),f=(n={},n[a]=l+"Date",n[h]=l+"Date",n[c]=l+"Month",n[d]=l+"FullYear",n[s]=l+"Hours",n[o]=l+"Minutes",n[i]=l+"Seconds",n[r]=l+"Milliseconds",n)[u],p=u===a?this.$D+(t-this.$W):t;if(u===c||u===d){var _=this.clone().set(h,1);_.$d[f](p),_.init(),this.$d=_.set(h,Math.min(this.$D,_.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[T.p(e)]()},m.add=function(r,l){var h,f=this;r=Number(r);var p=T.p(l),_=function(e){var t=C(f);return T.w(t.date(t.date()+Math.round(e*r)),f)};if(p===c)return this.set(c,this.$M+r);if(p===d)return this.set(d,this.$y+r);if(p===a)return _(1);if(p===u)return _(7);var v=(h={},h[o]=t,h[s]=n,h[i]=e,h)[p]||1,m=this.$d.getTime()+r*v;return T.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=T.z(this),o=this.$H,s=this.$m,a=this.$M,u=n.weekdays,c=n.months,l=n.meridiem,d=function(e,n,i,o){return e&&(e[n]||e(t,r))||i[n].slice(0,o)},h=function(e){return T.s(o%12||12,e,"0")},p=l||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(_,(function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return T.s(t.$y,4,"0");case"M":return a+1;case"MM":return T.s(a+1,2,"0");case"MMM":return d(n.monthsShort,a,c,3);case"MMMM":return d(c,a);case"D":return t.$D;case"DD":return T.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(n.weekdaysMin,t.$W,u,2);case"ddd":return d(n.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(o);case"HH":return T.s(o,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return p(o,s,!0);case"A":return p(o,s,!1);case"m":return String(s);case"mm":return T.s(s,2,"0");case"s":return String(t.$s);case"ss":return T.s(t.$s,2,"0");case"SSS":return T.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,h,f){var p,_=this,v=T.p(h),m=C(r),g=(m.utcOffset()-this.utcOffset())*t,y=this-m,b=function(){return T.m(_,m)};switch(v){case d:p=b()/12;break;case c:p=b();break;case l:p=b()/3;break;case u:p=(y-g)/6048e5;break;case a:p=(y-g)/864e5;break;case s:p=y/n;break;case o:p=y/t;break;case i:p=y/e;break;default:p=y}return f?p:T.a(p)},m.daysInMonth=function(){return this.endOf(c).$D},m.$locale=function(){return b[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=w(e,t,!0);return r&&(n.$L=r),n},m.clone=function(){return T.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},v}(),S=A.prototype;return C.prototype=S,[["$ms",r],["$s",i],["$m",o],["$H",s],["$W",a],["$M",c],["$y",d],["$D",h]].forEach((function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),C.extend=function(e,t){return e.$i||(e(t,A,C),e.$i=!0),C},C.locale=w,C.isDayjs=E,C.unix=function(e){return C(1e3*e)},C.en=b[y],C.Ls=b,C.p={},C}()},1630:function(e){e.exports=function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\d\d/,r=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,o={},s=function(e){return(e=+e)+(e>68?1900:2e3)},a=function(e){return function(t){this[e]=+t}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),n=60*t[1]+(+t[2]||0);return 0===n?0:"+"===t[0]?-n:n}(e)}],c=function(e){var t=o[e];return t&&(t.indexOf?t:t.s.concat(t.f))},l=function(e,t){var n,r=o.meridiem;if(r){for(var i=1;i<=24;i+=1)if(e.indexOf(r(i,0,t))>-1){n=i>12;break}}else n=e===(t?"pm":"PM");return n},d={A:[i,function(e){this.afternoon=l(e,!1)}],a:[i,function(e){this.afternoon=l(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[n,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[r,a("seconds")],ss:[r,a("seconds")],m:[r,a("minutes")],mm:[r,a("minutes")],H:[r,a("hours")],h:[r,a("hours")],HH:[r,a("hours")],hh:[r,a("hours")],D:[r,a("day")],DD:[n,a("day")],Do:[i,function(e){var t=o.ordinal,n=e.match(/\d+/);if(this.day=n[0],t)for(var r=1;r<=31;r+=1)t(r).replace(/\[|\]/g,"")===e&&(this.day=r)}],M:[r,a("month")],MM:[n,a("month")],MMM:[i,function(e){var t=c("months"),n=(c("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[i,function(e){var t=c("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,a("year")],YY:[n,function(e){this.year=s(e)}],YYYY:[/\d{4}/,a("year")],Z:u,ZZ:u};function h(n){var r,i;r=n,i=o&&o.formats;for(var s=(n=r.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,n,r){var o=r&&r.toUpperCase();return n||i[r]||e[r]||i[o].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))).match(t),a=s.length,u=0;u<a;u+=1){var c=s[u],l=d[c],h=l&&l[0],f=l&&l[1];s[u]=f?{regex:h,parser:f}:c.replace(/^\[|\]$/g,"")}return function(e){for(var t={},n=0,r=0;n<a;n+=1){var i=s[n];if("string"==typeof i)r+=i.length;else{var o=i.regex,u=i.parser,c=e.slice(r),l=o.exec(c)[0];u.call(t,l),e=e.replace(l,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,n){n.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(s=e.parseTwoDigitYear);var r=t.prototype,i=r.parse;r.parse=function(e){var t=e.date,r=e.utc,s=e.args;this.$u=r;var a=s[1];if("string"==typeof a){var u=!0===s[2],c=!0===s[3],l=u||c,d=s[2];c&&(d=s[2]),o=this.$locale(),!u&&d&&(o=n.Ls[d]),this.$d=function(e,t,n){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var r=h(t)(e),i=r.year,o=r.month,s=r.day,a=r.hours,u=r.minutes,c=r.seconds,l=r.milliseconds,d=r.zone,f=new Date,p=s||(i||o?1:f.getDate()),_=i||f.getFullYear(),v=0;i&&!o||(v=o>0?o-1:f.getMonth());var m=a||0,g=u||0,y=c||0,b=l||0;return d?new Date(Date.UTC(_,v,p,m,g,y,b+60*d.offset*1e3)):n?new Date(Date.UTC(_,v,p,m,g,y,b)):new Date(_,v,p,m,g,y,b)}catch(e){return new Date("")}}(t,a,r),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),l&&t!=this.format(a)&&(this.$d=new Date("")),o={}}else if(a instanceof Array)for(var f=a.length,p=1;p<=f;p+=1){s[1]=a[p-1];var _=n.apply(this,s);if(_.isValid()){this.$d=_.$d,this.$L=_.$L,this.init();break}p===f&&(this.$d=new Date(""))}else i.call(this,e)}}}()},5562:function(e){e.exports=function(e,t,n){e=e||{};var r=t.prototype,i={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function o(e,t,n,i){return r.fromToBase(e,t,n,i)}n.en.relativeTime=i,r.fromToBase=function(t,r,o,s,a){for(var u,c,l,d=o.$locale().relativeTime||i,h=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],f=h.length,p=0;p<f;p+=1){var _=h[p];_.d&&(u=s?n(t).diff(o,_.d,!0):o.diff(t,_.d,!0));var v=(e.rounding||Math.round)(Math.abs(u));if(l=u>0,v<=_.r||!_.r){v<=1&&p>0&&(_=h[p-1]);var m=d[_.l];a&&(v=a(""+v)),c="string"==typeof m?m.replace("%d",v):m(v,r,_.l,l);break}}if(r)return c;var g=l?d.future:d.past;return"function"==typeof g?g(c):g.replace("%s",c)},r.to=function(e,t){return o(e,t,this,!0)},r.from=function(e,t){return o(e,t,this)};var s=function(e){return e.$u?n.utc():n()};r.toNow=function(e){return this.to(s(this),e)},r.fromNow=function(e){return this.from(s(this),e)}}},7657:function(e){var t,n,r;e.exports=(t="minute",n=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g,function(e,i,o){var s=i.prototype;o.utc=function(e){return new i({date:e,utc:!0,args:arguments})},s.utc=function(e){var n=o(this.toDate(),{locale:this.$L,utc:!0});return e?n.add(this.utcOffset(),t):n},s.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var a=s.parse;s.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),a.call(this,e)};var u=s.init;s.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else u.call(this)};var c=s.utcOffset;s.utcOffset=function(e,i){var o=this.$utils().u;if(o(e))return this.$u?0:o(this.$offset)?c.call(this):this.$offset;if("string"==typeof e&&(e=function(e){void 0===e&&(e="");var t=e.match(n);if(!t)return null;var i=(""+t[0]).match(r)||["-",0,0],o=i[0],s=60*+i[1]+ +i[2];return 0===s?0:"+"===o?s:-s}(e),null===e))return this;var s=Math.abs(e)<=16?60*e:e,a=this;if(i)return a.$offset=s,a.$u=0===e,a;if(0!==e){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(a=this.local().add(s+u,t)).$offset=s,a.$x.$localOffset=u}else a=this.utc();return a};var l=s.format;s.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},s.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()};var d=s.toDate;s.toDate=function(e){return"s"===e&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var h=s.diff;s.diff=function(e,t,n){if(e&&this.$u===e.$u)return h.call(this,e,t,n);var r=this.local(),i=o(e).local();return h.call(r,i,t,n)}})},1651:function(e){e.exports=function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,n){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,n)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,i,o){return r=n()?Reflect.construct:function(e,n,r){var i=[null];i.push.apply(i,n);var o=new(Function.bind.apply(e,i));return r&&t(o,r.prototype),o},r.apply(null,arguments)}function i(e){return o(e)||s(e)||a(e)||c()}function o(e){if(Array.isArray(e))return u(e)}function s(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function a(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=Object.hasOwnProperty,d=Object.setPrototypeOf,h=Object.isFrozen,f=Object.getPrototypeOf,p=Object.getOwnPropertyDescriptor,_=Object.freeze,v=Object.seal,m=Object.create,g="undefined"!=typeof Reflect&&Reflect,y=g.apply,b=g.construct;y||(y=function(e,t,n){return e.apply(t,n)}),_||(_=function(e){return e}),v||(v=function(e){return e}),b||(b=function(e,t){return r(e,i(t))});var E=M(Array.prototype.forEach),w=M(Array.prototype.pop),C=M(Array.prototype.push),T=M(String.prototype.toLowerCase),A=M(String.prototype.toString),S=M(String.prototype.match),I=M(String.prototype.replace),N=M(String.prototype.indexOf),k=M(String.prototype.trim),x=M(RegExp.prototype.test),O=R(TypeError);function M(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return y(e,t,r)}}function R(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return b(e,n)}}function D(e,t,n){var r;n=null!==(r=n)&&void 0!==r?r:T,d&&d(e,null);for(var i=t.length;i--;){var o=t[i];if("string"==typeof o){var s=n(o);s!==o&&(h(t)||(t[i]=s),o=s)}e[o]=!0}return e}function U(e){var t,n=m(null);for(t in e)!0===y(l,e,[t])&&(n[t]=e[t]);return n}function L(e,t){for(;null!==e;){var n=p(e,t);if(n){if(n.get)return M(n.get);if("function"==typeof n.value)return M(n.value)}e=f(e)}function r(e){return console.warn("fallback value for",e),null}return r}var P=_(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),F=_(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),j=_(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),q=_(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),H=_(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),V=_(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),B=_(["#text"]),z=_(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),G=_(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),W=_(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),K=_(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Q=v(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Z=v(/<%[\w\W]*|[\w\W]*%>/gm),Y=v(/\${[\w\W]*}/gm),$=v(/^data-[\-\w.\u00B7-\uFFFF]/),X=v(/^aria-[\-\w]+$/),J=v(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ee=v(/^(?:\w+script|data):/i),te=v(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ne=v(/^html$/i),re=function(){return"undefined"==typeof window?null:window},ie=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function oe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re(),n=function(e){return oe(e)};if(n.version="2.4.7",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,o=t.document,s=t.DocumentFragment,a=t.HTMLTemplateElement,u=t.Node,c=t.Element,l=t.NodeFilter,d=t.NamedNodeMap,h=void 0===d?t.NamedNodeMap||t.MozNamedAttrMap:d,f=t.HTMLFormElement,p=t.DOMParser,v=t.trustedTypes,m=c.prototype,g=L(m,"cloneNode"),y=L(m,"nextSibling"),b=L(m,"childNodes"),M=L(m,"parentNode");if("function"==typeof a){var R=o.createElement("template");R.content&&R.content.ownerDocument&&(o=R.content.ownerDocument)}var se=ie(v,r),ae=se?se.createHTML(""):"",ue=o,ce=ue.implementation,le=ue.createNodeIterator,de=ue.createDocumentFragment,he=ue.getElementsByTagName,fe=r.importNode,pe={};try{pe=U(o).documentMode?o.documentMode:{}}catch(e){}var _e={};n.isSupported="function"==typeof M&&ce&&void 0!==ce.createHTMLDocument&&9!==pe;var ve,me,ge=Q,ye=Z,be=Y,Ee=$,we=X,Ce=ee,Te=te,Ae=J,Se=null,Ie=D({},[].concat(i(P),i(F),i(j),i(H),i(B))),Ne=null,ke=D({},[].concat(i(z),i(G),i(W),i(K))),xe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,Me=null,Re=!0,De=!0,Ue=!1,Le=!0,Pe=!1,Fe=!1,je=!1,qe=!1,He=!1,Ve=!1,Be=!1,ze=!0,Ge=!1,We="user-content-",Ke=!0,Qe=!1,Ze={},Ye=null,$e=D({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Xe=null,Je=D({},["audio","video","img","source","image","track"]),et=null,tt=D({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nt="http://www.w3.org/1998/Math/MathML",rt="http://www.w3.org/2000/svg",it="http://www.w3.org/1999/xhtml",ot=it,st=!1,at=null,ut=D({},[nt,rt,it],A),ct=["application/xhtml+xml","text/html"],lt="text/html",dt=null,ht=o.createElement("form"),ft=function(e){return e instanceof RegExp||e instanceof Function},pt=function(t){dt&&dt===t||(t&&"object"===e(t)||(t={}),t=U(t),ve=ve=-1===ct.indexOf(t.PARSER_MEDIA_TYPE)?lt:t.PARSER_MEDIA_TYPE,me="application/xhtml+xml"===ve?A:T,Se="ALLOWED_TAGS"in t?D({},t.ALLOWED_TAGS,me):Ie,Ne="ALLOWED_ATTR"in t?D({},t.ALLOWED_ATTR,me):ke,at="ALLOWED_NAMESPACES"in t?D({},t.ALLOWED_NAMESPACES,A):ut,et="ADD_URI_SAFE_ATTR"in t?D(U(tt),t.ADD_URI_SAFE_ATTR,me):tt,Xe="ADD_DATA_URI_TAGS"in t?D(U(Je),t.ADD_DATA_URI_TAGS,me):Je,Ye="FORBID_CONTENTS"in t?D({},t.FORBID_CONTENTS,me):$e,Oe="FORBID_TAGS"in t?D({},t.FORBID_TAGS,me):{},Me="FORBID_ATTR"in t?D({},t.FORBID_ATTR,me):{},Ze="USE_PROFILES"in t&&t.USE_PROFILES,Re=!1!==t.ALLOW_ARIA_ATTR,De=!1!==t.ALLOW_DATA_ATTR,Ue=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Le=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Pe=t.SAFE_FOR_TEMPLATES||!1,Fe=t.WHOLE_DOCUMENT||!1,He=t.RETURN_DOM||!1,Ve=t.RETURN_DOM_FRAGMENT||!1,Be=t.RETURN_TRUSTED_TYPE||!1,qe=t.FORCE_BODY||!1,ze=!1!==t.SANITIZE_DOM,Ge=t.SANITIZE_NAMED_PROPS||!1,Ke=!1!==t.KEEP_CONTENT,Qe=t.IN_PLACE||!1,Ae=t.ALLOWED_URI_REGEXP||Ae,ot=t.NAMESPACE||it,xe=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ft(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ft(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(xe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Pe&&(De=!1),Ve&&(He=!0),Ze&&(Se=D({},i(B)),Ne=[],!0===Ze.html&&(D(Se,P),D(Ne,z)),!0===Ze.svg&&(D(Se,F),D(Ne,G),D(Ne,K)),!0===Ze.svgFilters&&(D(Se,j),D(Ne,G),D(Ne,K)),!0===Ze.mathMl&&(D(Se,H),D(Ne,W),D(Ne,K))),t.ADD_TAGS&&(Se===Ie&&(Se=U(Se)),D(Se,t.ADD_TAGS,me)),t.ADD_ATTR&&(Ne===ke&&(Ne=U(Ne)),D(Ne,t.ADD_ATTR,me)),t.ADD_URI_SAFE_ATTR&&D(et,t.ADD_URI_SAFE_ATTR,me),t.FORBID_CONTENTS&&(Ye===$e&&(Ye=U(Ye)),D(Ye,t.FORBID_CONTENTS,me)),Ke&&(Se["#text"]=!0),Fe&&D(Se,["html","head","body"]),Se.table&&(D(Se,["tbody"]),delete Oe.tbody),_&&_(t),dt=t)},_t=D({},["mi","mo","mn","ms","mtext"]),vt=D({},["foreignobject","desc","title","annotation-xml"]),mt=D({},["title","style","font","a","script"]),gt=D({},F);D(gt,j),D(gt,q);var yt=D({},H);D(yt,V);var bt=function(e){var t=M(e);t&&t.tagName||(t={namespaceURI:ot,tagName:"template"});var n=T(e.tagName),r=T(t.tagName);return!!at[e.namespaceURI]&&(e.namespaceURI===rt?t.namespaceURI===it?"svg"===n:t.namespaceURI===nt?"svg"===n&&("annotation-xml"===r||_t[r]):Boolean(gt[n]):e.namespaceURI===nt?t.namespaceURI===it?"math"===n:t.namespaceURI===rt?"math"===n&&vt[r]:Boolean(yt[n]):e.namespaceURI===it?!(t.namespaceURI===rt&&!vt[r])&&!(t.namespaceURI===nt&&!_t[r])&&!yt[n]&&(mt[n]||!gt[n]):!("application/xhtml+xml"!==ve||!at[e.namespaceURI]))},Et=function(e){C(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ae}catch(t){e.remove()}}},wt=function(e,t){try{C(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){C(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Ne[e])if(He||Ve)try{Et(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Ct=function(e){var t,n;if(qe)e="<remove></remove>"+e;else{var r=S(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===ve&&ot===it&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=se?se.createHTML(e):e;if(ot===it)try{t=(new p).parseFromString(i,ve)}catch(e){}if(!t||!t.documentElement){t=ce.createDocument(ot,"template",null);try{t.documentElement.innerHTML=st?ae:i}catch(e){}}var s=t.body||t.documentElement;return e&&n&&s.insertBefore(o.createTextNode(n),s.childNodes[0]||null),ot===it?he.call(t,Fe?"html":"body")[0]:Fe?t.documentElement:s},Tt=function(e){return le.call(e.ownerDocument||e,e,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},At=function(e){return e instanceof f&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof h)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},St=function(t){return"object"===e(u)?t instanceof u:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},It=function(e,t,r){_e[e]&&E(_e[e],(function(e){e.call(n,t,r,dt)}))},Nt=function(e){var t;if(It("beforeSanitizeElements",e,null),At(e))return Et(e),!0;if(x(/[\u0080-\uFFFF]/,e.nodeName))return Et(e),!0;var r=me(e.nodeName);if(It("uponSanitizeElement",e,{tagName:r,allowedTags:Se}),e.hasChildNodes()&&!St(e.firstElementChild)&&(!St(e.content)||!St(e.content.firstElementChild))&&x(/<[/\w]/g,e.innerHTML)&&x(/<[/\w]/g,e.textContent))return Et(e),!0;if("select"===r&&x(/<template/i,e.innerHTML))return Et(e),!0;if(!Se[r]||Oe[r]){if(!Oe[r]&&xt(r)){if(xe.tagNameCheck instanceof RegExp&&x(xe.tagNameCheck,r))return!1;if(xe.tagNameCheck instanceof Function&&xe.tagNameCheck(r))return!1}if(Ke&&!Ye[r]){var i=M(e)||e.parentNode,o=b(e)||e.childNodes;if(o&&i)for(var s=o.length-1;s>=0;--s)i.insertBefore(g(o[s],!0),y(e))}return Et(e),!0}return e instanceof c&&!bt(e)?(Et(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!x(/<\/no(script|embed|frames)/i,e.innerHTML)?(Pe&&3===e.nodeType&&(t=e.textContent,t=I(t,ge," "),t=I(t,ye," "),t=I(t,be," "),e.textContent!==t&&(C(n.removed,{element:e.cloneNode()}),e.textContent=t)),It("afterSanitizeElements",e,null),!1):(Et(e),!0)},kt=function(e,t,n){if(ze&&("id"===t||"name"===t)&&(n in o||n in ht))return!1;if(De&&!Me[t]&&x(Ee,t));else if(Re&&x(we,t));else if(!Ne[t]||Me[t]){if(!(xt(e)&&(xe.tagNameCheck instanceof RegExp&&x(xe.tagNameCheck,e)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(e))&&(xe.attributeNameCheck instanceof RegExp&&x(xe.attributeNameCheck,t)||xe.attributeNameCheck instanceof Function&&xe.attributeNameCheck(t))||"is"===t&&xe.allowCustomizedBuiltInElements&&(xe.tagNameCheck instanceof RegExp&&x(xe.tagNameCheck,n)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(n))))return!1}else if(et[t]);else if(x(Ae,I(n,Te,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==N(n,"data:")||!Xe[e])if(Ue&&!x(Ce,I(n,Te,"")));else if(n)return!1;return!0},xt=function(e){return e.indexOf("-")>0},Ot=function(t){var r,i,o,s;It("beforeSanitizeAttributes",t,null);var a=t.attributes;if(a){var u={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ne};for(s=a.length;s--;){var c=r=a[s],l=c.name,d=c.namespaceURI;if(i="value"===l?r.value:k(r.value),o=me(l),u.attrName=o,u.attrValue=i,u.keepAttr=!0,u.forceKeepAttr=void 0,It("uponSanitizeAttribute",t,u),i=u.attrValue,!u.forceKeepAttr&&(wt(l,t),u.keepAttr))if(Le||!x(/\/>/i,i)){Pe&&(i=I(i,ge," "),i=I(i,ye," "),i=I(i,be," "));var h=me(t.nodeName);if(kt(h,o,i)){if(!Ge||"id"!==o&&"name"!==o||(wt(l,t),i=We+i),se&&"object"===e(v)&&"function"==typeof v.getAttributeType)if(d);else switch(v.getAttributeType(h,o)){case"TrustedHTML":i=se.createHTML(i);break;case"TrustedScriptURL":i=se.createScriptURL(i)}try{d?t.setAttributeNS(d,l,i):t.setAttribute(l,i),w(n.removed)}catch(e){}}}else wt(l,t)}It("afterSanitizeAttributes",t,null)}},Mt=function e(t){var n,r=Tt(t);for(It("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)It("uponSanitizeShadowNode",n,null),Nt(n)||(n.content instanceof s&&e(n.content),Ot(n));It("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(i){var o,a,c,l,d,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((st=!i)&&(i="\x3c!--\x3e"),"string"!=typeof i&&!St(i)){if("function"!=typeof i.toString)throw O("toString is not a function");if("string"!=typeof(i=i.toString()))throw O("dirty is not a string, aborting")}if(!n.isSupported){if("object"===e(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof i)return t.toStaticHTML(i);if(St(i))return t.toStaticHTML(i.outerHTML)}return i}if(je||pt(h),n.removed=[],"string"==typeof i&&(Qe=!1),Qe){if(i.nodeName){var f=me(i.nodeName);if(!Se[f]||Oe[f])throw O("root node is forbidden and cannot be sanitized in-place")}}else if(i instanceof u)1===(a=(o=Ct("\x3c!----\x3e")).ownerDocument.importNode(i,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?o=a:o.appendChild(a);else{if(!He&&!Pe&&!Fe&&-1===i.indexOf("<"))return se&&Be?se.createHTML(i):i;if(!(o=Ct(i)))return He?null:Be?ae:""}o&&qe&&Et(o.firstChild);for(var p=Tt(Qe?i:o);c=p.nextNode();)3===c.nodeType&&c===l||Nt(c)||(c.content instanceof s&&Mt(c.content),Ot(c),l=c);if(l=null,Qe)return i;if(He){if(Ve)for(d=de.call(o.ownerDocument);o.firstChild;)d.appendChild(o.firstChild);else d=o;return(Ne.shadowroot||Ne.shadowrootmod)&&(d=fe.call(r,d,!0)),d}var _=Fe?o.outerHTML:o.innerHTML;return Fe&&Se["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&x(ne,o.ownerDocument.doctype.name)&&(_="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+_),Pe&&(_=I(_,ge," "),_=I(_,ye," "),_=I(_,be," ")),se&&Be?se.createHTML(_):_},n.setConfig=function(e){pt(e),je=!0},n.clearConfig=function(){dt=null,je=!1},n.isValidAttribute=function(e,t,n){dt||pt({});var r=me(e),i=me(t);return kt(r,i,n)},n.addHook=function(e,t){"function"==typeof t&&(_e[e]=_e[e]||[],C(_e[e],t))},n.removeHook=function(e){if(_e[e])return w(_e[e])},n.removeHooks=function(e){_e[e]&&(_e[e]=[])},n.removeAllHooks=function(){_e={}},n}return oe()}()},5985:function(e,t,n){var r=n(524),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function u(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var c=Object.defineProperty,l=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!=typeof n){if(p){var i=f(n);i&&i!==p&&e(t,i,r)}var s=l(n);d&&(s=s.concat(d(n)));for(var a=u(t),_=u(n),v=0;v<s.length;++v){var m=s[v];if(!(o[m]||r&&r[m]||_&&_[m]||a&&a[m])){var g=h(n,m);try{c(t,m,g)}catch(e){}}}}return t}},8958:function(e){e.exports=function(e,t,n,r,i,o,s,a){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,i,o,s,a],l=0;(u=new Error(t.replace(/%s/g,(function(){return c[l++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}}},5730:function(e){e.exports={"blacklist_client.lua":"local blacklist = ARGV[num_static_argv + 1]\n\nif redis.call('zscore', client_last_seen_key, blacklist) then\n  redis.call('zadd', client_last_seen_key, 0, blacklist)\nend\n\n\nreturn {}\n","check.lua":"local weight = tonumber(ARGV[num_static_argv + 1])\n\nlocal capacity = process_tick(now, false)['capacity']\nlocal nextRequest = tonumber(redis.call('hget', settings_key, 'nextRequest'))\n\nreturn conditions_check(capacity, weight) and nextRequest - now <= 0\n","conditions_check.lua":"local conditions_check = function (capacity, weight)\n  return capacity == nil or weight <= capacity\nend\n","current_reservoir.lua":"return process_tick(now, false)['reservoir']\n","done.lua":"process_tick(now, false)\n\nreturn tonumber(redis.call('hget', settings_key, 'done'))\n","free.lua":"local index = ARGV[num_static_argv + 1]\n\nredis.call('zadd', job_expirations_key, 0, index)\n\nreturn process_tick(now, false)['running']\n","get_time.lua":"redis.replicate_commands()\n\nlocal get_time = function ()\n  local time = redis.call('time')\n\n  return tonumber(time[1]..string.sub(time[2], 1, 3))\nend\n","group_check.lua":"return not (redis.call('exists', settings_key) == 1)\n","heartbeat.lua":"process_tick(now, true)\n","increment_reservoir.lua":"local incr = tonumber(ARGV[num_static_argv + 1])\n\nredis.call('hincrby', settings_key, 'reservoir', incr)\n\nlocal reservoir = process_tick(now, true)['reservoir']\n\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\nrefresh_expiration(0, 0, groupTimeout)\n\nreturn reservoir\n","init.lua":"local clear = tonumber(ARGV[num_static_argv + 1])\nlocal limiter_version = ARGV[num_static_argv + 2]\nlocal num_local_argv = num_static_argv + 2\n\nif clear == 1 then\n  redis.call('del', unpack(KEYS))\nend\n\nif redis.call('exists', settings_key) == 0 then\n  -- Create\n  local args = {'hmset', settings_key}\n\n  for i = num_local_argv + 1, #ARGV do\n    table.insert(args, ARGV[i])\n  end\n\n  redis.call(unpack(args))\n  redis.call('hmset', settings_key,\n    'nextRequest', now,\n    'lastReservoirRefresh', now,\n    'lastReservoirIncrease', now,\n    'running', 0,\n    'done', 0,\n    'unblockTime', 0,\n    'capacityPriorityCounter', 0\n  )\n\nelse\n  -- Apply migrations\n  local settings = redis.call('hmget', settings_key,\n    'id',\n    'version'\n  )\n  local id = settings[1]\n  local current_version = settings[2]\n\n  if current_version ~= limiter_version then\n    local version_digits = {}\n    for k, v in string.gmatch(current_version, \"([^.]+)\") do\n      table.insert(version_digits, tonumber(k))\n    end\n\n    -- 2.10.0\n    if version_digits[2] < 10 then\n      redis.call('hsetnx', settings_key, 'reservoirRefreshInterval', '')\n      redis.call('hsetnx', settings_key, 'reservoirRefreshAmount', '')\n      redis.call('hsetnx', settings_key, 'lastReservoirRefresh', '')\n      redis.call('hsetnx', settings_key, 'done', 0)\n      redis.call('hset', settings_key, 'version', '2.10.0')\n    end\n\n    -- 2.11.1\n    if version_digits[2] < 11 or (version_digits[2] == 11 and version_digits[3] < 1) then\n      if redis.call('hstrlen', settings_key, 'lastReservoirRefresh') == 0 then\n        redis.call('hmset', settings_key,\n          'lastReservoirRefresh', now,\n          'version', '2.11.1'\n        )\n      end\n    end\n\n    -- 2.14.0\n    if version_digits[2] < 14 then\n      local old_running_key = 'b_'..id..'_running'\n      local old_executing_key = 'b_'..id..'_executing'\n\n      if redis.call('exists', old_running_key) == 1 then\n        redis.call('rename', old_running_key, job_weights_key)\n      end\n      if redis.call('exists', old_executing_key) == 1 then\n        redis.call('rename', old_executing_key, job_expirations_key)\n      end\n      redis.call('hset', settings_key, 'version', '2.14.0')\n    end\n\n    -- 2.15.2\n    if version_digits[2] < 15 or (version_digits[2] == 15 and version_digits[3] < 2) then\n      redis.call('hsetnx', settings_key, 'capacityPriorityCounter', 0)\n      redis.call('hset', settings_key, 'version', '2.15.2')\n    end\n\n    -- 2.17.0\n    if version_digits[2] < 17 then\n      redis.call('hsetnx', settings_key, 'clientTimeout', 10000)\n      redis.call('hset', settings_key, 'version', '2.17.0')\n    end\n\n    -- 2.18.0\n    if version_digits[2] < 18 then\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseInterval', '')\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseAmount', '')\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseMaximum', '')\n      redis.call('hsetnx', settings_key, 'lastReservoirIncrease', now)\n      redis.call('hset', settings_key, 'version', '2.18.0')\n    end\n\n  end\n\n  process_tick(now, false)\nend\n\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\nrefresh_expiration(0, 0, groupTimeout)\n\nreturn {}\n","process_tick.lua":"local process_tick = function (now, always_publish)\n\n  local compute_capacity = function (maxConcurrent, running, reservoir)\n    if maxConcurrent ~= nil and reservoir ~= nil then\n      return math.min((maxConcurrent - running), reservoir)\n    elseif maxConcurrent ~= nil then\n      return maxConcurrent - running\n    elseif reservoir ~= nil then\n      return reservoir\n    else\n      return nil\n    end\n  end\n\n  local settings = redis.call('hmget', settings_key,\n    'id',\n    'maxConcurrent',\n    'running',\n    'reservoir',\n    'reservoirRefreshInterval',\n    'reservoirRefreshAmount',\n    'lastReservoirRefresh',\n    'reservoirIncreaseInterval',\n    'reservoirIncreaseAmount',\n    'reservoirIncreaseMaximum',\n    'lastReservoirIncrease',\n    'capacityPriorityCounter',\n    'clientTimeout'\n  )\n  local id = settings[1]\n  local maxConcurrent = tonumber(settings[2])\n  local running = tonumber(settings[3])\n  local reservoir = tonumber(settings[4])\n  local reservoirRefreshInterval = tonumber(settings[5])\n  local reservoirRefreshAmount = tonumber(settings[6])\n  local lastReservoirRefresh = tonumber(settings[7])\n  local reservoirIncreaseInterval = tonumber(settings[8])\n  local reservoirIncreaseAmount = tonumber(settings[9])\n  local reservoirIncreaseMaximum = tonumber(settings[10])\n  local lastReservoirIncrease = tonumber(settings[11])\n  local capacityPriorityCounter = tonumber(settings[12])\n  local clientTimeout = tonumber(settings[13])\n\n  local initial_capacity = compute_capacity(maxConcurrent, running, reservoir)\n\n  --\n  -- Process 'running' changes\n  --\n  local expired = redis.call('zrangebyscore', job_expirations_key, '-inf', '('..now)\n\n  if #expired > 0 then\n    redis.call('zremrangebyscore', job_expirations_key, '-inf', '('..now)\n\n    local flush_batch = function (batch, acc)\n      local weights = redis.call('hmget', job_weights_key, unpack(batch))\n                      redis.call('hdel',  job_weights_key, unpack(batch))\n      local clients = redis.call('hmget', job_clients_key, unpack(batch))\n                      redis.call('hdel',  job_clients_key, unpack(batch))\n\n      -- Calculate sum of removed weights\n      for i = 1, #weights do\n        acc['total'] = acc['total'] + (tonumber(weights[i]) or 0)\n      end\n\n      -- Calculate sum of removed weights by client\n      local client_weights = {}\n      for i = 1, #clients do\n        local removed = tonumber(weights[i]) or 0\n        if removed > 0 then\n          acc['client_weights'][clients[i]] = (acc['client_weights'][clients[i]] or 0) + removed\n        end\n      end\n    end\n\n    local acc = {\n      ['total'] = 0,\n      ['client_weights'] = {}\n    }\n    local batch_size = 1000\n\n    -- Compute changes to Zsets and apply changes to Hashes\n    for i = 1, #expired, batch_size do\n      local batch = {}\n      for j = i, math.min(i + batch_size - 1, #expired) do\n        table.insert(batch, expired[j])\n      end\n\n      flush_batch(batch, acc)\n    end\n\n    -- Apply changes to Zsets\n    if acc['total'] > 0 then\n      redis.call('hincrby', settings_key, 'done', acc['total'])\n      running = tonumber(redis.call('hincrby', settings_key, 'running', -acc['total']))\n    end\n\n    for client, weight in pairs(acc['client_weights']) do\n      redis.call('zincrby', client_running_key, -weight, client)\n    end\n  end\n\n  --\n  -- Process 'reservoir' changes\n  --\n  local reservoirRefreshActive = reservoirRefreshInterval ~= nil and reservoirRefreshAmount ~= nil\n  if reservoirRefreshActive and now >= lastReservoirRefresh + reservoirRefreshInterval then\n    reservoir = reservoirRefreshAmount\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir,\n      'lastReservoirRefresh', now\n    )\n  end\n\n  local reservoirIncreaseActive = reservoirIncreaseInterval ~= nil and reservoirIncreaseAmount ~= nil\n  if reservoirIncreaseActive and now >= lastReservoirIncrease + reservoirIncreaseInterval then\n    local num_intervals = math.floor((now - lastReservoirIncrease) / reservoirIncreaseInterval)\n    local incr = reservoirIncreaseAmount * num_intervals\n    if reservoirIncreaseMaximum ~= nil then\n      incr = math.min(incr, reservoirIncreaseMaximum - (reservoir or 0))\n    end\n    if incr > 0 then\n      reservoir = (reservoir or 0) + incr\n    end\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir,\n      'lastReservoirIncrease', lastReservoirIncrease + (num_intervals * reservoirIncreaseInterval)\n    )\n  end\n\n  --\n  -- Clear unresponsive clients\n  --\n  local unresponsive = redis.call('zrangebyscore', client_last_seen_key, '-inf', (now - clientTimeout))\n  local unresponsive_lookup = {}\n  local terminated_clients = {}\n  for i = 1, #unresponsive do\n    unresponsive_lookup[unresponsive[i]] = true\n    if tonumber(redis.call('zscore', client_running_key, unresponsive[i])) == 0 then\n      table.insert(terminated_clients, unresponsive[i])\n    end\n  end\n  if #terminated_clients > 0 then\n    redis.call('zrem', client_running_key,         unpack(terminated_clients))\n    redis.call('hdel', client_num_queued_key,      unpack(terminated_clients))\n    redis.call('zrem', client_last_registered_key, unpack(terminated_clients))\n    redis.call('zrem', client_last_seen_key,       unpack(terminated_clients))\n  end\n\n  --\n  -- Broadcast capacity changes\n  --\n  local final_capacity = compute_capacity(maxConcurrent, running, reservoir)\n\n  if always_publish or (initial_capacity ~= nil and final_capacity == nil) then\n    -- always_publish or was not unlimited, now unlimited\n    redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))\n\n  elseif initial_capacity ~= nil and final_capacity ~= nil and final_capacity > initial_capacity then\n    -- capacity was increased\n    -- send the capacity message to the limiter having the lowest number of running jobs\n    -- the tiebreaker is the limiter having not registered a job in the longest time\n\n    local lowest_concurrency_value = nil\n    local lowest_concurrency_clients = {}\n    local lowest_concurrency_last_registered = {}\n    local client_concurrencies = redis.call('zrange', client_running_key, 0, -1, 'withscores')\n\n    for i = 1, #client_concurrencies, 2 do\n      local client = client_concurrencies[i]\n      local concurrency = tonumber(client_concurrencies[i+1])\n\n      if (\n        lowest_concurrency_value == nil or lowest_concurrency_value == concurrency\n      ) and (\n        not unresponsive_lookup[client]\n      ) and (\n        tonumber(redis.call('hget', client_num_queued_key, client)) > 0\n      ) then\n        lowest_concurrency_value = concurrency\n        table.insert(lowest_concurrency_clients, client)\n        local last_registered = tonumber(redis.call('zscore', client_last_registered_key, client))\n        table.insert(lowest_concurrency_last_registered, last_registered)\n      end\n    end\n\n    if #lowest_concurrency_clients > 0 then\n      local position = 1\n      local earliest = lowest_concurrency_last_registered[1]\n\n      for i,v in ipairs(lowest_concurrency_last_registered) do\n        if v < earliest then\n          position = i\n          earliest = v\n        end\n      end\n\n      local next_client = lowest_concurrency_clients[position]\n      redis.call('publish', 'b_'..id,\n        'capacity-priority:'..(final_capacity or '')..\n        ':'..next_client..\n        ':'..capacityPriorityCounter\n      )\n      redis.call('hincrby', settings_key, 'capacityPriorityCounter', '1')\n    else\n      redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))\n    end\n  end\n\n  return {\n    ['capacity'] = final_capacity,\n    ['running'] = running,\n    ['reservoir'] = reservoir\n  }\nend\n","queued.lua":"local clientTimeout = tonumber(redis.call('hget', settings_key, 'clientTimeout'))\nlocal valid_clients = redis.call('zrangebyscore', client_last_seen_key, (now - clientTimeout), 'inf')\nlocal client_queued = redis.call('hmget', client_num_queued_key, unpack(valid_clients))\n\nlocal sum = 0\nfor i = 1, #client_queued do\n  sum = sum + tonumber(client_queued[i])\nend\n\nreturn sum\n","refresh_expiration.lua":"local refresh_expiration = function (now, nextRequest, groupTimeout)\n\n  if groupTimeout ~= nil then\n    local ttl = (nextRequest + groupTimeout) - now\n\n    for i = 1, #KEYS do\n      redis.call('pexpire', KEYS[i], ttl)\n    end\n  end\n\nend\n","refs.lua":"local settings_key = KEYS[1]\nlocal job_weights_key = KEYS[2]\nlocal job_expirations_key = KEYS[3]\nlocal job_clients_key = KEYS[4]\nlocal client_running_key = KEYS[5]\nlocal client_num_queued_key = KEYS[6]\nlocal client_last_registered_key = KEYS[7]\nlocal client_last_seen_key = KEYS[8]\n\nlocal now = tonumber(ARGV[1])\nlocal client = ARGV[2]\n\nlocal num_static_argv = 2\n","register.lua":"local index = ARGV[num_static_argv + 1]\nlocal weight = tonumber(ARGV[num_static_argv + 2])\nlocal expiration = tonumber(ARGV[num_static_argv + 3])\n\nlocal state = process_tick(now, false)\nlocal capacity = state['capacity']\nlocal reservoir = state['reservoir']\n\nlocal settings = redis.call('hmget', settings_key,\n  'nextRequest',\n  'minTime',\n  'groupTimeout'\n)\nlocal nextRequest = tonumber(settings[1])\nlocal minTime = tonumber(settings[2])\nlocal groupTimeout = tonumber(settings[3])\n\nif conditions_check(capacity, weight) then\n\n  redis.call('hincrby', settings_key, 'running', weight)\n  redis.call('hset', job_weights_key, index, weight)\n  if expiration ~= nil then\n    redis.call('zadd', job_expirations_key, now + expiration, index)\n  end\n  redis.call('hset', job_clients_key, index, client)\n  redis.call('zincrby', client_running_key, weight, client)\n  redis.call('hincrby', client_num_queued_key, client, -1)\n  redis.call('zadd', client_last_registered_key, now, client)\n\n  local wait = math.max(nextRequest - now, 0)\n  local newNextRequest = now + wait + minTime\n\n  if reservoir == nil then\n    redis.call('hset', settings_key,\n      'nextRequest', newNextRequest\n    )\n  else\n    reservoir = reservoir - weight\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir,\n      'nextRequest', newNextRequest\n    )\n  end\n\n  refresh_expiration(now, newNextRequest, groupTimeout)\n\n  return {true, wait, reservoir}\n\nelse\n  return {false}\nend\n","register_client.lua":"local queued = tonumber(ARGV[num_static_argv + 1])\n\n-- Could have been re-registered concurrently\nif not redis.call('zscore', client_last_seen_key, client) then\n  redis.call('zadd', client_running_key, 0, client)\n  redis.call('hset', client_num_queued_key, client, queued)\n  redis.call('zadd', client_last_registered_key, 0, client)\nend\n\nredis.call('zadd', client_last_seen_key, now, client)\n\nreturn {}\n","running.lua":"return process_tick(now, false)['running']\n","submit.lua":"local queueLength = tonumber(ARGV[num_static_argv + 1])\nlocal weight = tonumber(ARGV[num_static_argv + 2])\n\nlocal capacity = process_tick(now, false)['capacity']\n\nlocal settings = redis.call('hmget', settings_key,\n  'id',\n  'maxConcurrent',\n  'highWater',\n  'nextRequest',\n  'strategy',\n  'unblockTime',\n  'penalty',\n  'minTime',\n  'groupTimeout'\n)\nlocal id = settings[1]\nlocal maxConcurrent = tonumber(settings[2])\nlocal highWater = tonumber(settings[3])\nlocal nextRequest = tonumber(settings[4])\nlocal strategy = tonumber(settings[5])\nlocal unblockTime = tonumber(settings[6])\nlocal penalty = tonumber(settings[7])\nlocal minTime = tonumber(settings[8])\nlocal groupTimeout = tonumber(settings[9])\n\nif maxConcurrent ~= nil and weight > maxConcurrent then\n  return redis.error_reply('OVERWEIGHT:'..weight..':'..maxConcurrent)\nend\n\nlocal reachedHWM = (highWater ~= nil and queueLength == highWater\n  and not (\n    conditions_check(capacity, weight)\n    and nextRequest - now <= 0\n  )\n)\n\nlocal blocked = strategy == 3 and (reachedHWM or unblockTime >= now)\n\nif blocked then\n  local computedPenalty = penalty\n  if computedPenalty == nil then\n    if minTime == 0 then\n      computedPenalty = 5000\n    else\n      computedPenalty = 15 * minTime\n    end\n  end\n\n  local newNextRequest = now + computedPenalty + minTime\n\n  redis.call('hmset', settings_key,\n    'unblockTime', now + computedPenalty,\n    'nextRequest', newNextRequest\n  )\n\n  local clients_queued_reset = redis.call('hkeys', client_num_queued_key)\n  local queued_reset = {}\n  for i = 1, #clients_queued_reset do\n    table.insert(queued_reset, clients_queued_reset[i])\n    table.insert(queued_reset, 0)\n  end\n  redis.call('hmset', client_num_queued_key, unpack(queued_reset))\n\n  redis.call('publish', 'b_'..id, 'blocked:')\n\n  refresh_expiration(now, newNextRequest, groupTimeout)\nend\n\nif not blocked and not reachedHWM then\n  redis.call('hincrby', client_num_queued_key, client, 1)\nend\n\nreturn {reachedHWM, blocked, strategy}\n","update_settings.lua":"local args = {'hmset', settings_key}\n\nfor i = num_static_argv + 1, #ARGV do\n  table.insert(args, ARGV[i])\nend\n\nredis.call(unpack(args))\n\nprocess_tick(now, true)\n\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\nrefresh_expiration(0, 0, groupTimeout)\n\nreturn {}\n","validate_client.lua":"if not redis.call('zscore', client_last_seen_key, client) then\n  return redis.error_reply('UNKNOWN_CLIENT')\nend\n\nredis.call('zadd', client_last_seen_key, now, client)\n","validate_keys.lua":"if not (redis.call('exists', settings_key) == 1) then\n  return redis.error_reply('SETTINGS_KEY_NOT_FOUND')\nend\n"}},7444:function(e){e.exports={version:"2.19.5"}},3103:function(e,t,n){var r=n(4715)(n(8942),"DataView");e.exports=r},5098:function(e,t,n){var r=n(3305),i=n(9361),o=n(1112),s=n(5276),a=n(7452);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},7553:function(e,t,n){var r=n(9747),i=n(5962);function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},1386:function(e,t,n){var r=n(2393),i=n(2049),o=n(7144),s=n(5071),a=n(3964);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},528:function(e,t,n){var r=n(9747),i=n(5962);function o(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},9770:function(e,t,n){var r=n(4715)(n(8942),"Map");e.exports=r},8250:function(e,t,n){var r=n(9753),i=n(5681),o=n(88),s=n(4732),a=n(9068);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},9413:function(e,t,n){var r=n(4715)(n(8942),"Promise");e.exports=r},4512:function(e,t,n){var r=n(4715)(n(8942),"Set");e.exports=r},3212:function(e,t,n){var r=n(8250),i=n(1877),o=n(8006);function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=i,s.prototype.has=o,e.exports=s},1340:function(e,t,n){var r=n(1386),i=n(4103),o=n(1779),s=n(4162),a=n(7462),u=n(6638);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=s,c.prototype.has=a,c.prototype.set=u,e.exports=c},5650:function(e,t,n){var r=n(8942).Symbol;e.exports=r},1623:function(e,t,n){var r=n(8942).Uint8Array;e.exports=r},9270:function(e,t,n){var r=n(4715)(n(8942),"WeakMap");e.exports=r},6912:function(e){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},3788:function(e){e.exports=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}},7587:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},9847:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}},9756:function(e,t,n){var r=n(2478);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},935:function(e){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},358:function(e,t,n){var r=n(6137),i=n(3283),o=n(3142),s=n(5853),a=n(9632),u=n(8666),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),l=!n&&i(e),d=!n&&!l&&s(e),h=!n&&!l&&!d&&u(e),f=n||l||d||h,p=f?r(e.length,String):[],_=p.length;for(var v in e)!t&&!c.call(e,v)||f&&("length"==v||d&&("offset"==v||"parent"==v)||h&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||a(v,_))||p.push(v);return p}},5111:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},1129:function(e){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},4187:function(e){e.exports=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}},6465:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},2837:function(e){e.exports=function(e){return e.split("")}},9546:function(e){var t=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(t)||[]}},3422:function(e,t,n){var r=n(7073),i=n(6285),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var s=e[t];o.call(e,t)&&i(s,n)&&(void 0!==n||t in e)||r(e,t,n)}},7034:function(e,t,n){var r=n(6285);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},2226:function(e,t,n){var r=n(4570);e.exports=function(e,t,n,i){return r(e,(function(e,r,o){t(i,e,n(e),o)})),i}},7930:function(e,t,n){var r=n(9032),i=n(1211);e.exports=function(e,t){return e&&r(t,i(t),e)}},125:function(e,t,n){var r=n(9032),i=n(5288);e.exports=function(e,t){return e&&r(t,i(t),e)}},7073:function(e,t,n){var r=n(2532);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},4436:function(e){e.exports=function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}},9334:function(e,t,n){var r=n(1340),i=n(7587),o=n(3422),s=n(7930),a=n(125),u=n(7099),c=n(4354),l=n(3546),d=n(4733),h=n(393),f=n(3650),p=n(8486),_=n(7350),v=n(424),m=n(5964),g=n(3142),y=n(5853),b=n(7681),E=n(1580),w=n(3943),C=n(1211),T=n(5288),A="[object Arguments]",S="[object Function]",I="[object Object]",N={};N[A]=N["[object Array]"]=N["[object ArrayBuffer]"]=N["[object DataView]"]=N["[object Boolean]"]=N["[object Date]"]=N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Map]"]=N["[object Number]"]=N[I]=N["[object RegExp]"]=N["[object Set]"]=N["[object String]"]=N["[object Symbol]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N["[object Error]"]=N[S]=N["[object WeakMap]"]=!1,e.exports=function e(t,n,k,x,O,M){var R,D=1&n,U=2&n,L=4&n;if(k&&(R=O?k(t,x,O,M):k(t)),void 0!==R)return R;if(!E(t))return t;var P=g(t);if(P){if(R=_(t),!D)return c(t,R)}else{var F=p(t),j=F==S||"[object GeneratorFunction]"==F;if(y(t))return u(t,D);if(F==I||F==A||j&&!O){if(R=U||j?{}:m(t),!D)return U?d(t,a(R,t)):l(t,s(R,t))}else{if(!N[F])return O?t:{};R=v(t,F,D)}}M||(M=new r);var q=M.get(t);if(q)return q;M.set(t,R),w(t)?t.forEach((function(r){R.add(e(r,n,k,r,t,M))})):b(t)&&t.forEach((function(r,i){R.set(i,e(r,n,k,i,t,M))}));var H=P?void 0:(L?U?f:h:U?T:C)(t);return i(H||t,(function(r,i){H&&(r=t[i=r]),o(R,i,e(r,n,k,i,t,M))})),R}},9747:function(e,t,n){var r=n(1580),i=Object.create,o=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=o},6396:function(e){e.exports=function(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,n)}),t)}},4570:function(e,t,n){var r=n(7170),i=n(5770)(r);e.exports=i},7250:function(e){e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},313:function(e,t,n){var r=n(1129),i=n(714);e.exports=function e(t,n,o,s,a){var u=-1,c=t.length;for(o||(o=i),a||(a=[]);++u<c;){var l=t[u];n>0&&o(l)?n>1?e(l,n-1,o,s,a):r(a,l):s||(a[a.length]=l)}return a}},5636:function(e,t,n){var r=n(6596)();e.exports=r},7170:function(e,t,n){var r=n(5636),i=n(1211);e.exports=function(e,t){return e&&r(e,t,i)}},7923:function(e,t,n){var r=n(3526),i=n(6040);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},8244:function(e,t,n){var r=n(1129),i=n(3142);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},7379:function(e,t,n){var r=n(5650),i=n(8870),o=n(9005),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):o(e)}},3636:function(e){e.exports=function(e,t){return null!=e&&t in Object(e)}},2478:function(e,t,n){var r=n(7250),i=n(9454),o=n(7706);e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,i,n)}},6027:function(e,t,n){var r=n(7379),i=n(547);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},4687:function(e,t,n){var r=n(353),i=n(547);e.exports=function e(t,n,o,s,a){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,o,s,e,a))}},353:function(e,t,n){var r=n(1340),i=n(3934),o=n(8861),s=n(1182),a=n(8486),u=n(3142),c=n(5853),l=n(8666),d="[object Arguments]",h="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,_,v,m){var g=u(e),y=u(t),b=g?h:a(e),E=y?h:a(t),w=(b=b==d?f:b)==f,C=(E=E==d?f:E)==f,T=b==E;if(T&&c(e)){if(!c(t))return!1;g=!0,w=!1}if(T&&!w)return m||(m=new r),g||l(e)?i(e,t,n,_,v,m):o(e,t,b,n,_,v,m);if(!(1&n)){var A=w&&p.call(e,"__wrapped__"),S=C&&p.call(t,"__wrapped__");if(A||S){var I=A?e.value():e,N=S?t.value():t;return m||(m=new r),v(I,N,n,_,m)}}return!!T&&(m||(m=new r),s(e,t,n,_,v,m))}},777:function(e,t,n){var r=n(8486),i=n(547);e.exports=function(e){return i(e)&&"[object Map]"==r(e)}},8330:function(e,t,n){var r=n(1340),i=n(4687);e.exports=function(e,t,n,o){var s=n.length,a=s,u=!o;if(null==e)return!a;for(e=Object(e);s--;){var c=n[s];if(u&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++s<a;){var l=(c=n[s])[0],d=e[l],h=c[1];if(u&&c[2]){if(void 0===d&&!(l in e))return!1}else{var f=new r;if(o)var p=o(d,h,l,e,t,f);if(!(void 0===p?i(h,d,3,o,f):p))return!1}}return!0}},9454:function(e){e.exports=function(e){return e!=e}},9624:function(e,t,n){var r=n(3655),i=n(4759),o=n(1580),s=n(4066),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,d=c.hasOwnProperty,h=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?h:a).test(s(e))}},1935:function(e,t,n){var r=n(8486),i=n(547);e.exports=function(e){return i(e)&&"[object Set]"==r(e)}},674:function(e,t,n){var r=n(7379),i=n(5387),o=n(547),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!s[r(e)]}},3334:function(e,t,n){var r=n(6526),i=n(2343),o=n(2053),s=n(3142),a=n(3282);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?s(e)?i(e[0],e[1]):r(e):a(e)}},195:function(e,t,n){var r=n(4882),i=n(8121),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},7200:function(e,t,n){var r=n(1580),i=n(4882),o=n(8546),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=i(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},5962:function(e){e.exports=function(){}},6526:function(e,t,n){var r=n(8330),i=n(4367),o=n(3904);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},2343:function(e,t,n){var r=n(4687),i=n(6123),o=n(7276),s=n(5187),a=n(7267),u=n(3904),c=n(6040);e.exports=function(e,t){return s(e)&&a(t)?u(c(e),t):function(n){var s=i(n,e);return void 0===s&&s===t?o(n,e):r(t,s,3)}}},5031:function(e,t,n){var r=n(7923),i=n(7655),o=n(3526);e.exports=function(e,t,n){for(var s=-1,a=t.length,u={};++s<a;){var c=t[s],l=r(e,c);n(l,c)&&i(u,o(c,e),l)}return u}},2762:function(e){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},8880:function(e,t,n){var r=n(7923);e.exports=function(e){return function(t){return r(t,e)}}},1035:function(e){e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},3945:function(e,t,n){var r=n(2053),i=n(5234),o=n(796);e.exports=function(e,t){return o(i(e,t,r),e+"")}},7655:function(e,t,n){var r=n(3422),i=n(3526),o=n(9632),s=n(1580),a=n(6040);e.exports=function(e,t,n,u){if(!s(e))return e;for(var c=-1,l=(t=i(t,e)).length,d=l-1,h=e;null!=h&&++c<l;){var f=a(t[c]),p=n;if("__proto__"===f||"constructor"===f||"prototype"===f)return e;if(c!=d){var _=h[f];void 0===(p=u?u(_,f,h):void 0)&&(p=s(_)?_:o(t[c+1])?[]:{})}r(h,f,p),h=h[f]}return e}},7403:function(e,t,n){var r=n(2619),i=n(2532),o=n(2053),s=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=s},3501:function(e){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},6137:function(e){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},2291:function(e,t,n){var r=n(5650),i=n(5111),o=n(3142),s=n(1187),a=r?r.prototype:void 0,u=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(s(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},6403:function(e,t,n){var r=n(2945),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},9460:function(e){e.exports=function(e){return function(t){return e(t)}}},5630:function(e,t,n){var r=n(3212),i=n(9756),o=n(935),s=n(5568),a=n(6208),u=n(9828);e.exports=function(e,t,n){var c=-1,l=i,d=e.length,h=!0,f=[],p=f;if(n)h=!1,l=o;else if(d>=200){var _=t?null:a(e);if(_)return u(_);h=!1,l=s,p=new r}else p=t?[]:f;e:for(;++c<d;){var v=e[c],m=t?t(v):v;if(v=n||0!==v?v:0,h&&m==m){for(var g=p.length;g--;)if(p[g]===m)continue e;t&&p.push(m),f.push(v)}else l(p,m,n)||(p!==f&&p.push(m),f.push(v))}return f}},1586:function(e,t,n){var r=n(3526),i=n(8087),o=n(3398),s=n(6040);e.exports=function(e,t){return t=r(t,e),null==(e=o(e,t))||delete e[s(i(t))]}},5568:function(e){e.exports=function(e,t){return e.has(t)}},3526:function(e,t,n){var r=n(3142),i=n(5187),o=n(6493),s=n(5243);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(s(e))}},8931:function(e,t,n){var r=n(3501);e.exports=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:r(e,t,n)}},8898:function(e,t,n){var r=n(1623);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},7099:function(e,t,n){e=n.nmd(e);var r=n(8942),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i?r.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}},2480:function(e,t,n){var r=n(8898);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},8340:function(e){var t=/\w*$/;e.exports=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}},8069:function(e,t,n){var r=n(5650),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},2264:function(e,t,n){var r=n(8898);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},4354:function(e){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},9032:function(e,t,n){var r=n(3422),i=n(7073);e.exports=function(e,t,n,o){var s=!n;n||(n={});for(var a=-1,u=t.length;++a<u;){var c=t[a],l=o?o(n[c],e[c],c,n,e):void 0;void 0===l&&(l=e[c]),s?i(n,c,l):r(n,c,l)}return n}},3546:function(e,t,n){var r=n(9032),i=n(7979);e.exports=function(e,t){return r(e,i(e),t)}},4733:function(e,t,n){var r=n(9032),i=n(5832);e.exports=function(e,t){return r(e,i(e),t)}},1950:function(e,t,n){var r=n(8942)["__core-js_shared__"];e.exports=r},2195:function(e,t,n){var r=n(3788),i=n(2226),o=n(3334),s=n(3142);e.exports=function(e,t){return function(n,a){var u=s(n)?r:i,c=t?t():{};return u(n,e,o(a,2),c)}}},5770:function(e,t,n){var r=n(6529);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var o=n.length,s=t?o:-1,a=Object(n);(t?s--:++s<o)&&!1!==i(a[s],s,a););return n}}},6596:function(e){e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var u=s[e?a:++i];if(!1===n(o[u],u,o))break}return t}}},4326:function(e,t,n){var r=n(8931),i=n(3417),o=n(2237),s=n(5243);e.exports=function(e){return function(t){t=s(t);var n=i(t)?o(t):void 0,a=n?n[0]:t.charAt(0),u=n?r(n,1).join(""):t.slice(1);return a[e]()+u}}},3640:function(e,t,n){var r=n(4187),i=n(5881),o=n(9850),s=RegExp("[']","g");e.exports=function(e){return function(t){return r(o(i(t).replace(s,"")),e,"")}}},1942:function(e,t,n){var r=n(528),i=n(1439),o=n(5196),s=n(961),a=n(3142),u=n(6648);e.exports=function(e){return i((function(t){var n=t.length,i=n,c=r.prototype.thru;for(e&&t.reverse();i--;){var l=t[i];if("function"!=typeof l)throw new TypeError("Expected a function");if(c&&!d&&"wrapper"==s(l))var d=new r([],!0)}for(i=d?i:n;++i<n;){l=t[i];var h=s(l),f="wrapper"==h?o(l):void 0;d=f&&u(f[0])&&424==f[1]&&!f[4].length&&1==f[9]?d[s(f[0])].apply(d,f[3]):1==l.length&&u(l)?d[h]():d.thru(l)}return function(){var e=arguments,r=e[0];if(d&&1==e.length&&a(r))return d.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}},6208:function(e,t,n){var r=n(4512),i=n(9071),o=n(9828),s=r&&1/o(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=s},9259:function(e,t,n){var r=n(8360);e.exports=function(e){return r(e)?void 0:e}},9968:function(e,t,n){var r=n(1035)({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"});e.exports=r},2532:function(e,t,n){var r=n(4715),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},3934:function(e,t,n){var r=n(3212),i=n(6465),o=n(5568);e.exports=function(e,t,n,s,a,u){var c=1&n,l=e.length,d=t.length;if(l!=d&&!(c&&d>l))return!1;var h=u.get(e),f=u.get(t);if(h&&f)return h==t&&f==e;var p=-1,_=!0,v=2&n?new r:void 0;for(u.set(e,t),u.set(t,e);++p<l;){var m=e[p],g=t[p];if(s)var y=c?s(g,m,p,t,e,u):s(m,g,p,e,t,u);if(void 0!==y){if(y)continue;_=!1;break}if(v){if(!i(t,(function(e,t){if(!o(v,t)&&(m===e||a(m,e,n,s,u)))return v.push(t)}))){_=!1;break}}else if(m!==g&&!a(m,g,n,s,u)){_=!1;break}}return u.delete(e),u.delete(t),_}},8861:function(e,t,n){var r=n(5650),i=n(1623),o=n(6285),s=n(3934),a=n(5894),u=n(9828),c=r?r.prototype:void 0,l=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,d,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=a;case"[object Set]":var p=1&r;if(f||(f=u),e.size!=t.size&&!p)return!1;var _=h.get(e);if(_)return _==t;r|=2,h.set(e,t);var v=s(f(e),f(t),r,c,d,h);return h.delete(e),v;case"[object Symbol]":if(l)return l.call(e)==l.call(t)}return!1}},1182:function(e,t,n){var r=n(393),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,s,a){var u=1&n,c=r(e),l=c.length;if(l!=r(t).length&&!u)return!1;for(var d=l;d--;){var h=c[d];if(!(u?h in t:i.call(t,h)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var _=!0;a.set(e,t),a.set(t,e);for(var v=u;++d<l;){var m=e[h=c[d]],g=t[h];if(o)var y=u?o(g,m,h,t,e,a):o(m,g,h,e,t,a);if(!(void 0===y?m===g||s(m,g,n,o,a):y)){_=!1;break}v||(v="constructor"==h)}if(_&&!v){var b=e.constructor,E=t.constructor;b==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof E&&E instanceof E||(_=!1)}return a.delete(e),a.delete(t),_}},1439:function(e,t,n){var r=n(5857),i=n(5234),o=n(796);e.exports=function(e){return o(i(e,void 0,r),e+"")}},4967:function(e,t,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},393:function(e,t,n){var r=n(8244),i=n(7979),o=n(1211);e.exports=function(e){return r(e,o,i)}},3650:function(e,t,n){var r=n(8244),i=n(5832),o=n(5288);e.exports=function(e){return r(e,o,i)}},5196:function(e,t,n){var r=n(6065),i=n(9071),o=r?function(e){return r.get(e)}:i;e.exports=o},961:function(e,t,n){var r=n(3476),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=r[t],o=i.call(r,t)?n.length:0;o--;){var s=n[o],a=s.func;if(null==a||a==e)return s.name}return t}},4700:function(e,t,n){var r=n(1448);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},4367:function(e,t,n){var r=n(7267),i=n(1211);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],s=e[o];t[n]=[o,s,r(s)]}return t}},4715:function(e,t,n){var r=n(9624),i=n(155);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},4784:function(e,t,n){var r=n(3766)(Object.getPrototypeOf,Object);e.exports=r},8870:function(e,t,n){var r=n(5650),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[a]=n:delete e[a]),i}},7979:function(e,t,n){var r=n(9847),i=n(9306),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),(function(t){return o.call(e,t)})))}:i;e.exports=a},5832:function(e,t,n){var r=n(1129),i=n(4784),o=n(7979),s=n(9306),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,o(e)),e=i(e);return t}:s;e.exports=a},8486:function(e,t,n){var r=n(3103),i=n(9770),o=n(9413),s=n(4512),a=n(9270),u=n(7379),c=n(4066),l="[object Map]",d="[object Promise]",h="[object Set]",f="[object WeakMap]",p="[object DataView]",_=c(r),v=c(i),m=c(o),g=c(s),y=c(a),b=u;(r&&b(new r(new ArrayBuffer(1)))!=p||i&&b(new i)!=l||o&&b(o.resolve())!=d||s&&b(new s)!=h||a&&b(new a)!=f)&&(b=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case _:return p;case v:return l;case m:return d;case g:return h;case y:return f}return t}),e.exports=b},155:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},5899:function(e,t,n){var r=n(3526),i=n(3283),o=n(3142),s=n(9632),a=n(5387),u=n(6040);e.exports=function(e,t,n){for(var c=-1,l=(t=r(t,e)).length,d=!1;++c<l;){var h=u(t[c]);if(!(d=null!=e&&n(e,h)))break;e=e[h]}return d||++c!=l?d:!!(l=null==e?0:e.length)&&a(l)&&s(h,l)&&(o(e)||i(e))}},3417:function(e){var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},5813:function(e){var t=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return t.test(e)}},3305:function(e,t,n){var r=n(4497);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},9361:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},1112:function(e,t,n){var r=n(4497),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},5276:function(e,t,n){var r=n(4497),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},7452:function(e,t,n){var r=n(4497);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},7350:function(e){var t=Object.prototype.hasOwnProperty;e.exports=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},424:function(e,t,n){var r=n(8898),i=n(2480),o=n(8340),s=n(8069),a=n(2264);e.exports=function(e,t,n){var u=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new u(+e);case"[object DataView]":return i(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,n);case"[object Map]":case"[object Set]":return new u;case"[object Number]":case"[object String]":return new u(e);case"[object RegExp]":return o(e);case"[object Symbol]":return s(e)}}},5964:function(e,t,n){var r=n(9747),i=n(4784),o=n(4882);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:r(i(e))}},714:function(e,t,n){var r=n(5650),i=n(3283),o=n(3142),s=r?r.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||i(e)||!!(s&&e&&e[s])}},9632:function(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},5187:function(e,t,n){var r=n(3142),i=n(1187),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(s.test(e)||!o.test(e)||null!=t&&e in Object(t))}},1448:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},6648:function(e,t,n){var r=n(7553),i=n(5196),o=n(961),s=n(3321);e.exports=function(e){var t=o(e),n=s[t];if("function"!=typeof n||!(t in r.prototype))return!1;if(e===n)return!0;var a=i(n);return!!a&&e===a[0]}},4759:function(e,t,n){var r,i=n(1950),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},4882:function(e){var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},7267:function(e,t,n){var r=n(1580);e.exports=function(e){return e==e&&!r(e)}},2393:function(e){e.exports=function(){this.__data__=[],this.size=0}},2049:function(e,t,n){var r=n(7034),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},7144:function(e,t,n){var r=n(7034);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},5071:function(e,t,n){var r=n(7034);e.exports=function(e){return r(this.__data__,e)>-1}},3964:function(e,t,n){var r=n(7034);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},9753:function(e,t,n){var r=n(5098),i=n(1386),o=n(9770);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},5681:function(e,t,n){var r=n(4700);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},88:function(e,t,n){var r=n(4700);e.exports=function(e){return r(this,e).get(e)}},4732:function(e,t,n){var r=n(4700);e.exports=function(e){return r(this,e).has(e)}},9068:function(e,t,n){var r=n(4700);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},5894:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},3904:function(e){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},6853:function(e,t,n){var r=n(9011);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},6065:function(e,t,n){var r=n(9270),i=r&&new r;e.exports=i},4497:function(e,t,n){var r=n(4715)(Object,"create");e.exports=r},8121:function(e,t,n){var r=n(3766)(Object.keys,Object);e.exports=r},8546:function(e){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},2306:function(e,t,n){e=n.nmd(e);var r=n(4967),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i&&r.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a},9005:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},3766:function(e){e.exports=function(e,t){return function(n){return e(t(n))}}},5234:function(e,t,n){var r=n(6912),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,a=i(o.length-t,0),u=Array(a);++s<a;)u[s]=o[t+s];s=-1;for(var c=Array(t+1);++s<t;)c[s]=o[s];return c[t]=n(u),r(e,this,c)}}},3398:function(e,t,n){var r=n(7923),i=n(3501);e.exports=function(e,t){return t.length<2?e:r(e,i(t,0,-1))}},3476:function(e){e.exports={}},8942:function(e,t,n){var r=n(4967),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},1877:function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},8006:function(e){e.exports=function(e){return this.__data__.has(e)}},9828:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},796:function(e,t,n){var r=n(7403),i=n(3316)(r);e.exports=i},3316:function(e){var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var i=t(),o=16-(i-r);if(r=i,o>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},4103:function(e,t,n){var r=n(1386);e.exports=function(){this.__data__=new r,this.size=0}},1779:function(e){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},4162:function(e){e.exports=function(e){return this.__data__.get(e)}},7462:function(e){e.exports=function(e){return this.__data__.has(e)}},6638:function(e,t,n){var r=n(1386),i=n(9770),o=n(8250);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(e,t),this.size=n.size,this}},7706:function(e){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},2237:function(e,t,n){var r=n(2837),i=n(3417),o=n(2013);e.exports=function(e){return i(e)?o(e):r(e)}},6493:function(e,t,n){var r=n(6853),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=s},6040:function(e,t,n){var r=n(1187);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},4066:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},2945:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},2013:function(e){var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^"+t+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+r+"|"+i+")"+"?",c="[\\ufe0e\\ufe0f]?",l=c+u+("(?:\\u200d(?:"+[o,s,a].join("|")+")"+c+u+")*"),d="(?:"+[o+r+"?",r,s,a,n].join("|")+")",h=RegExp(i+"(?="+i+")|"+d+l,"g");e.exports=function(e){return e.match(h)||[]}},482:function(e){var t="\\ud800-\\udfff",n="\\u2700-\\u27bf",r="a-z\\xdf-\\xf6\\xf8-\\xff",i="A-Z\\xc0-\\xd6\\xd8-\\xde",o="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",s="["+o+"]",a="\\d+",u="["+n+"]",c="["+r+"]",l="[^"+t+o+a+n+r+i+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",h="[\\ud800-\\udbff][\\udc00-\\udfff]",f="["+i+"]",p="(?:"+c+"|"+l+")",_="(?:"+f+"|"+l+")",v="(?:['](?:d|ll|m|re|s|t|ve))?",m="(?:['](?:D|LL|M|RE|S|T|VE))?",g="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",y="[\\ufe0e\\ufe0f]?",b=y+g+("(?:\\u200d(?:"+["[^"+t+"]",d,h].join("|")+")"+y+g+")*"),E="(?:"+[u,d,h].join("|")+")"+b,w=RegExp([f+"?"+c+"+"+v+"(?="+[s,f,"$"].join("|")+")",_+"+"+m+"(?="+[s,f+p,"$"].join("|")+")",f+"?"+p+"+"+v,f+"+"+m,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",a,E].join("|"),"g");e.exports=function(e){return e.match(w)||[]}},3410:function(e,t,n){var r=n(7553),i=n(528),o=n(4354);e.exports=function(e){if(e instanceof r)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=o(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},6238:function(e){e.exports=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}},2619:function(e){e.exports=function(e){return function(){return e}}},5881:function(e,t,n){var r=n(9968),i=n(5243),o=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,s=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=i(e))&&e.replace(o,r).replace(s,"")}},7684:function(e,t,n){var r=n(6396),i=n(3945),o=n(6131),s=i((function(e,t,n){return r(e,o(t)||0,n)}));e.exports=s},6285:function(e){e.exports=function(e,t){return e===t||e!=e&&t!=t}},5857:function(e,t,n){var r=n(313);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},3741:function(e,t,n){var r=n(1942)(!0);e.exports=r},6123:function(e,t,n){var r=n(7923);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},7276:function(e,t,n){var r=n(3636),i=n(5899);e.exports=function(e,t){return null!=e&&i(e,t,r)}},2053:function(e){e.exports=function(e){return e}},3283:function(e,t,n){var r=n(6027),i=n(547),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return i(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},3142:function(e){var t=Array.isArray;e.exports=t},6529:function(e,t,n){var r=n(3655),i=n(5387);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},5853:function(e,t,n){e=n.nmd(e);var r=n(8942),i=n(4772),o=t&&!t.nodeType&&t,s=o&&e&&!e.nodeType&&e,a=s&&s.exports===o?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||i;e.exports=u},3514:function(e,t,n){var r=n(195),i=n(8486),o=n(3283),s=n(3142),a=n(6529),u=n(5853),c=n(4882),l=n(8666),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||u(e)||l(e)||o(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},3655:function(e,t,n){var r=n(7379),i=n(1580);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},5387:function(e){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},7681:function(e,t,n){var r=n(777),i=n(9460),o=n(2306),s=o&&o.isMap,a=s?i(s):r;e.exports=a},1580:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},547:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},8360:function(e,t,n){var r=n(7379),i=n(4784),o=n(547),s=Function.prototype,a=Object.prototype,u=s.toString,c=a.hasOwnProperty,l=u.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==l}},3943:function(e,t,n){var r=n(1935),i=n(9460),o=n(2306),s=o&&o.isSet,a=s?i(s):r;e.exports=a},1187:function(e,t,n){var r=n(7379),i=n(547);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},8666:function(e,t,n){var r=n(674),i=n(9460),o=n(2306),s=o&&o.isTypedArray,a=s?i(s):r;e.exports=a},4789:function(e,t,n){var r=n(7073),i=n(2195)((function(e,t,n){r(e,n,t)}));e.exports=i},1211:function(e,t,n){var r=n(358),i=n(195),o=n(6529);e.exports=function(e){return o(e)?r(e):i(e)}},5288:function(e,t,n){var r=n(358),i=n(7200),o=n(6529);e.exports=function(e){return o(e)?r(e,!0):i(e)}},8087:function(e){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},5250:function(e,t,n){var r;e=n.nmd(e),function(){var i,o="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",u=16,c=32,l=64,d=128,h=256,f=1/0,p=9007199254740991,_=NaN,v=4294967295,m=[["ary",d],["bind",1],["bindKey",2],["curry",8],["curryRight",u],["flip",512],["partial",c],["partialRight",l],["rearg",h]],g="[object Arguments]",y="[object Array]",b="[object Boolean]",E="[object Date]",w="[object Error]",C="[object Function]",T="[object GeneratorFunction]",A="[object Map]",S="[object Number]",I="[object Object]",N="[object Promise]",k="[object RegExp]",x="[object Set]",O="[object String]",M="[object Symbol]",R="[object WeakMap]",D="[object ArrayBuffer]",U="[object DataView]",L="[object Float32Array]",P="[object Float64Array]",F="[object Int8Array]",j="[object Int16Array]",q="[object Int32Array]",H="[object Uint8Array]",V="[object Uint8ClampedArray]",B="[object Uint16Array]",z="[object Uint32Array]",G=/\b__p \+= '';/g,W=/\b(__p \+=) '' \+/g,K=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Q=/&(?:amp|lt|gt|quot|#39);/g,Z=/[&<>"']/g,Y=RegExp(Q.source),$=RegExp(Z.source),X=/<%-([\s\S]+?)%>/g,J=/<%([\s\S]+?)%>/g,ee=/<%=([\s\S]+?)%>/g,te=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ne=/^\w*$/,re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ie=/[\\^$.*+?()[\]{}|]/g,oe=RegExp(ie.source),se=/^\s+/,ae=/\s/,ue=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ce=/\{\n\/\* \[wrapped with (.+)\] \*/,le=/,? & /,de=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,he=/[()=,{}\[\]\/\s]/,fe=/\\(\\)?/g,pe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_e=/\w*$/,ve=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,ye=/^0o[0-7]+$/i,be=/^(?:0|[1-9]\d*)$/,Ee=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,we=/($^)/,Ce=/['\n\r\u2028\u2029\\]/g,Te="\\ud800-\\udfff",Ae="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Se="\\u2700-\\u27bf",Ie="a-z\\xdf-\\xf6\\xf8-\\xff",Ne="A-Z\\xc0-\\xd6\\xd8-\\xde",ke="\\ufe0e\\ufe0f",xe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Oe="[']",Me="["+Te+"]",Re="["+xe+"]",De="["+Ae+"]",Ue="\\d+",Le="["+Se+"]",Pe="["+Ie+"]",Fe="[^"+Te+xe+Ue+Se+Ie+Ne+"]",je="\\ud83c[\\udffb-\\udfff]",qe="[^"+Te+"]",He="(?:\\ud83c[\\udde6-\\uddff]){2}",Ve="[\\ud800-\\udbff][\\udc00-\\udfff]",Be="["+Ne+"]",ze="\\u200d",Ge="(?:"+Pe+"|"+Fe+")",We="(?:"+Be+"|"+Fe+")",Ke="(?:['](?:d|ll|m|re|s|t|ve))?",Qe="(?:['](?:D|LL|M|RE|S|T|VE))?",Ze="(?:"+De+"|"+je+")"+"?",Ye="["+ke+"]?",$e=Ye+Ze+("(?:"+ze+"(?:"+[qe,He,Ve].join("|")+")"+Ye+Ze+")*"),Xe="(?:"+[Le,He,Ve].join("|")+")"+$e,Je="(?:"+[qe+De+"?",De,He,Ve,Me].join("|")+")",et=RegExp(Oe,"g"),tt=RegExp(De,"g"),nt=RegExp(je+"(?="+je+")|"+Je+$e,"g"),rt=RegExp([Be+"?"+Pe+"+"+Ke+"(?="+[Re,Be,"$"].join("|")+")",We+"+"+Qe+"(?="+[Re,Be+Ge,"$"].join("|")+")",Be+"?"+Ge+"+"+Ke,Be+"+"+Qe,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ue,Xe].join("|"),"g"),it=RegExp("["+ze+Te+Ae+ke+"]"),ot=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,st=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],at=-1,ut={};ut[L]=ut[P]=ut[F]=ut[j]=ut[q]=ut[H]=ut[V]=ut[B]=ut[z]=!0,ut[g]=ut[y]=ut[D]=ut[b]=ut[U]=ut[E]=ut[w]=ut[C]=ut[A]=ut[S]=ut[I]=ut[k]=ut[x]=ut[O]=ut[R]=!1;var ct={};ct[g]=ct[y]=ct[D]=ct[U]=ct[b]=ct[E]=ct[L]=ct[P]=ct[F]=ct[j]=ct[q]=ct[A]=ct[S]=ct[I]=ct[k]=ct[x]=ct[O]=ct[M]=ct[H]=ct[V]=ct[B]=ct[z]=!0,ct[w]=ct[C]=ct[R]=!1;var lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},dt=parseFloat,ht=parseInt,ft="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,pt="object"==typeof self&&self&&self.Object===Object&&self,_t=ft||pt||Function("return this")(),vt=t&&!t.nodeType&&t,mt=vt&&e&&!e.nodeType&&e,gt=mt&&mt.exports===vt,yt=gt&&ft.process,bt=function(){try{var e=mt&&mt.require&&mt.require("util").types;return e||yt&&yt.binding&&yt.binding("util")}catch(e){}}(),Et=bt&&bt.isArrayBuffer,wt=bt&&bt.isDate,Ct=bt&&bt.isMap,Tt=bt&&bt.isRegExp,At=bt&&bt.isSet,St=bt&&bt.isTypedArray;function It(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Nt(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function kt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function xt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Ot(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Mt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function Rt(e,t){return!!(null==e?0:e.length)&&Bt(e,t,0)>-1}function Dt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Ut(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Lt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Pt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Ft(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function jt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var qt=Kt("length");function Ht(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Vt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Bt(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Vt(e,Gt,n)}function zt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Gt(e){return e!=e}function Wt(e,t){var n=null==e?0:e.length;return n?Yt(e,t)/n:_}function Kt(e){return function(t){return null==t?i:t[e]}}function Qt(e){return function(t){return null==e?i:e[t]}}function Zt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Yt(e,t){for(var n,r=-1,o=e.length;++r<o;){var s=t(e[r]);s!==i&&(n=n===i?s:n+s)}return n}function $t(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Xt(e){return e?e.slice(0,vn(e)+1).replace(se,""):e}function Jt(e){return function(t){return e(t)}}function en(e,t){return Ut(t,(function(t){return e[t]}))}function tn(e,t){return e.has(t)}function nn(e,t){for(var n=-1,r=e.length;++n<r&&Bt(t,e[n],0)>-1;);return n}function rn(e,t){for(var n=e.length;n--&&Bt(t,e[n],0)>-1;);return n}var on=Qt({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),sn=Qt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function an(e){return"\\"+lt[e]}function un(e){return it.test(e)}function cn(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function ln(e,t){return function(n){return e(t(n))}}function dn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&s!==a||(e[n]=a,o[i++]=n)}return o}function hn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function fn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function pn(e){return un(e)?function(e){var t=nt.lastIndex=0;for(;nt.test(e);)++t;return t}(e):qt(e)}function _n(e){return un(e)?function(e){return e.match(nt)||[]}(e):function(e){return e.split("")}(e)}function vn(e){for(var t=e.length;t--&&ae.test(e.charAt(t)););return t}var mn=Qt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var gn=function e(t){var n,r=(t=null==t?_t:gn.defaults(_t.Object(),t,gn.pick(_t,st))).Array,ae=t.Date,Te=t.Error,Ae=t.Function,Se=t.Math,Ie=t.Object,Ne=t.RegExp,ke=t.String,xe=t.TypeError,Oe=r.prototype,Me=Ae.prototype,Re=Ie.prototype,De=t["__core-js_shared__"],Ue=Me.toString,Le=Re.hasOwnProperty,Pe=0,Fe=(n=/[^.]+$/.exec(De&&De.keys&&De.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",je=Re.toString,qe=Ue.call(Ie),He=_t._,Ve=Ne("^"+Ue.call(Le).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Be=gt?t.Buffer:i,ze=t.Symbol,Ge=t.Uint8Array,We=Be?Be.allocUnsafe:i,Ke=ln(Ie.getPrototypeOf,Ie),Qe=Ie.create,Ze=Re.propertyIsEnumerable,Ye=Oe.splice,$e=ze?ze.isConcatSpreadable:i,Xe=ze?ze.iterator:i,Je=ze?ze.toStringTag:i,nt=function(){try{var e=fo(Ie,"defineProperty");return e({},"",{}),e}catch(e){}}(),it=t.clearTimeout!==_t.clearTimeout&&t.clearTimeout,lt=ae&&ae.now!==_t.Date.now&&ae.now,ft=t.setTimeout!==_t.setTimeout&&t.setTimeout,pt=Se.ceil,vt=Se.floor,mt=Ie.getOwnPropertySymbols,yt=Be?Be.isBuffer:i,bt=t.isFinite,qt=Oe.join,Qt=ln(Ie.keys,Ie),yn=Se.max,bn=Se.min,En=ae.now,wn=t.parseInt,Cn=Se.random,Tn=Oe.reverse,An=fo(t,"DataView"),Sn=fo(t,"Map"),In=fo(t,"Promise"),Nn=fo(t,"Set"),kn=fo(t,"WeakMap"),xn=fo(Ie,"create"),On=kn&&new kn,Mn={},Rn=jo(An),Dn=jo(Sn),Un=jo(In),Ln=jo(Nn),Pn=jo(kn),Fn=ze?ze.prototype:i,jn=Fn?Fn.valueOf:i,qn=Fn?Fn.toString:i;function Hn(e){if(na(e)&&!Gs(e)&&!(e instanceof Gn)){if(e instanceof zn)return e;if(Le.call(e,"__wrapped__"))return qo(e)}return new zn(e)}var Vn=function(){function e(){}return function(t){if(!ta(t))return{};if(Qe)return Qe(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function Bn(){}function zn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Gn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=v,this.__views__=[]}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Qn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Zn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Qn;++t<n;)this.add(e[t])}function Yn(e){var t=this.__data__=new Kn(e);this.size=t.size}function $n(e,t){var n=Gs(e),r=!n&&zs(e),i=!n&&!r&&Zs(e),o=!n&&!r&&!i&&la(e),s=n||r||i||o,a=s?$t(e.length,ke):[],u=a.length;for(var c in e)!t&&!Le.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||bo(c,u))||a.push(c);return a}function Xn(e){var t=e.length;return t?e[Zr(0,t-1)]:i}function Jn(e,t){return Lo(xi(e),ur(t,0,e.length))}function er(e){return Lo(xi(e))}function tr(e,t,n){(n!==i&&!Hs(e[t],n)||n===i&&!(t in e))&&sr(e,t,n)}function nr(e,t,n){var r=e[t];Le.call(e,t)&&Hs(r,n)&&(n!==i||t in e)||sr(e,t,n)}function rr(e,t){for(var n=e.length;n--;)if(Hs(e[n][0],t))return n;return-1}function ir(e,t,n,r){return fr(e,(function(e,i,o){t(r,e,n(e),o)})),r}function or(e,t){return e&&Oi(t,Ma(t),e)}function sr(e,t,n){"__proto__"==t&&nt?nt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ar(e,t){for(var n=-1,o=t.length,s=r(o),a=null==e;++n<o;)s[n]=a?i:Ia(e,t[n]);return s}function ur(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function cr(e,t,n,r,o,s){var a,u=1&t,c=2&t,l=4&t;if(n&&(a=o?n(e,r,o,s):n(e)),a!==i)return a;if(!ta(e))return e;var d=Gs(e);if(d){if(a=function(e){var t=e.length,n=new e.constructor(t);t&&"string"==typeof e[0]&&Le.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(e),!u)return xi(e,a)}else{var h=vo(e),f=h==C||h==T;if(Zs(e))return Ti(e,u);if(h==I||h==g||f&&!o){if(a=c||f?{}:go(e),!u)return c?function(e,t){return Oi(e,_o(e),t)}(e,function(e,t){return e&&Oi(t,Ra(t),e)}(a,e)):function(e,t){return Oi(e,po(e),t)}(e,or(a,e))}else{if(!ct[h])return o?e:{};a=function(e,t,n){var r=e.constructor;switch(t){case D:return Ai(e);case b:case E:return new r(+e);case U:return function(e,t){var n=t?Ai(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case L:case P:case F:case j:case q:case H:case V:case B:case z:return Si(e,n);case A:return new r;case S:case O:return new r(e);case k:return function(e){var t=new e.constructor(e.source,_e.exec(e));return t.lastIndex=e.lastIndex,t}(e);case x:return new r;case M:return i=e,jn?Ie(jn.call(i)):{}}var i}(e,h,u)}}s||(s=new Yn);var p=s.get(e);if(p)return p;s.set(e,a),aa(e)?e.forEach((function(r){a.add(cr(r,t,n,r,e,s))})):ra(e)&&e.forEach((function(r,i){a.set(i,cr(r,t,n,i,e,s))}));var _=d?i:(l?c?oo:io:c?Ra:Ma)(e);return kt(_||e,(function(r,i){_&&(r=e[i=r]),nr(a,i,cr(r,t,n,i,e,s))})),a}function lr(e,t,n){var r=n.length;if(null==e)return!r;for(e=Ie(e);r--;){var o=n[r],s=t[o],a=e[o];if(a===i&&!(o in e)||!s(a))return!1}return!0}function dr(e,t,n){if("function"!=typeof e)throw new xe(o);return Mo((function(){e.apply(i,n)}),t)}function hr(e,t,n,r){var i=-1,o=Rt,s=!0,a=e.length,u=[],c=t.length;if(!a)return u;n&&(t=Ut(t,Jt(n))),r?(o=Dt,s=!1):t.length>=200&&(o=tn,s=!1,t=new Zn(t));e:for(;++i<a;){var l=e[i],d=null==n?l:n(l);if(l=r||0!==l?l:0,s&&d==d){for(var h=c;h--;)if(t[h]===d)continue e;u.push(l)}else o(t,d,r)||u.push(l)}return u}Hn.templateSettings={escape:X,evaluate:J,interpolate:ee,variable:"",imports:{_:Hn}},Hn.prototype=Bn.prototype,Hn.prototype.constructor=Hn,zn.prototype=Vn(Bn.prototype),zn.prototype.constructor=zn,Gn.prototype=Vn(Bn.prototype),Gn.prototype.constructor=Gn,Wn.prototype.clear=function(){this.__data__=xn?xn(null):{},this.size=0},Wn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Wn.prototype.get=function(e){var t=this.__data__;if(xn){var n=t[e];return n===s?i:n}return Le.call(t,e)?t[e]:i},Wn.prototype.has=function(e){var t=this.__data__;return xn?t[e]!==i:Le.call(t,e)},Wn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=xn&&t===i?s:t,this},Kn.prototype.clear=function(){this.__data__=[],this.size=0},Kn.prototype.delete=function(e){var t=this.__data__,n=rr(t,e);return!(n<0)&&(n==t.length-1?t.pop():Ye.call(t,n,1),--this.size,!0)},Kn.prototype.get=function(e){var t=this.__data__,n=rr(t,e);return n<0?i:t[n][1]},Kn.prototype.has=function(e){return rr(this.__data__,e)>-1},Kn.prototype.set=function(e,t){var n=this.__data__,r=rr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Qn.prototype.clear=function(){this.size=0,this.__data__={hash:new Wn,map:new(Sn||Kn),string:new Wn}},Qn.prototype.delete=function(e){var t=lo(this,e).delete(e);return this.size-=t?1:0,t},Qn.prototype.get=function(e){return lo(this,e).get(e)},Qn.prototype.has=function(e){return lo(this,e).has(e)},Qn.prototype.set=function(e,t){var n=lo(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Zn.prototype.add=Zn.prototype.push=function(e){return this.__data__.set(e,s),this},Zn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.clear=function(){this.__data__=new Kn,this.size=0},Yn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Yn.prototype.get=function(e){return this.__data__.get(e)},Yn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Kn){var r=n.__data__;if(!Sn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Qn(r)}return n.set(e,t),this.size=n.size,this};var fr=Di(Er),pr=Di(wr,!0);function _r(e,t){var n=!0;return fr(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function vr(e,t,n){for(var r=-1,o=e.length;++r<o;){var s=e[r],a=t(s);if(null!=a&&(u===i?a==a&&!ca(a):n(a,u)))var u=a,c=s}return c}function mr(e,t){var n=[];return fr(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function gr(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=yo),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?gr(a,t-1,n,r,i):Lt(i,a):r||(i[i.length]=a)}return i}var yr=Ui(),br=Ui(!0);function Er(e,t){return e&&yr(e,t,Ma)}function wr(e,t){return e&&br(e,t,Ma)}function Cr(e,t){return Mt(t,(function(t){return Xs(e[t])}))}function Tr(e,t){for(var n=0,r=(t=bi(t,e)).length;null!=e&&n<r;)e=e[Fo(t[n++])];return n&&n==r?e:i}function Ar(e,t,n){var r=t(e);return Gs(e)?r:Lt(r,n(e))}function Sr(e){return null==e?e===i?"[object Undefined]":"[object Null]":Je&&Je in Ie(e)?function(e){var t=Le.call(e,Je),n=e[Je];try{e[Je]=i;var r=!0}catch(e){}var o=je.call(e);r&&(t?e[Je]=n:delete e[Je]);return o}(e):function(e){return je.call(e)}(e)}function Ir(e,t){return e>t}function Nr(e,t){return null!=e&&Le.call(e,t)}function kr(e,t){return null!=e&&t in Ie(e)}function xr(e,t,n){for(var o=n?Dt:Rt,s=e[0].length,a=e.length,u=a,c=r(a),l=1/0,d=[];u--;){var h=e[u];u&&t&&(h=Ut(h,Jt(t))),l=bn(h.length,l),c[u]=!n&&(t||s>=120&&h.length>=120)?new Zn(u&&h):i}h=e[0];var f=-1,p=c[0];e:for(;++f<s&&d.length<l;){var _=h[f],v=t?t(_):_;if(_=n||0!==_?_:0,!(p?tn(p,v):o(d,v,n))){for(u=a;--u;){var m=c[u];if(!(m?tn(m,v):o(e[u],v,n)))continue e}p&&p.push(v),d.push(_)}}return d}function Or(e,t,n){var r=null==(e=ko(e,t=bi(t,e)))?e:e[Fo($o(t))];return null==r?i:It(r,e,n)}function Mr(e){return na(e)&&Sr(e)==g}function Rr(e,t,n,r,o){return e===t||(null==e||null==t||!na(e)&&!na(t)?e!=e&&t!=t:function(e,t,n,r,o,s){var a=Gs(e),u=Gs(t),c=a?y:vo(e),l=u?y:vo(t),d=(c=c==g?I:c)==I,h=(l=l==g?I:l)==I,f=c==l;if(f&&Zs(e)){if(!Zs(t))return!1;a=!0,d=!1}if(f&&!d)return s||(s=new Yn),a||la(e)?no(e,t,n,r,o,s):function(e,t,n,r,i,o,s){switch(n){case U:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case D:return!(e.byteLength!=t.byteLength||!o(new Ge(e),new Ge(t)));case b:case E:case S:return Hs(+e,+t);case w:return e.name==t.name&&e.message==t.message;case k:case O:return e==t+"";case A:var a=cn;case x:var u=1&r;if(a||(a=hn),e.size!=t.size&&!u)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var l=no(a(e),a(t),r,i,o,s);return s.delete(e),l;case M:if(jn)return jn.call(e)==jn.call(t)}return!1}(e,t,c,n,r,o,s);if(!(1&n)){var p=d&&Le.call(e,"__wrapped__"),_=h&&Le.call(t,"__wrapped__");if(p||_){var v=p?e.value():e,m=_?t.value():t;return s||(s=new Yn),o(v,m,n,r,s)}}if(!f)return!1;return s||(s=new Yn),function(e,t,n,r,o,s){var a=1&n,u=io(e),c=u.length,l=io(t),d=l.length;if(c!=d&&!a)return!1;var h=c;for(;h--;){var f=u[h];if(!(a?f in t:Le.call(t,f)))return!1}var p=s.get(e),_=s.get(t);if(p&&_)return p==t&&_==e;var v=!0;s.set(e,t),s.set(t,e);var m=a;for(;++h<c;){var g=e[f=u[h]],y=t[f];if(r)var b=a?r(y,g,f,t,e,s):r(g,y,f,e,t,s);if(!(b===i?g===y||o(g,y,n,r,s):b)){v=!1;break}m||(m="constructor"==f)}if(v&&!m){var E=e.constructor,w=t.constructor;E==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof E&&E instanceof E&&"function"==typeof w&&w instanceof w||(v=!1)}return s.delete(e),s.delete(t),v}(e,t,n,r,o,s)}(e,t,n,r,Rr,o))}function Dr(e,t,n,r){var o=n.length,s=o,a=!r;if(null==e)return!s;for(e=Ie(e);o--;){var u=n[o];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<s;){var c=(u=n[o])[0],l=e[c],d=u[1];if(a&&u[2]){if(l===i&&!(c in e))return!1}else{var h=new Yn;if(r)var f=r(l,d,c,e,t,h);if(!(f===i?Rr(d,l,3,r,h):f))return!1}}return!0}function Ur(e){return!(!ta(e)||function(e){return!!Fe&&Fe in e}(e))&&(Xs(e)?Ve:ge).test(jo(e))}function Lr(e){return"function"==typeof e?e:null==e?iu:"object"==typeof e?Gs(e)?Vr(e[0],e[1]):Hr(e):fu(e)}function Pr(e){if(!Ao(e))return Qt(e);var t=[];for(var n in Ie(e))Le.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Fr(e){if(!ta(e))return function(e){var t=[];if(null!=e)for(var n in Ie(e))t.push(n);return t}(e);var t=Ao(e),n=[];for(var r in e)("constructor"!=r||!t&&Le.call(e,r))&&n.push(r);return n}function jr(e,t){return e<t}function qr(e,t){var n=-1,i=Ks(e)?r(e.length):[];return fr(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Hr(e){var t=ho(e);return 1==t.length&&t[0][2]?Io(t[0][0],t[0][1]):function(n){return n===e||Dr(n,e,t)}}function Vr(e,t){return wo(e)&&So(t)?Io(Fo(e),t):function(n){var r=Ia(n,e);return r===i&&r===t?Na(n,e):Rr(t,r,3)}}function Br(e,t,n,r,o){e!==t&&yr(t,(function(s,a){if(o||(o=new Yn),ta(s))!function(e,t,n,r,o,s,a){var u=xo(e,n),c=xo(t,n),l=a.get(c);if(l)return void tr(e,n,l);var d=s?s(u,c,n+"",e,t,a):i,h=d===i;if(h){var f=Gs(c),p=!f&&Zs(c),_=!f&&!p&&la(c);d=c,f||p||_?Gs(u)?d=u:Qs(u)?d=xi(u):p?(h=!1,d=Ti(c,!0)):_?(h=!1,d=Si(c,!0)):d=[]:oa(c)||zs(c)?(d=u,zs(u)?d=ga(u):ta(u)&&!Xs(u)||(d=go(c))):h=!1}h&&(a.set(c,d),o(d,c,r,s,a),a.delete(c));tr(e,n,d)}(e,t,a,n,Br,r,o);else{var u=r?r(xo(e,a),s,a+"",e,t,o):i;u===i&&(u=s),tr(e,a,u)}}),Ra)}function zr(e,t){var n=e.length;if(n)return bo(t+=t<0?n:0,n)?e[t]:i}function Gr(e,t,n){t=t.length?Ut(t,(function(e){return Gs(e)?function(t){return Tr(t,1===e.length?e[0]:e)}:e})):[iu];var r=-1;t=Ut(t,Jt(co()));var i=qr(e,(function(e,n,i){var o=Ut(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(i,(function(e,t){return function(e,t,n){var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;for(;++r<s;){var u=Ii(i[r],o[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))}function Wr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=Tr(e,s);n(a,s)&&ei(o,bi(s,e),a)}return o}function Kr(e,t,n,r){var i=r?zt:Bt,o=-1,s=t.length,a=e;for(e===t&&(t=xi(t)),n&&(a=Ut(e,Jt(n)));++o<s;)for(var u=0,c=t[o],l=n?n(c):c;(u=i(a,l,u,r))>-1;)a!==e&&Ye.call(a,u,1),Ye.call(e,u,1);return e}function Qr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;bo(i)?Ye.call(e,i,1):hi(e,i)}}return e}function Zr(e,t){return e+vt(Cn()*(t-e+1))}function Yr(e,t){var n="";if(!e||t<1||t>p)return n;do{t%2&&(n+=e),(t=vt(t/2))&&(e+=e)}while(t);return n}function $r(e,t){return Ro(No(e,t,iu),e+"")}function Xr(e){return Xn(Ha(e))}function Jr(e,t){var n=Ha(e);return Lo(n,ur(t,0,n.length))}function ei(e,t,n,r){if(!ta(e))return e;for(var o=-1,s=(t=bi(t,e)).length,a=s-1,u=e;null!=u&&++o<s;){var c=Fo(t[o]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var d=u[c];(l=r?r(d,c,u):i)===i&&(l=ta(d)?d:bo(t[o+1])?[]:{})}nr(u,c,l),u=u[c]}return e}var ti=On?function(e,t){return On.set(e,t),e}:iu,ni=nt?function(e,t){return nt(e,"toString",{configurable:!0,enumerable:!1,value:tu(t),writable:!0})}:iu;function ri(e){return Lo(Ha(e))}function ii(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var s=r(o);++i<o;)s[i]=e[i+t];return s}function oi(e,t){var n;return fr(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function si(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!ca(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return ai(e,t,iu,n)}function ai(e,t,n,r){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=n(t))!=t,u=null===t,c=ca(t),l=t===i;o<s;){var d=vt((o+s)/2),h=n(e[d]),f=h!==i,p=null===h,_=h==h,v=ca(h);if(a)var m=r||_;else m=l?_&&(r||f):u?_&&f&&(r||!p):c?_&&f&&!p&&(r||!v):!p&&!v&&(r?h<=t:h<t);m?o=d+1:s=d}return bn(s,4294967294)}function ui(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!Hs(a,u)){var u=a;o[i++]=0===s?0:s}}return o}function ci(e){return"number"==typeof e?e:ca(e)?_:+e}function li(e){if("string"==typeof e)return e;if(Gs(e))return Ut(e,li)+"";if(ca(e))return qn?qn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function di(e,t,n){var r=-1,i=Rt,o=e.length,s=!0,a=[],u=a;if(n)s=!1,i=Dt;else if(o>=200){var c=t?null:Yi(e);if(c)return hn(c);s=!1,i=tn,u=new Zn}else u=t?[]:a;e:for(;++r<o;){var l=e[r],d=t?t(l):l;if(l=n||0!==l?l:0,s&&d==d){for(var h=u.length;h--;)if(u[h]===d)continue e;t&&u.push(d),a.push(l)}else i(u,d,n)||(u!==a&&u.push(d),a.push(l))}return a}function hi(e,t){return null==(e=ko(e,t=bi(t,e)))||delete e[Fo($o(t))]}function fi(e,t,n,r){return ei(e,t,n(Tr(e,t)),r)}function pi(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ii(e,r?0:o,r?o+1:i):ii(e,r?o+1:0,r?i:o)}function _i(e,t){var n=e;return n instanceof Gn&&(n=n.value()),Pt(t,(function(e,t){return t.func.apply(t.thisArg,Lt([e],t.args))}),n)}function vi(e,t,n){var i=e.length;if(i<2)return i?di(e[0]):[];for(var o=-1,s=r(i);++o<i;)for(var a=e[o],u=-1;++u<i;)u!=o&&(s[o]=hr(s[o]||a,e[u],t,n));return di(gr(s,1),t,n)}function mi(e,t,n){for(var r=-1,o=e.length,s=t.length,a={};++r<o;){var u=r<s?t[r]:i;n(a,e[r],u)}return a}function gi(e){return Qs(e)?e:[]}function yi(e){return"function"==typeof e?e:iu}function bi(e,t){return Gs(e)?e:wo(e,t)?[e]:Po(ya(e))}var Ei=$r;function wi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ii(e,t,n)}var Ci=it||function(e){return _t.clearTimeout(e)};function Ti(e,t){if(t)return e.slice();var n=e.length,r=We?We(n):new e.constructor(n);return e.copy(r),r}function Ai(e){var t=new e.constructor(e.byteLength);return new Ge(t).set(new Ge(e)),t}function Si(e,t){var n=t?Ai(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ii(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,s=ca(e),a=t!==i,u=null===t,c=t==t,l=ca(t);if(!u&&!l&&!s&&e>t||s&&a&&c&&!u&&!l||r&&a&&c||!n&&c||!o)return 1;if(!r&&!s&&!l&&e<t||l&&n&&o&&!r&&!s||u&&n&&o||!a&&o||!c)return-1}return 0}function Ni(e,t,n,i){for(var o=-1,s=e.length,a=n.length,u=-1,c=t.length,l=yn(s-a,0),d=r(c+l),h=!i;++u<c;)d[u]=t[u];for(;++o<a;)(h||o<s)&&(d[n[o]]=e[o]);for(;l--;)d[u++]=e[o++];return d}function ki(e,t,n,i){for(var o=-1,s=e.length,a=-1,u=n.length,c=-1,l=t.length,d=yn(s-u,0),h=r(d+l),f=!i;++o<d;)h[o]=e[o];for(var p=o;++c<l;)h[p+c]=t[c];for(;++a<u;)(f||o<s)&&(h[p+n[a]]=e[o++]);return h}function xi(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Oi(e,t,n,r){var o=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var u=t[s],c=r?r(n[u],e[u],u,n,e):i;c===i&&(c=e[u]),o?sr(n,u,c):nr(n,u,c)}return n}function Mi(e,t){return function(n,r){var i=Gs(n)?Nt:ir,o=t?t():{};return i(n,e,co(r,2),o)}}function Ri(e){return $r((function(t,n){var r=-1,o=n.length,s=o>1?n[o-1]:i,a=o>2?n[2]:i;for(s=e.length>3&&"function"==typeof s?(o--,s):i,a&&Eo(n[0],n[1],a)&&(s=o<3?i:s,o=1),t=Ie(t);++r<o;){var u=n[r];u&&e(t,u,r,s)}return t}))}function Di(e,t){return function(n,r){if(null==n)return n;if(!Ks(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=Ie(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Ui(e){return function(t,n,r){for(var i=-1,o=Ie(t),s=r(t),a=s.length;a--;){var u=s[e?a:++i];if(!1===n(o[u],u,o))break}return t}}function Li(e){return function(t){var n=un(t=ya(t))?_n(t):i,r=n?n[0]:t.charAt(0),o=n?wi(n,1).join(""):t.slice(1);return r[e]()+o}}function Pi(e){return function(t){return Pt(Xa(za(t).replace(et,"")),e,"")}}function Fi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Vn(e.prototype),r=e.apply(n,t);return ta(r)?r:n}}function ji(e){return function(t,n,r){var o=Ie(t);if(!Ks(t)){var s=co(n,3);t=Ma(t),n=function(e){return s(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[s?t[a]:a]:i}}function qi(e){return ro((function(t){var n=t.length,r=n,s=zn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new xe(o);if(s&&!u&&"wrapper"==ao(a))var u=new zn([],!0)}for(r=u?r:n;++r<n;){var c=ao(a=t[r]),l="wrapper"==c?so(a):i;u=l&&Co(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?u[ao(l[0])].apply(u,l[3]):1==a.length&&Co(a)?u[c]():u.thru(a)}return function(){var e=arguments,r=e[0];if(u&&1==e.length&&Gs(r))return u.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function Hi(e,t,n,o,s,a,u,c,l,h){var f=t&d,p=1&t,_=2&t,v=24&t,m=512&t,g=_?i:Fi(e);return function d(){for(var y=arguments.length,b=r(y),E=y;E--;)b[E]=arguments[E];if(v)var w=uo(d),C=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(b,w);if(o&&(b=Ni(b,o,s,v)),a&&(b=ki(b,a,u,v)),y-=C,v&&y<h){var T=dn(b,w);return Qi(e,t,Hi,d.placeholder,n,b,T,c,l,h-y)}var A=p?n:this,S=_?A[e]:e;return y=b.length,c?b=function(e,t){var n=e.length,r=bn(t.length,n),o=xi(e);for(;r--;){var s=t[r];e[r]=bo(s,n)?o[s]:i}return e}(b,c):m&&y>1&&b.reverse(),f&&l<y&&(b.length=l),this&&this!==_t&&this instanceof d&&(S=g||Fi(S)),S.apply(A,b)}}function Vi(e,t){return function(n,r){return function(e,t,n,r){return Er(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function Bi(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=li(n),r=li(r)):(n=ci(n),r=ci(r)),o=e(n,r)}return o}}function zi(e){return ro((function(t){return t=Ut(t,Jt(co())),$r((function(n){var r=this;return e(t,(function(e){return It(e,r,n)}))}))}))}function Gi(e,t){var n=(t=t===i?" ":li(t)).length;if(n<2)return n?Yr(t,e):t;var r=Yr(t,pt(e/pn(t)));return un(t)?wi(_n(r),0,e).join(""):r.slice(0,e)}function Wi(e){return function(t,n,o){return o&&"number"!=typeof o&&Eo(t,n,o)&&(n=o=i),t=pa(t),n===i?(n=t,t=0):n=pa(n),function(e,t,n,i){for(var o=-1,s=yn(pt((t-e)/(n||1)),0),a=r(s);s--;)a[i?s:++o]=e,e+=n;return a}(t,n,o=o===i?t<n?1:-1:pa(o),e)}}function Ki(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ma(t),n=ma(n)),e(t,n)}}function Qi(e,t,n,r,o,s,a,u,d,h){var f=8&t;t|=f?c:l,4&(t&=~(f?l:c))||(t&=-4);var p=[e,t,o,f?s:i,f?a:i,f?i:s,f?i:a,u,d,h],_=n.apply(i,p);return Co(e)&&Oo(_,p),_.placeholder=r,Do(_,e,t)}function Zi(e){var t=Se[e];return function(e,n){if(e=ma(e),(n=null==n?0:bn(_a(n),292))&&bt(e)){var r=(ya(e)+"e").split("e");return+((r=(ya(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Yi=Nn&&1/hn(new Nn([,-0]))[1]==f?function(e){return new Nn(e)}:cu;function $i(e){return function(t){var n=vo(t);return n==A?cn(t):n==x?fn(t):function(e,t){return Ut(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Xi(e,t,n,s,f,p,_,v){var m=2&t;if(!m&&"function"!=typeof e)throw new xe(o);var g=s?s.length:0;if(g||(t&=-97,s=f=i),_=_===i?_:yn(_a(_),0),v=v===i?v:_a(v),g-=f?f.length:0,t&l){var y=s,b=f;s=f=i}var E=m?i:so(e),w=[e,t,n,s,f,y,b,p,_,v];if(E&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,s=r==d&&8==n||r==d&&n==h&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!s)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var u=t[3];if(u){var c=e[3];e[3]=c?Ni(c,u,t[4]):u,e[4]=c?dn(e[3],a):t[4]}(u=t[5])&&(c=e[5],e[5]=c?ki(c,u,t[6]):u,e[6]=c?dn(e[5],a):t[6]);(u=t[7])&&(e[7]=u);r&d&&(e[8]=null==e[8]?t[8]:bn(e[8],t[8]));null==e[9]&&(e[9]=t[9]);e[0]=t[0],e[1]=i}(w,E),e=w[0],t=w[1],n=w[2],s=w[3],f=w[4],!(v=w[9]=w[9]===i?m?0:e.length:yn(w[9]-g,0))&&24&t&&(t&=-25),t&&1!=t)C=8==t||t==u?function(e,t,n){var o=Fi(e);return function s(){for(var a=arguments.length,u=r(a),c=a,l=uo(s);c--;)u[c]=arguments[c];var d=a<3&&u[0]!==l&&u[a-1]!==l?[]:dn(u,l);return(a-=d.length)<n?Qi(e,t,Hi,s.placeholder,i,u,d,i,i,n-a):It(this&&this!==_t&&this instanceof s?o:e,this,u)}}(e,t,v):t!=c&&33!=t||f.length?Hi.apply(i,w):function(e,t,n,i){var o=1&t,s=Fi(e);return function t(){for(var a=-1,u=arguments.length,c=-1,l=i.length,d=r(l+u),h=this&&this!==_t&&this instanceof t?s:e;++c<l;)d[c]=i[c];for(;u--;)d[c++]=arguments[++a];return It(h,o?n:this,d)}}(e,t,n,s);else var C=function(e,t,n){var r=1&t,i=Fi(e);return function t(){return(this&&this!==_t&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Do((E?ti:Oo)(C,w),e,t)}function Ji(e,t,n,r){return e===i||Hs(e,Re[n])&&!Le.call(r,n)?t:e}function eo(e,t,n,r,o,s){return ta(e)&&ta(t)&&(s.set(t,e),Br(e,t,i,eo,s),s.delete(t)),e}function to(e){return oa(e)?i:e}function no(e,t,n,r,o,s){var a=1&n,u=e.length,c=t.length;if(u!=c&&!(a&&c>u))return!1;var l=s.get(e),d=s.get(t);if(l&&d)return l==t&&d==e;var h=-1,f=!0,p=2&n?new Zn:i;for(s.set(e,t),s.set(t,e);++h<u;){var _=e[h],v=t[h];if(r)var m=a?r(v,_,h,t,e,s):r(_,v,h,e,t,s);if(m!==i){if(m)continue;f=!1;break}if(p){if(!jt(t,(function(e,t){if(!tn(p,t)&&(_===e||o(_,e,n,r,s)))return p.push(t)}))){f=!1;break}}else if(_!==v&&!o(_,v,n,r,s)){f=!1;break}}return s.delete(e),s.delete(t),f}function ro(e){return Ro(No(e,i,Wo),e+"")}function io(e){return Ar(e,Ma,po)}function oo(e){return Ar(e,Ra,_o)}var so=On?function(e){return On.get(e)}:cu;function ao(e){for(var t=e.name+"",n=Mn[t],r=Le.call(Mn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function uo(e){return(Le.call(Hn,"placeholder")?Hn:e).placeholder}function co(){var e=Hn.iteratee||ou;return e=e===ou?Lr:e,arguments.length?e(arguments[0],arguments[1]):e}function lo(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function ho(e){for(var t=Ma(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,So(i)]}return t}function fo(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Ur(n)?n:i}var po=mt?function(e){return null==e?[]:(e=Ie(e),Mt(mt(e),(function(t){return Ze.call(e,t)})))}:vu,_o=mt?function(e){for(var t=[];e;)Lt(t,po(e)),e=Ke(e);return t}:vu,vo=Sr;function mo(e,t,n){for(var r=-1,i=(t=bi(t,e)).length,o=!1;++r<i;){var s=Fo(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&ea(i)&&bo(s,i)&&(Gs(e)||zs(e))}function go(e){return"function"!=typeof e.constructor||Ao(e)?{}:Vn(Ke(e))}function yo(e){return Gs(e)||zs(e)||!!($e&&e&&e[$e])}function bo(e,t){var n=typeof e;return!!(t=null==t?p:t)&&("number"==n||"symbol"!=n&&be.test(e))&&e>-1&&e%1==0&&e<t}function Eo(e,t,n){if(!ta(n))return!1;var r=typeof t;return!!("number"==r?Ks(n)&&bo(t,n.length):"string"==r&&t in n)&&Hs(n[t],e)}function wo(e,t){if(Gs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ca(e))||(ne.test(e)||!te.test(e)||null!=t&&e in Ie(t))}function Co(e){var t=ao(e),n=Hn[t];if("function"!=typeof n||!(t in Gn.prototype))return!1;if(e===n)return!0;var r=so(n);return!!r&&e===r[0]}(An&&vo(new An(new ArrayBuffer(1)))!=U||Sn&&vo(new Sn)!=A||In&&vo(In.resolve())!=N||Nn&&vo(new Nn)!=x||kn&&vo(new kn)!=R)&&(vo=function(e){var t=Sr(e),n=t==I?e.constructor:i,r=n?jo(n):"";if(r)switch(r){case Rn:return U;case Dn:return A;case Un:return N;case Ln:return x;case Pn:return R}return t});var To=De?Xs:mu;function Ao(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Re)}function So(e){return e==e&&!ta(e)}function Io(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==i||e in Ie(n)))}}function No(e,t,n){return t=yn(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=yn(i.length-t,0),a=r(s);++o<s;)a[o]=i[t+o];o=-1;for(var u=r(t+1);++o<t;)u[o]=i[o];return u[t]=n(a),It(e,this,u)}}function ko(e,t){return t.length<2?e:Tr(e,ii(t,0,-1))}function xo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Oo=Uo(ti),Mo=ft||function(e,t){return _t.setTimeout(e,t)},Ro=Uo(ni);function Do(e,t,n){var r=t+"";return Ro(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ue,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return kt(m,(function(n){var r="_."+n[0];t&n[1]&&!Rt(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ce);return t?t[1].split(le):[]}(r),n)))}function Uo(e){var t=0,n=0;return function(){var r=En(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Lo(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var s=Zr(n,o),a=e[s];e[s]=e[n],e[n]=a}return e.length=t,e}var Po=function(e){var t=Us(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(re,(function(e,n,r,i){t.push(r?i.replace(fe,"$1"):n||e)})),t}));function Fo(e){if("string"==typeof e||ca(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function jo(e){if(null!=e){try{return Ue.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function qo(e){if(e instanceof Gn)return e.clone();var t=new zn(e.__wrapped__,e.__chain__);return t.__actions__=xi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ho=$r((function(e,t){return Qs(e)?hr(e,gr(t,1,Qs,!0)):[]})),Vo=$r((function(e,t){var n=$o(t);return Qs(n)&&(n=i),Qs(e)?hr(e,gr(t,1,Qs,!0),co(n,2)):[]})),Bo=$r((function(e,t){var n=$o(t);return Qs(n)&&(n=i),Qs(e)?hr(e,gr(t,1,Qs,!0),i,n):[]}));function zo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:_a(n);return i<0&&(i=yn(r+i,0)),Vt(e,co(t,3),i)}function Go(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=_a(n),o=n<0?yn(r+o,0):bn(o,r-1)),Vt(e,co(t,3),o,!0)}function Wo(e){return(null==e?0:e.length)?gr(e,1):[]}function Ko(e){return e&&e.length?e[0]:i}var Qo=$r((function(e){var t=Ut(e,gi);return t.length&&t[0]===e[0]?xr(t):[]})),Zo=$r((function(e){var t=$o(e),n=Ut(e,gi);return t===$o(n)?t=i:n.pop(),n.length&&n[0]===e[0]?xr(n,co(t,2)):[]})),Yo=$r((function(e){var t=$o(e),n=Ut(e,gi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?xr(n,i,t):[]}));function $o(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Xo=$r(Jo);function Jo(e,t){return e&&e.length&&t&&t.length?Kr(e,t):e}var es=ro((function(e,t){var n=null==e?0:e.length,r=ar(e,t);return Qr(e,Ut(t,(function(e){return bo(e,n)?+e:e})).sort(Ii)),r}));function ts(e){return null==e?e:Tn.call(e)}var ns=$r((function(e){return di(gr(e,1,Qs,!0))})),rs=$r((function(e){var t=$o(e);return Qs(t)&&(t=i),di(gr(e,1,Qs,!0),co(t,2))})),is=$r((function(e){var t=$o(e);return t="function"==typeof t?t:i,di(gr(e,1,Qs,!0),i,t)}));function os(e){if(!e||!e.length)return[];var t=0;return e=Mt(e,(function(e){if(Qs(e))return t=yn(e.length,t),!0})),$t(t,(function(t){return Ut(e,Kt(t))}))}function ss(e,t){if(!e||!e.length)return[];var n=os(e);return null==t?n:Ut(n,(function(e){return It(t,i,e)}))}var as=$r((function(e,t){return Qs(e)?hr(e,t):[]})),us=$r((function(e){return vi(Mt(e,Qs))})),cs=$r((function(e){var t=$o(e);return Qs(t)&&(t=i),vi(Mt(e,Qs),co(t,2))})),ls=$r((function(e){var t=$o(e);return t="function"==typeof t?t:i,vi(Mt(e,Qs),i,t)})),ds=$r(os);var hs=$r((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,ss(e,n)}));function fs(e){var t=Hn(e);return t.__chain__=!0,t}function ps(e,t){return t(e)}var _s=ro((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ar(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Gn&&bo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:ps,args:[o],thisArg:i}),new zn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(o)}));var vs=Mi((function(e,t,n){Le.call(e,n)?++e[n]:sr(e,n,1)}));var ms=ji(zo),gs=ji(Go);function ys(e,t){return(Gs(e)?kt:fr)(e,co(t,3))}function bs(e,t){return(Gs(e)?xt:pr)(e,co(t,3))}var Es=Mi((function(e,t,n){Le.call(e,n)?e[n].push(t):sr(e,n,[t])}));var ws=$r((function(e,t,n){var i=-1,o="function"==typeof t,s=Ks(e)?r(e.length):[];return fr(e,(function(e){s[++i]=o?It(t,e,n):Or(e,t,n)})),s})),Cs=Mi((function(e,t,n){sr(e,n,t)}));function Ts(e,t){return(Gs(e)?Ut:qr)(e,co(t,3))}var As=Mi((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var Ss=$r((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Eo(e,t[0],t[1])?t=[]:n>2&&Eo(t[0],t[1],t[2])&&(t=[t[0]]),Gr(e,gr(t,1),[])})),Is=lt||function(){return _t.Date.now()};function Ns(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Xi(e,d,i,i,i,i,t)}function ks(e,t){var n;if("function"!=typeof t)throw new xe(o);return e=_a(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var xs=$r((function(e,t,n){var r=1;if(n.length){var i=dn(n,uo(xs));r|=c}return Xi(e,r,t,n,i)})),Os=$r((function(e,t,n){var r=3;if(n.length){var i=dn(n,uo(Os));r|=c}return Xi(t,r,e,n,i)}));function Ms(e,t,n){var r,s,a,u,c,l,d=0,h=!1,f=!1,p=!0;if("function"!=typeof e)throw new xe(o);function _(t){var n=r,o=s;return r=s=i,d=t,u=e.apply(o,n)}function v(e){var n=e-l;return l===i||n>=t||n<0||f&&e-d>=a}function m(){var e=Is();if(v(e))return g(e);c=Mo(m,function(e){var n=t-(e-l);return f?bn(n,a-(e-d)):n}(e))}function g(e){return c=i,p&&r?_(e):(r=s=i,u)}function y(){var e=Is(),n=v(e);if(r=arguments,s=this,l=e,n){if(c===i)return function(e){return d=e,c=Mo(m,t),h?_(e):u}(l);if(f)return Ci(c),c=Mo(m,t),_(l)}return c===i&&(c=Mo(m,t)),u}return t=ma(t)||0,ta(n)&&(h=!!n.leading,a=(f="maxWait"in n)?yn(ma(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),y.cancel=function(){c!==i&&Ci(c),d=0,r=l=s=c=i},y.flush=function(){return c===i?u:g(Is())},y}var Rs=$r((function(e,t){return dr(e,1,t)})),Ds=$r((function(e,t,n){return dr(e,ma(t)||0,n)}));function Us(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new xe(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Us.Cache||Qn),n}function Ls(e){if("function"!=typeof e)throw new xe(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Us.Cache=Qn;var Ps=Ei((function(e,t){var n=(t=1==t.length&&Gs(t[0])?Ut(t[0],Jt(co())):Ut(gr(t,1),Jt(co()))).length;return $r((function(r){for(var i=-1,o=bn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return It(e,this,r)}))})),Fs=$r((function(e,t){var n=dn(t,uo(Fs));return Xi(e,c,i,t,n)})),js=$r((function(e,t){var n=dn(t,uo(js));return Xi(e,l,i,t,n)})),qs=ro((function(e,t){return Xi(e,h,i,i,i,t)}));function Hs(e,t){return e===t||e!=e&&t!=t}var Vs=Ki(Ir),Bs=Ki((function(e,t){return e>=t})),zs=Mr(function(){return arguments}())?Mr:function(e){return na(e)&&Le.call(e,"callee")&&!Ze.call(e,"callee")},Gs=r.isArray,Ws=Et?Jt(Et):function(e){return na(e)&&Sr(e)==D};function Ks(e){return null!=e&&ea(e.length)&&!Xs(e)}function Qs(e){return na(e)&&Ks(e)}var Zs=yt||mu,Ys=wt?Jt(wt):function(e){return na(e)&&Sr(e)==E};function $s(e){if(!na(e))return!1;var t=Sr(e);return t==w||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!oa(e)}function Xs(e){if(!ta(e))return!1;var t=Sr(e);return t==C||t==T||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Js(e){return"number"==typeof e&&e==_a(e)}function ea(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=p}function ta(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function na(e){return null!=e&&"object"==typeof e}var ra=Ct?Jt(Ct):function(e){return na(e)&&vo(e)==A};function ia(e){return"number"==typeof e||na(e)&&Sr(e)==S}function oa(e){if(!na(e)||Sr(e)!=I)return!1;var t=Ke(e);if(null===t)return!0;var n=Le.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ue.call(n)==qe}var sa=Tt?Jt(Tt):function(e){return na(e)&&Sr(e)==k};var aa=At?Jt(At):function(e){return na(e)&&vo(e)==x};function ua(e){return"string"==typeof e||!Gs(e)&&na(e)&&Sr(e)==O}function ca(e){return"symbol"==typeof e||na(e)&&Sr(e)==M}var la=St?Jt(St):function(e){return na(e)&&ea(e.length)&&!!ut[Sr(e)]};var da=Ki(jr),ha=Ki((function(e,t){return e<=t}));function fa(e){if(!e)return[];if(Ks(e))return ua(e)?_n(e):xi(e);if(Xe&&e[Xe])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Xe]());var t=vo(e);return(t==A?cn:t==x?hn:Ha)(e)}function pa(e){return e?(e=ma(e))===f||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function _a(e){var t=pa(e),n=t%1;return t==t?n?t-n:t:0}function va(e){return e?ur(_a(e),0,v):0}function ma(e){if("number"==typeof e)return e;if(ca(e))return _;if(ta(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ta(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xt(e);var n=me.test(e);return n||ye.test(e)?ht(e.slice(2),n?2:8):ve.test(e)?_:+e}function ga(e){return Oi(e,Ra(e))}function ya(e){return null==e?"":li(e)}var ba=Ri((function(e,t){if(Ao(t)||Ks(t))Oi(t,Ma(t),e);else for(var n in t)Le.call(t,n)&&nr(e,n,t[n])})),Ea=Ri((function(e,t){Oi(t,Ra(t),e)})),wa=Ri((function(e,t,n,r){Oi(t,Ra(t),e,r)})),Ca=Ri((function(e,t,n,r){Oi(t,Ma(t),e,r)})),Ta=ro(ar);var Aa=$r((function(e,t){e=Ie(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&Eo(t[0],t[1],o)&&(r=1);++n<r;)for(var s=t[n],a=Ra(s),u=-1,c=a.length;++u<c;){var l=a[u],d=e[l];(d===i||Hs(d,Re[l])&&!Le.call(e,l))&&(e[l]=s[l])}return e})),Sa=$r((function(e){return e.push(i,eo),It(Ua,i,e)}));function Ia(e,t,n){var r=null==e?i:Tr(e,t);return r===i?n:r}function Na(e,t){return null!=e&&mo(e,t,kr)}var ka=Vi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=je.call(t)),e[t]=n}),tu(iu)),xa=Vi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=je.call(t)),Le.call(e,t)?e[t].push(n):e[t]=[n]}),co),Oa=$r(Or);function Ma(e){return Ks(e)?$n(e):Pr(e)}function Ra(e){return Ks(e)?$n(e,!0):Fr(e)}var Da=Ri((function(e,t,n){Br(e,t,n)})),Ua=Ri((function(e,t,n,r){Br(e,t,n,r)})),La=ro((function(e,t){var n={};if(null==e)return n;var r=!1;t=Ut(t,(function(t){return t=bi(t,e),r||(r=t.length>1),t})),Oi(e,oo(e),n),r&&(n=cr(n,7,to));for(var i=t.length;i--;)hi(n,t[i]);return n}));var Pa=ro((function(e,t){return null==e?{}:function(e,t){return Wr(e,t,(function(t,n){return Na(e,n)}))}(e,t)}));function Fa(e,t){if(null==e)return{};var n=Ut(oo(e),(function(e){return[e]}));return t=co(t),Wr(e,n,(function(e,n){return t(e,n[0])}))}var ja=$i(Ma),qa=$i(Ra);function Ha(e){return null==e?[]:en(e,Ma(e))}var Va=Pi((function(e,t,n){return t=t.toLowerCase(),e+(n?Ba(t):t)}));function Ba(e){return $a(ya(e).toLowerCase())}function za(e){return(e=ya(e))&&e.replace(Ee,on).replace(tt,"")}var Ga=Pi((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Wa=Pi((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ka=Li("toLowerCase");var Qa=Pi((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));var Za=Pi((function(e,t,n){return e+(n?" ":"")+$a(t)}));var Ya=Pi((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),$a=Li("toUpperCase");function Xa(e,t,n){return e=ya(e),(t=n?i:t)===i?function(e){return ot.test(e)}(e)?function(e){return e.match(rt)||[]}(e):function(e){return e.match(de)||[]}(e):e.match(t)||[]}var Ja=$r((function(e,t){try{return It(e,i,t)}catch(e){return $s(e)?e:new Te(e)}})),eu=ro((function(e,t){return kt(t,(function(t){t=Fo(t),sr(e,t,xs(e[t],e))})),e}));function tu(e){return function(){return e}}var nu=qi(),ru=qi(!0);function iu(e){return e}function ou(e){return Lr("function"==typeof e?e:cr(e,1))}var su=$r((function(e,t){return function(n){return Or(n,e,t)}})),au=$r((function(e,t){return function(n){return Or(e,n,t)}}));function uu(e,t,n){var r=Ma(t),i=Cr(t,r);null!=n||ta(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Cr(t,Ma(t)));var o=!(ta(n)&&"chain"in n&&!n.chain),s=Xs(e);return kt(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=xi(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Lt([this.value()],arguments))})})),e}function cu(){}var lu=zi(Ut),du=zi(Ot),hu=zi(jt);function fu(e){return wo(e)?Kt(Fo(e)):function(e){return function(t){return Tr(t,e)}}(e)}var pu=Wi(),_u=Wi(!0);function vu(){return[]}function mu(){return!1}var gu=Bi((function(e,t){return e+t}),0),yu=Zi("ceil"),bu=Bi((function(e,t){return e/t}),1),Eu=Zi("floor");var wu,Cu=Bi((function(e,t){return e*t}),1),Tu=Zi("round"),Au=Bi((function(e,t){return e-t}),0);return Hn.after=function(e,t){if("function"!=typeof t)throw new xe(o);return e=_a(e),function(){if(--e<1)return t.apply(this,arguments)}},Hn.ary=Ns,Hn.assign=ba,Hn.assignIn=Ea,Hn.assignInWith=wa,Hn.assignWith=Ca,Hn.at=Ta,Hn.before=ks,Hn.bind=xs,Hn.bindAll=eu,Hn.bindKey=Os,Hn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Gs(e)?e:[e]},Hn.chain=fs,Hn.chunk=function(e,t,n){t=(n?Eo(e,t,n):t===i)?1:yn(_a(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var s=0,a=0,u=r(pt(o/t));s<o;)u[a++]=ii(e,s,s+=t);return u},Hn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Hn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Lt(Gs(n)?xi(n):[n],gr(t,1))},Hn.cond=function(e){var t=null==e?0:e.length,n=co();return e=t?Ut(e,(function(e){if("function"!=typeof e[1])throw new xe(o);return[n(e[0]),e[1]]})):[],$r((function(n){for(var r=-1;++r<t;){var i=e[r];if(It(i[0],this,n))return It(i[1],this,n)}}))},Hn.conforms=function(e){return function(e){var t=Ma(e);return function(n){return lr(n,e,t)}}(cr(e,1))},Hn.constant=tu,Hn.countBy=vs,Hn.create=function(e,t){var n=Vn(e);return null==t?n:or(n,t)},Hn.curry=function e(t,n,r){var o=Xi(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Hn.curryRight=function e(t,n,r){var o=Xi(t,u,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Hn.debounce=Ms,Hn.defaults=Aa,Hn.defaultsDeep=Sa,Hn.defer=Rs,Hn.delay=Ds,Hn.difference=Ho,Hn.differenceBy=Vo,Hn.differenceWith=Bo,Hn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ii(e,(t=n||t===i?1:_a(t))<0?0:t,r):[]},Hn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ii(e,0,(t=r-(t=n||t===i?1:_a(t)))<0?0:t):[]},Hn.dropRightWhile=function(e,t){return e&&e.length?pi(e,co(t,3),!0,!0):[]},Hn.dropWhile=function(e,t){return e&&e.length?pi(e,co(t,3),!0):[]},Hn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&Eo(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=_a(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:_a(r))<0&&(r+=o),r=n>r?0:va(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Hn.filter=function(e,t){return(Gs(e)?Mt:mr)(e,co(t,3))},Hn.flatMap=function(e,t){return gr(Ts(e,t),1)},Hn.flatMapDeep=function(e,t){return gr(Ts(e,t),f)},Hn.flatMapDepth=function(e,t,n){return n=n===i?1:_a(n),gr(Ts(e,t),n)},Hn.flatten=Wo,Hn.flattenDeep=function(e){return(null==e?0:e.length)?gr(e,f):[]},Hn.flattenDepth=function(e,t){return(null==e?0:e.length)?gr(e,t=t===i?1:_a(t)):[]},Hn.flip=function(e){return Xi(e,512)},Hn.flow=nu,Hn.flowRight=ru,Hn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Hn.functions=function(e){return null==e?[]:Cr(e,Ma(e))},Hn.functionsIn=function(e){return null==e?[]:Cr(e,Ra(e))},Hn.groupBy=Es,Hn.initial=function(e){return(null==e?0:e.length)?ii(e,0,-1):[]},Hn.intersection=Qo,Hn.intersectionBy=Zo,Hn.intersectionWith=Yo,Hn.invert=ka,Hn.invertBy=xa,Hn.invokeMap=ws,Hn.iteratee=ou,Hn.keyBy=Cs,Hn.keys=Ma,Hn.keysIn=Ra,Hn.map=Ts,Hn.mapKeys=function(e,t){var n={};return t=co(t,3),Er(e,(function(e,r,i){sr(n,t(e,r,i),e)})),n},Hn.mapValues=function(e,t){var n={};return t=co(t,3),Er(e,(function(e,r,i){sr(n,r,t(e,r,i))})),n},Hn.matches=function(e){return Hr(cr(e,1))},Hn.matchesProperty=function(e,t){return Vr(e,cr(t,1))},Hn.memoize=Us,Hn.merge=Da,Hn.mergeWith=Ua,Hn.method=su,Hn.methodOf=au,Hn.mixin=uu,Hn.negate=Ls,Hn.nthArg=function(e){return e=_a(e),$r((function(t){return zr(t,e)}))},Hn.omit=La,Hn.omitBy=function(e,t){return Fa(e,Ls(co(t)))},Hn.once=function(e){return ks(2,e)},Hn.orderBy=function(e,t,n,r){return null==e?[]:(Gs(t)||(t=null==t?[]:[t]),Gs(n=r?i:n)||(n=null==n?[]:[n]),Gr(e,t,n))},Hn.over=lu,Hn.overArgs=Ps,Hn.overEvery=du,Hn.overSome=hu,Hn.partial=Fs,Hn.partialRight=js,Hn.partition=As,Hn.pick=Pa,Hn.pickBy=Fa,Hn.property=fu,Hn.propertyOf=function(e){return function(t){return null==e?i:Tr(e,t)}},Hn.pull=Xo,Hn.pullAll=Jo,Hn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,co(n,2)):e},Hn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,i,n):e},Hn.pullAt=es,Hn.range=pu,Hn.rangeRight=_u,Hn.rearg=qs,Hn.reject=function(e,t){return(Gs(e)?Mt:mr)(e,Ls(co(t,3)))},Hn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=co(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return Qr(e,i),n},Hn.rest=function(e,t){if("function"!=typeof e)throw new xe(o);return $r(e,t=t===i?t:_a(t))},Hn.reverse=ts,Hn.sampleSize=function(e,t,n){return t=(n?Eo(e,t,n):t===i)?1:_a(t),(Gs(e)?Jn:Jr)(e,t)},Hn.set=function(e,t,n){return null==e?e:ei(e,t,n)},Hn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:ei(e,t,n,r)},Hn.shuffle=function(e){return(Gs(e)?er:ri)(e)},Hn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Eo(e,t,n)?(t=0,n=r):(t=null==t?0:_a(t),n=n===i?r:_a(n)),ii(e,t,n)):[]},Hn.sortBy=Ss,Hn.sortedUniq=function(e){return e&&e.length?ui(e):[]},Hn.sortedUniqBy=function(e,t){return e&&e.length?ui(e,co(t,2)):[]},Hn.split=function(e,t,n){return n&&"number"!=typeof n&&Eo(e,t,n)&&(t=n=i),(n=n===i?v:n>>>0)?(e=ya(e))&&("string"==typeof t||null!=t&&!sa(t))&&!(t=li(t))&&un(e)?wi(_n(e),0,n):e.split(t,n):[]},Hn.spread=function(e,t){if("function"!=typeof e)throw new xe(o);return t=null==t?0:yn(_a(t),0),$r((function(n){var r=n[t],i=wi(n,0,t);return r&&Lt(i,r),It(e,this,i)}))},Hn.tail=function(e){var t=null==e?0:e.length;return t?ii(e,1,t):[]},Hn.take=function(e,t,n){return e&&e.length?ii(e,0,(t=n||t===i?1:_a(t))<0?0:t):[]},Hn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ii(e,(t=r-(t=n||t===i?1:_a(t)))<0?0:t,r):[]},Hn.takeRightWhile=function(e,t){return e&&e.length?pi(e,co(t,3),!1,!0):[]},Hn.takeWhile=function(e,t){return e&&e.length?pi(e,co(t,3)):[]},Hn.tap=function(e,t){return t(e),e},Hn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new xe(o);return ta(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ms(e,t,{leading:r,maxWait:t,trailing:i})},Hn.thru=ps,Hn.toArray=fa,Hn.toPairs=ja,Hn.toPairsIn=qa,Hn.toPath=function(e){return Gs(e)?Ut(e,Fo):ca(e)?[e]:xi(Po(ya(e)))},Hn.toPlainObject=ga,Hn.transform=function(e,t,n){var r=Gs(e),i=r||Zs(e)||la(e);if(t=co(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:ta(e)&&Xs(o)?Vn(Ke(e)):{}}return(i?kt:Er)(e,(function(e,r,i){return t(n,e,r,i)})),n},Hn.unary=function(e){return Ns(e,1)},Hn.union=ns,Hn.unionBy=rs,Hn.unionWith=is,Hn.uniq=function(e){return e&&e.length?di(e):[]},Hn.uniqBy=function(e,t){return e&&e.length?di(e,co(t,2)):[]},Hn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?di(e,i,t):[]},Hn.unset=function(e,t){return null==e||hi(e,t)},Hn.unzip=os,Hn.unzipWith=ss,Hn.update=function(e,t,n){return null==e?e:fi(e,t,yi(n))},Hn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:fi(e,t,yi(n),r)},Hn.values=Ha,Hn.valuesIn=function(e){return null==e?[]:en(e,Ra(e))},Hn.without=as,Hn.words=Xa,Hn.wrap=function(e,t){return Fs(yi(t),e)},Hn.xor=us,Hn.xorBy=cs,Hn.xorWith=ls,Hn.zip=ds,Hn.zipObject=function(e,t){return mi(e||[],t||[],nr)},Hn.zipObjectDeep=function(e,t){return mi(e||[],t||[],ei)},Hn.zipWith=hs,Hn.entries=ja,Hn.entriesIn=qa,Hn.extend=Ea,Hn.extendWith=wa,uu(Hn,Hn),Hn.add=gu,Hn.attempt=Ja,Hn.camelCase=Va,Hn.capitalize=Ba,Hn.ceil=yu,Hn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=ma(n))==n?n:0),t!==i&&(t=(t=ma(t))==t?t:0),ur(ma(e),t,n)},Hn.clone=function(e){return cr(e,4)},Hn.cloneDeep=function(e){return cr(e,5)},Hn.cloneDeepWith=function(e,t){return cr(e,5,t="function"==typeof t?t:i)},Hn.cloneWith=function(e,t){return cr(e,4,t="function"==typeof t?t:i)},Hn.conformsTo=function(e,t){return null==t||lr(e,t,Ma(t))},Hn.deburr=za,Hn.defaultTo=function(e,t){return null==e||e!=e?t:e},Hn.divide=bu,Hn.endsWith=function(e,t,n){e=ya(e),t=li(t);var r=e.length,o=n=n===i?r:ur(_a(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Hn.eq=Hs,Hn.escape=function(e){return(e=ya(e))&&$.test(e)?e.replace(Z,sn):e},Hn.escapeRegExp=function(e){return(e=ya(e))&&oe.test(e)?e.replace(ie,"\\$&"):e},Hn.every=function(e,t,n){var r=Gs(e)?Ot:_r;return n&&Eo(e,t,n)&&(t=i),r(e,co(t,3))},Hn.find=ms,Hn.findIndex=zo,Hn.findKey=function(e,t){return Ht(e,co(t,3),Er)},Hn.findLast=gs,Hn.findLastIndex=Go,Hn.findLastKey=function(e,t){return Ht(e,co(t,3),wr)},Hn.floor=Eu,Hn.forEach=ys,Hn.forEachRight=bs,Hn.forIn=function(e,t){return null==e?e:yr(e,co(t,3),Ra)},Hn.forInRight=function(e,t){return null==e?e:br(e,co(t,3),Ra)},Hn.forOwn=function(e,t){return e&&Er(e,co(t,3))},Hn.forOwnRight=function(e,t){return e&&wr(e,co(t,3))},Hn.get=Ia,Hn.gt=Vs,Hn.gte=Bs,Hn.has=function(e,t){return null!=e&&mo(e,t,Nr)},Hn.hasIn=Na,Hn.head=Ko,Hn.identity=iu,Hn.includes=function(e,t,n,r){e=Ks(e)?e:Ha(e),n=n&&!r?_a(n):0;var i=e.length;return n<0&&(n=yn(i+n,0)),ua(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Bt(e,t,n)>-1},Hn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:_a(n);return i<0&&(i=yn(r+i,0)),Bt(e,t,i)},Hn.inRange=function(e,t,n){return t=pa(t),n===i?(n=t,t=0):n=pa(n),function(e,t,n){return e>=bn(t,n)&&e<yn(t,n)}(e=ma(e),t,n)},Hn.invoke=Oa,Hn.isArguments=zs,Hn.isArray=Gs,Hn.isArrayBuffer=Ws,Hn.isArrayLike=Ks,Hn.isArrayLikeObject=Qs,Hn.isBoolean=function(e){return!0===e||!1===e||na(e)&&Sr(e)==b},Hn.isBuffer=Zs,Hn.isDate=Ys,Hn.isElement=function(e){return na(e)&&1===e.nodeType&&!oa(e)},Hn.isEmpty=function(e){if(null==e)return!0;if(Ks(e)&&(Gs(e)||"string"==typeof e||"function"==typeof e.splice||Zs(e)||la(e)||zs(e)))return!e.length;var t=vo(e);if(t==A||t==x)return!e.size;if(Ao(e))return!Pr(e).length;for(var n in e)if(Le.call(e,n))return!1;return!0},Hn.isEqual=function(e,t){return Rr(e,t)},Hn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Rr(e,t,i,n):!!r},Hn.isError=$s,Hn.isFinite=function(e){return"number"==typeof e&&bt(e)},Hn.isFunction=Xs,Hn.isInteger=Js,Hn.isLength=ea,Hn.isMap=ra,Hn.isMatch=function(e,t){return e===t||Dr(e,t,ho(t))},Hn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Dr(e,t,ho(t),n)},Hn.isNaN=function(e){return ia(e)&&e!=+e},Hn.isNative=function(e){if(To(e))throw new Te("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ur(e)},Hn.isNil=function(e){return null==e},Hn.isNull=function(e){return null===e},Hn.isNumber=ia,Hn.isObject=ta,Hn.isObjectLike=na,Hn.isPlainObject=oa,Hn.isRegExp=sa,Hn.isSafeInteger=function(e){return Js(e)&&e>=-9007199254740991&&e<=p},Hn.isSet=aa,Hn.isString=ua,Hn.isSymbol=ca,Hn.isTypedArray=la,Hn.isUndefined=function(e){return e===i},Hn.isWeakMap=function(e){return na(e)&&vo(e)==R},Hn.isWeakSet=function(e){return na(e)&&"[object WeakSet]"==Sr(e)},Hn.join=function(e,t){return null==e?"":qt.call(e,t)},Hn.kebabCase=Ga,Hn.last=$o,Hn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=_a(n))<0?yn(r+o,0):bn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Vt(e,Gt,o,!0)},Hn.lowerCase=Wa,Hn.lowerFirst=Ka,Hn.lt=da,Hn.lte=ha,Hn.max=function(e){return e&&e.length?vr(e,iu,Ir):i},Hn.maxBy=function(e,t){return e&&e.length?vr(e,co(t,2),Ir):i},Hn.mean=function(e){return Wt(e,iu)},Hn.meanBy=function(e,t){return Wt(e,co(t,2))},Hn.min=function(e){return e&&e.length?vr(e,iu,jr):i},Hn.minBy=function(e,t){return e&&e.length?vr(e,co(t,2),jr):i},Hn.stubArray=vu,Hn.stubFalse=mu,Hn.stubObject=function(){return{}},Hn.stubString=function(){return""},Hn.stubTrue=function(){return!0},Hn.multiply=Cu,Hn.nth=function(e,t){return e&&e.length?zr(e,_a(t)):i},Hn.noConflict=function(){return _t._===this&&(_t._=He),this},Hn.noop=cu,Hn.now=Is,Hn.pad=function(e,t,n){e=ya(e);var r=(t=_a(t))?pn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Gi(vt(i),n)+e+Gi(pt(i),n)},Hn.padEnd=function(e,t,n){e=ya(e);var r=(t=_a(t))?pn(e):0;return t&&r<t?e+Gi(t-r,n):e},Hn.padStart=function(e,t,n){e=ya(e);var r=(t=_a(t))?pn(e):0;return t&&r<t?Gi(t-r,n)+e:e},Hn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),wn(ya(e).replace(se,""),t||0)},Hn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&Eo(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=pa(e),t===i?(t=e,e=0):t=pa(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=Cn();return bn(e+o*(t-e+dt("1e-"+((o+"").length-1))),t)}return Zr(e,t)},Hn.reduce=function(e,t,n){var r=Gs(e)?Pt:Zt,i=arguments.length<3;return r(e,co(t,4),n,i,fr)},Hn.reduceRight=function(e,t,n){var r=Gs(e)?Ft:Zt,i=arguments.length<3;return r(e,co(t,4),n,i,pr)},Hn.repeat=function(e,t,n){return t=(n?Eo(e,t,n):t===i)?1:_a(t),Yr(ya(e),t)},Hn.replace=function(){var e=arguments,t=ya(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Hn.result=function(e,t,n){var r=-1,o=(t=bi(t,e)).length;for(o||(o=1,e=i);++r<o;){var s=null==e?i:e[Fo(t[r])];s===i&&(r=o,s=n),e=Xs(s)?s.call(e):s}return e},Hn.round=Tu,Hn.runInContext=e,Hn.sample=function(e){return(Gs(e)?Xn:Xr)(e)},Hn.size=function(e){if(null==e)return 0;if(Ks(e))return ua(e)?pn(e):e.length;var t=vo(e);return t==A||t==x?e.size:Pr(e).length},Hn.snakeCase=Qa,Hn.some=function(e,t,n){var r=Gs(e)?jt:oi;return n&&Eo(e,t,n)&&(t=i),r(e,co(t,3))},Hn.sortedIndex=function(e,t){return si(e,t)},Hn.sortedIndexBy=function(e,t,n){return ai(e,t,co(n,2))},Hn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=si(e,t);if(r<n&&Hs(e[r],t))return r}return-1},Hn.sortedLastIndex=function(e,t){return si(e,t,!0)},Hn.sortedLastIndexBy=function(e,t,n){return ai(e,t,co(n,2),!0)},Hn.sortedLastIndexOf=function(e,t){if(null==e?0:e.length){var n=si(e,t,!0)-1;if(Hs(e[n],t))return n}return-1},Hn.startCase=Za,Hn.startsWith=function(e,t,n){return e=ya(e),n=null==n?0:ur(_a(n),0,e.length),t=li(t),e.slice(n,n+t.length)==t},Hn.subtract=Au,Hn.sum=function(e){return e&&e.length?Yt(e,iu):0},Hn.sumBy=function(e,t){return e&&e.length?Yt(e,co(t,2)):0},Hn.template=function(e,t,n){var r=Hn.templateSettings;n&&Eo(e,t,n)&&(t=i),e=ya(e),t=wa({},t,r,Ji);var o,s,a=wa({},t.imports,r.imports,Ji),u=Ma(a),c=en(a,u),l=0,d=t.interpolate||we,h="__p += '",f=Ne((t.escape||we).source+"|"+d.source+"|"+(d===ee?pe:we).source+"|"+(t.evaluate||we).source+"|$","g"),p="//# sourceURL="+(Le.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++at+"]")+"\n";e.replace(f,(function(t,n,r,i,a,u){return r||(r=i),h+=e.slice(l,u).replace(Ce,an),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),a&&(s=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+t.length,t})),h+="';\n";var _=Le.call(t,"variable")&&t.variable;if(_){if(he.test(_))throw new Te("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(s?h.replace(G,""):h).replace(W,"$1").replace(K,"$1;"),h="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var v=Ja((function(){return Ae(u,p+"return "+h).apply(i,c)}));if(v.source=h,$s(v))throw v;return v},Hn.times=function(e,t){if((e=_a(e))<1||e>p)return[];var n=v,r=bn(e,v);t=co(t),e-=v;for(var i=$t(r,t);++n<e;)t(n);return i},Hn.toFinite=pa,Hn.toInteger=_a,Hn.toLength=va,Hn.toLower=function(e){return ya(e).toLowerCase()},Hn.toNumber=ma,Hn.toSafeInteger=function(e){return e?ur(_a(e),-9007199254740991,p):0===e?e:0},Hn.toString=ya,Hn.toUpper=function(e){return ya(e).toUpperCase()},Hn.trim=function(e,t,n){if((e=ya(e))&&(n||t===i))return Xt(e);if(!e||!(t=li(t)))return e;var r=_n(e),o=_n(t);return wi(r,nn(r,o),rn(r,o)+1).join("")},Hn.trimEnd=function(e,t,n){if((e=ya(e))&&(n||t===i))return e.slice(0,vn(e)+1);if(!e||!(t=li(t)))return e;var r=_n(e);return wi(r,0,rn(r,_n(t))+1).join("")},Hn.trimStart=function(e,t,n){if((e=ya(e))&&(n||t===i))return e.replace(se,"");if(!e||!(t=li(t)))return e;var r=_n(e);return wi(r,nn(r,_n(t))).join("")},Hn.truncate=function(e,t){var n=30,r="...";if(ta(t)){var o="separator"in t?t.separator:o;n="length"in t?_a(t.length):n,r="omission"in t?li(t.omission):r}var s=(e=ya(e)).length;if(un(e)){var a=_n(e);s=a.length}if(n>=s)return e;var u=n-pn(r);if(u<1)return r;var c=a?wi(a,0,u).join(""):e.slice(0,u);if(o===i)return c+r;if(a&&(u+=c.length-u),sa(o)){if(e.slice(u).search(o)){var l,d=c;for(o.global||(o=Ne(o.source,ya(_e.exec(o))+"g")),o.lastIndex=0;l=o.exec(d);)var h=l.index;c=c.slice(0,h===i?u:h)}}else if(e.indexOf(li(o),u)!=u){var f=c.lastIndexOf(o);f>-1&&(c=c.slice(0,f))}return c+r},Hn.unescape=function(e){return(e=ya(e))&&Y.test(e)?e.replace(Q,mn):e},Hn.uniqueId=function(e){var t=++Pe;return ya(e)+t},Hn.upperCase=Ya,Hn.upperFirst=$a,Hn.each=ys,Hn.eachRight=bs,Hn.first=Ko,uu(Hn,(wu={},Er(Hn,(function(e,t){Le.call(Hn.prototype,t)||(wu[t]=e)})),wu),{chain:!1}),Hn.VERSION="4.17.21",kt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Hn[e].placeholder=Hn})),kt(["drop","take"],(function(e,t){Gn.prototype[e]=function(n){n=n===i?1:yn(_a(n),0);var r=this.__filtered__&&!t?new Gn(this):this.clone();return r.__filtered__?r.__takeCount__=bn(n,r.__takeCount__):r.__views__.push({size:bn(n,v),type:e+(r.__dir__<0?"Right":"")}),r},Gn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),kt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Gn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:co(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),kt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Gn.prototype[e]=function(){return this[n](1).value()[0]}})),kt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Gn.prototype[e]=function(){return this.__filtered__?new Gn(this):this[n](1)}})),Gn.prototype.compact=function(){return this.filter(iu)},Gn.prototype.find=function(e){return this.filter(e).head()},Gn.prototype.findLast=function(e){return this.reverse().find(e)},Gn.prototype.invokeMap=$r((function(e,t){return"function"==typeof e?new Gn(this):this.map((function(n){return Or(n,e,t)}))})),Gn.prototype.reject=function(e){return this.filter(Ls(co(e)))},Gn.prototype.slice=function(e,t){e=_a(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Gn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=_a(t))<0?n.dropRight(-t):n.take(t-e)),n)},Gn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Gn.prototype.toArray=function(){return this.take(v)},Er(Gn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Hn[r?"take"+("last"==t?"Right":""):t],s=r||/^find/.test(t);o&&(Hn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,u=t instanceof Gn,c=a[0],l=u||Gs(t),d=function(e){var t=o.apply(Hn,Lt([e],a));return r&&h?t[0]:t};l&&n&&"function"==typeof c&&1!=c.length&&(u=l=!1);var h=this.__chain__,f=!!this.__actions__.length,p=s&&!h,_=u&&!f;if(!s&&l){t=_?t:new Gn(this);var v=e.apply(t,a);return v.__actions__.push({func:ps,args:[d],thisArg:i}),new zn(v,h)}return p&&_?e.apply(this,a):(v=this.thru(d),p?r?v.value()[0]:v.value():v)})})),kt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Oe[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Hn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Gs(i)?i:[],e)}return this[n]((function(n){return t.apply(Gs(n)?n:[],e)}))}})),Er(Gn.prototype,(function(e,t){var n=Hn[t];if(n){var r=n.name+"";Le.call(Mn,r)||(Mn[r]=[]),Mn[r].push({name:t,func:n})}})),Mn[Hi(i,2).name]=[{name:"wrapper",func:i}],Gn.prototype.clone=function(){var e=new Gn(this.__wrapped__);return e.__actions__=xi(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=xi(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=xi(this.__views__),e},Gn.prototype.reverse=function(){if(this.__filtered__){var e=new Gn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Gn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Gs(e),r=t<0,i=n?e.length:0,o=function(e,t,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=bn(t,e+s);break;case"takeRight":e=yn(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,u=a-s,c=r?a:s-1,l=this.__iteratees__,d=l.length,h=0,f=bn(u,this.__takeCount__);if(!n||!r&&i==u&&f==u)return _i(e,this.__actions__);var p=[];e:for(;u--&&h<f;){for(var _=-1,v=e[c+=t];++_<d;){var m=l[_],g=m.iteratee,y=m.type,b=g(v);if(2==y)v=b;else if(!b){if(1==y)continue e;break e}}p[h++]=v}return p},Hn.prototype.at=_s,Hn.prototype.chain=function(){return fs(this)},Hn.prototype.commit=function(){return new zn(this.value(),this.__chain__)},Hn.prototype.next=function(){this.__values__===i&&(this.__values__=fa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Hn.prototype.plant=function(e){for(var t,n=this;n instanceof Bn;){var r=qo(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Hn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Gn){var t=e;return this.__actions__.length&&(t=new Gn(this)),(t=t.reverse()).__actions__.push({func:ps,args:[ts],thisArg:i}),new zn(t,this.__chain__)}return this.thru(ts)},Hn.prototype.toJSON=Hn.prototype.valueOf=Hn.prototype.value=function(){return _i(this.__wrapped__,this.__actions__)},Hn.prototype.first=Hn.prototype.head,Xe&&(Hn.prototype[Xe]=function(){return this}),Hn}();_t._=gn,(r=function(){return gn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},9011:function(e,t,n){var r=n(8250);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},9071:function(e){e.exports=function(){}},3326:function(e,t,n){var r=n(5111),i=n(9334),o=n(1586),s=n(3526),a=n(9032),u=n(9259),c=n(1439),l=n(3650),d=c((function(e,t){var n={};if(null==e)return n;var c=!1;t=r(t,(function(t){return t=s(t,e),c||(c=t.length>1),t})),a(e,l(e),n),c&&(n=i(n,7,u));for(var d=t.length;d--;)o(n,t[d]);return n}));e.exports=d},6735:function(e,t,n){var r=n(5111),i=n(3334),o=n(5031),s=n(3650);e.exports=function(e,t){if(null==e)return{};var n=r(s(e),(function(e){return[e]}));return t=i(t),o(e,n,(function(e,n){return t(e,n[0])}))}},3282:function(e,t,n){var r=n(2762),i=n(8880),o=n(5187),s=n(6040);e.exports=function(e){return o(e)?r(s(e)):i(e)}},5479:function(e,t,n){var r=n(3640),i=n(5485),o=r((function(e,t,n){return e+(n?" ":"")+i(t)}));e.exports=o},2162:function(e,t,n){var r=n(4436),i=n(2291),o=n(7642),s=n(5243);e.exports=function(e,t,n){return e=s(e),n=null==n?0:r(o(n),0,e.length),t=i(t),e.slice(n,n+t.length)==t}},9306:function(e){e.exports=function(){return[]}},4772:function(e){e.exports=function(){return!1}},3301:function(e,t,n){var r=n(6131),i=1/0;e.exports=function(e){return e?(e=r(e))===i||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},7642:function(e,t,n){var r=n(3301);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},6131:function(e,t,n){var r=n(6403),i=n(1580),o=n(1187),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=a.test(e);return n||u.test(e)?c(e.slice(2),n?2:8):s.test(e)?NaN:+e}},5243:function(e,t,n){var r=n(2291);e.exports=function(e){return null==e?"":r(e)}},2438:function(e,t,n){var r=n(5630);e.exports=function(e){return e&&e.length?r(e):[]}},8285:function(e,t,n){var r=n(5243),i=0;e.exports=function(e){var t=++i;return r(e)+t}},5485:function(e,t,n){var r=n(4326)("toUpperCase");e.exports=r},9850:function(e,t,n){var r=n(9546),i=n(5813),o=n(5243),s=n(482);e.exports=function(e,t,n){return e=o(e),void 0===(t=n?void 0:t)?i(e)?s(e):r(e):e.match(t)||[]}},3321:function(e,t,n){var r=n(7553),i=n(528),o=n(5962),s=n(3142),a=n(547),u=n(3410),c=Object.prototype.hasOwnProperty;function l(e){if(a(e)&&!s(e)&&!(e instanceof r)){if(e instanceof i)return e;if(c.call(e,"__wrapped__"))return u(e)}return new i(e)}l.prototype=o.prototype,l.prototype.constructor=l,e.exports=l},8382:function(e,t,n){e.exports=n(176)},176:function(e,t){var n,r={asArray:function(e){var t=this.getBreakPoints(e),n=this.getCustomQueries(e);return this._translate(this._makeSteps(this._toSortedArray(t))).concat(this._objToArr(n))},asObject:function(e){return this._arrToObj(this.asArray(e))},getBreakPoints:function(e){return Object.keys(e).reduce((function(t,n){return"number"==typeof e[n]&&(t[n]=e[n]),t}),{})},getCustomQueries:function(e){return Object.keys(e).reduce((function(t,n){return"string"==typeof e[n]&&(t[n]=e[n]),t}),{})},_toSortedArray:function(e){return Object.keys(e).map((function(t){return[t,e[t]]})).sort((function(e,t){return e[1]-t[1]}))},_makeSteps:function(e){return e[e.length-1][1]===1/0?e:e.concat([1/0])},_translate:function(e){return e.map((function(t,n){return 0===n?[t[0],"screen and (max-width: "+t[1]+"px)"]:n===e.length-1?[t[0]||"default","screen and (min-width: "+(e[n-1][1]+1)+"px)"]:[t[0],"screen and (min-width: "+(e[n-1][1]+1)+"px) and (max-width: "+t[1]+"px)"]}))},_objToArr:function(e){return Object.keys(e).map((function(t){return[t,e[t]]}))},_arrToObj:function(e){return e.reduce((function(e,t){return e[t[0]]=t[1],e}),{})}};void 0!==e.exports?e.exports=r:void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)},6999:function(e,t,n){var r=n(6848);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},9067:function(e,t,n){e.exports=n(6999)()},6848:function(e){e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},5873:function(e,t,n){var r=n(5206);t.H=r.createRoot,r.hydrateRoot},3363:function(e,t,n){var r=n(1594),i=n.n(r),o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o(e,t)};var s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};var a="Pixel",u="Percent",c={unit:u,value:.8};function l(e){return"number"==typeof e?{unit:u,value:100*e}:"string"==typeof e?e.match(/^(\d*(\.\d+)?)px$/)?{unit:a,value:parseFloat(e)}:e.match(/^(\d*(\.\d+)?)%$/)?{unit:u,value:parseFloat(e)}:(console.warn('scrollThreshold format is invalid. Valid formats: "120px", "50%"...'),c):(console.warn("scrollThreshold should be string or number"),c)}var d=function(e){function t(t){var n=e.call(this,t)||this;return n.lastScrollTop=0,n.actionTriggered=!1,n.startY=0,n.currentY=0,n.dragging=!1,n.maxPullDownDistance=0,n.getScrollableTarget=function(){return n.props.scrollableTarget instanceof HTMLElement?n.props.scrollableTarget:"string"==typeof n.props.scrollableTarget?document.getElementById(n.props.scrollableTarget):(null===n.props.scrollableTarget&&console.warn("You are trying to pass scrollableTarget but it is null. This might\n        happen because the element may not have been added to DOM yet.\n        See https://github.com/ankeetmaini/react-infinite-scroll-component/issues/59 for more info.\n      "),null)},n.onStart=function(e){n.lastScrollTop||(n.dragging=!0,e instanceof MouseEvent?n.startY=e.pageY:e instanceof TouchEvent&&(n.startY=e.touches[0].pageY),n.currentY=n.startY,n._infScroll&&(n._infScroll.style.willChange="transform",n._infScroll.style.transition="transform 0.2s cubic-bezier(0,0,0.31,1)"))},n.onMove=function(e){n.dragging&&(e instanceof MouseEvent?n.currentY=e.pageY:e instanceof TouchEvent&&(n.currentY=e.touches[0].pageY),n.currentY<n.startY||(n.currentY-n.startY>=Number(n.props.pullDownToRefreshThreshold)&&n.setState({pullToRefreshThresholdBreached:!0}),n.currentY-n.startY>1.5*n.maxPullDownDistance||n._infScroll&&(n._infScroll.style.overflow="visible",n._infScroll.style.transform="translate3d(0px, "+(n.currentY-n.startY)+"px, 0px)")))},n.onEnd=function(){n.startY=0,n.currentY=0,n.dragging=!1,n.state.pullToRefreshThresholdBreached&&(n.props.refreshFunction&&n.props.refreshFunction(),n.setState({pullToRefreshThresholdBreached:!1})),requestAnimationFrame((function(){n._infScroll&&(n._infScroll.style.overflow="auto",n._infScroll.style.transform="none",n._infScroll.style.willChange="unset")}))},n.onScrollListener=function(e){"function"==typeof n.props.onScroll&&setTimeout((function(){return n.props.onScroll&&n.props.onScroll(e)}),0);var t=n.props.height||n._scrollableNode?e.target:document.documentElement.scrollTop?document.documentElement:document.body;n.actionTriggered||((n.props.inverse?n.isElementAtTop(t,n.props.scrollThreshold):n.isElementAtBottom(t,n.props.scrollThreshold))&&n.props.hasMore&&(n.actionTriggered=!0,n.setState({showLoader:!0}),n.props.next&&n.props.next()),n.lastScrollTop=t.scrollTop)},n.state={showLoader:!1,pullToRefreshThresholdBreached:!1,prevDataLength:t.dataLength},n.throttledOnScrollListener=function(e,t,n,r){var i,o=!1,s=0;function a(){i&&clearTimeout(i)}function u(){var u=this,c=Date.now()-s,l=arguments;function d(){s=Date.now(),n.apply(u,l)}o||(r&&!i&&d(),a(),void 0===r&&c>e?d():!0!==t&&(i=setTimeout(r?function(){i=void 0}:d,void 0===r?e-c:e)))}return"boolean"!=typeof t&&(r=n,n=t,t=void 0),u.cancel=function(){a(),o=!0},u}(150,n.onScrollListener).bind(n),n.onStart=n.onStart.bind(n),n.onMove=n.onMove.bind(n),n.onEnd=n.onEnd.bind(n),n}return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.componentDidMount=function(){if(void 0===this.props.dataLength)throw new Error('mandatory prop "dataLength" is missing. The prop is needed when loading more content. Check README.md for usage');if(this._scrollableNode=this.getScrollableTarget(),this.el=this.props.height?this._infScroll:this._scrollableNode||window,this.el&&this.el.addEventListener("scroll",this.throttledOnScrollListener),"number"==typeof this.props.initialScrollY&&this.el&&this.el instanceof HTMLElement&&this.el.scrollHeight>this.props.initialScrollY&&this.el.scrollTo(0,this.props.initialScrollY),this.props.pullDownToRefresh&&this.el&&(this.el.addEventListener("touchstart",this.onStart),this.el.addEventListener("touchmove",this.onMove),this.el.addEventListener("touchend",this.onEnd),this.el.addEventListener("mousedown",this.onStart),this.el.addEventListener("mousemove",this.onMove),this.el.addEventListener("mouseup",this.onEnd),this.maxPullDownDistance=this._pullDown&&this._pullDown.firstChild&&this._pullDown.firstChild.getBoundingClientRect().height||0,this.forceUpdate(),"function"!=typeof this.props.refreshFunction))throw new Error('Mandatory prop "refreshFunction" missing.\n          Pull Down To Refresh functionality will not work\n          as expected. Check README.md for usage\'')},t.prototype.componentWillUnmount=function(){this.el&&(this.el.removeEventListener("scroll",this.throttledOnScrollListener),this.props.pullDownToRefresh&&(this.el.removeEventListener("touchstart",this.onStart),this.el.removeEventListener("touchmove",this.onMove),this.el.removeEventListener("touchend",this.onEnd),this.el.removeEventListener("mousedown",this.onStart),this.el.removeEventListener("mousemove",this.onMove),this.el.removeEventListener("mouseup",this.onEnd)))},t.prototype.componentDidUpdate=function(e){this.props.dataLength!==e.dataLength&&(this.actionTriggered=!1,this.setState({showLoader:!1}))},t.getDerivedStateFromProps=function(e,t){return e.dataLength!==t.prevDataLength?s(s({},t),{prevDataLength:e.dataLength}):null},t.prototype.isElementAtTop=function(e,t){void 0===t&&(t=.8);var n=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,r=l(t);return r.unit===a?e.scrollTop<=r.value+n-e.scrollHeight+1:e.scrollTop<=r.value/100+n-e.scrollHeight+1},t.prototype.isElementAtBottom=function(e,t){void 0===t&&(t=.8);var n=e===document.body||e===document.documentElement?window.screen.availHeight:e.clientHeight,r=l(t);return r.unit===a?e.scrollTop+n>=e.scrollHeight-r.value:e.scrollTop+n>=r.value/100*e.scrollHeight},t.prototype.render=function(){var e=this,t=s({height:this.props.height||"auto",overflow:"auto",WebkitOverflowScrolling:"touch"},this.props.style),n=this.props.hasChildren||!!(this.props.children&&this.props.children instanceof Array&&this.props.children.length),r=this.props.pullDownToRefresh&&this.props.height?{overflow:"auto"}:{};return i().createElement("div",{style:r,className:"infinite-scroll-component__outerdiv"},i().createElement("div",{className:"infinite-scroll-component "+(this.props.className||""),ref:function(t){return e._infScroll=t},style:t},this.props.pullDownToRefresh&&i().createElement("div",{style:{position:"relative"},ref:function(t){return e._pullDown=t}},i().createElement("div",{style:{position:"absolute",left:0,right:0,top:-1*this.maxPullDownDistance}},this.state.pullToRefreshThresholdBreached?this.props.releaseToRefreshContent:this.props.pullDownToRefreshContent)),this.props.children,!this.state.showLoader&&!n&&this.props.hasMore&&this.props.loader,this.state.showLoader&&this.props.hasMore&&this.props.loader,!this.props.hasMore&&this.props.endMessage))},t}(r.Component);t.A=d},320:function(e,t){var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,_=n?Symbol.for("react.memo"):60115,v=n?Symbol.for("react.lazy"):60116,m=n?Symbol.for("react.block"):60121,g=n?Symbol.for("react.fundamental"):60117,y=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function E(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case d:case o:case a:case s:case f:return e;default:switch(e=e&&e.$$typeof){case c:case h:case v:case _:case u:return e;default:return t}}case i:return t}}}function w(e){return E(e)===d}t.AsyncMode=l,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=u,t.Element=r,t.ForwardRef=h,t.Fragment=o,t.Lazy=v,t.Memo=_,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return w(e)||E(e)===l},t.isConcurrentMode=w,t.isContextConsumer=function(e){return E(e)===c},t.isContextProvider=function(e){return E(e)===u},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return E(e)===h},t.isFragment=function(e){return E(e)===o},t.isLazy=function(e){return E(e)===v},t.isMemo=function(e){return E(e)===_},t.isPortal=function(e){return E(e)===i},t.isProfiler=function(e){return E(e)===a},t.isStrictMode=function(e){return E(e)===s},t.isSuspense=function(e){return E(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===d||e===a||e===s||e===f||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===_||e.$$typeof===u||e.$$typeof===c||e.$$typeof===h||e.$$typeof===g||e.$$typeof===y||e.$$typeof===b||e.$$typeof===m)},t.typeOf=E},524:function(e,t,n){e.exports=n(320)},3705:function(e,t,n){n.d(t,{Kq:function(){return d},wA:function(){return v},d4:function(){return b}});var r=n(1594),i=n.n(r),o=i().createContext(null);var s=function(e){e()},a=function(){return s};var u={notify:function(){},get:function(){return[]}};function c(e,t){var n,r=u;function i(){s.onStateChange&&s.onStateChange()}function o(){n||(n=t?t.addNestedSub(i):e.subscribe(i),r=function(){var e=a(),t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,i=n={callback:e,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){r&&null!==t&&(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}())}var s={addNestedSub:function(e){return o(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:i,isSubscribed:function(){return Boolean(n)},trySubscribe:o,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=u)},getListeners:function(){return r}};return s}var l="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect;var d=function(e){var t=e.store,n=e.context,s=e.children,a=(0,r.useMemo)((function(){var e=c(t);return{store:t,subscription:e}}),[t]),u=(0,r.useMemo)((function(){return t.getState()}),[t]);l((function(){var e=a.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),u!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[a,u]);var d=n||o;return i().createElement(d.Provider,{value:a},s)};n(5985),n(1524);n(9575);function h(){return(0,r.useContext)(o)}function f(e){void 0===e&&(e=o);var t=e===o?h:function(){return(0,r.useContext)(e)};return function(){return t().store}}var p=f();function _(e){void 0===e&&(e=o);var t=e===o?p:f(e);return function(){return t().dispatch}}var v=_(),m=function(e,t){return e===t};function g(e){void 0===e&&(e=o);var t=e===o?h:function(){return(0,r.useContext)(e)};return function(e,n){void 0===n&&(n=m);var i=t(),o=function(e,t,n,i){var o,s=(0,r.useReducer)((function(e){return e+1}),0)[1],a=(0,r.useMemo)((function(){return c(n,i)}),[n,i]),u=(0,r.useRef)(),d=(0,r.useRef)(),h=(0,r.useRef)(),f=(0,r.useRef)(),p=n.getState();try{if(e!==d.current||p!==h.current||u.current){var _=e(p);o=void 0!==f.current&&t(_,f.current)?f.current:_}else o=f.current}catch(e){throw u.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+u.current.stack+"\n\n"),e}return l((function(){d.current=e,h.current=p,f.current=o,u.current=void 0})),l((function(){function e(){try{var e=n.getState();if(e===h.current)return;var r=d.current(e);if(t(r,f.current))return;f.current=r,h.current=e}catch(e){u.current=e}s()}return a.onStateChange=e,a.trySubscribe(),e(),function(){return a.tryUnsubscribe()}}),[n,a]),o}(e,n,i.store,i.subscription);return(0,r.useDebugValue)(o),o}}var y,b=g(),E=n(5206);y=E.unstable_batchedUpdates,s=y},4104:function(e,t){var n=60103,r=60106,i=60107,o=60108,s=60114,a=60109,u=60110,c=60112,l=60113,d=60120,h=60115,f=60116,p=60121,_=60122,v=60117,m=60129,g=60131;if("function"==typeof Symbol&&Symbol.for){var y=Symbol.for;n=y("react.element"),r=y("react.portal"),i=y("react.fragment"),o=y("react.strict_mode"),s=y("react.profiler"),a=y("react.provider"),u=y("react.context"),c=y("react.forward_ref"),l=y("react.suspense"),d=y("react.suspense_list"),h=y("react.memo"),f=y("react.lazy"),p=y("react.block"),_=y("react.server.block"),v=y("react.fundamental"),m=y("react.debug_trace_mode"),g=y("react.legacy_hidden")}function b(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case s:case o:case l:case d:return e;default:switch(e=e&&e.$$typeof){case u:case c:case f:case h:case a:return e;default:return t}}case r:return t}}}},1524:function(e,t,n){n(4104)},4721:function(e,t,n){function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{A:function(){return y}});var i=n(1594),o=i.useLayoutEffect,s=function(e,t){"function"!=typeof e?e.current=t:e(t)},a=function(e,t){var n=(0,i.useRef)();return(0,i.useCallback)((function(r){e.current=r,n.current&&s(n.current,null),n.current=t,t&&s(t,r)}),[t])},u={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},c=function(e){Object.keys(u).forEach((function(t){e.style.setProperty(t,u[t],"important")}))},l=null,d=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize};var h=function(){},f=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],p=!!document.documentElement.currentStyle,_=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,r=(n=t,f.reduce((function(e,t){return e[t]=n[t],e}),{})),i=r.boxSizing;return""===i?null:(p&&"border-box"===i&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px"),{sizingStyle:r,paddingSize:parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),borderSize:parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth)})};function v(e,t,n){var r,s,a=(r=n,s=i.useRef(r),o((function(){s.current=r})),s);i.useLayoutEffect((function(){var n=function(e){return a.current(e)};if(e)return e.addEventListener(t,n),function(){return e.removeEventListener(t,n)}}),[])}var m=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],g=function(e,t){var n=e.cacheMeasurements,o=e.maxRows,s=e.minRows,u=e.onChange,f=void 0===u?h:u,p=e.onHeightChange,g=void 0===p?h:p,y=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,m),b=void 0!==y.value,E=i.useRef(null),w=a(E,t),C=i.useRef(0),T=i.useRef(),A=function(){var e=E.current,t=n&&T.current?T.current:_(e);if(t){T.current=t;var r=function(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=1/0),l||((l=document.createElement("textarea")).setAttribute("tabindex","-1"),l.setAttribute("aria-hidden","true"),c(l)),null===l.parentNode&&document.body.appendChild(l);var i=e.paddingSize,o=e.borderSize,s=e.sizingStyle,a=s.boxSizing;Object.keys(s).forEach((function(e){var t=e;l.style[t]=s[t]})),c(l),l.value=t;var u=d(l,e);l.value=t,u=d(l,e),l.value="x";var h=l.scrollHeight-i,f=h*n;"border-box"===a&&(f=f+i+o),u=Math.max(f,u);var p=h*r;return"border-box"===a&&(p=p+i+o),[u=Math.min(p,u),h]}(t,e.value||e.placeholder||"x",s,o),i=r[0],a=r[1];C.current!==i&&(C.current=i,e.style.setProperty("height",i+"px","important"),g(i,{rowHeight:a}))}};return i.useLayoutEffect(A),v(window,"resize",A),function(e){v(document.fonts,"loadingdone",e)}(A),i.createElement("textarea",r({},y,{onChange:function(e){b||A(),f(e)},ref:w}))},y=i.forwardRef(g)},1348:function(e,t,n){n.d(t,{A:function(){return u}});var r=n(8958),i=n.n(r),o=n(9273),s=n(3907),a=function(e){return null===e};function u(e,t,n){void 0===t&&(t=s.A),i()((0,o.A)(t)||a(t),"Expected payloadCreator to be a function, undefined or null");var r=a(t)||t===s.A?s.A:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return e instanceof Error?e:t.apply(void 0,[e].concat(r))},u=(0,o.A)(n),c=e.toString(),l=function(){var t=r.apply(void 0,arguments),i={type:e};return t instanceof Error&&(i.error=!0),void 0!==t&&(i.payload=t),u&&(i.meta=n.apply(void 0,arguments)),i};return l.toString=function(){return c},l}},2324:function(e,t,n){n.d(t,{A:function(){return g}});var r=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="function"!=typeof t[t.length-1]&&t.pop(),i=t;if(void 0===r)throw new TypeError("The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.");return function(e,t){for(var n=arguments.length,o=Array(n>2?n-2:0),s=2;s<n;s++)o[s-2]=arguments[s];var a=void 0===e,u=void 0===t;return a&&u&&r?r:i.reduce((function(e,n){return n.apply(void 0,[e,t].concat(o))}),a&&!u&&r?r:e)}},i=n(8958),o=n.n(i),s=function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},a=function(e){return"undefined"!=typeof Map&&e instanceof Map};function u(e){if(a(e))return Array.from(e.keys());if("undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys)return Reflect.ownKeys(e);var t=Object.getOwnPropertyNames(e);return"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t}var c="||";function l(e,t){return a(t)?t.get(e):t[e]}var d,h=(d=function(e){return(s(e)||a(e))&&(t=u(e),n=t.every((function(e){return"next"===e||"throw"===e})),!(t.length&&t.length<=2&&n));var t,n},function e(t,n,r,i){var o=void 0===n?{}:n,s=o.namespace,a=void 0===s?"/":s,h=o.prefix;return void 0===r&&(r={}),void 0===i&&(i=""),u(t).forEach((function(n){var o=function(e){return i||!h||h&&new RegExp("^"+h+a).test(e)?e:""+h+a+e}(function(e){var t;if(!i)return e;var n=e.toString().split(c),r=i.split(c);return(t=[]).concat.apply(t,r.map((function(e){return n.map((function(t){return""+e+a+t}))}))).join(c)}(n)),s=l(n,t);d(s)?e(s,{namespace:a,prefix:h},r,o):r[o]=s})),r}),f=n(9273),p=n(3907),_=function(e){return null==e},v=function(e){return void 0===e},m=function(e){return e.toString()};function g(e,t,n){void 0===n&&(n={}),o()(s(e)||a(e),"Expected handlers to be a plain object.");var i=h(e,n),d=u(i).map((function(e){return function(e,t,n){void 0===t&&(t=p.A);var r=m(e).split(c);o()(!v(n),"defaultState for reducer handling "+r.join(", ")+" should be defined"),o()((0,f.A)(t)||s(t),"Expected reducer to be a function or object with next and throw reducers");var i=(0,f.A)(t)?[t,t]:[t.next,t.throw].map((function(e){return _(e)?p.A:e})),a=i[0],u=i[1];return function(e,t){void 0===e&&(e=n);var i=t.type;return i&&-1!==r.indexOf(m(i))?(!0===t.error?u:a)(e,t):e}}(e,l(e,i),t)})),g=r.apply(void 0,d.concat([t]));return function(e,n){return void 0===e&&(e=t),g(e,n)}}},3907:function(e,t){t.A=function(e){return e}},9273:function(e,t){t.A=function(e){return"function"==typeof e}},7783:function(e,t,n){!function(e){function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function i(e,t,n){i.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function o(e,t){o.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function s(e,t){s.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function a(e,t,n){a.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function u(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}function c(e){var t=void 0===e?"undefined":x(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function l(e,t,n,r,d,h,f){f=f||[];var p=(d=d||[]).slice(0);if(void 0!==h){if(r){if("function"==typeof r&&r(p,h))return;if("object"===(void 0===r?"undefined":x(r))){if(r.prefilter&&r.prefilter(p,h))return;if(r.normalize){var _=r.normalize(p,h,e,t);_&&(e=_[0],t=_[1])}}}p.push(h)}"regexp"===c(e)&&"regexp"===c(t)&&(e=e.toString(),t=t.toString());var v=void 0===e?"undefined":x(e),m=void 0===t?"undefined":x(t),g="undefined"!==v||f&&f[f.length-1].lhs&&f[f.length-1].lhs.hasOwnProperty(h),y="undefined"!==m||f&&f[f.length-1].rhs&&f[f.length-1].rhs.hasOwnProperty(h);if(!g&&y)n(new o(p,t));else if(!y&&g)n(new s(p,e));else if(c(e)!==c(t))n(new i(p,e,t));else if("date"===c(e)&&e-t!=0)n(new i(p,e,t));else if("object"===v&&null!==e&&null!==t)if(f.filter((function(t){return t.lhs===e})).length)e!==t&&n(new i(p,e,t));else{if(f.push({lhs:e,rhs:t}),Array.isArray(e)){var b;for(e.length,b=0;b<e.length;b++)b>=t.length?n(new a(p,b,new s(void 0,e[b]))):l(e[b],t[b],n,r,p,b,f);for(;b<t.length;)n(new a(p,b,new o(void 0,t[b++])))}else{var E=Object.keys(e),w=Object.keys(t);E.forEach((function(i,o){var s=w.indexOf(i);s>=0?(l(e[i],t[i],n,r,p,i,f),w=u(w,s)):l(e[i],void 0,n,r,p,i,f)})),w.forEach((function(e){l(void 0,t[e],n,r,p,e,f)}))}f.length=f.length-1}else e!==t&&("number"===v&&isNaN(e)&&isNaN(t)||n(new i(p,e,t)))}function d(e,t,n,r){return r=r||[],l(e,t,(function(e){e&&r.push(e)}),n),r.length?r:void 0}function h(e,t,n){if(n.path&&n.path.length){var r,i=e[t],o=n.path.length-1;for(r=0;r<o;r++)i=i[n.path[r]];switch(n.kind){case"A":h(i[n.path[r]],n.index,n.item);break;case"D":delete i[n.path[r]];break;case"E":case"N":i[n.path[r]]=n.rhs}}else switch(n.kind){case"A":h(e[t],n.index,n.item);break;case"D":e=u(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function f(e,t,n){if(e&&t&&n&&n.kind){for(var r=e,i=-1,o=n.path?n.path.length-1:0;++i<o;)void 0===r[n.path[i]]&&(r[n.path[i]]="number"==typeof n.path[i]?[]:{}),r=r[n.path[i]];switch(n.kind){case"A":h(n.path?r[n.path[i]]:r,n.index,n.item);break;case"D":delete r[n.path[i]];break;case"E":case"N":r[n.path[i]]=n.rhs}}}function p(e,t,n){if(n.path&&n.path.length){var r,i=e[t],o=n.path.length-1;for(r=0;r<o;r++)i=i[n.path[r]];switch(n.kind){case"A":p(i[n.path[r]],n.index,n.item);break;case"D":case"E":i[n.path[r]]=n.lhs;break;case"N":delete i[n.path[r]]}}else switch(n.kind){case"A":p(e[t],n.index,n.item);break;case"D":case"E":e[t]=n.lhs;break;case"N":e=u(e,t)}return e}function _(e,t,n){if(e&&t&&n&&n.kind){var r,i,o=e;for(i=n.path.length-1,r=0;r<i;r++)void 0===o[n.path[r]]&&(o[n.path[r]]={}),o=o[n.path[r]];switch(n.kind){case"A":p(o[n.path[r]],n.index,n.item);break;case"D":case"E":o[n.path[r]]=n.lhs;break;case"N":delete o[n.path[r]]}}}function v(e,t,n){e&&t&&l(e,t,(function(r){n&&!n(e,t,r)||f(e,t,r)}))}function m(e){return"color: "+R[e].color+"; font-weight: bold"}function g(e){var t=e.kind,n=e.path,r=e.lhs,i=e.rhs,o=e.index,s=e.item;switch(t){case"E":return[n.join("."),r,"",i];case"N":return[n.join("."),i];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+o+"]",s];default:return[]}}function y(e,t,n,r){var i=d(e,t);try{r?n.groupCollapsed("diff"):n.group("diff")}catch(e){n.log("diff")}i?i.forEach((function(e){var t=e.kind,r=g(e);n.log.apply(n,["%c "+R[t].text,m(t)].concat(O(r)))})):n.log(" no diff ");try{n.groupEnd()}catch(e){n.log(" diff end  ")}}function b(e,t,n,r){switch(void 0===e?"undefined":x(e)){case"object":return"function"==typeof e[r]?e[r].apply(e,O(n)):e[r];case"function":return e(t);default:return e}}function E(e){var t=e.timestamp,n=e.duration;return function(e,r,i){var o=["action"];return o.push("%c"+String(e.type)),t&&o.push("%c@ "+r),n&&o.push("%c(in "+i.toFixed(2)+" ms)"),o.join(" ")}}function w(e,t){var n=t.logger,r=t.actionTransformer,i=t.titleFormatter,o=void 0===i?E(t):i,s=t.collapsed,a=t.colors,u=t.level,c=t.diff,l=void 0===t.titleFormatter;e.forEach((function(i,d){var h=i.started,f=i.startedTime,p=i.action,_=i.prevState,v=i.error,m=i.took,g=i.nextState,E=e[d+1];E&&(g=E.prevState,m=E.started-h);var w=r(p),C="function"==typeof s?s((function(){return g}),p,i):s,T=N(f),A=a.title?"color: "+a.title(w)+";":"",S=["color: gray; font-weight: lighter;"];S.push(A),t.timestamp&&S.push("color: gray; font-weight: lighter;"),t.duration&&S.push("color: gray; font-weight: lighter;");var I=o(w,T,m);try{C?a.title&&l?n.groupCollapsed.apply(n,["%c "+I].concat(S)):n.groupCollapsed(I):a.title&&l?n.group.apply(n,["%c "+I].concat(S)):n.group(I)}catch(e){n.log(I)}var k=b(u,w,[_],"prevState"),x=b(u,w,[w],"action"),O=b(u,w,[v,_],"error"),M=b(u,w,[g],"nextState");if(k)if(a.prevState){var R="color: "+a.prevState(_)+"; font-weight: bold";n[k]("%c prev state",R,_)}else n[k]("prev state",_);if(x)if(a.action){var D="color: "+a.action(w)+"; font-weight: bold";n[x]("%c action    ",D,w)}else n[x]("action    ",w);if(v&&O)if(a.error){var U="color: "+a.error(v,_)+"; font-weight: bold;";n[O]("%c error     ",U,v)}else n[O]("error     ",v);if(M)if(a.nextState){var L="color: "+a.nextState(g)+"; font-weight: bold";n[M]("%c next state",L,g)}else n[M]("next state",g);c&&y(_,g,n,C);try{n.groupEnd()}catch(e){n.log(" log end ")}}))}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},D,e),n=t.logger,r=t.stateTransformer,i=t.errorTransformer,o=t.predicate,s=t.logErrors,a=t.diffPredicate;if(void 0===n)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var u=[];return function(e){var n=e.getState;return function(e){return function(c){if("function"==typeof o&&!o(n,c))return e(c);var l={};u.push(l),l.started=k.now(),l.startedTime=new Date,l.prevState=r(n()),l.action=c;var d=void 0;if(s)try{d=e(c)}catch(e){l.error=i(e)}else d=e(c);l.took=k.now()-l.started,l.nextState=r(n());var h=t.diff&&"function"==typeof a?a(n,c):t.diff;if(w(u,Object.assign({},t,{diff:h})),u.length=0,l.error)throw l.error;return d}}}}var T,A,S=function(e,t){return new Array(t+1).join(e)},I=function(e,t){return S("0",t-e.toString().length)+e},N=function(e){return I(e.getHours(),2)+":"+I(e.getMinutes(),2)+":"+I(e.getSeconds(),2)+"."+I(e.getMilliseconds(),3)},k="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},M=[];T="object"===(void 0===n.g?"undefined":x(n.g))&&n.g?n.g:"undefined"!=typeof window?window:{},(A=T.DeepDiff)&&M.push((function(){void 0!==A&&T.DeepDiff===d&&(T.DeepDiff=A,A=void 0)})),t(i,r),t(o,r),t(s,r),t(a,r),Object.defineProperties(d,{diff:{value:d,enumerable:!0},observableDiff:{value:l,enumerable:!0},applyDiff:{value:v,enumerable:!0},applyChange:{value:f,enumerable:!0},revertChange:{value:_,enumerable:!0},isConflict:{value:function(){return void 0!==A},enumerable:!0},noConflict:{value:function(){return M&&(M.forEach((function(e){e()})),M=null),d},enumerable:!0}});var R={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},D={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,n=e.getState;return"function"==typeof t||"function"==typeof n?C()({dispatch:t,getState:n}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};e.defaults=D,e.createLogger=C,e.logger=U,e.default=U,Object.defineProperty(e,"__esModule",{value:!0})}(t)},1249:function(e,t,n){n.d(t,{r2:function(){return o},d:function(){return m},rL:function(){return A},GM:function(){return R}});var r="persist:",i="persist/FLUSH",o="persist/REHYDRATE",s="persist/PAUSE",a="persist/PERSIST",u="persist/PURGE",c="persist/REGISTER",l=-1;function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t,n,r){r.debug;var i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(n,!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);return e&&"object"===d(e)&&Object.keys(e).forEach((function(r){"_persist"!==r&&t[r]===n[r]&&(i[r]=e[r])})),i}function _(e){var t,n=e.blacklist||null,i=e.whitelist||null,o=e.transforms||[],s=e.throttle||0,a="".concat(void 0!==e.keyPrefix?e.keyPrefix:r).concat(e.key),u=e.storage;t=!1===e.serialize?function(e){return e}:"function"==typeof e.serialize?e.serialize:v;var c=e.writeFailHandler||null,l={},d={},h=[],f=null,p=null;function _(){if(0===h.length)return f&&clearInterval(f),void(f=null);var e=h.shift(),n=o.reduce((function(t,n){return n.in(t,e,l)}),l[e]);if(void 0!==n)try{d[e]=t(n)}catch(e){console.error("redux-persist/createPersistoid: error serializing state",e)}else delete d[e];0===h.length&&(Object.keys(d).forEach((function(e){void 0===l[e]&&delete d[e]})),p=u.setItem(a,t(d)).catch(g))}function m(e){return(!i||-1!==i.indexOf(e)||"_persist"===e)&&(!n||-1===n.indexOf(e))}function g(e){c&&c(e)}return{update:function(e){Object.keys(e).forEach((function(t){m(t)&&l[t]!==e[t]&&-1===h.indexOf(t)&&h.push(t)})),Object.keys(l).forEach((function(t){void 0===e[t]&&m(t)&&-1===h.indexOf(t)&&void 0!==l[t]&&h.push(t)})),null===f&&(f=setInterval(_,s)),l=e},flush:function(){for(;0!==h.length;)_();return p||Promise.resolve()}}}function v(e){return JSON.stringify(e)}function m(e){var t,n=e.transforms||[],i="".concat(void 0!==e.keyPrefix?e.keyPrefix:r).concat(e.key),o=e.storage;e.debug;return t=!1===e.deserialize?function(e){return e}:"function"==typeof e.deserialize?e.deserialize:g,o.getItem(i).then((function(e){if(e)try{var r={},i=t(e);return Object.keys(i).forEach((function(e){r[e]=n.reduceRight((function(t,n){return n.out(t,e,i)}),t(i[e]))})),r}catch(e){throw e}}))}function g(e){return JSON.parse(e)}function y(e){0}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(n,!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var T=5e3;function A(e,t){var n=void 0!==e.version?e.version:l,c=(e.debug,void 0===e.stateReconciler?p:e.stateReconciler),d=e.getStoredState||m,h=void 0!==e.timeout?e.timeout:T,f=null,v=!1,g=!0,b=function(e){return e._persist.rehydrated&&f&&!g&&f.update(e),e};return function(l,p){var m=l||{},w=m._persist,T=C(m,["_persist"]);if(p.type===a){var A=!1,S=function(t,n){A||(p.rehydrate(e.key,t,n),A=!0)};if(h&&setTimeout((function(){!A&&S(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(e.key,'"')))}),h),g=!1,f||(f=_(e)),w)return E({},t(T,p),{_persist:w});if("function"!=typeof p.rehydrate||"function"!=typeof p.register)throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return p.register(e.key),d(e).then((function(t){(e.migrate||function(e,t){return Promise.resolve(e)})(t,n).then((function(e){S(e)}),(function(e){S(void 0,e)}))}),(function(e){S(void 0,e)})),E({},t(T,p),{_persist:{version:n,rehydrated:!1}})}if(p.type===u)return v=!0,p.result(function(e){var t=e.storage,n="".concat(void 0!==e.keyPrefix?e.keyPrefix:r).concat(e.key);return t.removeItem(n,y)}(e)),E({},t(T,p),{_persist:w});if(p.type===i)return p.result(f&&f.flush()),E({},t(T,p),{_persist:w});if(p.type===s)g=!0;else if(p.type===o){if(v)return E({},T,{_persist:E({},w,{rehydrated:!0})});if(p.key===e.key){var I=t(T,p),N=p.payload,k=E({},!1!==c&&void 0!==N?c(N,l,I,e):I,{_persist:E({},w,{rehydrated:!0})});return b(k)}}if(!w)return t(l,p);var x=t(T,p);return x===T?l:b(E({},x,{_persist:w}))}}var S=n(5930);function I(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(n,!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O={registry:[],bootstrapped:!1},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c:return k({},e,{registry:[].concat(I(e.registry),[t.key])});case o:var n=e.registry.indexOf(t.key),r=I(e.registry);return r.splice(n,1),k({},e,{registry:r,bootstrapped:0===r.length});default:return e}};function R(e,t,n){var r=n||!1,l=(0,S.y$)(M,O,t&&t.enhancer?t.enhancer:void 0),d=function(e){l.dispatch({type:c,key:e})},h=function(t,n,i){var s={type:o,payload:n,err:i,key:t};e.dispatch(s),l.dispatch(s),r&&f.getState().bootstrapped&&(r(),r=!1)},f=k({},l,{purge:function(){var t=[];return e.dispatch({type:u,result:function(e){t.push(e)}}),Promise.all(t)},flush:function(){var t=[];return e.dispatch({type:i,result:function(e){t.push(e)}}),Promise.all(t)},pause:function(){e.dispatch({type:s})},persist:function(){e.dispatch({type:a,register:d,rehydrate:h})}});return t&&t.manualPersist||f.persist(),f}},5424:function(e,t,n){n.d(t,{Q:function(){return l}});var r=n(1594);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){function t(){var e,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=new Array(r),u=0;u<r;u++)o[u]=arguments[u];return n=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?a(e):t}(this,(e=s(t)).call.apply(e,[this].concat(o))),c(a(n),"state",{bootstrapped:!1}),c(a(n),"_unsubscribe",void 0),c(a(n),"handlePersistorState",(function(){n.props.persistor.getState().bootstrapped&&(n.props.onBeforeLift?Promise.resolve(n.props.onBeforeLift()).finally((function(){return n.setState({bootstrapped:!0})})):n.setState({bootstrapped:!0}),n._unsubscribe&&n._unsubscribe())})),n}var n,r,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return"function"==typeof this.props.children?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}])&&o(n.prototype,r),l&&o(n,l),t}(r.PureComponent);c(l,"defaultProps",{children:null,loading:null})},6672:function(e,t,n){t.__esModule=!0,t.default=function(e){var t=(0,i.default)(e);return{getItem:function(e){return new Promise((function(n,r){n(t.getItem(e))}))},setItem:function(e,n){return new Promise((function(r,i){r(t.setItem(e,n))}))},removeItem:function(e){return new Promise((function(n,r){n(t.removeItem(e))}))}}};var r,i=(r=n(4178))&&r.__esModule?r:{default:r}},4178:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(){}t.__esModule=!0,t.default=function(e){var t="".concat(e,"Storage");return function(e){if("object"!==("undefined"==typeof self?"undefined":n(self))||!(e in self))return!1;try{var t=self[e],r="redux-persist ".concat(e," test");t.setItem(r,"test"),t.getItem(r),t.removeItem(r)}catch(e){return!1}return!0}(t)?self[t]:i};var i={getItem:r,setItem:r,removeItem:r}},2431:function(e,t,n){var r;t.A=void 0;var i=(0,((r=n(6672))&&r.__esModule?r:{default:r}).default)("local");t.A=i},7798:function(e,t,n){n.d(t,{KY:function(){return v},uG:function(){return g}});var r=n(8382),i=n.n(r),o="redux-responsive/CALCULATE_RESPONSIVE_STATE",s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a={extraSmall:480,small:768,medium:992,large:1200},u=function(e,t){var n={};return Object.keys(e).forEach((function(r){return t(n,e[r],r)})),n};function c(e,t){return u(t,(function(t,n,r){t[r]=r===e}))}function l(e,t){var n=t[e];return u(t,(function(e,r,i){e[i]="number"==typeof r&&n>t[i]}))}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function h(e,t){return"function"==typeof e.getIn?e.getIn(t):t.reduce((function(e,t){return e[t]}),e)}function f(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,r=[[]],i=function(){var i=r.shift();if(i.length>n)return"continue";var o,s=h(e,i);if(s){if(s[t])return{v:i};r.push.apply(r,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}((o=s,"function"==typeof o.keys?Array.from(o.keys()):Object.keys(o)).map((function(e){return i.concat(e)}))))}};r.length>0;){var o=i();if("continue"!==o&&"object"===(void 0===o?"undefined":d(o)))return o.v}return!1}var p=function(e){var t=e.getState(),n=f(t,"_responsiveState");if(!n)throw new Error("Could not find responsive state reducer. If you are still running into trouble, please open a ticket on github.");return h(t,n).breakpoints},_=function(e){var t=e.store,n=e.window,r=e.calculateInitialState,s=function(){return t.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.innerWidth,n=e.innerHeight,r=e.matchMedia;return{type:o,innerWidth:t,innerHeight:n,matchMedia:r}}(n))},a=i().asObject(p(t));Object.keys(a).forEach((function(e){n.matchMedia(a[e]).addListener((function(e){e.matches&&s()}))})),n.addEventListener("orientationchange",s),r&&s()},v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.initialMediaType,r=t.infinity,d=void 0===r?"infinity":r,h=t.extraFields,f=void 0===h?function(){return{}}:h;e||(e=a),e[d]=1/0;var p=i().asObject(e),_=function(e){var t=Object.keys(e).sort((function(t,n){var r=e[t],i=e[n];return"number"==typeof r&&"string"==typeof i?-1:"number"==typeof i&&"string"==typeof r||r>=i?1:-1}));return u(e,(function(e,n,r){var i=t.indexOf(r);-1!==i&&(e[r]=i)}))}(e);return function(t,r){var i,a,h,v=r.type,m=r.matchMedia;if(v===o||void 0===t){var g=!t&&n?n:function(e,t,n){return void 0===e?n:Object.keys(t).reduce((function(n,r){return e(t[r]).matches?r:n}),n)}(m,p,d),y=function(e){if(void 0===e)return null;var t={portrait:"(orientation: portrait)",landscape:"(orientation: landscape)"};return Object.keys(t).reduce((function(n,r){return e(t[r]).matches?r:n}),null)}(m),b={_responsiveState:!0,lessThan:(i=g,a=_,h=a[i],u(a,(function(e,t,n){"number"==typeof t&&a[n]?e[n]=h<a[n]:e[n]=!1}))),greaterThan:l(g,_),is:c(g,e),mediaType:g,orientation:y,breakpoints:e};return s({},b,f(b))}return t}},m=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).calculateInitialState,t=void 0===e||e;return function(e){return function(){var n=e.apply(void 0,arguments);return"undefined"!=typeof window&&void 0!==window.matchMedia&&_({store:n,window:window,calculateInitialState:t}),n}}},g=(v(),m())},1028:function(e,t,n){n.d(t,{Ay:function(){return $},Od:function(){return S}});var r=n(3068),i=n(9575);var o=n(4860),s=n(258);function a(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e}var u=a,c=[],l=0;function d(e){try{p(),e()}finally{_()}}function h(e){c.push(e),l||(p(),v())}function f(e){try{return p(),e()}finally{v()}}function p(){l++}function _(){l--}function v(){var e;for(_();!l&&void 0!==(e=c.shift());)d(e)}var m=function(e){return function(t){return e.some((function(e){return w(e)(t)}))}},g=function(e){return function(t){return e(t)}},y=function(e){return function(t){return t.type===String(e)}},b=function(e){return function(t){return t.type===e}},E=function(){return s.k};function w(e){var t="*"===e?E:(0,o.Yj)(e)?y:(0,o.YO)(e)?m:(0,o.mr)(e)?y:(0,o.Pc)(e)?g:(0,o.HR)(e)?b:null;if(null===t)throw new Error("invalid pattern: "+e);return t(e)}var C={type:r.x7},T=function(e){return e&&e.type===r.x7};function A(e){void 0===e&&(e=(0,s.e)());var t=!1,n=[];return{take:function(r){t&&e.isEmpty()?r(C):e.isEmpty()?(n.push(r),r.cancel=function(){(0,s.r)(n,r)}):r(e.take())},put:function(r){if(!t){if(0===n.length)return e.put(r);n.shift()(r)}},flush:function(n){t&&e.isEmpty()?n(C):n(e.flush())},close:function(){if(!t){t=!0;var e=n;n=[];for(var r=0,i=e.length;r<i;r++){(0,e[r])(C)}}}}}function S(e,t){void 0===t&&(t=(0,s.n)());var n,r=!1,i=A(t),a=function(){r||(r=!0,(0,o.Pc)(n)&&n(),i.close())};return n=e((function(e){T(e)?a():i.put(e)})),n=(0,s.o)(n),r&&n(),{take:i.take,flush:i.flush,close:a}}function I(){var e,t,n,i,o,a,u=(t=!1,i=n=[],o=function(){i===n&&(i=n.slice())},a=function(){t=!0;var e=n=i;i=[],e.forEach((function(e){e(C)}))},(e={})[r.Xl]=!0,e.put=function(e){if(!t)if(T(e))a();else for(var o=n=i,s=0,u=o.length;s<u;s++){var c=o[s];c[r.E_](e)&&(c.cancel(),c(e))}},e.take=function(e,n){void 0===n&&(n=E),t?e(C):(e[r.E_]=n,o(),i.push(e),e.cancel=(0,s.o)((function(){o(),(0,s.r)(i,e)})))},e.close=a,e),c=u.put;return u.put=function(e){e[r.q8]?c(e):h((function(){c(e)}))},u}var N=0,k=1,x=2,O=3;function M(e,t){var n=e[r.bO];(0,o.Pc)(n)&&(t.cancel=n),e.then(t,(function(e){t(e,!0)}))}var R,D=0,U=function(){return++D};function L(e){e.isRunning()&&e.cancel()}var P=((R={})[s.T]=function(e,t,n){var i=t.channel,s=void 0===i?e.channel:i,a=t.pattern,u=t.maybe,c=function(e){e instanceof Error?n(e,!0):!T(e)||u?n(e):n(r.a6)};try{s.take(c,(0,o.uQ)(a)?w(a):null)}catch(e){return void n(e,!0)}n.cancel=c.cancel},R[s.P]=function(e,t,n){var r=t.channel,i=t.action,s=t.resolve;h((function(){var t;try{t=(r?r.put:e.dispatch)(i)}catch(e){return void n(e,!0)}s&&(0,o.iv)(t)?M(t,n):n(t)}))},R[s.A]=function(e,t,n,r){var i=r.digestEffect,a=D,u=Object.keys(t);if(0!==u.length){var c=(0,s.l)(t,n);u.forEach((function(e){i(t[e],a,c[e],e)}))}else n((0,o.YO)(t)?[]:{})},R[s.R]=function(e,t,n,r){var i=r.digestEffect,a=D,u=Object.keys(t),c=(0,o.YO)(t)?(0,s.m)(u.length):{},l={},d=!1;u.forEach((function(e){var t=function(t,r){d||(r||(0,s.s)(t)?(n.cancel(),n(t,r)):(n.cancel(),d=!0,c[e]=t,n(c)))};t.cancel=s.t,l[e]=t})),n.cancel=function(){d||(d=!0,u.forEach((function(e){return l[e].cancel()})))},u.forEach((function(e){d||i(t[e],a,l[e],e)}))},R[s.C]=function(e,t,n,r){var i=t.context,a=t.fn,u=t.args,c=r.task;try{var l=a.apply(i,u);if((0,o.iv)(l))return void M(l,n);if((0,o.lJ)(l))return void Q(e,l,c.context,D,(0,s.j)(a),!1,n);n(l)}catch(e){n(e,!0)}},R[s.a]=function(e,t,n){var r=t.context,i=t.fn,s=t.args;try{var a=function(e,t){(0,o.vD)(e)?n(t):n(e,!0)};i.apply(r,s.concat(a)),a.cancel&&(n.cancel=a.cancel)}catch(e){n(e,!0)}},R[s.F]=function(e,t,n,r){var i=t.context,a=t.fn,u=t.args,c=t.detached,l=r.task,d=function(e){var t=e.context,n=e.fn,r=e.args;try{var i=n.apply(t,r);if((0,o.lJ)(i))return i;var a=!1;return(0,s.q)((function(e){return a?{value:e,done:!0}:(a=!0,{value:i,done:!(0,o.iv)(i)})}))}catch(e){return(0,s.q)((function(){throw e}))}}({context:i,fn:a,args:u}),h=function(e,t){return e.isSagaIterator?{name:e.meta.name}:(0,s.j)(t)}(d,a);f((function(){var t=Q(e,d,l.context,D,h,c,void 0);c?n(t):t.isRunning()?(l.queue.addTask(t),n(t)):t.isAborted()?l.queue.abort(t.error()):n(t)}))},R[s.J]=function(e,t,n,r){var i=r.task,a=function(e,t){if(e.isRunning()){var n={task:i,cb:t};t.cancel=function(){e.isRunning()&&(0,s.r)(e.joiners,n)},e.joiners.push(n)}else e.isAborted()?t(e.error(),!0):t(e.result())};if((0,o.YO)(t)){if(0===t.length)return void n([]);var u=(0,s.l)(t,n);t.forEach((function(e,t){a(e,u[t])}))}else a(t,n)},R[s.b]=function(e,t,n,i){var s=i.task;t===r.Pe?L(s):(0,o.YO)(t)?t.forEach(L):L(t),n()},R[s.S]=function(e,t,n){var r=t.selector,i=t.args;try{n(r.apply(void 0,[e.getState()].concat(i)))}catch(e){n(e,!0)}},R[s.d]=function(e,t,n){var r=t.pattern,i=A(t.buffer),o=w(r),s=function t(n){T(n)||e.channel.take(t,o),i.put(n)},a=i.close;i.close=function(){s.cancel(),a()},e.channel.take(s,o),n(i)},R[s.f]=function(e,t,n,r){n(r.task.isCancelled())},R[s.g]=function(e,t,n){t.flush(n)},R[s.G]=function(e,t,n,r){n(r.task.context[t])},R[s.h]=function(e,t,n,r){var i=r.task;(0,s.p)(i.context,t),n()},R);function F(e,t){return e+"?"+t}function j(e){var t=e.name,n=e.location;return n?t+"  "+F(n.fileName,n.lineNumber):t}function q(e){var t=(0,s.u)((function(e){return e.cancelledTasks}),e);return t.length?["Tasks cancelled due to error:"].concat(t).join("\n"):""}var H=null,V=[],B=function(e){e.crashedEffect=H,V.push(e)},z=function(){H=null,V.length=0},G=function(e){H=e},W=function(){var e=V[0],t=V.slice(1),n=e.crashedEffect?function(e){var t=(0,s.v)(e);return t?t.code+"  "+F(t.fileName,t.lineNumber):""}(e.crashedEffect):null;return["The above error occurred in task "+j(e.meta)+(n?" \n when executing effect "+n:"")].concat(t.map((function(e){return"    created by "+j(e.meta)})),[q(V)]).join("\n")};function K(e,t,n,i,o,a,c){var l;void 0===c&&(c=s.t);var d,h,f=N,p=null,_=[],v=Object.create(n),m=function(e,t,n){var r,i=[],o=!1;function a(e){t(),c(),n(e,!0)}function u(t){i.push(t),t.cont=function(u,c){o||((0,s.r)(i,t),t.cont=s.t,c?a(u):(t===e&&(r=u),i.length||(o=!0,n(r))))}}function c(){o||(o=!0,i.forEach((function(e){e.cont=s.t,e.cancel()})),i=[])}return u(e),{addTask:u,cancelAll:c,abort:a,getTasks:function(){return i}}}(t,(function(){_.push.apply(_,m.getTasks().map((function(e){return e.meta.name})))}),g);function g(t,n){if(n){if(f=x,B({meta:o,cancelledTasks:_}),y.isRoot){var i=W();z(),e.onError(t,{sagaStack:i})}h=t,p&&p.reject(t)}else t===r.nm?f=k:f!==k&&(f=O),d=t,p&&p.resolve(t);y.cont(t,n),y.joiners.forEach((function(e){e.cb(t,n)})),y.joiners=null}var y=((l={})[r.wn]=!0,l.id=i,l.meta=o,l.isRoot=a,l.context=v,l.joiners=[],l.queue=m,l.cancel=function(){f===N&&(f=k,m.cancelAll(),g(r.nm,!1))},l.cont=c,l.end=g,l.setContext=function(e){(0,s.p)(v,e)},l.toPromise=function(){return p||(p=u(),f===x?p.reject(h):f!==N&&p.resolve(d)),p.promise},l.isRunning=function(){return f===N},l.isCancelled=function(){return f===k||f===N&&t.status===k},l.isAborted=function(){return f===x},l.result=function(){return d},l.error=function(){return h},l);return y}function Q(e,t,n,i,a,u,c){var l=e.finalizeRunEffect((function(t,n,i){if((0,o.iv)(t))M(t,i);else if((0,o.lJ)(t))Q(e,t,h.context,n,a,!1,i);else if(t&&t[r.IO]){(0,P[t.type])(e,t.payload,i,f)}else i(t)}));p.cancel=s.t;var d={meta:a,cancel:function(){d.status===N&&(d.status=k,p(r.nm))},status:N},h=K(e,d,n,i,a,u,c),f={task:h,digestEffect:_};return c&&(c.cancel=h.cancel),p(),h;function p(e,n){try{var a;n?(a=t.throw(e),z()):(0,s.y)(e)?(d.status=k,p.cancel(),a=(0,o.Pc)(t.return)?t.return(r.nm):{done:!0,value:r.nm}):a=(0,s.z)(e)?(0,o.Pc)(t.return)?t.return():{done:!0}:t.next(e),a.done?(d.status!==k&&(d.status=O),d.cont(a.value)):_(a.value,i,p)}catch(e){if(d.status===k)throw e;d.status=x,d.cont(e,!0)}}function _(t,n,r,i){void 0===i&&(i="");var o,a=U();function u(n,i){o||(o=!0,r.cancel=s.t,e.sagaMonitor&&(i?e.sagaMonitor.effectRejected(a,n):e.sagaMonitor.effectResolved(a,n)),i&&G(t),r(n,i))}e.sagaMonitor&&e.sagaMonitor.effectTriggered({effectId:a,parentEffectId:n,label:i,effect:t}),u.cancel=s.t,r.cancel=function(){o||(o=!0,u.cancel(),u.cancel=s.t,e.sagaMonitor&&e.sagaMonitor.effectCancelled(a))},l(t,a,u)}}function Z(e,t){var n=e.channel,r=void 0===n?I():n,i=e.dispatch,o=e.getState,a=e.context,u=void 0===a?{}:a,c=e.sagaMonitor,l=e.effectMiddlewares,d=e.onError,h=void 0===d?s.D:d;for(var p=arguments.length,_=new Array(p>2?p-2:0),v=2;v<p;v++)_[v-2]=arguments[v];var m=t.apply(void 0,_);var g,y=U();if(c&&(c.rootSagaStarted=c.rootSagaStarted||s.t,c.effectTriggered=c.effectTriggered||s.t,c.effectResolved=c.effectResolved||s.t,c.effectRejected=c.effectRejected||s.t,c.effectCancelled=c.effectCancelled||s.t,c.actionDispatched=c.actionDispatched||s.t,c.rootSagaStarted({effectId:y,saga:t,args:_})),l){var b=s.B.apply(void 0,l);g=function(e){return function(t,n,r){return b((function(t){return e(t,n,r)}))(t)}}}else g=s.H;var E={channel:r,dispatch:(0,s.E)(i),getState:o,sagaMonitor:c,onError:h,finalizeRunEffect:g};return f((function(){var e=Q(E,m,u,y,(0,s.j)(t),!0,void 0);return c&&c.effectResolved(y,e),e}))}var Y=function(e){var t,n=void 0===e?{}:e,r=n.context,o=void 0===r?{}:r,a=n.channel,u=void 0===a?I():a,c=n.sagaMonitor,l=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(n,["context","channel","sagaMonitor"]);function d(e){var n=e.getState,r=e.dispatch;return t=Z.bind(null,(0,i.A)({},l,{context:o,channel:u,dispatch:r,getState:n,sagaMonitor:c})),function(e){return function(t){c&&c.actionDispatched&&c.actionDispatched(t);var n=e(t);return u.put(t),n}}}return d.run=function(){return t.apply(void 0,arguments)},d.setContext=function(e){(0,s.p)(o,e)},d},$=Y},9979:function(e,t,n){n.d(t,{Q7:function(){return i.$},T1:function(){return i.O},sg:function(){return p},cb:function(){return i.Q},Zy:function(){return i.M},yJ:function(){return i.Z},O4:function(){return i.W},Lt:function(){return i.a4},s:function(){return i.L},jP:function(){return h},p8:function(){return f}});var r=n(4860),i=n(258),o=function(e){return{done:!0,value:e}},s={};function a(e){return(0,r.Ix)(e)?"channel":(0,r.mr)(e)?String(e):(0,r.Pc)(e)?e.name:String(e)}function u(e,t,n){var r,a,u,c=t;function l(t,n){if(c===s)return o(t);if(n&&!a)throw c=s,n;r&&r(t);var i=n?e[a](n):e[c]();return c=i.nextState,u=i.effect,r=i.stateUpdater,a=i.errorState,c===s?o(t):u}return(0,i.q)(l,(function(e){return l(null,e)}),n)}function c(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var s,c={done:!1,value:(0,i.L)(e)},l=function(e){return s=e};return u({q1:function(){return{nextState:"q2",effect:c,stateUpdater:l}},q2:function(){return{nextState:"q1",effect:(e=s,{done:!1,value:i.M.apply(void 0,[t].concat(r,[e]))})};var e}},"q1","takeEvery("+a(e)+", "+t.name+")")}function l(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var s,c,l={done:!1,value:(0,i.L)(e)},d=function(e){return{done:!1,value:i.M.apply(void 0,[t].concat(r,[e]))}},h=function(e){return{done:!1,value:(0,i.N)(e)}},f=function(e){return s=e},p=function(e){return c=e};return u({q1:function(){return{nextState:"q2",effect:l,stateUpdater:p}},q2:function(){return s?{nextState:"q3",effect:h(s)}:{nextState:"q1",effect:d(c),stateUpdater:f}},q3:function(){return{nextState:"q1",effect:d(c),stateUpdater:f}}},"q1","takeLatest("+a(e)+", "+t.name+")")}function d(e,t,n){for(var r=arguments.length,o=new Array(r>3?r-3:0),s=3;s<r;s++)o[s-3]=arguments[s];var c,l,d={done:!1,value:(0,i.L)(t)},h={done:!1,value:(0,i.W)({action:(0,i.L)(t),debounce:(0,i.Q)(e)})},f=function(e){return c=e},p=function(e){return l=e};return u({q1:function(){return{nextState:"q2",effect:d,stateUpdater:f}},q2:function(){return{nextState:"q3",effect:h,stateUpdater:p}},q3:function(){return l.debounce?{nextState:"q1",effect:(t=c,{done:!1,value:i.M.apply(void 0,[n].concat(o,[t]))})}:{nextState:"q2",effect:(e=l.action,{done:!1,value:e}),stateUpdater:f};var e,t}},"q1","debounce("+a(t)+", "+n.name+")")}function h(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return i.M.apply(void 0,[c,e,t].concat(r))}function f(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return i.M.apply(void 0,[l,e,t].concat(r))}function p(e,t,n){for(var r=arguments.length,o=new Array(r>3?r-3:0),s=3;s<r;s++)o[s-3]=arguments[s];return i.M.apply(void 0,[d,e,t,n].concat(o))}},5930:function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}n.d(t,{Tw:function(){return p},HY:function(){return h},Zz:function(){return f},y$:function(){return d}});var a="function"==typeof Symbol&&Symbol.observable||"@@observable",u=function(){return Math.random().toString(36).substring(7).split("").join(".")},c={INIT:"@@redux/INIT"+u(),REPLACE:"@@redux/REPLACE"+u(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+u()}};function l(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function d(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(s(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(s(1));return n(d)(e,t)}if("function"!=typeof e)throw new Error(s(2));var i=e,o=t,u=[],h=u,f=!1;function p(){h===u&&(h=u.slice())}function _(){if(f)throw new Error(s(3));return o}function v(e){if("function"!=typeof e)throw new Error(s(4));if(f)throw new Error(s(5));var t=!0;return p(),h.push(e),function(){if(t){if(f)throw new Error(s(6));t=!1,p();var n=h.indexOf(e);h.splice(n,1),u=null}}}function m(e){if(!l(e))throw new Error(s(7));if(void 0===e.type)throw new Error(s(8));if(f)throw new Error(s(9));try{f=!0,o=i(o,e)}finally{f=!1}for(var t=u=h,n=0;n<t.length;n++){(0,t[n])()}return e}return m({type:c.INIT}),(r={dispatch:m,subscribe:v,getState:_,replaceReducer:function(e){if("function"!=typeof e)throw new Error(s(10));i=e,m({type:c.REPLACE})}})[a]=function(){var e,t=v;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(s(11));function n(){e.next&&e.next(_())}return n(),{unsubscribe:t(n)}}})[a]=function(){return this},e},r}function h(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"==typeof e[i]&&(n[i]=e[i])}var o,a=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:c.INIT}))throw new Error(s(12));if(void 0===n(void 0,{type:c.PROBE_UNKNOWN_ACTION()}))throw new Error(s(13))}))}(n)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var r=!1,i={},u=0;u<a.length;u++){var c=a[u],l=n[c],d=e[c],h=l(d,t);if(void 0===h){t&&t.type;throw new Error(s(14))}i[c]=h,r=r||h!==d}return(r=r||a.length!==Object.keys(e).length)?i:e}}function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(s(15))},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(i)}));return r=f.apply(void 0,a)(n.dispatch),o(o({},n),{},{dispatch:r})}}}},2964:function(e,t,n){n.d(t,{A:function(){return c}});var r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let i;const o=new Uint8Array(16);function s(){if(!i&&(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(o)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function u(e,t=0){return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}var c=function(e,t,n){if(r.randomUUID&&!t&&!e)return r.randomUUID();const i=(e=e||{}).random||(e.rng||s)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return u(i)}},6603:function(e,t,n){var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==r&&r,i="URLSearchParams"in r,o="Symbol"in r&&"iterator"in Symbol,s="FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in r,u="ArrayBuffer"in r;if(u)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function h(e){return"string"!=typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function _(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=v(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:s&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:i&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():u&&s&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):u&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=_(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=_(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(m)}),this.text=function(){var e,t,n,r=_(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=v(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(e,t){e=d(e),t=h(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},p.prototype.delete=function(e){delete this.map[d(e)]},p.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},p.prototype.set=function(e,t){this.map[d(e)]=h(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),f(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),f(e)},o&&(p.prototype[Symbol.iterator]=p.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function E(e,t){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,r,i=(t=t||{}).body;if(e instanceof E){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),b.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var o=/([?&])_=[^&]*/;if(o.test(this.url))this.url=this.url.replace(o,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function C(e,t){if(!(this instanceof C))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},y.call(E.prototype),y.call(C.prototype),C.prototype.clone=function(){return new C(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},C.error=function(){var e=new C(null,{status:0,statusText:""});return e.type="error",e};var T=[301,302,303,307,308];C.redirect=function(e,t){if(-1===T.indexOf(t))throw new RangeError("Invalid status code");return new C(null,{status:t,headers:{location:e}})};var A=r.DOMException;try{new A}catch(e){(A=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),A.prototype.constructor=A}function S(e,t){return new Promise((function(n,i){var o=new E(e,t);if(o.signal&&o.signal.aborted)return i(new A("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;setTimeout((function(){n(new C(i,r))}),0)},a.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},a.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},a.onabort=function(){setTimeout((function(){i(new A("Aborted","AbortError"))}),0)},a.open(o.method,function(e){try{return""===e&&r.location.href?r.location.href:e}catch(t){return e}}(o.url),!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&(s?a.responseType="blob":u&&o.headers.get("Content-Type")&&-1!==o.headers.get("Content-Type").indexOf("application/octet-stream")&&(a.responseType="arraybuffer")),!t||"object"!=typeof t.headers||t.headers instanceof p?o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})):Object.getOwnPropertyNames(t.headers).forEach((function(e){a.setRequestHeader(e,h(t.headers[e]))})),o.signal&&(o.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",c)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}S.polyfill=!0,r.fetch||(r.fetch=S,r.Headers=p,r.Request=E,r.Response=C)},9575:function(e,t,n){function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,{A:function(){return r}})},8684:function(e,t,n){n.d(t,{UE:function(){return M},RK:function(){return I},ll:function(){return T},rD:function(){return U},__:function(){return A},UU:function(){return k},jD:function(){return O},mG:function(){return R},ER:function(){return D},cY:function(){return S},iD:function(){return C},BN:function(){return N},Ej:function(){return x}});var r=n(2166);function i(e,t,n){let{reference:i,floating:o}=e;const s=(0,r.TV)(t),a=(0,r.Dz)(t),u=(0,r.sq)(a),c=(0,r.C0)(t),l="y"===s,d=i.x+i.width/2-o.width/2,h=i.y+i.height/2-o.height/2,f=i[u]/2-o[u]/2;let p;switch(c){case"top":p={x:d,y:i.y-o.height};break;case"bottom":p={x:d,y:i.y+i.height};break;case"right":p={x:i.x+i.width,y:h};break;case"left":p={x:i.x-o.width,y:h};break;default:p={x:i.x,y:i.y}}switch((0,r.Sg)(t)){case"start":p[a]-=f*(n&&l?-1:1);break;case"end":p[a]+=f*(n&&l?-1:1)}return p}async function o(e,t){var n;void 0===t&&(t={});const{x:i,y:o,platform:s,rects:a,elements:u,strategy:c}=e,{boundary:l="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=(0,r._3)(t,e),_=(0,r.nI)(p),v=u[f?"floating"===h?"reference":"floating":h],m=(0,r.B1)(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(v)))||n?v:v.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(u.floating)),boundary:l,rootBoundary:d,strategy:c})),g="floating"===h?{x:i,y:o,width:a.floating.width,height:a.floating.height}:a.reference,y=await(null==s.getOffsetParent?void 0:s.getOffsetParent(u.floating)),b=await(null==s.isElement?void 0:s.isElement(y))&&await(null==s.getScale?void 0:s.getScale(y))||{x:1,y:1},E=(0,r.B1)(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:g,offsetParent:y,strategy:c}):g);return{top:(m.top-E.top+_.top)/b.y,bottom:(E.bottom-m.bottom+_.bottom)/b.y,left:(m.left-E.left+_.left)/b.x,right:(E.right-m.right+_.right)/b.x}}function s(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function a(e){return r.r_.some((t=>e[t]>=0))}function u(e){const t=(0,r.jk)(...e.map((e=>e.left))),n=(0,r.jk)(...e.map((e=>e.top)));return{x:t,y:n,width:(0,r.T9)(...e.map((e=>e.right)))-t,height:(0,r.T9)(...e.map((e=>e.bottom)))-n}}var c=n(1860);function l(e){const t=(0,c.L9)(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const o=(0,c.sb)(e),s=o?e.offsetWidth:n,a=o?e.offsetHeight:i,u=(0,r.LI)(n)!==s||(0,r.LI)(i)!==a;return u&&(n=s,i=a),{width:n,height:i,$:u}}function d(e){return(0,c.vq)(e)?e:e.contextElement}function h(e){const t=d(e);if(!(0,c.sb)(t))return(0,r.Jx)(1);const n=t.getBoundingClientRect(),{width:i,height:o,$:s}=l(t);let a=(s?(0,r.LI)(n.width):n.width)/i,u=(s?(0,r.LI)(n.height):n.height)/o;return a&&Number.isFinite(a)||(a=1),u&&Number.isFinite(u)||(u=1),{x:a,y:u}}const f=(0,r.Jx)(0);function p(e){const t=(0,c.zk)(e);return(0,c.Tc)()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:f}function _(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const o=e.getBoundingClientRect(),s=d(e);let a=(0,r.Jx)(1);t&&(i?(0,c.vq)(i)&&(a=h(i)):a=h(e));const u=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==(0,c.zk)(e))&&t}(s,n,i)?p(s):(0,r.Jx)(0);let l=(o.left+u.x)/a.x,f=(o.top+u.y)/a.y,_=o.width/a.x,v=o.height/a.y;if(s){const e=(0,c.zk)(s),t=i&&(0,c.vq)(i)?(0,c.zk)(i):i;let n=e,r=(0,c._m)(n);for(;r&&i&&t!==n;){const e=h(r),t=r.getBoundingClientRect(),i=(0,c.L9)(r),o=t.left+(r.clientLeft+parseFloat(i.paddingLeft))*e.x,s=t.top+(r.clientTop+parseFloat(i.paddingTop))*e.y;l*=e.x,f*=e.y,_*=e.x,v*=e.y,l+=o,f+=s,n=(0,c.zk)(r),r=(0,c._m)(n)}}return(0,r.B1)({width:_,height:v,x:l,y:f})}function v(e){return _((0,c.ep)(e)).left+(0,c.CP)(e).scrollLeft}function m(e,t,n){let i;if("viewport"===t)i=function(e,t){const n=(0,c.zk)(e),r=(0,c.ep)(e),i=n.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,u=0;if(i){o=i.width,s=i.height;const e=(0,c.Tc)();(!e||e&&"fixed"===t)&&(a=i.offsetLeft,u=i.offsetTop)}return{width:o,height:s,x:a,y:u}}(e,n);else if("document"===t)i=function(e){const t=(0,c.ep)(e),n=(0,c.CP)(e),i=e.ownerDocument.body,o=(0,r.T9)(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=(0,r.T9)(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let a=-n.scrollLeft+v(e);const u=-n.scrollTop;return"rtl"===(0,c.L9)(i).direction&&(a+=(0,r.T9)(t.clientWidth,i.clientWidth)-o),{width:o,height:s,x:a,y:u}}((0,c.ep)(e));else if((0,c.vq)(t))i=function(e,t){const n=_(e,!0,"fixed"===t),i=n.top+e.clientTop,o=n.left+e.clientLeft,s=(0,c.sb)(e)?h(e):(0,r.Jx)(1);return{width:e.clientWidth*s.x,height:e.clientHeight*s.y,x:o*s.x,y:i*s.y}}(t,n);else{const n=p(e);i={...t,x:t.x-n.x,y:t.y-n.y}}return(0,r.B1)(i)}function g(e,t){const n=(0,c.$4)(e);return!(n===t||!(0,c.vq)(n)||(0,c.eu)(n))&&("fixed"===(0,c.L9)(n).position||g(n,t))}function y(e,t,n){const i=(0,c.sb)(t),o=(0,c.ep)(t),s="fixed"===n,a=_(e,!0,s,t);let u={scrollLeft:0,scrollTop:0};const l=(0,r.Jx)(0);if(i||!i&&!s)if(("body"!==(0,c.mq)(t)||(0,c.ZU)(o))&&(u=(0,c.CP)(t)),i){const e=_(t,!0,s,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else o&&(l.x=v(o));return{x:a.left+u.scrollLeft-l.x,y:a.top+u.scrollTop-l.y,width:a.width,height:a.height}}function b(e){return"static"===(0,c.L9)(e).position}function E(e,t){return(0,c.sb)(e)&&"fixed"!==(0,c.L9)(e).position?t?t(e):e.offsetParent:null}function w(e,t){const n=(0,c.zk)(e);if((0,c.Tf)(e))return n;if(!(0,c.sb)(e)){let t=(0,c.$4)(e);for(;t&&!(0,c.eu)(t);){if((0,c.vq)(t)&&!b(t))return t;t=(0,c.$4)(t)}return n}let r=E(e,t);for(;r&&(0,c.Lv)(r)&&b(r);)r=E(r,t);return r&&(0,c.eu)(r)&&b(r)&&!(0,c.sQ)(r)?n:r||(0,c.gJ)(e)||n}const C={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:i,strategy:o}=e;const s="fixed"===o,a=(0,c.ep)(i),u=!!t&&(0,c.Tf)(t.floating);if(i===a||u&&s)return n;let l={scrollLeft:0,scrollTop:0},d=(0,r.Jx)(1);const f=(0,r.Jx)(0),p=(0,c.sb)(i);if((p||!p&&!s)&&(("body"!==(0,c.mq)(i)||(0,c.ZU)(a))&&(l=(0,c.CP)(i)),(0,c.sb)(i))){const e=_(i);d=h(i),f.x=e.x+i.clientLeft,f.y=e.y+i.clientTop}return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-l.scrollLeft*d.x+f.x,y:n.y*d.y-l.scrollTop*d.y+f.y}},getDocumentElement:c.ep,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:i,strategy:o}=e;const s=[..."clippingAncestors"===n?(0,c.Tf)(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let r=(0,c.v9)(e,[],!1).filter((e=>(0,c.vq)(e)&&"body"!==(0,c.mq)(e))),i=null;const o="fixed"===(0,c.L9)(e).position;let s=o?(0,c.$4)(e):e;for(;(0,c.vq)(s)&&!(0,c.eu)(s);){const t=(0,c.L9)(s),n=(0,c.sQ)(s);n||"fixed"!==t.position||(i=null),(o?!n&&!i:!n&&"static"===t.position&&i&&["absolute","fixed"].includes(i.position)||(0,c.ZU)(s)&&!n&&g(e,s))?r=r.filter((e=>e!==s)):i=t,s=(0,c.$4)(s)}return t.set(e,r),r}(t,this._c):[].concat(n),i],a=s[0],u=s.reduce(((e,n)=>{const i=m(t,n,o);return e.top=(0,r.T9)(i.top,e.top),e.right=(0,r.jk)(i.right,e.right),e.bottom=(0,r.jk)(i.bottom,e.bottom),e.left=(0,r.T9)(i.left,e.left),e}),m(t,a,o));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}},getOffsetParent:w,getElementRects:async function(e){const t=this.getOffsetParent||w,n=this.getDimensions,r=await n(e.floating);return{reference:y(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=l(e);return{width:t,height:n}},getScale:h,isElement:c.vq,isRTL:function(e){return"rtl"===(0,c.L9)(e).direction}};function T(e,t,n,i){void 0===i&&(i={});const{ancestorScroll:o=!0,ancestorResize:s=!0,elementResize:a="function"==typeof ResizeObserver,layoutShift:u="function"==typeof IntersectionObserver,animationFrame:l=!1}=i,h=d(e),f=o||s?[...h?(0,c.v9)(h):[],...(0,c.v9)(t)]:[];f.forEach((e=>{o&&e.addEventListener("scroll",n,{passive:!0}),s&&e.addEventListener("resize",n)}));const p=h&&u?function(e,t){let n,i=null;const o=(0,c.ep)(e);function s(){var e;clearTimeout(n),null==(e=i)||e.disconnect(),i=null}return function a(u,c){void 0===u&&(u=!1),void 0===c&&(c=1),s();const{left:l,top:d,width:h,height:f}=e.getBoundingClientRect();if(u||t(),!h||!f)return;const p={rootMargin:-(0,r.RI)(d)+"px "+-(0,r.RI)(o.clientWidth-(l+h))+"px "+-(0,r.RI)(o.clientHeight-(d+f))+"px "+-(0,r.RI)(l)+"px",threshold:(0,r.T9)(0,(0,r.jk)(1,c))||1};let _=!0;function v(e){const t=e[0].intersectionRatio;if(t!==c){if(!_)return a();t?a(!1,t):n=setTimeout((()=>{a(!1,1e-7)}),1e3)}_=!1}try{i=new IntersectionObserver(v,{...p,root:o.ownerDocument})}catch(e){i=new IntersectionObserver(v,p)}i.observe(e)}(!0),s}(h,n):null;let v,m=-1,g=null;a&&(g=new ResizeObserver((e=>{let[r]=e;r&&r.target===h&&g&&(g.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame((()=>{var e;null==(e=g)||e.observe(t)}))),n()})),h&&!l&&g.observe(h),g.observe(t));let y=l?_(e):null;return l&&function t(){const r=_(e);!y||r.x===y.x&&r.y===y.y&&r.width===y.width&&r.height===y.height||n();y=r,v=requestAnimationFrame(t)}(),n(),()=>{var e;f.forEach((e=>{o&&e.removeEventListener("scroll",n),s&&e.removeEventListener("resize",n)})),null==p||p(),null==(e=g)||e.disconnect(),g=null,l&&cancelAnimationFrame(v)}}const A=o,S=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:o,y:s,placement:a,middlewareData:u}=t,c=await async function(e,t){const{placement:n,platform:i,elements:o}=e,s=await(null==i.isRTL?void 0:i.isRTL(o.floating)),a=(0,r.C0)(n),u=(0,r.Sg)(n),c="y"===(0,r.TV)(n),l=["left","top"].includes(a)?-1:1,d=s&&c?-1:1,h=(0,r._3)(t,e);let{mainAxis:f,crossAxis:p,alignmentAxis:_}="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return u&&"number"==typeof _&&(p="end"===u?-1*_:_),c?{x:p*d,y:f*l}:{x:f*l,y:p*d}}(t,e);return a===(null==(n=u.offset)?void 0:n.placement)&&null!=(i=u.arrow)&&i.alignmentOffset?{}:{x:o+c.x,y:s+c.y,data:{...c,placement:a}}}}},I=function(e){return void 0===e&&(e={}),{name:"autoPlacement",options:e,async fn(t){var n,i,s;const{rects:a,middlewareData:u,placement:c,platform:l,elements:d}=t,{crossAxis:h=!1,alignment:f,allowedPlacements:p=r.DD,autoAlignment:_=!0,...v}=(0,r._3)(e,t),m=void 0!==f||p===r.DD?function(e,t,n){return(e?[...n.filter((t=>(0,r.Sg)(t)===e)),...n.filter((t=>(0,r.Sg)(t)!==e))]:n.filter((e=>(0,r.C0)(e)===e))).filter((n=>!e||(0,r.Sg)(n)===e||!!t&&(0,r.aD)(n)!==n))}(f||null,_,p):p,g=await o(t,v),y=(null==(n=u.autoPlacement)?void 0:n.index)||0,b=m[y];if(null==b)return{};const E=(0,r.w7)(b,a,await(null==l.isRTL?void 0:l.isRTL(d.floating)));if(c!==b)return{reset:{placement:m[0]}};const w=[g[(0,r.C0)(b)],g[E[0]],g[E[1]]],C=[...(null==(i=u.autoPlacement)?void 0:i.overflows)||[],{placement:b,overflows:w}],T=m[y+1];if(T)return{data:{index:y+1,overflows:C},reset:{placement:T}};const A=C.map((e=>{const t=(0,r.Sg)(e.placement);return[e.placement,t&&h?e.overflows.slice(0,2).reduce(((e,t)=>e+t),0):e.overflows[0],e.overflows]})).sort(((e,t)=>e[1]-t[1])),S=(null==(s=A.filter((e=>e[2].slice(0,(0,r.Sg)(e[0])?2:3).every((e=>e<=0))))[0])?void 0:s[0])||A[0][0];return S!==c?{data:{index:y+1,overflows:C},reset:{placement:S}}:{}}}},N=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:s}=t,{mainAxis:a=!0,crossAxis:u=!1,limiter:c={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...l}=(0,r._3)(e,t),d={x:n,y:i},h=await o(t,l),f=(0,r.TV)((0,r.C0)(s)),p=(0,r.PG)(f);let _=d[p],v=d[f];if(a){const e="y"===p?"bottom":"right",t=_+h["y"===p?"top":"left"],n=_-h[e];_=(0,r.qE)(t,_,n)}if(u){const e="y"===f?"bottom":"right",t=v+h["y"===f?"top":"left"],n=v-h[e];v=(0,r.qE)(t,v,n)}const m=c.fn({...t,[p]:_,[f]:v});return{...m,data:{x:m.x-n,y:m.y-i}}}}},k=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:s,middlewareData:a,rects:u,initialPlacement:c,platform:l,elements:d}=t,{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:_="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:m=!0,...g}=(0,r._3)(e,t);if(null!=(n=a.arrow)&&n.alignmentOffset)return{};const y=(0,r.C0)(s),b=(0,r.TV)(c),E=(0,r.C0)(c)===c,w=await(null==l.isRTL?void 0:l.isRTL(d.floating)),C=p||(E||!m?[(0,r.bV)(c)]:(0,r.WJ)(c)),T="none"!==v;!p&&T&&C.push(...(0,r.lP)(c,m,v,w));const A=[c,...C],S=await o(t,g),I=[];let N=(null==(i=a.flip)?void 0:i.overflows)||[];if(h&&I.push(S[y]),f){const e=(0,r.w7)(s,u,w);I.push(S[e[0]],S[e[1]])}if(N=[...N,{placement:s,overflows:I}],!I.every((e=>e<=0))){var k,x;const e=((null==(k=a.flip)?void 0:k.index)||0)+1,t=A[e];if(t)return{data:{index:e,overflows:N},reset:{placement:t}};let n=null==(x=N.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:x.placement;if(!n)switch(_){case"bestFit":{var O;const e=null==(O=N.filter((e=>{if(T){const t=(0,r.TV)(e.placement);return t===b||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:O[0];e&&(n=e);break}case"initialPlacement":n=c}if(s!==n)return{reset:{placement:n}}}return{}}}},x=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:i,platform:s,elements:a}=t,{apply:u=(()=>{}),...c}=(0,r._3)(e,t),l=await o(t,c),d=(0,r.C0)(n),h=(0,r.Sg)(n),f="y"===(0,r.TV)(n),{width:p,height:_}=i.floating;let v,m;"top"===d||"bottom"===d?(v=d,m=h===(await(null==s.isRTL?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(m=d,v="end"===h?"top":"bottom");const g=_-l.top-l.bottom,y=p-l.left-l.right,b=(0,r.jk)(_-l[v],g),E=(0,r.jk)(p-l[m],y),w=!t.middlewareData.shift;let C=b,T=E;if(f?T=h||w?(0,r.jk)(E,y):y:C=h||w?(0,r.jk)(b,g):g,w&&!h){const e=(0,r.T9)(l.left,0),t=(0,r.T9)(l.right,0),n=(0,r.T9)(l.top,0),i=(0,r.T9)(l.bottom,0);f?T=p-2*(0!==e||0!==t?e+t:(0,r.T9)(l.left,l.right)):C=_-2*(0!==n||0!==i?n+i:(0,r.T9)(l.top,l.bottom))}await u({...t,availableWidth:T,availableHeight:C});const A=await s.getDimensions(a.floating);return p!==A.width||_!==A.height?{reset:{rects:!0}}:{}}}},O=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...u}=(0,r._3)(e,t);switch(i){case"referenceHidden":{const e=s(await o(t,{...u,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:a(e)}}}case"escaped":{const e=s(await o(t,{...u,altBoundary:!0}),n.floating);return{data:{escapedOffsets:e,escaped:a(e)}}}default:return{}}}}},M=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:o,rects:s,platform:a,elements:u,middlewareData:c}=t,{element:l,padding:d=0}=(0,r._3)(e,t)||{};if(null==l)return{};const h=(0,r.nI)(d),f={x:n,y:i},p=(0,r.Dz)(o),_=(0,r.sq)(p),v=await a.getDimensions(l),m="y"===p,g=m?"top":"left",y=m?"bottom":"right",b=m?"clientHeight":"clientWidth",E=s.reference[_]+s.reference[p]-f[p]-s.floating[_],w=f[p]-s.reference[p],C=await(null==a.getOffsetParent?void 0:a.getOffsetParent(l));let T=C?C[b]:0;T&&await(null==a.isElement?void 0:a.isElement(C))||(T=u.floating[b]||s.floating[_]);const A=E/2-w/2,S=T/2-v[_]/2-1,I=(0,r.jk)(h[g],S),N=(0,r.jk)(h[y],S),k=I,x=T-v[_]-N,O=T/2-v[_]/2+A,M=(0,r.qE)(k,O,x),R=!c.arrow&&null!=(0,r.Sg)(o)&&O!==M&&s.reference[_]/2-(O<k?I:N)-v[_]/2<0,D=R?O<k?O-k:O-x:0;return{[p]:f[p]+D,data:{[p]:M,centerOffset:O-M-D,...R&&{alignmentOffset:D}},reset:R}}}),R=function(e){return void 0===e&&(e={}),{name:"inline",options:e,async fn(t){const{placement:n,elements:i,rects:o,platform:s,strategy:a}=t,{padding:c=2,x:l,y:d}=(0,r._3)(e,t),h=Array.from(await(null==s.getClientRects?void 0:s.getClientRects(i.reference))||[]),f=function(e){const t=e.slice().sort(((e,t)=>e.y-t.y)),n=[];let i=null;for(let e=0;e<t.length;e++){const r=t[e];!i||r.y-i.y>i.height/2?n.push([r]):n[n.length-1].push(r),i=r}return n.map((e=>(0,r.B1)(u(e))))}(h),p=(0,r.B1)(u(h)),_=(0,r.nI)(c);const v=await s.getElementRects({reference:{getBoundingClientRect:function(){if(2===f.length&&f[0].left>f[1].right&&null!=l&&null!=d)return f.find((e=>l>e.left-_.left&&l<e.right+_.right&&d>e.top-_.top&&d<e.bottom+_.bottom))||p;if(f.length>=2){if("y"===(0,r.TV)(n)){const e=f[0],t=f[f.length-1],i="top"===(0,r.C0)(n),o=e.top,s=t.bottom,a=i?e.left:t.left,u=i?e.right:t.right;return{top:o,bottom:s,left:a,right:u,width:u-a,height:s-o,x:a,y:o}}const e="left"===(0,r.C0)(n),t=(0,r.T9)(...f.map((e=>e.right))),i=(0,r.jk)(...f.map((e=>e.left))),o=f.filter((n=>e?n.left===i:n.right===t)),s=o[0].top,a=o[o.length-1].bottom;return{top:s,bottom:a,left:i,right:t,width:t-i,height:a-s,x:i,y:s}}return p}},floating:i.floating,strategy:a});return o.reference.x!==v.reference.x||o.reference.y!==v.reference.y||o.reference.width!==v.reference.width||o.reference.height!==v.reference.height?{reset:{rects:v}}:{}}}},D=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:o,rects:s,middlewareData:a}=t,{offset:u=0,mainAxis:c=!0,crossAxis:l=!0}=(0,r._3)(e,t),d={x:n,y:i},h=(0,r.TV)(o),f=(0,r.PG)(h);let p=d[f],_=d[h];const v=(0,r._3)(u,t),m="number"==typeof v?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const e="y"===f?"height":"width",t=s.reference[f]-s.floating[e]+m.mainAxis,n=s.reference[f]+s.reference[e]-m.mainAxis;p<t?p=t:p>n&&(p=n)}if(l){var g,y;const e="y"===f?"width":"height",t=["top","left"].includes((0,r.C0)(o)),n=s.reference[h]-s.floating[e]+(t&&(null==(g=a.offset)?void 0:g[h])||0)+(t?0:m.crossAxis),i=s.reference[h]+s.reference[e]+(t?0:(null==(y=a.offset)?void 0:y[h])||0)-(t?m.crossAxis:0);_<n?_=n:_>i&&(_=i)}return{[f]:p,[h]:_}}}},U=(e,t,n)=>{const r=new Map,o={platform:C,...n},s={...o.platform,_c:r};return(async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:s=[],platform:a}=n,u=s.filter(Boolean),c=await(null==a.isRTL?void 0:a.isRTL(t));let l=await a.getElementRects({reference:e,floating:t,strategy:o}),{x:d,y:h}=i(l,r,c),f=r,p={},_=0;for(let n=0;n<u.length;n++){const{name:s,fn:v}=u[n],{x:m,y:g,data:y,reset:b}=await v({x:d,y:h,initialPlacement:r,placement:f,strategy:o,middlewareData:p,rects:l,platform:a,elements:{reference:e,floating:t}});d=null!=m?m:d,h=null!=g?g:h,p={...p,[s]:{...p[s],...y}},b&&_<=50&&(_++,"object"==typeof b&&(b.placement&&(f=b.placement),b.rects&&(l=!0===b.rects?await a.getElementRects({reference:e,floating:t,strategy:o}):b.rects),({x:d,y:h}=i(l,f,c))),n=-1)}return{x:d,y:h,placement:f,strategy:o,middlewareData:p}})(e,t,{...o,platform:s})}},6584:function(e,t,n){n.d(t,{BN:function(){return p},ER:function(){return _},Ej:function(){return m},RK:function(){return g},UE:function(){return E},UU:function(){return v},cY:function(){return f},jD:function(){return y},mG:function(){return b},we:function(){return d}});var r=n(8684),i=n(1594),o=n(5206),s="undefined"!=typeof document?i.useLayoutEffect:i.useEffect;function a(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let n,r,i;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;0!=r--;)if(!a(e[r],t[r]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!{}.hasOwnProperty.call(t,i[r]))return!1;for(r=n;0!=r--;){const n=i[r];if(("_owner"!==n||!e.$$typeof)&&!a(e[n],t[n]))return!1}return!0}return e!=e&&t!=t}function u(e){if("undefined"==typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function c(e,t){const n=u(e);return Math.round(t*n)/n}function l(e){const t=i.useRef(e);return s((()=>{t.current=e})),t}function d(e){void 0===e&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:d=[],platform:h,elements:{reference:f,floating:p}={},transform:_=!0,whileElementsMounted:v,open:m}=e,[g,y]=i.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[b,E]=i.useState(d);a(b,d)||E(d);const[w,C]=i.useState(null),[T,A]=i.useState(null),S=i.useCallback((e=>{e!==x.current&&(x.current=e,C(e))}),[]),I=i.useCallback((e=>{e!==O.current&&(O.current=e,A(e))}),[]),N=f||w,k=p||T,x=i.useRef(null),O=i.useRef(null),M=i.useRef(g),R=null!=v,D=l(v),U=l(h),L=i.useCallback((()=>{if(!x.current||!O.current)return;const e={placement:t,strategy:n,middleware:b};U.current&&(e.platform=U.current),(0,r.rD)(x.current,O.current,e).then((e=>{const t={...e,isPositioned:!0};P.current&&!a(M.current,t)&&(M.current=t,o.flushSync((()=>{y(t)})))}))}),[b,t,n,U]);s((()=>{!1===m&&M.current.isPositioned&&(M.current.isPositioned=!1,y((e=>({...e,isPositioned:!1}))))}),[m]);const P=i.useRef(!1);s((()=>(P.current=!0,()=>{P.current=!1})),[]),s((()=>{if(N&&(x.current=N),k&&(O.current=k),N&&k){if(D.current)return D.current(N,k,L);L()}}),[N,k,L,D,R]);const F=i.useMemo((()=>({reference:x,floating:O,setReference:S,setFloating:I})),[S,I]),j=i.useMemo((()=>({reference:N,floating:k})),[N,k]),q=i.useMemo((()=>{const e={position:n,left:0,top:0};if(!j.floating)return e;const t=c(j.floating,g.x),r=c(j.floating,g.y);return _?{...e,transform:"translate("+t+"px, "+r+"px)",...u(j.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:t,top:r}}),[n,_,j.floating,g.x,g.y]);return i.useMemo((()=>({...g,update:L,refs:F,elements:j,floatingStyles:q})),[g,L,F,j,q])}const h=e=>({name:"arrow",options:e,fn(t){const{element:n,padding:i}="function"==typeof e?e(t):e;return n&&(o=n,{}.hasOwnProperty.call(o,"current"))?null!=n.current?(0,r.UE)({element:n.current,padding:i}).fn(t):{}:n?(0,r.UE)({element:n,padding:i}).fn(t):{};var o}}),f=(e,t)=>({...(0,r.cY)(e),options:[e,t]}),p=(e,t)=>({...(0,r.BN)(e),options:[e,t]}),_=(e,t)=>({...(0,r.ER)(e),options:[e,t]}),v=(e,t)=>({...(0,r.UU)(e),options:[e,t]}),m=(e,t)=>({...(0,r.Ej)(e),options:[e,t]}),g=(e,t)=>({...(0,r.RK)(e),options:[e,t]}),y=(e,t)=>({...(0,r.jD)(e),options:[e,t]}),b=(e,t)=>({...(0,r.mG)(e),options:[e,t]}),E=(e,t)=>({...h(e),options:[e,t]})},4713:function(e,t,n){n.r(t),n.d(t,{Composite:function(){return Te},CompositeItem:function(){return Ae},FloatingArrow:function(){return Oe},FloatingDelayGroup:function(){return Qe},FloatingFocusManager:function(){return At},FloatingList:function(){return me},FloatingNode:function(){return Fe},FloatingOverlay:function(){return It},FloatingPortal:function(){return gt},FloatingTree:function(){return je},arrow:function(){return W.UE},autoPlacement:function(){return W.RK},autoUpdate:function(){return K.ll},computePosition:function(){return K.rD},detectOverflow:function(){return K.__},flip:function(){return W.UU},getOverflowAncestors:function(){return o.v9},hide:function(){return W.jD},inline:function(){return W.mG},inner:function(){return on},limitShift:function(){return W.ER},offset:function(){return W.cY},platform:function(){return K.iD},safePolygon:function(){return un},shift:function(){return W.BN},size:function(){return W.Ej},useClick:function(){return xt},useClientPoint:function(){return Mt},useDelayGroup:function(){return Ze},useDelayGroupContext:function(){return Ke},useDismiss:function(){return Lt},useFloating:function(){return Ft},useFloatingNodeId:function(){return Pe},useFloatingParentNodeId:function(){return Ue},useFloatingPortalNode:function(){return mt},useFloatingRootContext:function(){return Pt},useFloatingTree:function(){return Le},useFocus:function(){return jt},useHover:function(){return ze},useId:function(){return xe},useInnerOffset:function(){return sn},useInteractions:function(){return Bt},useListItem:function(){return ge},useListNavigation:function(){return Zt},useMergeRefs:function(){return Q},useRole:function(){return $t},useTransitionStatus:function(){return en},useTransitionStyles:function(){return tn},useTypeahead:function(){return nn}});var r=n(1594),i=n.t(r,2),o=n(1860);function s(e){let t=e.activeElement;for(;null!=(null==(n=t)||null==(n=n.shadowRoot)?void 0:n.activeElement);){var n;t=t.shadowRoot.activeElement}return t}function a(e,t){if(!e||!t)return!1;const n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&(0,o.Ng)(n)){let n=t;for(;n;){if(e===n)return!0;n=n.parentNode||n.host}}return!1}function u(){const e=navigator.userAgentData;return null!=e&&e.platform?e.platform:navigator.platform}function c(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map((e=>{let{brand:t,version:n}=e;return t+"/"+n})).join(" "):navigator.userAgent}function l(e){return!(0!==e.mozInputSource||!e.isTrusted)||(f()&&e.pointerType?"click"===e.type&&1===e.buttons:0===e.detail&&!e.pointerType)}function d(e){return!c().includes("jsdom/")&&(!f()&&0===e.width&&0===e.height||f()&&1===e.width&&1===e.height&&0===e.pressure&&0===e.detail&&"mouse"===e.pointerType||e.width<1&&e.height<1&&0===e.pressure&&0===e.detail&&"touch"===e.pointerType)}function h(){return/apple/i.test(navigator.vendor)}function f(){const e=/android/i;return e.test(u())||e.test(c())}function p(){return u().toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints}function _(e,t){const n=["mouse","pen"];return t||n.push("",void 0),n.includes(e)}function v(e){return(null==e?void 0:e.ownerDocument)||document}function m(e,t){if(null==t)return!1;if("composedPath"in e)return e.composedPath().includes(t);const n=e;return null!=n.target&&t.contains(n.target)}function g(e){return"composedPath"in e?e.composedPath()[0]:e.target}const y="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function b(e){return(0,o.sb)(e)&&e.matches(y)}function E(e){e.preventDefault(),e.stopPropagation()}function w(e){return!!e&&("combobox"===e.getAttribute("role")&&b(e))}var C=n(2166),T=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],A=T.join(","),S="undefined"==typeof Element,I=S?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,N=!S&&Element.prototype.getRootNode?function(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}:function(e){return null==e?void 0:e.ownerDocument},k=function e(t,n){var r;void 0===n&&(n=!0);var i=null==t||null===(r=t.getAttribute)||void 0===r?void 0:r.call(t,"inert");return""===i||"true"===i||n&&t&&e(t.parentNode)},x=function(e,t,n){if(k(e))return[];var r=Array.prototype.slice.apply(e.querySelectorAll(A));return t&&I.call(e,A)&&r.unshift(e),r=r.filter(n)},O=function e(t,n,r){for(var i=[],o=Array.from(t);o.length;){var s=o.shift();if(!k(s,!1))if("SLOT"===s.tagName){var a=s.assignedElements(),u=e(a.length?a:s.children,!0,r);r.flatten?i.push.apply(i,u):i.push({scopeParent:s,candidates:u})}else{I.call(s,A)&&r.filter(s)&&(n||!t.includes(s))&&i.push(s);var c=s.shadowRoot||"function"==typeof r.getShadowRoot&&r.getShadowRoot(s),l=!k(c,!1)&&(!r.shadowRootFilter||r.shadowRootFilter(s));if(c&&l){var d=e(!0===c?s.children:c.children,!0,r);r.flatten?i.push.apply(i,d):i.push({scopeParent:s,candidates:d})}else o.unshift.apply(o,s.children)}}return i},M=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},R=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||function(e){var t,n=null==e||null===(t=e.getAttribute)||void 0===t?void 0:t.call(e,"contenteditable");return""===n||"true"===n}(e))&&!M(e)?0:e.tabIndex},D=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},U=function(e){return"INPUT"===e.tagName},L=function(e){return function(e){return U(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t,n=e.form||N(e),r=function(e){return n.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)t=r(window.CSS.escape(e.name));else try{t=r(e.name)}catch(e){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",e.message),!1}var i=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]}(t,e.form);return!i||i===e}(e)},P=function(e){var t=e.getBoundingClientRect(),n=t.width,r=t.height;return 0===n&&0===r},F=function(e,t){var n=t.displayCheck,r=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var i=I.call(e,"details>summary:first-of-type")?e.parentElement:e;if(I.call(i,"details:not([open]) *"))return!0;if(n&&"full"!==n&&"legacy-full"!==n){if("non-zero-area"===n)return P(e)}else{if("function"==typeof r){for(var o=e;e;){var s=e.parentElement,a=N(e);if(s&&!s.shadowRoot&&!0===r(s))return P(e);e=e.assignedSlot?e.assignedSlot:s||a===e.ownerDocument?s:a.host}e=o}if(function(e){var t,n,r,i,o=e&&N(e),s=null===(t=o)||void 0===t?void 0:t.host,a=!1;if(o&&o!==e)for(a=!!(null!==(n=s)&&void 0!==n&&null!==(r=n.ownerDocument)&&void 0!==r&&r.contains(s)||null!=e&&null!==(i=e.ownerDocument)&&void 0!==i&&i.contains(e));!a&&s;){var u,c,l;a=!(null===(c=s=null===(u=o=N(s))||void 0===u?void 0:u.host)||void 0===c||null===(l=c.ownerDocument)||void 0===l||!l.contains(s))}return a}(e))return!e.getClientRects().length;if("legacy-full"!==n)return!0}return!1},j=function(e,t){return!(t.disabled||k(t)||function(e){return U(e)&&"hidden"===e.type}(t)||F(t,e)||function(e){return"DETAILS"===e.tagName&&Array.prototype.slice.apply(e.children).some((function(e){return"SUMMARY"===e.tagName}))}(t)||function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var n=0;n<t.children.length;n++){var r=t.children.item(n);if("LEGEND"===r.tagName)return!!I.call(t,"fieldset[disabled] *")||!r.contains(e)}return!0}t=t.parentElement}return!1}(t))},q=function(e,t){return!(L(t)||R(t)<0||!j(e,t))},H=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},V=function e(t){var n=[],r=[];return t.forEach((function(t,i){var o=!!t.scopeParent,s=o?t.scopeParent:t,a=function(e,t){var n=R(e);return n<0&&t&&!M(e)?0:n}(s,o),u=o?e(t.candidates):s;0===a?o?n.push.apply(n,u):n.push(s):r.push({documentOrder:i,tabIndex:a,item:t,isScope:o,content:u})})),r.sort(D).reduce((function(e,t){return t.isScope?e.push.apply(e,t.content):e.push(t.content),e}),[]).concat(n)},B=function(e,t){var n;return n=(t=t||{}).getShadowRoot?O([e],t.includeContainer,{filter:q.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:H}):x(e,t.includeContainer,q.bind(null,t)),V(n)},z=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return!1!==I.call(e,A)&&q(t,e)},G=n(5206),W=n(6584),K=n(8684);function Q(e){return r.useMemo((()=>e.every((e=>null==e))?null:t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}),e)}const Z={...i},Y=Z.useInsertionEffect||(e=>e());function $(e){const t=r.useRef((()=>{0}));return Y((()=>{t.current=e})),r.useCallback((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)}),[])}const X="ArrowUp",J="ArrowDown",ee="ArrowLeft",te="ArrowRight";function ne(e,t,n){return Math.floor(e/t)!==n}function re(e,t){return t<0||t>=e.current.length}function ie(e,t){return se(e,{disabledIndices:t})}function oe(e,t){return se(e,{decrement:!0,startingIndex:e.current.length,disabledIndices:t})}function se(e,t){let{startingIndex:n=-1,decrement:r=!1,disabledIndices:i,amount:o=1}=void 0===t?{}:t;const s=e.current;let a=n;do{a+=r?-o:o}while(a>=0&&a<=s.length-1&&de(s,a,i));return a}function ae(e,t){let{event:n,orientation:r,loop:i,cols:o,disabledIndices:s,minIndex:a,maxIndex:u,prevIndex:c,stopEvent:l=!1}=t,d=c;if(n.key===X){if(l&&E(n),-1===c)d=u;else if(d=se(e,{startingIndex:d,amount:o,decrement:!0,disabledIndices:s}),i&&(c-o<a||d<0)){const e=c%o,t=u%o,n=u-(t-e);d=t===e?u:t>e?n:n-o}re(e,d)&&(d=c)}if(n.key===J&&(l&&E(n),-1===c?d=a:(d=se(e,{startingIndex:c,amount:o,disabledIndices:s}),i&&c+o>u&&(d=se(e,{startingIndex:c%o-o,amount:o,disabledIndices:s}))),re(e,d)&&(d=c)),"both"===r){const t=(0,C.RI)(c/o);n.key===te&&(l&&E(n),c%o!=o-1?(d=se(e,{startingIndex:c,disabledIndices:s}),i&&ne(d,o,t)&&(d=se(e,{startingIndex:c-c%o-1,disabledIndices:s}))):i&&(d=se(e,{startingIndex:c-c%o-1,disabledIndices:s})),ne(d,o,t)&&(d=c)),n.key===ee&&(l&&E(n),c%o!=0?(d=se(e,{startingIndex:c,decrement:!0,disabledIndices:s}),i&&ne(d,o,t)&&(d=se(e,{startingIndex:c+(o-c%o),decrement:!0,disabledIndices:s}))):i&&(d=se(e,{startingIndex:c+(o-c%o),decrement:!0,disabledIndices:s})),ne(d,o,t)&&(d=c));const r=(0,C.RI)(u/o)===t;re(e,d)&&(d=i&&r?n.key===ee?u:se(e,{startingIndex:c-c%o-1,disabledIndices:s}):c)}return d}function ue(e,t,n){const r=[];let i=0;return e.forEach(((e,o)=>{let{width:s,height:a}=e,u=!1;for(n&&(i=0);!u;){const e=[];for(let n=0;n<s;n++)for(let r=0;r<a;r++)e.push(i+n+r*t);i%t+s<=t&&e.every((e=>null==r[e]))?(e.forEach((e=>{r[e]=o})),u=!0):i++}})),[...r]}function ce(e,t,n,r,i){if(-1===e)return-1;const o=n.indexOf(e),s=t[e];switch(i){case"tl":return o;case"tr":return s?o+s.width-1:o;case"bl":return s?o+(s.height-1)*r:o;case"br":return n.lastIndexOf(e)}}function le(e,t){return t.flatMap(((t,n)=>e.includes(t)?[n]:[]))}function de(e,t,n){if(n)return n.includes(t);const r=e[t];return null==r||r.hasAttribute("disabled")||"true"===r.getAttribute("aria-disabled")}let he=0;function fe(e,t){void 0===t&&(t={});const{preventScroll:n=!1,cancelPrevious:r=!0,sync:i=!1}=t;r&&cancelAnimationFrame(he);const o=()=>null==e?void 0:e.focus({preventScroll:n});i?o():he=requestAnimationFrame(o)}var pe="undefined"!=typeof document?r.useLayoutEffect:r.useEffect;function _e(e,t){const n=e.compareDocumentPosition(t);return n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS?1:0}const ve=r.createContext({register:()=>{},unregister:()=>{},map:new Map,elementsRef:{current:[]}});function me(e){const{children:t,elementsRef:n,labelsRef:i}=e,[o,s]=r.useState((()=>new Map)),a=r.useCallback((e=>{s((t=>new Map(t).set(e,null)))}),[]),u=r.useCallback((e=>{s((t=>{const n=new Map(t);return n.delete(e),n}))}),[]);return pe((()=>{const e=new Map(o);Array.from(e.keys()).sort(_e).forEach(((t,n)=>{e.set(t,n)})),function(e,t){if(e.size!==t.size)return!1;for(const[n,r]of e.entries())if(r!==t.get(n))return!1;return!0}(o,e)||s(e)}),[o]),r.createElement(ve.Provider,{value:r.useMemo((()=>({register:a,unregister:u,map:o,elementsRef:n,labelsRef:i})),[a,u,o,n,i])},t)}function ge(e){void 0===e&&(e={});const{label:t}=e,{register:n,unregister:i,map:o,elementsRef:s,labelsRef:a}=r.useContext(ve),[u,c]=r.useState(null),l=r.useRef(null),d=r.useCallback((e=>{if(l.current=e,null!==u&&(s.current[u]=e,a)){var n;const r=void 0!==t;a.current[u]=r?t:null!=(n=null==e?void 0:e.textContent)?n:null}}),[u,s,a,t]);return pe((()=>{const e=l.current;if(e)return n(e),()=>{i(e)}}),[n,i]),pe((()=>{const e=l.current?o.get(l.current):null;null!=e&&c(e)}),[o]),r.useMemo((()=>({ref:d,index:null==u?-1:u})),[u,d])}function ye(e,t){return"function"==typeof e?e(t):e?r.cloneElement(e,t):r.createElement("div",t)}const be=r.createContext({activeIndex:0,onNavigate:()=>{}}),Ee=[ee,te],we=[X,J],Ce=[...Ee,...we],Te=r.forwardRef((function(e,t){const{render:n,orientation:i="both",loop:o=!0,cols:s=1,disabledIndices:a,activeIndex:u,onNavigate:c,itemSizes:l,dense:d=!1,...h}=e,[f,p]=r.useState(0),_=null!=u?u:f,v=$(null!=c?c:p),m=r.useRef([]),g=n&&"function"!=typeof n?n.props:{},y=r.useMemo((()=>({activeIndex:_,onNavigate:v})),[_,v]),b=s>1;const E={...h,...g,ref:t,"aria-orientation":"both"===i?void 0:i,onKeyDown(e){null==h.onKeyDown||h.onKeyDown(e),null==g.onKeyDown||g.onKeyDown(e),function(e){if(!Ce.includes(e.key))return;let t=_;const n=ie(m,a),r=oe(m,a);if(b){const u=l||Array.from({length:m.current.length},(()=>({width:1,height:1}))),c=ue(u,s,d),h=c.findIndex((e=>null!=e&&!de(m.current,e,a))),f=c.reduce(((e,t,n)=>null==t||de(m.current,t,a)?e:n),-1);t=c[ae({current:c.map((e=>e?m.current[e]:null))},{event:e,orientation:i,loop:o,cols:s,disabledIndices:le([...a||m.current.map(((e,t)=>de(m.current,t)?t:void 0)),void 0],c),minIndex:h,maxIndex:f,prevIndex:ce(_>r?n:_,u,c,s,e.key===J?"bl":e.key===te?"tr":"tl")})]}const u={horizontal:[te],vertical:[J],both:[te,J]}[i],c={horizontal:[ee],vertical:[X],both:[ee,X]}[i],h=b?Ce:{horizontal:Ee,vertical:we,both:Ce}[i];t===_&&[...u,...c].includes(e.key)&&(t=o&&t===r&&u.includes(e.key)?n:o&&t===n&&c.includes(e.key)?r:se(m,{startingIndex:t,decrement:c.includes(e.key),disabledIndices:a})),t===_||re(m,t)||(e.stopPropagation(),h.includes(e.key)&&e.preventDefault(),v(t),queueMicrotask((()=>{fe(m.current[t])})))}(e)}};return r.createElement(be.Provider,{value:y},r.createElement(me,{elementsRef:m},ye(n,E)))})),Ae=r.forwardRef((function(e,t){const{render:n,...i}=e,o=n&&"function"!=typeof n?n.props:{},{activeIndex:s,onNavigate:a}=r.useContext(be),{ref:u,index:c}=ge(),l=Q([u,t,o.ref]),d=s===c;return ye(n,{...i,...o,ref:l,tabIndex:d?0:-1,"data-active":d?"":void 0,onFocus(e){null==i.onFocus||i.onFocus(e),null==o.onFocus||o.onFocus(e),a(c)}})}));function Se(){return Se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Se.apply(this,arguments)}let Ie=!1,Ne=0;const ke=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+Ne++;const xe=Z.useId||function(){const[e,t]=r.useState((()=>Ie?ke():void 0));return pe((()=>{null==e&&t(ke())}),[]),r.useEffect((()=>{Ie=!0}),[]),e};const Oe=r.forwardRef((function(e,t){const{context:{placement:n,elements:{floating:i},middlewareData:{arrow:s}},width:a=14,height:u=7,tipRadius:c=0,strokeWidth:l=0,staticOffset:d,stroke:h,d:f,style:{transform:p,..._}={},...v}=e;const m=xe(),[g,y]=r.useState(!1);if(pe((()=>{if(!i)return;"rtl"===(0,o.L9)(i).direction&&y(!0)}),[i]),!i)return null;const b=2*l,E=b/2,w=a/2*(c/-8+1),C=u/2*c/4,[T,A]=n.split("-"),S=!!f,I="top"===T||"bottom"===T,N=d&&"end"===A?"bottom":"top";let k=d&&"end"===A?"right":"left";d&&g&&(k="end"===A?"left":"right");const x=null!=(null==s?void 0:s.x)?d||s.x:"",O=null!=(null==s?void 0:s.y)?d||s.y:"",M=f||"M0,0 H"+a+" L"+(a-w)+","+(u-C)+" Q"+a/2+","+u+" "+w+","+(u-C)+" Z",R={top:S?"rotate(180deg)":"",left:S?"rotate(90deg)":"rotate(-90deg)",bottom:S?"":"rotate(180deg)",right:S?"rotate(-90deg)":"rotate(90deg)"}[T];return r.createElement("svg",Se({},v,{"aria-hidden":!0,ref:t,width:S?a:a+b,height:a,viewBox:"0 0 "+a+" "+(u>a?u:a),style:{position:"absolute",pointerEvents:"none",[k]:x,[N]:O,[T]:I||S?"100%":"calc(100% - "+b/2+"px)",transform:""+R+(null!=p?p:""),..._}}),b>0&&r.createElement("path",{clipPath:"url(#"+m+")",fill:"none",stroke:h,strokeWidth:b+(f?0:1),d:M}),r.createElement("path",{stroke:b&&!f?v.fill:"none",d:M}),r.createElement("clipPath",{id:m},r.createElement("rect",{x:-E,y:E*(S?-1:1),width:a+b,height:a})))}));function Me(){const e=new Map;return{emit(t,n){var r;null==(r=e.get(t))||r.forEach((e=>e(n)))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var r;e.set(t,(null==(r=e.get(t))?void 0:r.filter((e=>e!==n)))||[])}}}const Re=r.createContext(null),De=r.createContext(null),Ue=()=>{var e;return(null==(e=r.useContext(Re))?void 0:e.id)||null},Le=()=>r.useContext(De);function Pe(e){const t=xe(),n=Le(),r=Ue(),i=e||r;return pe((()=>{const e={id:t,parentId:i};return null==n||n.addNode(e),()=>{null==n||n.removeNode(e)}}),[n,t,i]),t}function Fe(e){const{children:t,id:n}=e,i=Ue();return r.createElement(Re.Provider,{value:r.useMemo((()=>({id:n,parentId:i})),[n,i])},t)}function je(e){const{children:t}=e,n=r.useRef([]),i=r.useCallback((e=>{n.current=[...n.current,e]}),[]),o=r.useCallback((e=>{n.current=n.current.filter((t=>t!==e))}),[]),s=r.useState((()=>Me()))[0];return r.createElement(De.Provider,{value:r.useMemo((()=>({nodesRef:n,addNode:i,removeNode:o,events:s})),[i,o,s])},t)}function qe(e){return"data-floating-ui-"+e}function He(e){const t=(0,r.useRef)(e);return pe((()=>{t.current=e})),t}const Ve=qe("safe-polygon");function Be(e,t,n){return n&&!_(n)?0:"number"==typeof e?e:null==e?void 0:e[t]}function ze(e,t){void 0===t&&(t={});const{open:n,onOpenChange:i,dataRef:s,events:u,elements:c}=e,{enabled:l=!0,delay:d=0,handleClose:h=null,mouseOnly:f=!1,restMs:p=0,move:m=!0}=t,g=Le(),y=Ue(),b=He(h),E=He(d),w=He(n),C=r.useRef(),T=r.useRef(-1),A=r.useRef(),S=r.useRef(-1),I=r.useRef(!0),N=r.useRef(!1),k=r.useRef((()=>{})),x=r.useCallback((()=>{var e;const t=null==(e=s.current.openEvent)?void 0:e.type;return(null==t?void 0:t.includes("mouse"))&&"mousedown"!==t}),[s]);r.useEffect((()=>{if(l)return u.on("openchange",e),()=>{u.off("openchange",e)};function e(e){let{open:t}=e;t||(clearTimeout(T.current),clearTimeout(S.current),I.current=!0)}}),[l,u]),r.useEffect((()=>{if(!l)return;if(!b.current)return;if(!n)return;function e(e){x()&&i(!1,e,"hover")}const t=v(c.floating).documentElement;return t.addEventListener("mouseleave",e),()=>{t.removeEventListener("mouseleave",e)}}),[c.floating,n,i,l,b,x]);const O=r.useCallback((function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n="hover");const r=Be(E.current,"close",C.current);r&&!A.current?(clearTimeout(T.current),T.current=window.setTimeout((()=>i(!1,e,n)),r)):t&&(clearTimeout(T.current),i(!1,e,n))}),[E,i]),M=$((()=>{k.current(),A.current=void 0})),R=$((()=>{if(N.current){const e=v(c.floating).body;e.style.pointerEvents="",e.removeAttribute(Ve),N.current=!1}}));r.useEffect((()=>{if(l&&(0,o.vq)(c.domReference)){var e;const t=c.domReference;return n&&t.addEventListener("mouseleave",d),null==(e=c.floating)||e.addEventListener("mouseleave",d),m&&t.addEventListener("mousemove",r,{once:!0}),t.addEventListener("mouseenter",r),t.addEventListener("mouseleave",u),()=>{var e;n&&t.removeEventListener("mouseleave",d),null==(e=c.floating)||e.removeEventListener("mouseleave",d),m&&t.removeEventListener("mousemove",r),t.removeEventListener("mouseenter",r),t.removeEventListener("mouseleave",u)}}function t(){return!!s.current.openEvent&&["click","mousedown"].includes(s.current.openEvent.type)}function r(e){if(clearTimeout(T.current),I.current=!1,f&&!_(C.current)||p>0&&!Be(E.current,"open"))return;const t=Be(E.current,"open",C.current);t?T.current=window.setTimeout((()=>{w.current||i(!0,e,"hover")}),t):i(!0,e,"hover")}function u(e){if(t())return;k.current();const r=v(c.floating);if(clearTimeout(S.current),b.current&&s.current.floatingContext){n||clearTimeout(T.current),A.current=b.current({...s.current.floatingContext,tree:g,x:e.clientX,y:e.clientY,onClose(){R(),M(),O(e,!0,"safe-polygon")}});const t=A.current;return r.addEventListener("mousemove",t),void(k.current=()=>{r.removeEventListener("mousemove",t)})}("touch"!==C.current||!a(c.floating,e.relatedTarget))&&O(e)}function d(e){t()||s.current.floatingContext&&(null==b.current||b.current({...s.current.floatingContext,tree:g,x:e.clientX,y:e.clientY,onClose(){R(),M(),O(e)}})(e))}}),[c,l,e,f,p,m,O,M,R,i,n,w,g,E,b,s]),pe((()=>{var e;if(l&&n&&null!=(e=b.current)&&e.__options.blockPointerEvents&&x()){const e=v(c.floating).body;e.setAttribute(Ve,""),e.style.pointerEvents="none",N.current=!0;const n=c.floating;if((0,o.vq)(c.domReference)&&n){var t;const e=c.domReference,r=null==g||null==(t=g.nodesRef.current.find((e=>e.id===y)))||null==(t=t.context)?void 0:t.elements.floating;return r&&(r.style.pointerEvents=""),e.style.pointerEvents="auto",n.style.pointerEvents="auto",()=>{e.style.pointerEvents="",n.style.pointerEvents=""}}}}),[l,n,y,c,g,b,x]),pe((()=>{n||(C.current=void 0,M(),R())}),[n,M,R]),r.useEffect((()=>()=>{M(),clearTimeout(T.current),clearTimeout(S.current),R()}),[l,c.domReference,M,R]);const D=r.useMemo((()=>{function e(e){C.current=e.pointerType}return{onPointerDown:e,onPointerEnter:e,onMouseMove(e){const{nativeEvent:t}=e;function r(){I.current||w.current||i(!0,t,"hover")}f&&!_(C.current)||n||0===p||(clearTimeout(S.current),"touch"===C.current?r():S.current=window.setTimeout(r,p))}}}),[f,i,n,w,p]),U=r.useMemo((()=>({onMouseEnter(){clearTimeout(T.current)},onMouseLeave(e){O(e.nativeEvent,!1)}})),[O]);return r.useMemo((()=>l?{reference:D,floating:U}:{}),[l,D,U])}const Ge=()=>{},We=r.createContext({delay:0,initialDelay:0,timeoutMs:0,currentId:null,setCurrentId:Ge,setState:Ge,isInstantPhase:!1}),Ke=()=>r.useContext(We);function Qe(e){const{children:t,delay:n,timeoutMs:i=0}=e,[o,s]=r.useReducer(((e,t)=>({...e,...t})),{delay:n,timeoutMs:i,initialDelay:n,currentId:null,isInstantPhase:!1}),a=r.useRef(null),u=r.useCallback((e=>{s({currentId:e})}),[]);return pe((()=>{o.currentId?null===a.current?a.current=o.currentId:o.isInstantPhase||s({isInstantPhase:!0}):(o.isInstantPhase&&s({isInstantPhase:!1}),a.current=null)}),[o.currentId,o.isInstantPhase]),r.createElement(We.Provider,{value:r.useMemo((()=>({...o,setState:s,setCurrentId:u})),[o,u])},t)}function Ze(e,t){void 0===t&&(t={});const{open:n,onOpenChange:r,floatingId:i}=e,{id:o}=t,s=null!=o?o:i,a=Ke(),{currentId:u,setCurrentId:c,initialDelay:l,setState:d,timeoutMs:h}=a;return pe((()=>{u&&(d({delay:{open:1,close:Be(l,"close")}}),u!==s&&r(!1))}),[s,r,d,u,l]),pe((()=>{function e(){r(!1),d({delay:l,currentId:null})}if(u&&!n&&u===s){if(h){const t=window.setTimeout(e,h);return()=>{clearTimeout(t)}}e()}}),[n,d,u,s,r,l,h]),pe((()=>{c!==Ge&&n&&c(s)}),[n,c,s]),a}function Ye(e,t){let n=e.filter((e=>{var n;return e.parentId===t&&(null==(n=e.context)?void 0:n.open)})),r=n;for(;r.length;)r=e.filter((e=>{var t;return null==(t=r)?void 0:t.some((t=>{var n;return e.parentId===t.id&&(null==(n=e.context)?void 0:n.open)}))})),n=n.concat(r);return n}let $e=new WeakMap,Xe=new WeakSet,Je={},et=0;const tt=()=>"undefined"!=typeof HTMLElement&&"inert"in HTMLElement.prototype,nt=e=>e&&(e.host||nt(e.parentNode)),rt=(e,t)=>t.map((t=>{if(e.contains(t))return t;const n=nt(t);return e.contains(n)?n:null})).filter((e=>null!=e));function it(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=v(e[0]).body;return function(e,t,n,r){const i="data-floating-ui-inert",s=r?"inert":n?"aria-hidden":null,a=rt(t,e),u=new Set,c=new Set(a),l=[];Je[i]||(Je[i]=new WeakMap);const d=Je[i];return a.forEach((function e(t){t&&!u.has(t)&&(u.add(t),t.parentNode&&e(t.parentNode))})),function e(t){t&&!c.has(t)&&[].forEach.call(t.children,(t=>{if("script"!==(0,o.mq)(t))if(u.has(t))e(t);else{const e=s?t.getAttribute(s):null,n=null!==e&&"false"!==e,r=($e.get(t)||0)+1,o=(d.get(t)||0)+1;$e.set(t,r),d.set(t,o),l.push(t),1===r&&n&&Xe.add(t),1===o&&t.setAttribute(i,""),!n&&s&&t.setAttribute(s,"true")}}))}(t),u.clear(),et++,()=>{l.forEach((e=>{const t=($e.get(e)||0)-1,n=(d.get(e)||0)-1;$e.set(e,t),d.set(e,n),t||(!Xe.has(e)&&s&&e.removeAttribute(s),Xe.delete(e)),n||e.removeAttribute(i)})),et--,et||($e=new WeakMap,$e=new WeakMap,Xe=new WeakSet,Je={})}}(e.concat(Array.from(r.querySelectorAll("[aria-live]"))),r,t,n)}const ot=()=>({getShadowRoot:!0,displayCheck:"function"==typeof ResizeObserver&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function st(e,t){const n=B(e,ot());"prev"===t&&n.reverse();const r=n.indexOf(s(v(e)));return n.slice(r+1)[0]}function at(){return st(document.body,"next")}function ut(){return st(document.body,"prev")}function ct(e,t){const n=t||e.currentTarget,r=e.relatedTarget;return!r||!a(n,r)}function lt(e){B(e,ot()).forEach((e=>{e.dataset.tabindex=e.getAttribute("tabindex")||"",e.setAttribute("tabindex","-1")}))}function dt(e){e.querySelectorAll("[data-tabindex]").forEach((e=>{const t=e.dataset.tabindex;delete e.dataset.tabindex,t?e.setAttribute("tabindex",t):e.removeAttribute("tabindex")}))}const ht={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0};function ft(e){"Tab"===e.key&&(e.target,clearTimeout(undefined))}const pt=r.forwardRef((function(e,t){const[n,i]=r.useState();pe((()=>(h()&&i("button"),document.addEventListener("keydown",ft),()=>{document.removeEventListener("keydown",ft)})),[]);const o={ref:t,tabIndex:0,role:n,"aria-hidden":!n||void 0,[qe("focus-guard")]:"",style:ht};return r.createElement("span",Se({},e,o))})),_t=r.createContext(null),vt=qe("portal");function mt(e){void 0===e&&(e={});const{id:t,root:n}=e,i=xe(),s=yt(),[a,u]=r.useState(null),c=r.useRef(null);return pe((()=>()=>{null==a||a.remove(),queueMicrotask((()=>{c.current=null}))}),[a]),pe((()=>{if(!i)return;if(c.current)return;const e=t?document.getElementById(t):null;if(!e)return;const n=document.createElement("div");n.id=i,n.setAttribute(vt,""),e.appendChild(n),c.current=n,u(n)}),[t,i]),pe((()=>{if(!i)return;if(c.current)return;let e=n||(null==s?void 0:s.portalNode);e&&!(0,o.vq)(e)&&(e=e.current),e=e||document.body;let r=null;t&&(r=document.createElement("div"),r.id=t,e.appendChild(r));const a=document.createElement("div");a.id=i,a.setAttribute(vt,""),e=r||e,e.appendChild(a),c.current=a,u(a)}),[t,n,i,s]),a}function gt(e){const{children:t,id:n,root:i=null,preserveTabOrder:o=!0}=e,s=mt({id:n,root:i}),[a,u]=r.useState(null),c=r.useRef(null),l=r.useRef(null),d=r.useRef(null),h=r.useRef(null),f=!!a&&!a.modal&&a.open&&o&&!(!i&&!s);return r.useEffect((()=>{if(s&&o&&(null==a||!a.modal))return s.addEventListener("focusin",e,!0),s.addEventListener("focusout",e,!0),()=>{s.removeEventListener("focusin",e,!0),s.removeEventListener("focusout",e,!0)};function e(e){if(s&&ct(e)){("focusin"===e.type?dt:lt)(s)}}}),[s,o,null==a?void 0:a.modal]),r.createElement(_t.Provider,{value:r.useMemo((()=>({preserveTabOrder:o,beforeOutsideRef:c,afterOutsideRef:l,beforeInsideRef:d,afterInsideRef:h,portalNode:s,setFocusManagerState:u})),[o,s])},f&&s&&r.createElement(pt,{"data-type":"outside",ref:c,onFocus:e=>{if(ct(e,s)){var t;null==(t=d.current)||t.focus()}else{const e=ut()||(null==a?void 0:a.refs.domReference.current);null==e||e.focus()}}}),f&&s&&r.createElement("span",{"aria-owns":s.id,style:ht}),s&&G.createPortal(t,s),f&&s&&r.createElement(pt,{"data-type":"outside",ref:l,onFocus:e=>{if(ct(e,s)){var t;null==(t=h.current)||t.focus()}else{const t=at()||(null==a?void 0:a.refs.domReference.current);null==t||t.focus(),(null==a?void 0:a.closeOnFocusOut)&&(null==a||a.onOpenChange(!1,e.nativeEvent))}}}))}const yt=()=>r.useContext(_t),bt=20;let Et=[];function wt(e){Et=Et.filter((e=>e.isConnected));let t=e;if(t&&"body"!==(0,o.mq)(t)){if(!z(t,ot())){const e=B(t,ot())[0];e&&(t=e)}Et.push(t),Et.length>bt&&(Et=Et.slice(-bt))}}function Ct(){return Et.slice().reverse().find((e=>e.isConnected))}const Tt=r.forwardRef((function(e,t){return r.createElement("button",Se({},e,{type:"button",ref:t,tabIndex:-1,style:ht}))}));function At(e){const{context:t,children:n,disabled:i=!1,order:u=["content"],guards:c=!0,initialFocus:h=0,returnFocus:f=!0,restoreFocus:p=!1,modal:_=!0,visuallyHiddenDismiss:m=!1,closeOnFocusOut:y=!0}=e,{open:b,refs:C,nodeId:T,onOpenChange:A,events:S,dataRef:I,floatingId:N,elements:{domReference:k,floating:x}}=t,O="number"==typeof h&&h<0,M=w(k)&&O,R=!tt()||c,D=He(u),U=He(h),L=He(f),P=Le(),F=yt(),j=r.useRef(null),q=r.useRef(null),H=r.useRef(!1),V=r.useRef(!1),z=r.useRef(-1),G=null!=F,W=null==x?void 0:x.firstElementChild,K=(null==W?void 0:W.id)===N?W:x,Q=$((function(e){return void 0===e&&(e=K),e?B(e,ot()):[]})),Z=$((e=>{const t=Q(e);return D.current.map((e=>k&&"reference"===e?k:K&&"floating"===e?K:t)).filter(Boolean).flat()}));function Y(e){return!i&&m&&_?r.createElement(Tt,{ref:"start"===e?j:q,onClick:e=>A(!1,e.nativeEvent)},"string"==typeof m?m:"Dismiss"):null}r.useEffect((()=>{if(i)return;if(!_)return;function e(e){if("Tab"===e.key){a(K,s(v(K)))&&0===Q().length&&!M&&E(e);const t=Z(),n=g(e);"reference"===D.current[0]&&n===k&&(E(e),e.shiftKey?fe(t[t.length-1]):fe(t[1])),"floating"===D.current[1]&&n===K&&e.shiftKey&&(E(e),fe(t[0]))}}const t=v(K);return t.addEventListener("keydown",e),()=>{t.removeEventListener("keydown",e)}}),[i,k,K,_,D,M,Q,Z]),r.useEffect((()=>{if(!i&&x)return x.addEventListener("focusin",e),()=>{x.removeEventListener("focusin",e)};function e(e){const t=g(e),n=Q().indexOf(t);-1!==n&&(z.current=n)}}),[i,x,Q]),r.useEffect((()=>{if(!i&&y)return x&&(0,o.sb)(k)?(k.addEventListener("focusout",t),k.addEventListener("pointerdown",e),x.addEventListener("focusout",t),()=>{k.removeEventListener("focusout",t),k.removeEventListener("pointerdown",e),x.removeEventListener("focusout",t)}):void 0;function e(){V.current=!0,setTimeout((()=>{V.current=!1}))}function t(e){const t=e.relatedTarget;queueMicrotask((()=>{const n=!(a(k,t)||a(x,t)||a(t,x)||a(null==F?void 0:F.portalNode,t)||null!=t&&t.hasAttribute(qe("focus-guard"))||P&&(Ye(P.nodesRef.current,T).find((e=>{var n,r;return a(null==(n=e.context)?void 0:n.elements.floating,t)||a(null==(r=e.context)?void 0:r.elements.domReference,t)}))||function(e,t){var n;let r=[],i=null==(n=e.find((e=>e.id===t)))?void 0:n.parentId;for(;i;){const t=e.find((e=>e.id===i));i=null==t?void 0:t.parentId,t&&(r=r.concat(t))}return r}(P.nodesRef.current,T).find((e=>{var n,r;return(null==(n=e.context)?void 0:n.elements.floating)===t||(null==(r=e.context)?void 0:r.elements.domReference)===t}))));if(p&&n&&s(v(K))===v(K).body){(0,o.sb)(K)&&(null==K||K.focus());const e=z.current,t=Q(),n=t[e]||t[t.length-1]||K;(0,o.sb)(n)&&n.focus()}!M&&_||!t||!n||V.current||t===Ct()||(H.current=!0,A(!1,e))}))}}),[i,k,x,K,_,T,P,F,A,y,p,Q,M]),r.useEffect((()=>{var e;if(i)return;const t=Array.from((null==F||null==(e=F.portalNode)?void 0:e.querySelectorAll("["+qe("portal")+"]"))||[]);if(x){const e=[x,...t,j.current,q.current,D.current.includes("reference")||M?k:null].filter((e=>null!=e)),n=_||M?it(e,R,!R):it(e);return()=>{n()}}}),[i,k,x,_,D,F,M,R]),pe((()=>{if(i||!(0,o.sb)(K))return;const e=s(v(K));queueMicrotask((()=>{const t=Z(K),n=U.current,r=("number"==typeof n?t[n]:n.current)||K,i=a(K,e);O||i||!b||fe(r,{preventScroll:r===K})}))}),[i,b,K,O,Z,U]),pe((()=>{if(i||!K)return;let e=!1;const t=v(K),n=s(t);let r=I.current.openEvent;const u=C.domReference.current;function c(t){let{open:n,reason:i,event:o,nested:s}=t;n&&(r=o),"escape-key"===i&&C.domReference.current&&wt(C.domReference.current),"hover"===i&&"mouseleave"===o.type&&(H.current=!0),"outside-press"===i&&(s?(H.current=!1,e=!0):H.current=!(l(o)||d(o)))}return wt(n),S.on("openchange",c),()=>{S.off("openchange",c);const i=s(t),l=a(x,i)||P&&Ye(P.nodesRef.current,T).some((e=>{var t;return a(null==(t=e.context)?void 0:t.elements.floating,i)}));(l||r&&["click","mousedown"].includes(r.type))&&C.domReference.current&&wt(C.domReference.current);const d=u||n,h=B(v(d).body,ot());queueMicrotask((()=>{let n=Ct();!n&&(0,o.sb)(d)&&x&&(n=function(e,t,n){const r=e.indexOf(t);function i(t){const i=qe("focus-guard");let o=r+(t?1:0),s=e[o];for(;s&&(!s.isConnected||s.hasAttribute(i)||a(n,s));)t?o++:o--,s=e[o];return s}return i(!0)||i(!1)}(h,d,x)),L.current&&!H.current&&(0,o.sb)(n)&&(n===i||i===t.body||l)&&n.focus({preventScroll:e})}))}}),[i,x,K,L,I,C,S,P,T]),pe((()=>{if(!i&&F)return F.setFocusManagerState({modal:_,closeOnFocusOut:y,open:b,onOpenChange:A,refs:C}),()=>{F.setFocusManagerState(null)}}),[i,F,_,b,A,C,y]),pe((()=>{if(i)return;if(!K)return;if("function"!=typeof MutationObserver)return;if(O)return;const e=()=>{const e=K.getAttribute("tabindex"),t=Q(),n=s(v(x)),r=t.indexOf(n);-1!==r&&(z.current=r),D.current.includes("floating")||n!==C.domReference.current&&0===t.length?"0"!==e&&K.setAttribute("tabindex","0"):"-1"!==e&&K.setAttribute("tabindex","-1")};e();const t=new MutationObserver(e);return t.observe(K,{childList:!0,subtree:!0,attributes:!0}),()=>{t.disconnect()}}),[i,x,K,C,D,Q,O]);const X=!i&&R&&(!_||!M)&&(G||_);return r.createElement(r.Fragment,null,X&&r.createElement(pt,{"data-type":"inside",ref:null==F?void 0:F.beforeInsideRef,onFocus:e=>{if(_){const e=Z();fe("reference"===u[0]?e[0]:e[e.length-1])}else if(null!=F&&F.preserveTabOrder&&F.portalNode)if(H.current=!1,ct(e,F.portalNode)){const e=at()||k;null==e||e.focus()}else{var t;null==(t=F.beforeOutsideRef.current)||t.focus()}}}),!M&&Y("start"),n,Y("end"),X&&r.createElement(pt,{"data-type":"inside",ref:null==F?void 0:F.afterInsideRef,onFocus:e=>{if(_)fe(Z()[0]);else if(null!=F&&F.preserveTabOrder&&F.portalNode)if(y&&(H.current=!0),ct(e,F.portalNode)){const e=ut()||k;null==e||e.focus()}else{var t;null==(t=F.afterOutsideRef.current)||t.focus()}}}))}const St=new Set,It=r.forwardRef((function(e,t){const{lockScroll:n=!1,...i}=e,o=xe();return pe((()=>{if(!n)return;St.add(o);const e=/iP(hone|ad|od)|iOS/.test(u()),t=document.body.style,r=Math.round(document.documentElement.getBoundingClientRect().left)+document.documentElement.scrollLeft?"paddingLeft":"paddingRight",i=window.innerWidth-document.documentElement.clientWidth,s=t.left?parseFloat(t.left):window.scrollX,a=t.top?parseFloat(t.top):window.scrollY;if(t.overflow="hidden",i&&(t[r]=i+"px"),e){var c,l;const e=(null==(c=window.visualViewport)?void 0:c.offsetLeft)||0,n=(null==(l=window.visualViewport)?void 0:l.offsetTop)||0;Object.assign(t,{position:"fixed",top:-(a-Math.floor(n))+"px",left:-(s-Math.floor(e))+"px",right:"0"})}return()=>{St.delete(o),0===St.size&&(Object.assign(t,{overflow:"",[r]:""}),e&&(Object.assign(t,{position:"",top:"",left:"",right:""}),window.scrollTo(s,a)))}}),[o,n]),r.createElement("div",Se({ref:t},i,{style:{position:"fixed",overflow:"auto",top:0,right:0,bottom:0,left:0,...i.style}}))}));function Nt(e){return(0,o.sb)(e.target)&&"BUTTON"===e.target.tagName}function kt(e){return b(e)}function xt(e,t){void 0===t&&(t={});const{open:n,onOpenChange:i,dataRef:o,elements:{domReference:s}}=e,{enabled:a=!0,event:u="click",toggle:c=!0,ignoreMouse:l=!1,keyboardHandlers:d=!0}=t,h=r.useRef(),f=r.useRef(!1),p=r.useMemo((()=>({onPointerDown(e){h.current=e.pointerType},onMouseDown(e){const t=h.current;0===e.button&&"click"!==u&&(_(t,!0)&&l||(!n||!c||o.current.openEvent&&"mousedown"!==o.current.openEvent.type?(e.preventDefault(),i(!0,e.nativeEvent,"click")):i(!1,e.nativeEvent,"click")))},onClick(e){const t=h.current;"mousedown"===u&&h.current?h.current=void 0:_(t,!0)&&l||(!n||!c||o.current.openEvent&&"click"!==o.current.openEvent.type?i(!0,e.nativeEvent,"click"):i(!1,e.nativeEvent,"click"))},onKeyDown(e){h.current=void 0,e.defaultPrevented||!d||Nt(e)||(" "!==e.key||kt(s)||(e.preventDefault(),f.current=!0),"Enter"===e.key&&i(!n||!c,e.nativeEvent,"click"))},onKeyUp(e){e.defaultPrevented||!d||Nt(e)||kt(s)||" "===e.key&&f.current&&(f.current=!1,i(!n||!c,e.nativeEvent,"click"))}})),[o,s,u,l,d,i,n,c]);return r.useMemo((()=>a?{reference:p}:{}),[a,p])}function Ot(e){return null!=e&&null!=e.clientX}function Mt(e,t){void 0===t&&(t={});const{open:n,dataRef:i,elements:{floating:s,domReference:u},refs:c}=e,{enabled:l=!0,axis:d="both",x:h=null,y:f=null}=t,p=r.useRef(!1),v=r.useRef(null),[m,y]=r.useState(),[b,E]=r.useState([]),w=$(((e,t)=>{p.current||i.current.openEvent&&!Ot(i.current.openEvent)||c.setPositionReference(function(e,t){let n=null,r=null,i=!1;return{contextElement:e||void 0,getBoundingClientRect(){var o;const s=(null==e?void 0:e.getBoundingClientRect())||{width:0,height:0,x:0,y:0},a="x"===t.axis||"both"===t.axis,u="y"===t.axis||"both"===t.axis,c=["mouseenter","mousemove"].includes((null==(o=t.dataRef.current.openEvent)?void 0:o.type)||"")&&"touch"!==t.pointerType;let l=s.width,d=s.height,h=s.x,f=s.y;return null==n&&t.x&&a&&(n=s.x-t.x),null==r&&t.y&&u&&(r=s.y-t.y),h-=n||0,f-=r||0,l=0,d=0,!i||c?(l="y"===t.axis?s.width:0,d="x"===t.axis?s.height:0,h=a&&null!=t.x?t.x:h,f=u&&null!=t.y?t.y:f):i&&!c&&(d="x"===t.axis?s.height:d,l="y"===t.axis?s.width:l),i=!0,{width:l,height:d,x:h,y:f,top:f,right:h+l,bottom:f+d,left:h}}}}(u,{x:e,y:t,axis:d,dataRef:i,pointerType:m}))})),C=$((e=>{null==h&&null==f&&(n?v.current||E([]):w(e.clientX,e.clientY))})),T=_(m)?s:n,A=r.useCallback((()=>{if(!T||!l||null!=h||null!=f)return;const e=(0,o.zk)(s);function t(n){const r=g(n);a(s,r)?(e.removeEventListener("mousemove",t),v.current=null):w(n.clientX,n.clientY)}if(!i.current.openEvent||Ot(i.current.openEvent)){e.addEventListener("mousemove",t);const n=()=>{e.removeEventListener("mousemove",t),v.current=null};return v.current=n,n}c.setPositionReference(u)}),[T,l,h,f,s,i,c,u,w]);r.useEffect((()=>A()),[A,b]),r.useEffect((()=>{l&&!s&&(p.current=!1)}),[l,s]),r.useEffect((()=>{!l&&n&&(p.current=!0)}),[l,n]),pe((()=>{!l||null==h&&null==f||(p.current=!1,w(h,f))}),[l,h,f,w]);const S=r.useMemo((()=>{function e(e){let{pointerType:t}=e;y(t)}return{onPointerDown:e,onPointerEnter:e,onMouseMove:C,onMouseEnter:C}}),[C]);return r.useMemo((()=>l?{reference:S}:{}),[l,S])}const Rt={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},Dt={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Ut=e=>{var t,n;return{escapeKey:"boolean"==typeof e?e:null!=(t=null==e?void 0:e.escapeKey)&&t,outsidePress:"boolean"==typeof e?e:null==(n=null==e?void 0:e.outsidePress)||n}};function Lt(e,t){void 0===t&&(t={});const{open:n,onOpenChange:i,elements:s,dataRef:u}=e,{enabled:c=!0,escapeKey:l=!0,outsidePress:d=!0,outsidePressEvent:h="pointerdown",referencePress:f=!1,referencePressEvent:p="pointerdown",ancestorScroll:_=!1,bubbles:y,capture:b}=t,E=Le(),w=$("function"==typeof d?d:()=>!1),C="function"==typeof d?w:d,T=r.useRef(!1),A=r.useRef(!1),{escapeKey:S,outsidePress:I}=Ut(y),{escapeKey:N,outsidePress:k}=Ut(b),x=$((e=>{var t;if(!n||!c||!l||"Escape"!==e.key)return;const r=null==(t=u.current.floatingContext)?void 0:t.nodeId,o=E?Ye(E.nodesRef.current,r):[];if(!S&&(e.stopPropagation(),o.length>0)){let e=!0;if(o.forEach((t=>{var n;null==(n=t.context)||!n.open||t.context.dataRef.current.__escapeKeyBubbles||(e=!1)})),!e)return}i(!1,function(e){return"nativeEvent"in e}(e)?e.nativeEvent:e,"escape-key")})),O=$((e=>{var t;const n=()=>{var t;x(e),null==(t=g(e))||t.removeEventListener("keydown",n)};null==(t=g(e))||t.addEventListener("keydown",n)})),M=$((e=>{var t;const n=T.current;T.current=!1;const r=A.current;if(A.current=!1,"click"===h&&r)return;if(n)return;if("function"==typeof C&&!C(e))return;const c=g(e),l="["+qe("inert")+"]",d=v(s.floating).querySelectorAll(l);let f=(0,o.vq)(c)?c:null;for(;f&&!(0,o.eu)(f);){const e=(0,o.$4)(f);if((0,o.eu)(e)||!(0,o.vq)(e))break;f=e}if(d.length&&(0,o.vq)(c)&&!c.matches("html,body")&&!a(c,s.floating)&&Array.from(d).every((e=>!a(f,e))))return;if((0,o.sb)(c)&&U){const t=c.clientWidth>0&&c.scrollWidth>c.clientWidth,n=c.clientHeight>0&&c.scrollHeight>c.clientHeight;let r=n&&e.offsetX>c.clientWidth;if(n){"rtl"===(0,o.L9)(c).direction&&(r=e.offsetX<=c.offsetWidth-c.clientWidth)}if(r||t&&e.offsetY>c.clientHeight)return}const p=null==(t=u.current.floatingContext)?void 0:t.nodeId,_=E&&Ye(E.nodesRef.current,p).some((t=>{var n;return m(e,null==(n=t.context)?void 0:n.elements.floating)}));if(m(e,s.floating)||m(e,s.domReference)||_)return;const y=E?Ye(E.nodesRef.current,p):[];if(y.length>0){let e=!0;if(y.forEach((t=>{var n;null==(n=t.context)||!n.open||t.context.dataRef.current.__outsidePressBubbles||(e=!1)})),!e)return}i(!1,e,"outside-press")})),R=$((e=>{var t;const n=()=>{var t;M(e),null==(t=g(e))||t.removeEventListener(h,n)};null==(t=g(e))||t.addEventListener(h,n)}));r.useEffect((()=>{if(!n||!c)return;function e(e){i(!1,e,"ancestor-scroll")}u.current.__escapeKeyBubbles=S,u.current.__outsidePressBubbles=I;const t=v(s.floating);l&&t.addEventListener("keydown",N?O:x,N),C&&t.addEventListener(h,k?R:M,k);let r=[];return _&&((0,o.vq)(s.domReference)&&(r=(0,o.v9)(s.domReference)),(0,o.vq)(s.floating)&&(r=r.concat((0,o.v9)(s.floating))),!(0,o.vq)(s.reference)&&s.reference&&s.reference.contextElement&&(r=r.concat((0,o.v9)(s.reference.contextElement)))),r=r.filter((e=>{var n;return e!==(null==(n=t.defaultView)?void 0:n.visualViewport)})),r.forEach((t=>{t.addEventListener("scroll",e,{passive:!0})})),()=>{l&&t.removeEventListener("keydown",N?O:x,N),C&&t.removeEventListener(h,k?R:M,k),r.forEach((t=>{t.removeEventListener("scroll",e)}))}}),[u,s,l,C,h,n,i,_,c,S,I,x,N,O,M,k,R]),r.useEffect((()=>{T.current=!1}),[C,h]);const D=r.useMemo((()=>({onKeyDown:x,[Rt[p]]:e=>{f&&i(!1,e.nativeEvent,"reference-press")}})),[x,i,f,p]),U=r.useMemo((()=>({onKeyDown:x,onMouseDown(){A.current=!0},onMouseUp(){A.current=!0},[Dt[h]]:()=>{T.current=!0}})),[x,h]);return r.useMemo((()=>c?{reference:D,floating:U}:{}),[c,D,U])}function Pt(e){const{open:t=!1,onOpenChange:n,elements:i}=e,o=xe(),s=r.useRef({}),[a]=r.useState((()=>Me())),u=null!=Ue();const[c,l]=r.useState(i.reference),d=$(((e,t,r)=>{s.current.openEvent=e?t:void 0,a.emit("openchange",{open:e,event:t,reason:r,nested:u}),null==n||n(e,t,r)})),h=r.useMemo((()=>({setPositionReference:l})),[]),f=r.useMemo((()=>({reference:c||i.reference||null,floating:i.floating||null,domReference:i.reference})),[c,i.reference,i.floating]);return r.useMemo((()=>({dataRef:s,open:t,onOpenChange:d,elements:f,events:a,floatingId:o,refs:h})),[t,d,f,a,o,h])}function Ft(e){void 0===e&&(e={});const{nodeId:t}=e,n=Pt({...e,elements:{reference:null,floating:null,...e.elements}}),i=e.rootContext||n,s=i.elements,[a,u]=r.useState(null),[c,l]=r.useState(null),d=(null==s?void 0:s.reference)||a,h=r.useRef(null),f=Le();pe((()=>{d&&(h.current=d)}),[d]);const p=(0,W.we)({...e,elements:{...s,...c&&{reference:c}}}),_=r.useCallback((e=>{const t=(0,o.vq)(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),contextElement:e}:e;l(t),p.refs.setReference(t)}),[p.refs]),v=r.useCallback((e=>{((0,o.vq)(e)||null===e)&&(h.current=e,u(e)),((0,o.vq)(p.refs.reference.current)||null===p.refs.reference.current||null!==e&&!(0,o.vq)(e))&&p.refs.setReference(e)}),[p.refs]),m=r.useMemo((()=>({...p.refs,setReference:v,setPositionReference:_,domReference:h})),[p.refs,v,_]),g=r.useMemo((()=>({...p.elements,domReference:d})),[p.elements,d]),y=r.useMemo((()=>({...p,...i,refs:m,elements:g,nodeId:t})),[p,m,g,t,i]);return pe((()=>{i.dataRef.current.floatingContext=y;const e=null==f?void 0:f.nodesRef.current.find((e=>e.id===t));e&&(e.context=y)})),r.useMemo((()=>({...p,context:y,refs:m,elements:g})),[p,m,g,y])}function jt(e,t){void 0===t&&(t={});const{open:n,onOpenChange:i,events:u,dataRef:c,elements:l}=e,{enabled:f=!0,visibleOnly:_=!0}=t,m=r.useRef(!1),y=r.useRef(),E=r.useRef(!0);r.useEffect((()=>{if(!f)return;const e=(0,o.zk)(l.domReference);function t(){!n&&(0,o.sb)(l.domReference)&&l.domReference===s(v(l.domReference))&&(m.current=!0)}function r(){E.current=!0}return e.addEventListener("blur",t),e.addEventListener("keydown",r,!0),()=>{e.removeEventListener("blur",t),e.removeEventListener("keydown",r,!0)}}),[l.domReference,n,f]),r.useEffect((()=>{if(f)return u.on("openchange",e),()=>{u.off("openchange",e)};function e(e){let{reason:t}=e;"reference-press"!==t&&"escape-key"!==t||(m.current=!0)}}),[u,f]),r.useEffect((()=>()=>{clearTimeout(y.current)}),[]);const w=r.useMemo((()=>({onPointerDown(e){d(e.nativeEvent)||(E.current=!1)},onMouseLeave(){m.current=!1},onFocus(e){if(m.current)return;const t=g(e.nativeEvent);if(_&&(0,o.vq)(t))try{if(h()&&p())throw Error();if(!t.matches(":focus-visible"))return}catch(e){if(!E.current&&!b(t))return}i(!0,e.nativeEvent,"focus")},onBlur(e){m.current=!1;const t=e.relatedTarget,n=e.nativeEvent,r=(0,o.vq)(t)&&t.hasAttribute(qe("focus-guard"))&&"outside"===t.getAttribute("data-type");y.current=window.setTimeout((()=>{var e;const o=s(l.domReference?l.domReference.ownerDocument:document);(t||o!==l.domReference)&&(a(null==(e=c.current.floatingContext)?void 0:e.refs.floating.current,o)||a(l.domReference,o)||r||i(!1,n,"focus"))}))}})),[c,l.domReference,i,_]);return r.useMemo((()=>f?{reference:w}:{}),[f,w])}const qt="active",Ht="selected";function Vt(e,t,n){const r=new Map,i="item"===n;let o=e;if(i&&e){const{[qt]:t,[Ht]:n,...r}=e;o=r}return{..."floating"===n&&{tabIndex:-1},...o,...t.map((t=>{const r=t?t[n]:null;return"function"==typeof r?e?r(e):null:r})).concat(e).reduce(((e,t)=>t?(Object.entries(t).forEach((t=>{let[n,o]=t;var s;i&&[qt,Ht].includes(n)||(0===n.indexOf("on")?(r.has(n)||r.set(n,[]),"function"==typeof o&&(null==(s=r.get(n))||s.push(o),e[n]=function(){for(var e,t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return null==(e=r.get(n))?void 0:e.map((e=>e(...i))).find((e=>void 0!==e))})):e[n]=o)})),e):e),{})}}function Bt(e){void 0===e&&(e=[]);const t=e.map((e=>null==e?void 0:e.reference)),n=e.map((e=>null==e?void 0:e.floating)),i=e.map((e=>null==e?void 0:e.item)),o=r.useCallback((t=>Vt(t,e,"reference")),t),s=r.useCallback((t=>Vt(t,e,"floating")),n),a=r.useCallback((t=>Vt(t,e,"item")),i);return r.useMemo((()=>({getReferenceProps:o,getFloatingProps:s,getItemProps:a})),[o,s,a])}let zt=!1;function Gt(e,t,n){switch(e){case"vertical":return t;case"horizontal":return n;default:return t||n}}function Wt(e,t){return Gt(t,e===X||e===J,e===ee||e===te)}function Kt(e,t,n){return Gt(t,e===J,n?e===ee:e===te)||"Enter"===e||" "===e||""===e}function Qt(e,t,n){return Gt(t,n?e===te:e===ee,e===X)}function Zt(e,t){const{open:n,onOpenChange:i,elements:u}=e,{listRef:c,activeIndex:f,onNavigate:_=(()=>{}),enabled:m=!0,selectedIndex:g=null,allowEscape:y=!1,loop:b=!1,nested:C=!1,rtl:T=!1,virtual:A=!1,focusItemOnOpen:S="auto",focusItemOnHover:I=!0,openOnArrowKeyDown:N=!0,disabledIndices:k,orientation:x="vertical",cols:O=1,scrollItemIntoView:M=!0,virtualItemRef:R,itemSizes:D,dense:U=!1}=t;const L=Ue(),P=Le(),F=$(_),j=r.useRef(S),q=r.useRef(null!=g?g:-1),H=r.useRef(null),V=r.useRef(!0),B=r.useRef(F),z=r.useRef(!!u.floating),G=r.useRef(n),W=r.useRef(!1),K=r.useRef(!1),Q=He(k),Z=He(n),Y=He(M),X=He(u.floating),ne=He(g),[he,_e]=r.useState(),[ve,me]=r.useState(),ge=$((function(e,t,n){function r(e){A?(_e(e.id),null==P||P.events.emit("virtualfocus",e),R&&(R.current=e)):fe(e,{preventScroll:!0,sync:!(!p()||!h())&&(zt||W.current)})}void 0===n&&(n=!1);const i=e.current[t.current];i&&r(i),requestAnimationFrame((()=>{const o=e.current[t.current]||i;if(!o)return;i||r(o);const s=Y.current;s&&be&&(n||!V.current)&&(null==o.scrollIntoView||o.scrollIntoView("boolean"==typeof s?{block:"nearest",inline:"nearest"}:s))}))}));pe((()=>{document.createElement("div").focus({get preventScroll(){return zt=!0,!1}})}),[]),pe((()=>{m&&(n&&u.floating?j.current&&null!=g&&(K.current=!0,q.current=g,F(g)):z.current&&(q.current=-1,B.current(null)))}),[m,n,u.floating,g,F]),pe((()=>{if(m&&n&&u.floating)if(null==f){if(W.current=!1,null!=ne.current)return;if(z.current&&(q.current=-1,ge(c,q)),(!G.current||!z.current)&&j.current&&(null!=H.current||!0===j.current&&null==H.current)){let e=0;const t=()=>{if(null==c.current[0]){if(e<2){(e?requestAnimationFrame:queueMicrotask)(t)}e++}else q.current=null==H.current||Kt(H.current,x,T)||C?ie(c,Q.current):oe(c,Q.current),H.current=null,F(q.current)};t()}}else re(c,f)||(q.current=f,ge(c,q,K.current),K.current=!1)}),[m,n,u.floating,f,ne,C,c,x,T,F,ge,Q]),pe((()=>{var e;if(!m||u.floating||!P||A||!z.current)return;const t=P.nodesRef.current,n=null==(e=t.find((e=>e.id===L)))||null==(e=e.context)?void 0:e.elements.floating,r=s(v(u.floating)),i=t.some((e=>e.context&&a(e.context.elements.floating,r)));n&&!i&&V.current&&n.focus({preventScroll:!0})}),[m,u.floating,P,L,A]),pe((()=>{if(m&&P&&A&&!L)return P.events.on("virtualfocus",e),()=>{P.events.off("virtualfocus",e)};function e(e){me(e.id),R&&(R.current=e)}}),[m,P,A,L,R]),pe((()=>{B.current=F,z.current=!!u.floating})),pe((()=>{n||(H.current=null)}),[n]),pe((()=>{G.current=n}),[n]);const ye=null!=f,be=r.useMemo((()=>{function e(e){if(!n)return;const t=c.current.indexOf(e);-1!==t&&F(t)}return{onFocus(t){let{currentTarget:n}=t;e(n)},onClick:e=>{let{currentTarget:t}=e;return t.focus({preventScroll:!0})},...I&&{onMouseMove(t){let{currentTarget:n}=t;e(n)},onPointerLeave(e){let{pointerType:t}=e;V.current&&"touch"!==t&&(q.current=-1,ge(c,q),F(null),A||fe(X.current,{preventScroll:!0}))}}}}),[n,X,ge,I,c,F,A]),Ee=$((e=>{if(V.current=!1,W.current=!0,!Z.current&&e.currentTarget===X.current)return;if(C&&Qt(e.key,x,T))return E(e),i(!1,e.nativeEvent,"list-navigation"),void((0,o.sb)(u.domReference)&&!A&&u.domReference.focus());const t=q.current,r=ie(c,k),a=oe(c,k);if("Home"===e.key&&(E(e),q.current=r,F(q.current)),"End"===e.key&&(E(e),q.current=a,F(q.current)),O>1){const t=D||Array.from({length:c.current.length},(()=>({width:1,height:1}))),n=ue(t,O,U),i=n.findIndex((e=>null!=e&&!de(c.current,e,k))),o=n.reduce(((e,t,n)=>null==t||de(c.current,t,k)?e:n),-1);if(q.current=n[ae({current:n.map((e=>null!=e?c.current[e]:null))},{event:e,orientation:x,loop:b,cols:O,disabledIndices:le([...k||c.current.map(((e,t)=>de(c.current,t)?t:void 0)),void 0],n),minIndex:i,maxIndex:o,prevIndex:ce(q.current>a?r:q.current,t,n,O,e.key===J?"bl":e.key===te?"tr":"tl"),stopEvent:!0})],F(q.current),"both"===x)return}if(Wt(e.key,x)){if(E(e),n&&!A&&s(e.currentTarget.ownerDocument)===e.currentTarget)return q.current=Kt(e.key,x,T)?r:a,void F(q.current);Kt(e.key,x,T)?q.current=b?t>=a?y&&t!==c.current.length?-1:r:se(c,{startingIndex:t,disabledIndices:k}):Math.min(a,se(c,{startingIndex:t,disabledIndices:k})):q.current=b?t<=r?y&&-1!==t?c.current.length:a:se(c,{startingIndex:t,decrement:!0,disabledIndices:k}):Math.max(r,se(c,{startingIndex:t,decrement:!0,disabledIndices:k})),re(c,q.current)?F(null):F(q.current)}})),we=r.useMemo((()=>A&&n&&ye&&{"aria-activedescendant":ve||he}),[A,n,ye,ve,he]),Ce=r.useMemo((()=>({"aria-orientation":"both"===x?void 0:x,...!w(u.domReference)&&we,onKeyDown:Ee,onPointerMove(){V.current=!0}})),[we,Ee,u.domReference,x]),Te=r.useMemo((()=>{function e(e){"auto"===S&&l(e.nativeEvent)&&(j.current=!0)}return{...we,onKeyDown(e){V.current=!1;const t=0===e.key.indexOf("Arrow"),r=function(e,t,n){return Gt(t,n?e===ee:e===te,e===J)}(e.key,x,T),o=Qt(e.key,x,T),s=Wt(e.key,x),a=(C?r:s)||"Enter"===e.key||""===e.key.trim();if(A&&n){const n=null==P?void 0:P.nodesRef.current.find((e=>null==e.parentId)),i=P&&n?function(e,t){let n,r=-1;return function t(i,o){o>r&&(n=i,r=o),Ye(e,i).forEach((e=>{t(e.id,o+1)}))}(t,0),e.find((e=>e.id===n))}(P.nodesRef.current,n.id):null;if(t&&i&&R){const t=new KeyboardEvent("keydown",{key:e.key,bubbles:!0});if(r||o){var u,l;const n=(null==(u=i.context)?void 0:u.elements.domReference)===e.currentTarget,s=o&&!n?null==(l=i.context)?void 0:l.elements.domReference:r?c.current.find((e=>(null==e?void 0:e.id)===he)):null;s&&(E(e),s.dispatchEvent(t),me(void 0))}var d;if(s&&i.context)if(i.context.open&&i.parentId&&e.currentTarget!==i.context.elements.domReference)return E(e),void(null==(d=i.context.elements.domReference)||d.dispatchEvent(t))}return Ee(e)}(n||N||!t)&&(a&&(H.current=C&&s?null:e.key),C?r&&(E(e),n?(q.current=ie(c,Q.current),F(q.current)):i(!0,e.nativeEvent,"list-navigation")):s&&(null!=g&&(q.current=g),E(e),!n&&N?i(!0,e.nativeEvent,"list-navigation"):Ee(e),n&&F(q.current)))},onFocus(){n&&!A&&F(null)},onPointerDown:function(e){j.current=S,"auto"===S&&d(e.nativeEvent)&&(j.current=!0)},onMouseDown:e,onClick:e}}),[he,we,Ee,Q,S,c,C,F,i,n,N,x,T,g,P,A,R]);return r.useMemo((()=>m?{reference:Te,floating:Ce,item:be}:{}),[m,Te,Ce,be])}const Yt=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]);function $t(e,t){var n;void 0===t&&(t={});const{open:i,floatingId:o}=e,{enabled:s=!0,role:a="dialog"}=t,u=null!=(n=Yt.get(a))?n:a,c=xe(),l=null!=Ue(),d=r.useMemo((()=>"tooltip"===u||"label"===a?{["aria-"+("label"===a?"labelledby":"describedby")]:i?o:void 0}:{"aria-expanded":i?"true":"false","aria-haspopup":"alertdialog"===u?"dialog":u,"aria-controls":i?o:void 0,..."listbox"===u&&{role:"combobox"},..."menu"===u&&{id:c},..."menu"===u&&l&&{role:"menuitem"},..."select"===a&&{"aria-autocomplete":"none"},..."combobox"===a&&{"aria-autocomplete":"list"}}),[u,o,l,i,c,a]),h=r.useMemo((()=>{const e={id:o,...u&&{role:u}};return"tooltip"===u||"label"===a?e:{...e,..."menu"===u&&{"aria-labelledby":c}}}),[u,o,c,a]),f=r.useCallback((e=>{let{active:t,selected:n}=e;const r={role:"option",...t&&{id:o+"-option"}};switch(a){case"select":return{...r,"aria-selected":t&&n};case"combobox":return{...r,...t&&{"aria-selected":!0}}}return{}}),[o,a]);return r.useMemo((()=>s?{reference:d,floating:h,item:f}:{}),[s,d,h,f])}const Xt=e=>e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,((e,t)=>(t?"-":"")+e.toLowerCase()));function Jt(e,t){return"function"==typeof e?e(t):e}function en(e,t){void 0===t&&(t={});const{open:n,elements:{floating:i}}=e,{duration:o=250}=t,s=("number"==typeof o?o:o.close)||0,[a,u]=r.useState("unmounted"),c=function(e,t){const[n,i]=r.useState(e);return e&&!n&&i(!0),r.useEffect((()=>{if(!e&&n){const e=setTimeout((()=>i(!1)),t);return()=>clearTimeout(e)}}),[e,n,t]),n}(n,s);return c||"close"!==a||u("unmounted"),pe((()=>{if(i){if(n){u("initial");const e=requestAnimationFrame((()=>{u("open")}));return()=>{cancelAnimationFrame(e)}}u("close")}}),[n,i]),{isMounted:c,status:a}}function tn(e,t){void 0===t&&(t={});const{initial:n={opacity:0},open:i,close:o,common:s,duration:a=250}=t,u=e.placement,c=u.split("-")[0],l=r.useMemo((()=>({side:c,placement:u})),[c,u]),d="number"==typeof a,h=(d?a:a.open)||0,f=(d?a:a.close)||0,[p,_]=r.useState((()=>({...Jt(s,l),...Jt(n,l)}))),{isMounted:v,status:m}=en(e,{duration:a}),g=He(n),y=He(i),b=He(o),E=He(s);return pe((()=>{const e=Jt(g.current,l),t=Jt(b.current,l),n=Jt(E.current,l),r=Jt(y.current,l)||Object.keys(e).reduce(((e,t)=>(e[t]="",e)),{});if("initial"===m&&_((t=>({transitionProperty:t.transitionProperty,...n,...e}))),"open"===m&&_({transitionProperty:Object.keys(r).map(Xt).join(","),transitionDuration:h+"ms",...n,...r}),"close"===m){const r=t||e;_({transitionProperty:Object.keys(r).map(Xt).join(","),transitionDuration:f+"ms",...n,...r})}}),[f,b,g,y,E,h,m,l]),{isMounted:v,styles:p}}function nn(e,t){var n;const{open:i,dataRef:o}=e,{listRef:s,activeIndex:a,onMatch:u,onTypingChange:c,enabled:l=!0,findMatch:d=null,resetMs:h=750,ignoreKeys:f=[],selectedIndex:p=null}=t,_=r.useRef(),v=r.useRef(""),m=r.useRef(null!=(n=null!=p?p:a)?n:-1),g=r.useRef(null),y=$(u),b=$(c),w=He(d),C=He(f);pe((()=>{i&&(clearTimeout(_.current),g.current=null,v.current="")}),[i]),pe((()=>{var e;i&&""===v.current&&(m.current=null!=(e=null!=p?p:a)?e:-1)}),[i,p,a]);const T=$((e=>{e?o.current.typing||(o.current.typing=e,b(e)):o.current.typing&&(o.current.typing=e,b(e))})),A=$((e=>{function t(e,t,n){const r=w.current?w.current(t,n):t.find((e=>0===(null==e?void 0:e.toLocaleLowerCase().indexOf(n.toLocaleLowerCase()))));return r?e.indexOf(r):-1}const n=s.current;if(v.current.length>0&&" "!==v.current[0]&&(-1===t(n,n,v.current)?T(!1):" "===e.key&&E(e)),null==n||C.current.includes(e.key)||1!==e.key.length||e.ctrlKey||e.metaKey||e.altKey)return;i&&" "!==e.key&&(E(e),T(!0));n.every((e=>{var t,n;return!e||(null==(t=e[0])?void 0:t.toLocaleLowerCase())!==(null==(n=e[1])?void 0:n.toLocaleLowerCase())}))&&v.current===e.key&&(v.current="",m.current=g.current),v.current+=e.key,clearTimeout(_.current),_.current=setTimeout((()=>{v.current="",m.current=g.current,T(!1)}),h);const r=m.current,o=t(n,[...n.slice((r||0)+1),...n.slice(0,(r||0)+1)],v.current);-1!==o?(y(o),g.current=o):" "!==e.key&&(v.current="",T(!1))})),S=r.useMemo((()=>({onKeyDown:A})),[A]),I=r.useMemo((()=>({onKeyDown:A,onKeyUp(e){" "===e.key&&T(!1)}})),[A,T]);return r.useMemo((()=>l?{reference:S,floating:I}:{}),[l,S,I])}function rn(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}const on=e=>({name:"inner",options:e,async fn(t){const{listRef:n,overflowRef:r,onFallbackChange:i,offset:o=0,index:s=0,minItemsVisible:a=4,referenceOverflowThreshold:u=0,scrollRef:c,...l}=(0,C._3)(e,t),{rects:d,elements:{floating:h}}=t,f=n.current[s];if(!f)return{};const p={...t,...await(0,W.cY)(-f.offsetTop-h.clientTop-d.reference.height/2-f.offsetHeight/2-o).fn(t)},_=(null==c?void 0:c.current)||h,v=await(0,K.__)(rn(p,_.scrollHeight),l),m=await(0,K.__)(p,{...l,elementContext:"reference"}),g=Math.max(0,v.top),y=p.y+g,b=Math.max(0,_.scrollHeight-g-Math.max(0,v.bottom));return _.style.maxHeight=b+"px",_.scrollTop=g,i&&(_.offsetHeight<f.offsetHeight*Math.min(a,n.current.length-1)-1||m.top>=-u||m.bottom>=-u?G.flushSync((()=>i(!0))):G.flushSync((()=>i(!1)))),r&&(r.current=await(0,K.__)(rn({...p,y:y},_.offsetHeight),l)),{y:y}}});function sn(e,t){const{open:n,elements:i}=e,{enabled:o=!0,overflowRef:s,scrollRef:a,onChange:u}=t,l=$(u),d=r.useRef(!1),h=r.useRef(null),f=r.useRef(null);r.useEffect((()=>{if(!o)return;function e(e){if(e.ctrlKey||!t||null==s.current)return;const n=e.deltaY,r=s.current.top>=-.5,i=s.current.bottom>=-.5,o=t.scrollHeight-t.clientHeight,a=n<0?-1:1,u=n<0?"max":"min";t.scrollHeight<=t.clientHeight||(!r&&n>0||!i&&n<0?(e.preventDefault(),G.flushSync((()=>{l((e=>e+Math[u](n,o*a)))}))):/firefox/i.test(c())&&(t.scrollTop+=n))}const t=(null==a?void 0:a.current)||i.floating;return n&&t?(t.addEventListener("wheel",e),requestAnimationFrame((()=>{h.current=t.scrollTop,null!=s.current&&(f.current={...s.current})})),()=>{h.current=null,f.current=null,t.removeEventListener("wheel",e)}):void 0}),[o,n,i.floating,s,a,l]);const p=r.useMemo((()=>({onKeyDown(){d.current=!0},onWheel(){d.current=!1},onPointerMove(){d.current=!1},onScroll(){const e=(null==a?void 0:a.current)||i.floating;if(s.current&&e&&d.current){if(null!==h.current){const t=e.scrollTop-h.current;(s.current.bottom<-.5&&t<-1||s.current.top<-.5&&t>1)&&G.flushSync((()=>l((e=>e+t))))}requestAnimationFrame((()=>{h.current=e.scrollTop}))}}})),[i.floating,l,s,a]);return r.useMemo((()=>o?{floating:p}:{}),[o,p])}function an(e,t){const[n,r]=e;let i=!1;const o=t.length;for(let e=0,s=o-1;e<o;s=e++){const[o,a]=t[e]||[0,0],[u,c]=t[s]||[0,0];a>=r!=c>=r&&n<=(u-o)*(r-a)/(c-a)+o&&(i=!i)}return i}function un(e){void 0===e&&(e={});const{buffer:t=.5,blockPointerEvents:n=!1,requireIntent:r=!0}=e;let i,s=!1,u=null,c=null,l=performance.now();const d=e=>{let{x:n,y:d,placement:h,elements:f,onClose:p,nodeId:_,tree:v}=e;return function(e){function m(){clearTimeout(i),p()}if(clearTimeout(i),!f.domReference||!f.floating||null==h||null==n||null==d)return;const{clientX:y,clientY:b}=e,E=[y,b],w=g(e),C="mouseleave"===e.type,T=a(f.floating,w),A=a(f.domReference,w),S=f.domReference.getBoundingClientRect(),I=f.floating.getBoundingClientRect(),N=h.split("-")[0],k=n>I.right-I.width/2,x=d>I.bottom-I.height/2,O=function(e,t){return e[0]>=t.x&&e[0]<=t.x+t.width&&e[1]>=t.y&&e[1]<=t.y+t.height}(E,S),M=I.width>S.width,R=I.height>S.height,D=(M?S:I).left,U=(M?S:I).right,L=(R?S:I).top,P=(R?S:I).bottom;if(T&&(s=!0,!C))return;if(A&&(s=!1),A&&!C)return void(s=!0);if(C&&(0,o.vq)(e.relatedTarget)&&a(f.floating,e.relatedTarget))return;if(v&&Ye(v.nodesRef.current,_).some((e=>{let{context:t}=e;return null==t?void 0:t.open})))return;if("top"===N&&d>=S.bottom-1||"bottom"===N&&d<=S.top+1||"left"===N&&n>=S.right-1||"right"===N&&n<=S.left+1)return m();let F=[];switch(N){case"top":F=[[D,S.top+1],[D,I.bottom-1],[U,I.bottom-1],[U,S.top+1]];break;case"bottom":F=[[D,I.top+1],[D,S.bottom-1],[U,S.bottom-1],[U,I.top+1]];break;case"left":F=[[I.right-1,P],[I.right-1,L],[S.left+1,L],[S.left+1,P]];break;case"right":F=[[S.right-1,P],[S.right-1,L],[I.left+1,L],[I.left+1,P]]}if(!an([y,b],F)){if(s&&!O)return m();if(!C&&r){const t=function(e,t){const n=performance.now(),r=n-l;if(null===u||null===c||0===r)return u=e,c=t,l=n,null;const i=e-u,o=t-c,s=Math.sqrt(i*i+o*o);return u=e,c=t,l=n,s/r}(e.clientX,e.clientY);if(null!==t&&t<.1)return m()}an([y,b],function(e){let[n,r]=e;switch(N){case"top":return[[M?n+t/2:k?n+4*t:n-4*t,r+t+1],[M?n-t/2:k?n+4*t:n-4*t,r+t+1],...[[I.left,k||M?I.bottom-t:I.top],[I.right,k?M?I.bottom-t:I.top:I.bottom-t]]];case"bottom":return[[M?n+t/2:k?n+4*t:n-4*t,r-t],[M?n-t/2:k?n+4*t:n-4*t,r-t],...[[I.left,k||M?I.top+t:I.bottom],[I.right,k?M?I.top+t:I.bottom:I.top+t]]];case"left":{const e=[n+t+1,R?r+t/2:x?r+4*t:r-4*t],i=[n+t+1,R?r-t/2:x?r+4*t:r-4*t];return[...[[x||R?I.right-t:I.left,I.top],[x?R?I.right-t:I.left:I.right-t,I.bottom]],e,i]}case"right":return[[n-t,R?r+t/2:x?r+4*t:r-4*t],[n-t,R?r-t/2:x?r+4*t:r-4*t],...[[x||R?I.left+t:I.right,I.top],[x?R?I.left+t:I.right:I.left+t,I.bottom]]]}}([n,d]))?!s&&r&&(i=window.setTimeout(m,40)):m()}}};return d.__options={blockPointerEvents:n},d}},1860:function(e,t,n){function r(e){return s(e)?(e.nodeName||"").toLowerCase():"#document"}function i(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function o(e){var t;return null==(t=(s(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function s(e){return e instanceof Node||e instanceof i(e).Node}function a(e){return e instanceof Element||e instanceof i(e).Element}function u(e){return e instanceof HTMLElement||e instanceof i(e).HTMLElement}function c(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof i(e).ShadowRoot)}function l(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=m(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function d(e){return["table","td","th"].includes(r(e))}function h(e){return[":popover-open",":modal"].some((t=>{try{return e.matches(t)}catch(e){return!1}}))}function f(e){const t=_(),n=a(e)?m(e):e;return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function p(e){let t=y(e);for(;u(t)&&!v(t);){if(f(t))return t;if(h(t))return null;t=y(t)}return null}function _(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function v(e){return["html","body","#document"].includes(r(e))}function m(e){return i(e).getComputedStyle(e)}function g(e){return a(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function y(e){if("html"===r(e))return e;const t=e.assignedSlot||e.parentNode||c(e)&&e.host||o(e);return c(t)?t.host:t}function b(e){const t=y(e);return v(t)?e.ownerDocument?e.ownerDocument.body:e.body:u(t)&&l(t)?t:b(t)}function E(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const o=b(e),s=o===(null==(r=e.ownerDocument)?void 0:r.body),a=i(o);if(s){const e=w(a);return t.concat(a,a.visualViewport||[],l(o)?o:[],e&&n?E(e):[])}return t.concat(o,E(o,[],n))}function w(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}n.d(t,{$4:function(){return y},CP:function(){return g},L9:function(){return m},Lv:function(){return d},Ng:function(){return c},Tc:function(){return _},Tf:function(){return h},ZU:function(){return l},_m:function(){return w},ep:function(){return o},eu:function(){return v},gJ:function(){return p},mq:function(){return r},sQ:function(){return f},sb:function(){return u},v9:function(){return E},vq:function(){return a},zk:function(){return i}})},2166:function(e,t,n){n.d(t,{B1:function(){return I},C0:function(){return _},DD:function(){return o},Dz:function(){return b},Jx:function(){return l},LI:function(){return u},PG:function(){return m},RI:function(){return c},Sg:function(){return v},T9:function(){return a},TV:function(){return y},WJ:function(){return w},_3:function(){return p},aD:function(){return C},bV:function(){return A},jk:function(){return s},lP:function(){return T},nI:function(){return S},qE:function(){return f},r_:function(){return r},sq:function(){return g},w7:function(){return E}});const r=["top","right","bottom","left"],i=["start","end"],o=r.reduce(((e,t)=>e.concat(t,t+"-"+i[0],t+"-"+i[1])),[]),s=Math.min,a=Math.max,u=Math.round,c=Math.floor,l=e=>({x:e,y:e}),d={left:"right",right:"left",bottom:"top",top:"bottom"},h={start:"end",end:"start"};function f(e,t,n){return a(e,s(t,n))}function p(e,t){return"function"==typeof e?e(t):e}function _(e){return e.split("-")[0]}function v(e){return e.split("-")[1]}function m(e){return"x"===e?"y":"x"}function g(e){return"y"===e?"height":"width"}function y(e){return["top","bottom"].includes(_(e))?"y":"x"}function b(e){return m(y(e))}function E(e,t,n){void 0===n&&(n=!1);const r=v(e),i=b(e),o=g(i);let s="x"===i?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=A(s)),[s,A(s)]}function w(e){const t=A(e);return[C(e),t,C(t)]}function C(e){return e.replace(/start|end/g,(e=>h[e]))}function T(e,t,n,r){const i=v(e);let o=function(e,t,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?o:s;default:return[]}}(_(e),"start"===n,r);return i&&(o=o.map((e=>e+"-"+i)),t&&(o=o.concat(o.map(C)))),o}function A(e){return e.replace(/left|right|bottom|top/g,(e=>d[e]))}function S(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function I(e){const{x:t,y:n,width:r,height:i}=e;return{width:r,height:i,top:n,left:t,right:t+r,bottom:n+i,x:t,y:n}}},4604:function(e,t,n){function r(...e){return(...t)=>{for(let n of e)"function"==typeof n&&n(...t)}}n.d(t,{v:function(){return u}});n(1594);Boolean("undefined"!=typeof window&&window.document&&window.document.createElement);let i=new Map;function o(e,t){if(e===t)return e;let n=i.get(e);if(n)return n(t),t;let r=i.get(t);return r?(r(e),e):t}function s(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=s(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}var a=function(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=s(e))&&(r&&(r+=" "),r+=t);return r};function u(...e){let t={...e[0]};for(let n=1;n<e.length;n++){let i=e[n];for(let e in i){let n=t[e],s=i[e];"function"==typeof n&&"function"==typeof s&&"o"===e[0]&&"n"===e[1]&&e.charCodeAt(2)>=65&&e.charCodeAt(2)<=90?t[e]=r(n,s):"className"!==e&&"UNSAFE_className"!==e||"string"!=typeof n||"string"!=typeof s?"id"===e&&n&&s?t.id=o(n,s):t[e]=void 0!==s?s:n:t[e]=a(n,s)}}return t}},5539:function(e,t,n){n.d(t,{xg:function(){return en},Lc:function(){return on}});var r,i,o=n(9851),s=n(8777),a=n(4445),u=n(2217);(i=r||(r={})).NONE="none",i.JOINED="joined",i.INVITED="invited",i.LEFT="left";var c,l,d,h,f,p,_,v,m=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.state=null,i.role=null,i.isMuted=!1,i.isBlockedByMe=!1,i.isBlockingMe=!1,i.state=(0,o.T)(r,n.state)?n.state:null,i.role=(0,o.T)(o.a3,n.role)?n.role:null,"boolean"==typeof n.is_muted&&(i.isMuted=n.is_muted),"boolean"==typeof n.is_blocked_by_me&&(i.isBlockedByMe=n.is_blocked_by_me),"boolean"==typeof n.is_blocking_me&&(i.isBlockingMe=n.is_blocking_me),i}return(0,o.c)(t,e),t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{state:t.state,role:t.role,is_muted:t.isMuted,is_blocked_by_me:t.isBlockedByMe,is_blocking_me:t.isBlockingMe})))},t}(s.D),g=function(e){function t(t,n){var r,i,s=this;return(s=e.call(this,t)||this).channelUrl=null!==(r=n.channel_url)&&void 0!==r?r:"",s.channelType=null!==(i=n.channel_type)&&void 0!==i?i:o.C.GROUP,s.reader=new o.U(s._iid,n.user),s.readAt=n.ts,s}return(0,o.c)(t,e),t}(o.aa);!function(e){e.ALL="all",e.PUBLIC="public",e.PRIVATE="private"}(c||(c={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(l||(l={})),function(e){e.ALL="all",e.SUPER="super",e.NON_SUPER="nonsuper",e.BROADCAST_ONLY="broadcast_only",e.EXCLUSIVE_ONLY="exclusive_only"}(d||(d={})),function(e){e.ALL="all",e.UNREAD_MESSAGE="unread_message"}(h||(h={})),function(e){e.ALL="all",e.UNHIDDEN="unhidden_only",e.HIDDEN="hidden_only",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(f||(f={})),function(e){e.ALL="all",e.OPERATOR="operator",e.NONOPERATOR="nonoperator"}(p||(p={})),function(e){e.AND="AND",e.OR="OR"}(_||(_={})),function(e){e.MEMBER_NICKNAME="member_nickname",e.CHANNEL_NAME="channel_name"}(v||(v={}));var y,b=function(){function e(e){var t,n,r,i,o,s,a,u,p,_,v,m,g,y;this._searchFilter=null,this._userIdsFilter=null,this.includeEmpty=null!==(t=null==e?void 0:e.includeEmpty)&&void 0!==t&&t,this.nicknameContainsFilter=null!==(n=null==e?void 0:e.nicknameContainsFilter)&&void 0!==n?n:null,this.nicknameStartsWithFilter=null!==(r=null==e?void 0:e.nicknameStartsWithFilter)&&void 0!==r?r:null,this.nicknameExactMatchFilter=null!==(i=null==e?void 0:e.nicknameExactMatchFilter)&&void 0!==i?i:null,this.channelNameContainsFilter=null!==(o=null==e?void 0:e.channelNameContainsFilter)&&void 0!==o?o:"",this.myMemberStateFilter=null!==(s=null==e?void 0:e.myMemberStateFilter)&&void 0!==s?s:l.ALL,this.customTypesFilter=null!==(a=null==e?void 0:e.customTypesFilter)&&void 0!==a?a:null,this.channelUrlsFilter=null!==(u=null==e?void 0:e.channelUrlsFilter)&&void 0!==u?u:null,this.superChannelFilter=null!==(p=null==e?void 0:e.superChannelFilter)&&void 0!==p?p:d.ALL,this.publicChannelFilter=null!==(_=null==e?void 0:e.publicChannelFilter)&&void 0!==_?_:c.ALL,this.customTypeStartsWithFilter=null!==(v=null==e?void 0:e.customTypeStartsWithFilter)&&void 0!==v?v:null,this.unreadChannelFilter=null!==(m=null==e?void 0:e.unreadChannelFilter)&&void 0!==m?m:h.ALL,this.hiddenChannelFilter=null!==(g=null==e?void 0:e.hiddenChannelFilter)&&void 0!==g?g:f.UNHIDDEN,this.includeFrozen=null===(y=null==e?void 0:e.includeFrozen)||void 0===y||y,(null==e?void 0:e.createdAfter)&&(this.createdAfter=e.createdAfter),(null==e?void 0:e.createdBefore)&&(this.createdBefore=e.createdBefore)}return e.prototype._isFriend=function(e){return!(!e||!e.friendDiscoveryKey&&!e.friendName)},Object.defineProperty(e.prototype,"searchFilter",{get:function(){return this._searchFilter},enumerable:!1,configurable:!0}),e.prototype.setSearchFilter=function(e,t){Array.isArray(e)&&0!==e.length&&"string"==typeof t&&t&&(this._searchFilter={query:t,fields:e})},Object.defineProperty(e.prototype,"userIdsFilter",{get:function(){return this._userIdsFilter},enumerable:!1,configurable:!0}),e.prototype.setUserIdsFilter=function(e,t,n){void 0===n&&(n=_.AND),this._userIdsFilter={userIds:e,includeMode:t,queryType:n}},e.prototype.clone=function(){var t,n=new e;this.searchFilter&&n.setSearchFilter(this.searchFilter.fields,null!==(t=this.searchFilter.query)&&void 0!==t?t:void 0),this.userIdsFilter&&n.setUserIdsFilter(this.userIdsFilter.userIds,this.userIdsFilter.includeMode,this.userIdsFilter.queryType);var r=JSON.parse(JSON.stringify(this));return Object.keys(r).forEach((function(e){n[e]=r[e]})),n},e.prototype.match=function(e,t){if(this._searchFilter){var n=this._searchFilter,r=n.query,i=n.fields;if(r&&i&&i.length>0&&!i.some((function(t){switch(t){case v.CHANNEL_NAME:return e.name.toLowerCase().includes(r.toLowerCase());case v.MEMBER_NICKNAME:return e.members.some((function(e){return e.nickname.toLowerCase().includes(r.toLowerCase())}));default:return!0}})))return!1}if(this._userIdsFilter){var s=this._userIdsFilter,a=s.userIds,u=s.includeMode,p=s.queryType,m=e.members.map((function(e){return e.userId}));if(u){if(a.length>0)switch(p){case _.AND:if(a.some((function(e){return!m.includes(e)})))return!1;break;case _.OR:if(a.every((function(e){return!m.includes(e)})))return!1}}else{if(a.includes(t)||a.push(t),e.members.length>a.length)return!1;if(!(0,o.b6)(a,m))return!1}}if(!this.includeEmpty&&!e.lastMessage)return!1;if(!this.includeFrozen&&e.isFrozen)return!1;if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(e.customType))return!1;if(this.customTypeStartsWithFilter&&!new RegExp("^".concat(this.customTypeStartsWithFilter)).test(e.customType))return!1;if(this.channelNameContainsFilter&&!e.name.toLowerCase().includes(this.channelNameContainsFilter.toLowerCase()))return!1;if(this.nicknameContainsFilter){var g=this.nicknameContainsFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase().includes(g)})))return!1}if(this.nicknameStartsWithFilter){var y=this.nicknameStartsWithFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase().startsWith(y)})))return!1}if(this.nicknameExactMatchFilter){var b=this.nicknameExactMatchFilter.toLowerCase();if(!e.members.some((function(e){return e.userId!==t&&e.nickname.toLowerCase()!=b})))return!1}if(this.channelUrlsFilter&&this.channelUrlsFilter.length>0&&!this.channelUrlsFilter.includes(e.url))return!1;if(this.myMemberStateFilter)switch(this.myMemberStateFilter){case l.JOINED:if("joined"!==e.myMemberState)return!1;break;case l.INVITED:if("invited"!==e.myMemberState)return!1;break;case l.INVITED_BY_FRIEND:if("invited"!==e.myMemberState||!this._isFriend(e.inviter))return!1;break;case l.INVITED_BY_NON_FRIEND:if("invited"!==e.myMemberState||this._isFriend(e.inviter))return!1}if(this.hiddenChannelFilter)switch(this.hiddenChannelFilter){case f.UNHIDDEN:if(e.isHidden||"unhidden"!==e.hiddenState)return!1;break;case f.HIDDEN:if(!e.isHidden)return!1;break;case f.HIDDEN_ALLOW_AUTO_UNHIDE:if(!e.isHidden||"hidden_allow_auto_unhide"!==e.hiddenState)return!1;break;case f.HIDDEN_PREVENT_AUTO_UNHIDE:if(!e.isHidden||"hidden_prevent_auto_unhide"!==e.hiddenState)return!1}if(this.unreadChannelFilter&&this.unreadChannelFilter===h.UNREAD_MESSAGE&&0===e.unreadMessageCount)return!1;if(this.publicChannelFilter)switch(this.publicChannelFilter){case c.PUBLIC:if(!e.isPublic)return!1;break;case c.PRIVATE:if(e.isPublic)return!1}if(this.superChannelFilter)switch(this.superChannelFilter){case d.SUPER:if(!e.isSuper)return!1;break;case d.NON_SUPER:if(e.isSuper)return!1}return!(this.createdAfter&&e.createdAt<this.createdAfter||this.createdBefore&&e.createdAt>this.createdBefore)},e}(),E=function(e){function t(t,n){var r=n.sdkState,i=n.cacheContext,o=e.call(this,t)||this;return o._channels=new Map,o._sdkState=r,o._cacheContext=i,o}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return(0,o.t)(!!e).throw(o.r.databaseError),e.collection(s.a)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e,t){return void 0===t&&(t=0),(0,o.g)((0,o.g)({},e.serialize()),{lastMessageUpdatedAt:e.lastMessage?e.lastMessage.createdAt:0,syncIndex:t})},t.prototype._deserialize=function(e){return Oe.of(this._iid).buildGroupChannelFromSerializedData(e)},Object.defineProperty(t.prototype,"channels",{get:function(){return(0,o.o)([],(0,o.p)(this._channels.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.isCachedInMemory=function(e){return this._channels.has(e)},t.prototype.filterOffsetChanged=function(e){var t=this;return e.filter((function(e){if(t._channels.has(e.url))return t._channels.get(e.url).messageOffsetTimestamp<e.messageOffsetTimestamp}))},t.prototype.get=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return this._channels.has(e)?[3,3]:this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(t=r.sent())return n=this._deserialize(t),this._channels.set(e,n),[2,n];r.label=2;case 2:return[2,void 0];case 3:return[2,this._channels.get(e)]}}))}))},t.prototype.fetch=function(e){var t=e.token,n=e.limit,r=void 0===n?s.J:n,i=e.backward,u=void 0!==i&&i,c=e.filter,l=void 0===c?new b:c,d=e.order,h=void 0===d?a.G.LATEST_LAST_MESSAGE:d,f=e.borderlineChannelUrl;return(0,o._)(this,void 0,void 0,(function(){var e,n,i,s,c=this;return(0,o.b)(this,(function(o){switch(o.label){case 0:return this.localCacheEnabled?(e=(0,a.g)(h),n={where:function(e){if(t)switch(h){case a.G.CHANNEL_NAME_ALPHABETICAL:if(!u&&e.name.localeCompare(t)<0||u&&e.name.localeCompare(t)>0)return!1;if(f&&f===e.url)return!1;break;case a.G.CHRONOLOGICAL:if(!u&&e.createdAt>t||u&&e.createdAt<t)return!1;if(f&&f===e.url)return!1;break;case a.G.LATEST_LAST_MESSAGE:if(!u&&e.lastMessageUpdatedAt>t||u&&e.lastMessageUpdatedAt<t)return!1;if(f&&f===e.url)return!1}return l.match(c._deserialize(e),c._sdkState.userId)},index:e,backward:u},[4,this.collection.query(n)]):[3,3];case 1:return[4,o.sent().fetch({limit:r})];case 2:return i=o.sent(),(s=i.map((function(e){return c._deserialize(e)}))).forEach((function(e){c._channels.has(e.url)||c._channels.set(e.url,e)})),[2,s];case 3:return[2,[]]}}))}))},t.prototype.upsert=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i,s=this;return(0,o.b)(this,(function(o){switch(o.label){case 0:if(n=[],e.forEach((function(e){if(s._channels.has(e.url)){var r=s._channels.get(e.url);r._pinnedMessagesUpdatedAt<e._pinnedMessagesUpdatedAt&&(r._pinnedMessagesUpdatedAt=e._pinnedMessagesUpdatedAt),r._messageCollectionLastAccessedAt>e._messageCollectionLastAccessedAt&&Object.assign(e,{_messageCollectionLastAccessedAt:void 0}),e.cachedMetaData&&t&&(r._updateCachedMetaData(e.cachedMetaData,t),Object.assign(e,{_cachedMetaData:void 0})),r._update(e),n.push(r)}else s._channels.set(e.url,e),n.push(e)})),!this.localCacheEnabled)return[3,2];for(i in r=[],n)r.push(this._serialize(n[i],parseInt(i)));return[4,this.collection.upsertMany(r)];case 1:o.sent(),o.label=2;case 2:return[2,n]}}))}))},t.prototype.remove=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),t=(0,o.s)(e),n=t.next(),u.label=1;case 1:return n.done?[3,4]:(r=n.value,this._channels.delete(r),this.localCacheEnabled?[4,this.collection.remove(r)]:[3,3]);case 2:u.sent(),u.label=3;case 3:return n=t.next(),[3,1];case 4:return[3,7];case 5:return i=u.sent(),s={error:i},[3,7];case 6:try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return this.clearMemoryCache(),this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.clearMemoryCache=function(){this._channels.clear()},t.prototype._setBlockStateOfAllChannels=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i,s,a,u,c,l,d,h,f,p,_,v,m,g,y,b,E,w;return(0,o.b)(this,(function(C){switch(C.label){case 0:if(r=[],e===this._sdkState.userId)try{for(i=(0,o.s)(this._channels.values()),s=i.next();!s.done;s=i.next()){d=s.value;try{for(m=void 0,a=(0,o.s)(d.members),u=a.next();!u.done;u=a.next())if((p=u.value).userId===t){p.isBlockedByMe=n,r.push(d);break}}catch(e){m={error:e}}finally{try{u&&!u.done&&(g=a.return)&&g.call(a)}finally{if(m)throw m.error}}}}catch(e){_={error:e}}finally{try{s&&!s.done&&(v=i.return)&&v.call(i)}finally{if(_)throw _.error}}else if(t===this._sdkState.userId)try{for(c=(0,o.s)(this._channels.values()),l=c.next();!l.done;l=c.next()){d=l.value;try{for(E=void 0,h=(0,o.s)(d.members),f=h.next();!f.done;f=h.next())if((p=f.value).userId===e){p.isBlockingMe=n,r.push(d);break}}catch(e){E={error:e}}finally{try{f&&!f.done&&(w=h.return)&&w.call(h)}finally{if(E)throw E.error}}}}catch(e){y={error:e}}finally{try{l&&!l.done&&(b=c.return)&&b.call(c)}finally{if(y)throw y.error}}return r.length>0?[4,this.upsert(r)]:[3,2];case 1:C.sent(),C.label=2;case 2:return[2]}}))}))},t.prototype.block=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._setBlockStateOfAllChannels(e,t,!0)];case 1:return n.sent(),[2]}}))}))},t.prototype.unblock=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._setBlockStateOfAllChannels(e,t,!1)];case 1:return n.sent(),[2]}}))}))},t.prototype.markAsRead=function(e,t){return void 0===t&&(t=(0,o.o)([],(0,o.p)(this._channels.keys()),!1)),(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,l;return(0,o.b)(this,(function(d){switch(d.label){case 0:n=[],d.label=1;case 1:d.trys.push([1,6,7,8]),r=(0,o.s)(t),i=r.next(),d.label=2;case 2:return i.done?[3,5]:(s=i.value,[4,this.get(s)]);case 3:(null==(a=d.sent())?void 0:a._updateUnreadMemberState(this._sdkState.userId,e))&&(a._updateUnreadCount(0,0),n.push(a)),d.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return u=d.sent(),c={error:u},[3,8];case 7:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(c)throw c.error}return[7];case 8:return n.length>0?[4,this.upsert(n)]:[3,10];case 9:d.sent(),d.label=10;case 10:return[2]}}))}))},t}(o.aa),w={invitedUserIds:void 0,channelUrl:void 0,coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isSuper:void 0,isBroadcast:void 0,isExclusive:void 0,isPublic:void 0,isDiscoverable:void 0,isStrict:void 0,isEphemeral:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},C=function(e){return(0,o.O)("string",e.invitedUserIds,!0)&&(0,o.a)("string",e.channelUrl,!0)&&(0,o.a)("string",e.coverUrl,!0)&&((0,o.i)(e.coverImage)||(0,o.a)("string",e.coverImage,!0))&&(0,o.a)("boolean",e.isDistinct,!0)&&(0,o.a)("boolean",e.isSuper,!0)&&(0,o.a)("boolean",e.isBroadcast,!0)&&(0,o.a)("boolean",e.isExclusive,!0)&&(0,o.a)("boolean",e.isPublic,!0)&&(0,o.a)("boolean",e.isStrict,!0)&&(0,o.a)("boolean",e.isDiscoverable,!0)&&(0,o.a)("boolean",e.isEphemeral,!0)&&(0,o.a)("string",e.accessCode,!0)&&(0,o.a)("string",e.name,!0)&&(0,o.a)("string",e.data,!0)&&(0,o.a)("string",e.customType,!0)&&(0,o.O)("string",e.operatorUserIds,!0)&&(0,o.a)("number",e.messageSurvivalSeconds,!0)},T={customTypes:void 0,includeEmpty:!1,includeFrozen:!0,includeChatNotification:!1},A=function(e){return(0,o.O)("string",e.customTypes,!0)&&(0,o.a)("boolean",e.includeEmpty)&&(0,o.a)("boolean",e.includeFrozen)&&(0,o.a)("boolean",e.includeChatNotification)},S={myMemberStateFilter:l.ALL},I=function(e){return(0,o.T)(l,e.myMemberStateFilter)};!function(e){e.GROUP_CHANNEL_UNREAD_MENTION_COUNT="group_channel_unread_mention_count",e.NONSUPER_UNREAD_MENTION_COUNT="non_super_group_channel_unread_mention_count",e.SUPER_UNREAD_MENTION_COUNT="super_group_channel_unread_mention_count",e.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT="group_channel_unread_message_count",e.NONSUPER_UNREAD_MESSAGE_COUNT="non_super_group_channel_unread_message_count",e.SUPER_UNREAD_MESSAGE_COUNT="super_group_channel_unread_message_count",e.GROUP_CHANNEL_INVITATION_COUNT="group_channel_invitation_count",e.NONSUPER_INVITATION_COUNT="non_super_group_channel_invitation_count",e.SUPER_INVITATION_COUNT="super_group_channel_invitation_count"}(y||(y={}));var N,k={keys:[]},x={channelCustomTypesFilter:void 0,superChannelFilter:d.ALL},O={channelUrl:void 0,scheduledStatus:void 0,messageTypeFilter:o.al.ALL},M=((0,o.g)({},o.Z),function(e){return e.startsWith("EVENT_")||e===o.Z.SYNC_CHANNEL_CHANGELOGS||e===o.Z.REFRESH_CHANNEL}),R=function(e){function t(t){var n=t.channels,r=t.source,i=t.isWebSocketEventComing,o=void 0!==i&&i,s=t.data,a=void 0===s?null:s,u=t.ts,c=e.call(this)||this;return c.channels=n,c.source=r,c.isWebSocketEventComing=o,c.data=a,c.ts=u,c}return(0,o.c)(t,e),t}(o.b0),D=function(e){function t(t){var n=t.channelUrls,r=t.source,i=t.isWebSocketEventComing,o=void 0!==i&&i,s=e.call(this)||this;return s.channelUrls=n,s.source=r,s.isWebSocketEventComing=o,s}return(0,o.c)(t,e),t}(o.b0),U=function(){function e(e){var t=e.groupChannelCache,n=e.messageCache,r=e.unsentMessageCache,i=e.dispatcher,s=this;this._observers=new Map,i.on((function(e){return(0,o._)(s,void 0,void 0,(function(){var i,s,u,c,l,d,h,f,p,_,v,m,g,y,b=this;return(0,o.b)(this,(function(E){switch(E.label){case 0:if(!(e instanceof R))return[3,10];i=e.channels,v=e.source,m=e.isWebSocketEventComing,s=e.data,u=i.filter((function(e){return e instanceof Ht})),c=t.filterOffsetChanged(u),E.label=1;case 1:E.trys.push([1,6,7,8]),l=(0,o.s)(c),d=l.next(),E.label=2;case 2:return d.done?[3,5]:(h=d.value,[4,n.removeUnderOffset(h.url,h.messageOffsetTimestamp)]);case 3:E.sent(),E.label=4;case 4:return d=l.next(),[3,2];case 5:return[3,8];case 6:return f=E.sent(),g={error:f},[3,8];case 7:try{d&&!d.done&&(y=l.return)&&y.call(l)}finally{if(g)throw g.error}return[7];case 8:return[4,t.upsert(u,e.ts)];case 9:return p=E.sent(),m||this._broadcastUpdateEvent(p,v,s),[3,15];case 10:return e instanceof D?(_=e.channelUrls,v=e.source,m=e.isWebSocketEventComing,[4,t.remove(_)]):[3,13];case 11:return E.sent(),[4,(0,o.z)((function(){return(0,o._)(b,void 0,void 0,(function(){var e,t,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:c.trys.push([0,6,7,8]),e=(0,o.s)(_),t=e.next(),c.label=1;case 1:return t.done?[3,5]:(i=t.value,[4,n.removeMessagesOfChannel(i)]);case 2:return c.sent(),[4,r.removeMessagesOfChannel(i)];case 3:c.sent(),c.label=4;case 4:return t=e.next(),[3,1];case 5:return[3,8];case 6:return s=c.sent(),a={error:s},[3,8];case 7:try{t&&!t.done&&(u=e.return)&&u.call(e)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))}))];case 12:return E.sent(),m||this._broadcastRemoveEvent(_,v),[3,15];case 13:return e instanceof a.D?[4,t.fetch({token:Number.MAX_SAFE_INTEGER,limit:Number.MAX_SAFE_INTEGER})]:[3,15];case 14:E.sent(),E.label=15;case 15:return[2]}}))}))}))}return e.prototype._broadcastUpdateEvent=function(e,t,n){var r,i;try{for(var s=(0,o.s)(this._observers.values()),a=s.next();!a.done;a=s.next()){var u=a.value;u.onUpdate&&u.onUpdate(e,t,n)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}},e.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var i=(0,o.s)(this._observers.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.onRemove&&a.onRemove(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.subscribe=function(e,t){this._observers.set(e,t)},e.prototype.unsubscribe=function(e){this._observers.delete(e)},e.prototype.unsubscribeAll=function(){this._observers.clear()},e}(),L=function(e){function t(t){var n=t.userId,r=t.ts,i=t.token,s=t.filter,a=t.includeChatNotification,u=void 0!==a&&a,c=e.call(this)||this,l=(0,o.g)((0,o.g)({},T),s),d=l.customTypes,h=l.includeEmpty,f=l.includeFrozen;return c.method=o.A.GET,c.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/my_group_channels/changelogs"),c.params=(0,o.e)((0,o.u)({show_delivery_receipt:!0,show_member:!0,show_read_receipt:!0,change_ts:r||null,token:i,custom_types:d,show_empty:h,show_frozen:f,include_chat_notification:u})),c}return(0,o.c)(t,e),t}(o.f),P=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedChannels=n.updated.map((function(e){return new Ht(t,Object.assign(e,{ts:n.ts}))})),r.deletedChannelUrls=n.deleted,r.hasMore=n.has_more,r.token=n.next,r.ts=n.ts,r}return(0,o.c)(t,e),t}(o.h),F=function(e){function t(t){var n=t.channelUrl,r=t.isInternalCall,i=e.call(this)||this;return i.method=o.A.GET,i.path="".concat(r?o.b7:o.au,"/").concat(encodeURIComponent(n)),i.params={show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0},i}return(0,o.c)(t,e),t}(o.f),j=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new Ht(t,n),r}return(0,o.c)(t,e),t}(o.h),q={includeEmpty:!1,includeFrozen:!0,includeMetaData:!0,includeChatNotification:!1,channelUrlsFilter:void 0,customTypesFilter:void 0,customTypeStartsWithFilter:void 0,nicknameContainsFilter:void 0,nicknameStartsWithFilter:void 0,nicknameExactMatchFilter:void 0,channelNameContainsFilter:void 0,myMemberStateFilter:l.ALL,unreadChannelFilter:h.ALL,superChannelFilter:d.ALL,publicChannelFilter:c.ALL,hiddenChannelFilter:f.ALL,userIdsFilter:{userIds:[],includeMode:!0,queryType:_.AND},searchFilter:{query:void 0,fields:[]},metadataKey:void 0,metadataValues:void 0,metadataOrderKeyFilter:void 0,metadataValueStartsWith:void 0,order:a.G.LATEST_LAST_MESSAGE,createdAfter:void 0,createdBefore:void 0},H=function(e){function t(t){var n=this,r=t.userId,i=t.token,s=t.limit,a=t.order,u=t.includeEmpty,c=t.myMemberStateFilter,l=t.superChannelFilter,d=t.publicChannelFilter,h=t.unreadChannelFilter,f=t.nicknameContainsFilter,p=t.nicknameStartsWithFilter,_=t.nicknameExactMatchFilter,v=t.channelNameContainsFilter,m=t.channelUrlsFilter,g=t.customTypesFilter,y=t.customTypeStartsWithFilter,b=t.hiddenChannelFilter,E=t.metadataOrderKeyFilter,w=t.metadataKey,C=t.metadataValues,T=t.metadataValueStartsWith,A=t.includeFrozen,S=t.includeMetaData,I=t.searchFilter,N=t.userIdsFilter,k=t.includeChatNotification,x=void 0!==k&&k,O=t.createdAfter,M=t.createdBefore;return(n=e.call(this)||this).method=o.A.GET,n.path="".concat(o.d,"/").concat(encodeURIComponent(r),"/my_group_channels"),n.params=(0,o.e)({token:i,limit:s,order:null!=a?a:q.order,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:null!=u?u:q.includeEmpty,member_state_filter:null!=c?c:q.myMemberStateFilter,super_mode:null!=l?l:q.superChannelFilter,public_mode:null!=d?d:q.publicChannelFilter,unread_filter:null!=h?h:q.unreadChannelFilter,members_nickname_contains:f,members_nickname_startswith:p,members_nickname:_,name_contains:v,channel_urls:m,custom_types:g,custom_type_startswith:y,hidden_mode:b,metadata_order_key:E,metadata_key:w,metadata_values:C,metadata_value_startswith:T,show_frozen:A,show_metadata:S,include_chat_notification:x,created_after:O,created_before:M}),I&&I.query&&I.fields&&(n.params.search_query=I.query,n.params.search_fields=I.fields),N&&N.userIds&&N.userIds.length>0&&(N.includeMode?(n.params.members_include_in=N.userIds,n.params.query_type=N.queryType.toUpperCase()):n.params.members_exactly_in=N.userIds),n}return(0,o.c)(t,e),t}(o.f),V=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,o=n.channels,s=n.ts;return r.token=i,o&&o.length>0&&(r.channels=o.map((function(e){return e.ts=s,new Ht(t,e)}))),r.ts=null!=s?s:0,r}return(0,o.c)(t,e),t}(o.h),B=function(e){function t(t){var n=t.userId,r=t.filter,i=e.call(this)||this,s=r.myMemberStateFilter;return i.method=o.A.GET,i.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/group_channel_count"),i.params={state:null!=s?s:l.ALL},i}return(0,o.c)(t,e),t}(o.f),z=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.groupChannelCount=n.group_channel_count,r}return(0,o.c)(t,e),t}(o.h),G=function(e){function t(t){var n=t.userId,r=t.filter,i=e.call(this)||this,s=r.keys;return i.method=o.A.GET,i.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/unread_item_count"),i.params=(0,o.e)({item_keys:s}),i}return(0,o.c)(t,e),t}(o.f),W=function(e){function t(t,n){var r=e.call(this,t,n)||this;return"number"==typeof n[y.GROUP_CHANNEL_UNREAD_MENTION_COUNT]&&(r.groupChannelUnreadMentionCount=n[y.GROUP_CHANNEL_UNREAD_MENTION_COUNT]),"number"==typeof n[y.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]&&(r.groupChannelUnreadMessageCount=n[y.GROUP_CHANNEL_UNREAD_MESSAGE_COUNT]),"number"==typeof n[y.GROUP_CHANNEL_INVITATION_COUNT]&&(r.groupChannelInvitationCount=n[y.GROUP_CHANNEL_INVITATION_COUNT]),"number"==typeof n[y.SUPER_UNREAD_MENTION_COUNT]&&(r.superGroupChannelUnreadMentionCount=n[y.SUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[y.SUPER_UNREAD_MESSAGE_COUNT]&&(r.superGroupChannelUnreadMessageCount=n[y.SUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[y.SUPER_INVITATION_COUNT]&&(r.superGroupChannelInvitationCount=n[y.SUPER_INVITATION_COUNT]),"number"==typeof n[y.NONSUPER_UNREAD_MENTION_COUNT]&&(r.nonSuperGroupChannelUnreadMentionCount=n[y.NONSUPER_UNREAD_MENTION_COUNT]),"number"==typeof n[y.NONSUPER_UNREAD_MESSAGE_COUNT]&&(r.nonSuperGroupChannelUnreadMessageCount=n[y.NONSUPER_UNREAD_MESSAGE_COUNT]),"number"==typeof n[y.NONSUPER_INVITATION_COUNT]&&(r.nonSuperGroupChannelInvitationCount=n[y.NONSUPER_INVITATION_COUNT]),r}return(0,o.c)(t,e),t}(o.h),K=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=o.A.GET,r.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/unread_channel_count"),r}return(0,o.c)(t,e),t}(o.f),Q=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.unreadCount=n.unread_count,r}return(0,o.c)(t,e),t}(o.h),Z=function(e){function t(t){var n=t.userId,r=t.filter,i=t.includeFeedChannel,s=void 0!==i&&i,a=e.call(this)||this,u=r.channelCustomTypesFilter,c=r.superChannelFilter;return a.method=o.A.GET,a.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/unread_message_count"),a.params={super_mode:null!=c?c:d.ALL,custom_types:u,include_feed_channel:s},a}return(0,o.c)(t,e),t}(o.f),Y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.unreadCount=n.unread_count,r.unreadFeedCount=n.unread_feed_count,r}return(0,o.c)(t,e),t}(o.h),$=function(e){function t(t){var n=t.channelUrl,r=t.scheduledStatus,i=t.messageTypeFilter,s=e.call(this)||this;return s.method=o.A.GET,s.path="".concat(o.b3,"/count"),s.params={channel_url:n,status:J(r)},i&&(s.params.message_type=i),s}return(0,o.c)(t,e),t}(o.f),X=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.count=n.count,r}return(0,o.c)(t,e),t}(o.h),J=function(e){if(!e)return[];var t=[];return e.forEach((function(e){switch(e){case s.L.PENDING:t.push(s.Q.PENDING);break;case s.L.SENT:t.push(s.Q.IN_QUEUE),t.push(s.Q.SENT);break;case s.L.CANCELED:t.push(s.Q.CANCELED);break;case s.L.FAILED:t.push(s.Q.FAILED)}})),t},ee=function(e){function t(t){var n=this,r=t.userId,i=t.channelUrl,s=t.coverUrl,a=t.coverImage,u=t.isDistinct,c=t.isSuper,l=t.isBroadcast,d=t.isPublic,h=t.isExclusive,f=t.isDiscoverable,p=t.isStrict,_=t.isEphemeral,v=t.accessCode,m=t.name,g=t.data,y=t.customType,b=t.messageSurvivalSeconds,E=t.invitedUserIds,w=t.operatorUserIds;return(n=e.call(this)||this).method=o.A.POST,n.path=o.au,n.params=(0,o.e)({user_ids:(0,o.o)([r],(0,o.p)(null!=E?E:[]),!1).filter((function(e,t,n){return t===n.indexOf(e)})),channel_url:i,cover_url:s,cover_file:a,is_distinct:u,is_super:c,is_broadcast:l,is_exclusive:h,is_public:d,is_discoverable:f,strict:p,is_ephemeral:_,access_code:v,name:m,data:g,custom_type:y,operator_ids:w,message_survival_seconds:b}),n}return(0,o.c)(t,e),t}(o.f),te=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).channel=new Ht(t,n),i.isCreated=null===(r=n.is_created)||void 0===r||r,i}return(0,o.c)(t,e),t}(o.h),ne=function(e){function t(t){var n=t.userId,r=t.channelUrls,i=e.call(this)||this;return i.method=o.A.PUT,i.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/mark_as_read_all"),i.params={channel_urls:r},i}return(0,o.c)(t,e),t}(o.f);N=o.h,(0,o.c)((function(){return null!==N&&N.apply(this,arguments)||this}),N);var re=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,s=t.accessCode;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat(o.au,"/").concat(encodeURIComponent(r),"/join"),n.params={user_id:i,access_code:s},n}return(0,o.c)(t,e),t}(o.f),ie=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new Ht(t,n),r}return(0,o.c)(t,e),t}(o.h),oe=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,o=r.data,s=o.member_count,a=void 0===s?0:s,u=o.joined_member_count,c=void 0===u?0:u,l=o.users,d=void 0===l?null:l;return i.memberCount=a,i.joinedMemberCount=c,i.members=Array.isArray(d)?d.map((function(e){return new m(t,e)})):[new m(t,r.data)],i}return(0,o.c)(t,e),t}(u.C),se=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,s=t.shouldRemoveOperatorStatus;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat(o.au,"/").concat(encodeURIComponent(r),"/leave"),n.params={user_id:i,should_remove_operator_status:s},n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){return e.call(this,t,n)||this}),e)}(o.h);var ae=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,o=r.data,s=o.member_count,a=void 0===s?0:s,u=o.joined_member_count,c=void 0===u?0:u;return i.memberCount=a,i.joinedMemberCount=c,i.member=new m(i._iid,r.data),i}return(0,o.c)(t,e),t}(u.C),ue=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userIds;return(n=e.call(this)||this).method=o.A.POST,n.path="".concat(o.au,"/").concat(encodeURIComponent(r),"/invite"),n.params={user_ids:i},n}return(0,o.c)(t,e),t}(o.f),ce=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new Ht(t,n),r}return(0,o.c)(t,e),t}(o.h),le=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;i.inviter=null;var s=r.data,a=s.member_count,u=void 0===a?0:a,c=s.joined_member_count,l=void 0===c?0:c,d=s.inviter,h=s.invitees,f=void 0===h?[]:h;return i.memberCount=u,i.joinedMemberCount=l,d&&Object.keys(d).length>0&&(i.inviter=new o.U(t,d)),i.invitees=f.map((function(e){return new m(t,e)})),i}return(0,o.c)(t,e),t}(u.C),de=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat(o.au,"/").concat(encodeURIComponent(r),"/decline"),n.params={user_id:i},n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){var i=e.call(this,t,n)||this;return i.channel=new Ht(t,n),i.channel.myMemberState=r.NONE,i}),e)}(o.h);var he=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,s=r.data,a=s.member_count,u=s.joined_member_count,c=s.inviter,l=s.invitee;return i.memberCount=null!=a?a:0,i.joinedMemberCount=null!=u?u:0,i.inviter=new o.U(t,c),i.invitee=new m(t,l),i}return(0,o.c)(t,e),t}(u.C),fe={hidePreviousMessages:!1,allowAutoUnhide:!0},pe=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,s=t.hidePreviousMessages,a=t.allowAutoUnhide;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat(o.au,"/").concat(encodeURIComponent(r),"/hide"),n.params={user_id:i,hide_previous_messages:null!=s?s:fe.hidePreviousMessages,allow_auto_unhide:null!=a?a:fe.allowAutoUnhide},n}return(0,o.c)(t,e),t}(o.f),_e=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts_message_offset;return r.messageOffsetTimestamp=i,r}return(0,o.c)(t,e),t}(o.h),ve=function(e){function t(t,n,r){var i,o,s,a=this;return(a=e.call(this,t,"SYEV",r)||this).allowAutoUnhide=null,a.hidePreviousMessages=null,a.messageOffsetTimestamp=null,r.data&&(a.allowAutoUnhide=null!==(i=r.data.allow_auto_unhide)&&void 0!==i?i:null,a.hidePreviousMessages=null!==(o=r.data.hide_previous_messages)&&void 0!==o?o:null),a.messageOffsetTimestamp=null!==(s=r.ts_message_offset)&&void 0!==s?s:null,a}return(0,o.c)(t,e),t}(o.W),me=function(e){function t(t){var n=t.channelUrl,r=t.time;return e.call(this,{code:"TPST",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return(0,o.c)(t,e),t}(o.ao),ge=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new o.U(t,r.data),i}return(0,o.c)(t,e),t}(o.W),ye=function(e){function t(t){var n=t.channelUrl,r=t.time;return e.call(this,{code:"TPEN",ackRequired:!1,payload:{channel_url:n,time:r}})||this}return(0,o.c)(t,e),t}(o.ao),be=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new o.U(t,r.data),i}return(0,o.c)(t,e),t}(o.W),Ee=function(e){function t(t){var n=t.channelUrl,r=t.messageId;return e.call(this,{code:"MACK",ackRequired:!1,payload:{channel_url:n,msg_id:r}})||this}return(0,o.c)(t,e),t}(o.ao),we=function(e){function t(t,n){var r,i,o,s,u,p,v,m,g,y,b,E,w,C,T,A,S,I,N,k,x,O,M,R=this;return(R=e.call(this,t,n)||this).includeEmpty=!1,R.includeFrozen=!0,R.includeMetaData=!0,R.includeChatNotification=!1,R.channelUrlsFilter=null,R.customTypesFilter=null,R.customTypeStartsWithFilter=null,R.nicknameContainsFilter=null,R.nicknameStartsWithFilter=null,R.nicknameExactMatchFilter=null,R.channelNameContainsFilter="",R.myMemberStateFilter=l.ALL,R.unreadChannelFilter=h.ALL,R.superChannelFilter=d.ALL,R.publicChannelFilter=c.ALL,R.hiddenChannelFilter=f.UNHIDDEN,R.searchFilter={fields:[],query:null},R.userIdsFilter={userIds:[],includeMode:!0,queryType:_.AND},R.metadataKey=null,R.metadataValues=null,R.metadataOrderKeyFilter=null,R.metadataValueStartsWith=null,R.order=a.G.LATEST_LAST_MESSAGE,R.includeEmpty=null!==(r=n.includeEmpty)&&void 0!==r&&r,R.includeFrozen=null===(i=n.includeFrozen)||void 0===i||i,R.includeMetaData=null===(o=n.includeMetaData)||void 0===o||o,R.includeChatNotification=null!==(s=n.includeChatNotification)&&void 0!==s&&s,R.channelUrlsFilter=null!==(u=n.channelUrlsFilter)&&void 0!==u?u:null,R.customTypesFilter=null!==(p=n.customTypesFilter)&&void 0!==p?p:null,R.customTypeStartsWithFilter=null!==(v=n.customTypeStartsWithFilter)&&void 0!==v?v:"",R.nicknameContainsFilter=null!==(m=n.nicknameContainsFilter)&&void 0!==m?m:null,R.nicknameStartsWithFilter=null!==(g=n.nicknameStartsWithFilter)&&void 0!==g?g:null,R.nicknameExactMatchFilter=null!==(y=n.nicknameExactMatchFilter)&&void 0!==y?y:null,R.channelNameContainsFilter=null!==(b=n.channelNameContainsFilter)&&void 0!==b?b:"",R.myMemberStateFilter=null!==(E=n.myMemberStateFilter)&&void 0!==E?E:l.ALL,R.unreadChannelFilter=null!==(w=n.unreadChannelFilter)&&void 0!==w?w:h.ALL,R.superChannelFilter=null!==(C=n.superChannelFilter)&&void 0!==C?C:d.ALL,R.publicChannelFilter=null!==(T=n.publicChannelFilter)&&void 0!==T?T:c.ALL,R.hiddenChannelFilter=null!==(A=n.hiddenChannelFilter)&&void 0!==A?A:f.UNHIDDEN,R.searchFilter=null!==(S=n.searchFilter)&&void 0!==S?S:{fields:[],query:null},R.userIdsFilter=null!==(I=n.userIdsFilter)&&void 0!==I?I:{userIds:[],includeMode:!0,queryType:_.AND},R.metadataKey=null!==(N=n.metadataKey)&&void 0!==N?N:null,R.metadataValues=null!==(k=n.metadataValues)&&void 0!==k?k:null,R.metadataOrderKeyFilter=null!==(x=n.metadataOrderKeyFilter)&&void 0!==x?x:null,R.metadataValueStartsWith=null!==(O=n.metadataValueStartsWith)&&void 0!==O?O:null,R.order=null!==(M=n.order)&&void 0!==M?M:a.G.LATEST_LAST_MESSAGE,n.createdAfter&&(R.createdAfter=n.createdAfter),n.createdBefore&&(R.createdBefore=n.createdBefore),R}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,o.a)("boolean",this.includeEmpty)&&(0,o.a)("boolean",this.includeFrozen)&&(0,o.a)("boolean",this.includeMetaData)&&(0,o.a)("string",this.channelNameContainsFilter)&&(0,o.O)("string",this.channelUrlsFilter,!0)&&(0,o.O)("string",this.customTypesFilter,!0)&&(0,o.a)("string",this.customTypeStartsWithFilter)&&(0,o.a)("string",this.nicknameContainsFilter,!0)&&(0,o.a)("string",this.nicknameStartsWithFilter,!0)&&(0,o.a)("string",this.nicknameExactMatchFilter,!0)&&(0,o.T)(l,this.myMemberStateFilter)&&(0,o.T)(d,this.superChannelFilter)&&(0,o.T)(c,this.publicChannelFilter)&&(0,o.T)(h,this.unreadChannelFilter)&&(0,o.T)(f,this.hiddenChannelFilter)&&(0,o.O)(v,this.searchFilter.fields)&&(0,o.a)("string",this.searchFilter.query,!0)&&(0,o.O)("string",this.userIdsFilter.userIds)&&(0,o.a)("boolean",this.userIdsFilter.includeMode)&&(0,o.T)(_,this.userIdsFilter.queryType)&&(0,o.T)(a.G,this.order)&&(0,o.a)("string",this.metadataOrderKeyFilter,!0)&&(0,o.a)("string",this.metadataKey,!0)&&(0,o.O)("string",this.metadataValues,!0)&&(0,o.a)("string",this.metadataValueStartsWith,!0)&&(0,o.b8)(this.createdAfter,!0)&&(0,o.b8)(this.createdBefore,!0)},t.prototype.serialize=function(){return(0,o.ad)(this)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,Oe.of(this._iid).getMyGroupChannels(this._token,(0,o.u)((0,o.g)({},this)),this.limit)]):[3,2]:[3,5];case 1:return e=r.sent(),t=e.channels,n=e.token,this._token=n,this._hasNext=!!n,this._isLoading=!1,[2,t];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aI),Ce=function(e){function t(t,n,r){var i,a=this;return(a=e.call(this,t,"SYEV",r)||this).pinnedMessageIds=[],a.latestPinnedMessage=null,a.ts=0,r.data&&(a.pinnedMessageIds=null!==(i=r.data.pinned_message_ids)&&void 0!==i?i:[],a.latestPinnedMessage=r.data.latest_pinned_message?(0,s.K)(t,(0,o.g)({},r.data.latest_pinned_message)):null),a.ts=r.ts,a}return(0,o.c)(t,e),t}(o.W),Te=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"READ",ackRequired:!0,payload:{channel_url:n}})||this}return(0,o.c)(t,e),t}(o.ao),Ae=(function(e){function t(t){var n=e.call(this)||this,r=t.channelUrl,i=t.channelType,s=t.userId,a=t.notificationIds;return n.method=o.A.PUT,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/messages/mark_as_read"),n.params=(0,o.e)((0,o.u)({user_id:encodeURIComponent(s),message_ids:a})),n}(0,o.c)(t,e)}(o.f),function(e){function t(t,n,r){var i=e.call(this,t,"READ",r)||this;return i.readStatus=new g(t,r),i}return(0,o.c)(t,e),t}(o.W)),Se=(function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.readAt=n.ts,r.unreadMessageCount=n.unread_message_count,r}(0,o.c)(t,e)}(o.h),function(e){function t(t){var n=t.channelUrl,r=t.userId,i=e.call(this)||this;return i.method=o.A.PUT,i.path="".concat(o.au,"/").concat(encodeURIComponent(n),"/messages/mark_as_delivered"),i.params=(0,o.e)({userId:r}),i}return(0,o.c)(t,e),t}(o.f));!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var Ie,Ne=function(e){function t(t,n,r){var i=e.call(this,t,"DLVR",r)||this;return i.channelUrl=r.channel_url,i.deliveredStateUpdate=r.updated,i}return(0,o.c)(t,e),t}(o.W),ke=function(){function e(e){var t=e.top,n=void 0===t?Number.MAX_SAFE_INTEGER:t,r=e.bottom,i=void 0===r?0:r;this.top=n,this.bottom=i}return e.prototype.includes=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.every((function(t){return e.top<=t&&t<=e.bottom}))},e.prototype.overlap=function(e){return this.includes(e.top)||this.includes(e.bottom)},e.prototype.intersect=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.some((function(t){return e.top<=t&&t<=e.bottom}))},e.prototype.extends=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.top=Math.min.apply(Math,(0,o.o)([this.top],(0,o.p)(e),!1)),this.bottom=Math.max.apply(Math,(0,o.o)([this.bottom],(0,o.p)(e),!1))},e}(),xe={},Oe=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,(0,o.g)((0,o.g)({},n),{channelType:o.C.GROUP}))||this)._leftChannels=new Map,i._disableMack=!1,i._markAsReadAllLastSentAt=0,i._disableMack=null!==(r=n.disableMack)&&void 0!==r&&r,i._groupChannelHandlers=new Map,i._groupChannelCache=new E(i._iid,{sdkState:n.sdkState,cacheContext:n.cacheContext}),i._groupChannelBroadcast=new U({dispatcher:n.dispatcher,groupChannelCache:i._groupChannelCache,messageCache:s.t.of(i._iid),unsentMessageCache:s.u.of(i._iid)}),setInterval((function(){var e,t,n=function(e){e.invalidateTypingStatus()&&(i._dispatcher.dispatch(new R({channels:[e],source:o.Z.EVENT_CHANNEL_TYPING_STATUS_UPDATE})),i._groupChannelHandlers.forEach((function(t){t.onTypingStatusUpdated&&t.onTypingStatusUpdated(e)})))};try{for(var r=(0,o.s)(i._groupChannelCache.channels),s=r.next();!s.done;s=r.next())n(s.value)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}),1e3),i._dispatcher.on((function(e){e instanceof o.W?i._handleEvent(e).catch((function(e){if((0,o.N)(e))throw e})):e instanceof a.c?(0,o._)(i,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return t=e.message,[4,this.getChannel(t.channelUrl,!0)];case 1:return n=r.sent(),t instanceof s.T?n._autoResendUserMessage(t):t instanceof s.V&&n._autoResendFileMessage(t),[2]}}))})):e instanceof a.R&&i.reduceDBSize()})),xe[t]||(xe[t]=i),i}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return s.t.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return s.u.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e){return xe[e]||(xe[e]=new t(e,o.V.of(e))),xe[e]},t.clear=function(e){xe[e]&&delete xe[e]},Object.defineProperty(t.prototype,"handlers",{get:function(){return(0,o.o)([],(0,o.p)(this._groupChannelHandlers.values()),!1)},enumerable:!1,configurable:!0}),t.prototype.buildGroupChannelFromSerializedData=function(e){var t=(0,o.y)(e);return new Ht(this._iid,Ht.payloadify(t))},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){var t=(0,o.y)(e);return new we(this._iid,t)},t.prototype.buildMemberFromSerializedData=function(e){var t=(0,o.y)(e);return new m(this._iid,m.payloadify(t))},t.prototype.getChannelFromCache=function(e){var t;return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._groupChannelCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},t.prototype.getChannelsFromCache=function(e,t,n,r,i){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(o){switch(o.label){case 0:return[4,this._groupChannelCache.fetch({token:e,filter:t,order:n,limit:r,borderlineChannelUrl:i})];case 1:return[2,o.sent()]}}))}))},t.prototype.upsertChannelsToCache=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._groupChannelCache.upsert(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.removeChannelsFromCache=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._groupChannelCache.remove(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.clearChannelsFromCache=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._groupChannelCache.clear()];case 1:return e.sent(),[2]}}))}))},t.prototype.reduceDBSize=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,a,u,c,l,d,h,f,p,_,v;return(0,o.b)(this,(function(m){switch(m.label){case 0:return e=s.t.of(this._iid),t=o.V.of(this._iid).cacheContext,n=t.localCacheConfig,r=t.nestdb,t.localCacheEnabled&&r&&r.state==s.v.OPENED?(i=1024*n.maxSize*1024,[4,r.estimateUsage()]):[2];case 1:if((a=m.sent())<i)return[2];u=[],c=this._groupChannelCache.channels,l={},p=0,m.label=2;case 2:return p<c.length?[4,this.getMessagesFromCache(c[p].url,0,"prev",new s.H)]:[3,5];case 3:d=m.sent(),l[c[p].url]=JSON.stringify(d).length,h=new o.$({channel:c[p],cachedMessageCount:d.length}),u.push(h),m.label=4;case 4:return p++,[3,2];case 5:f=u.sort(n.clearOrderComparator),p=0,m.label=6;case 6:return p<f.length?[4,e.removeMessagesOfChannel(f[p].channel.url)]:[3,10];case 7:return m.sent(),[4,e._getGroupChannelPreferenceSize(f[p].channel.url)];case 8:if(_=m.sent(),v=l[f[p].channel.url]+_,(a-=v)<i)return[3,10];m.label=9;case 9:return p++,[3,6];case 10:return[2]}}))}))},t.prototype._handleEvent=function(e){var t,n;return(0,o._)(this,void 0,void 0,(function(){var i,c,l,d,h,f,p,_,v,m,g,y,b,E,w,C,T,A,S,I,N,k,x,O,M,U,L,P,F,j,q,H,V,B,z,G,W,K,Q,Z,Y,$,X,J,ee,te,ne,re,ie,se,ue,ce,de,fe,pe,_e,me,ye,we,Te,Se,Ie,ke,xe,Oe,Me,Re,De,Ue,Le,Pe,Fe,je,qe,He,Ve,Be,ze,Ge,We,Ke,Qe,Ze,Ye,$e,Xe,Je,et,tt,nt,rt,it,ot,st,at,ut,ct,lt,dt,ht,ft,pt,_t,vt,mt,gt,yt,bt,Et,wt,Ct,Tt,At,St,It,Nt,kt,xt,Ot,Mt,Rt,Ut,Lt,Pt,Ft,jt,qt,Ht,Vt,Bt,zt,Gt,Wt,Kt,Qt,Zt,Yt,$t,Xt=this;return(0,o.b)(this,(function(Jt){switch(Jt.label){case 0:switch(Jt.trys.push([0,80,,81]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"READ":return[3,10];case"DLVR":return[3,13];case"MRCT":return[3,15];case"MTHD":return[3,19];case"MCNT":return[3,23];case"PEDI":return[3,32];case"VOTE":return[3,35];case"SYEV":return[3,38];case"USEV":return[3,78]}return[3,79];case 1:return _=null,"MESG"===e.code?_=e.as(s.a7):"FILE"===e.code?_=e.as(s.a8):"ADMM"!==e.code&&"BRDM"!=e.code||(_=e.as(u.A)),_?(i=_.message,c=_.isMentioned,l=_.forceUpdateLastMessage,i.channelType!==o.C.GROUP?[3,3]:(this._disableMack||(0,o.z)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){return e=new Ee(i),this._requestQueue.send(e),[2]}))}))})),M=this._groupChannelCache.isCachedInMemory(i.channelUrl),y=i instanceof s.a4&&i.sender.userId===this._sdkState.userId,[4,this.getChannel(i.channelUrl,!0)])):[3,3];case 2:if((d=Jt.sent()).hiddenState===Dt.HIDDEN_ALLOW_AUTO_UNHIDE&&(d.hiddenState=Dt.UNHIDDEN),i instanceof s.a4){h=o.V.of(this._iid).useMemberInfoInMessage;try{for(f=(0,o.s)(d.members),p=f.next();!p.done;p=f.next())if((rt=p.value).userId===i.sender.userId){h||(i.sender.nickname=rt.nickname,i.sender.plainProfileUrl=rt.plainProfileUrl,i.sender.metaData=rt.metaData,i.sender.isBlockedByMe=rt.isBlockedByMe);break}}catch(e){Vt={error:e}}finally{try{p&&!p.done&&(Bt=f.return)&&Bt.call(f)}finally{if(Vt)throw Vt.error}}!h&&c&&(null===(t=i.mentionedUsers)||void 0===t||t.forEach((function(e){var t,n;try{for(var r=(0,o.s)(d.members),i=r.next();!i.done;i=r.next()){var s=i.value;if(e.userId===s.userId){e.nickname=s.nickname,e.plainProfileUrl=s.plainProfileUrl,e.metaData=s.metaData;break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}))),y&&(w=this._sessionManager.currentUser)&&(w.nickname=i.sender.nickname,w.plainProfileUrl=i.sender.plainProfileUrl,w.metaData=i.sender.metaData)}i.silent&&!y||(d.isEphemeral||M)&&(d._updateLastMessage(i),y||d._updateUnreadCount(d.unreadMessageCount+1,d.unreadMentionCount+(c?1:0))),l&&d._updateLastMessage(i),this._dispatcher.dispatch(new R({channels:[d],source:o.Z.EVENT_MESSAGE_RECEIVED})),i.silent&&!y||(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(d)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),this._dispatcher.dispatch(new o.ai({messages:[i],source:o.Z.EVENT_MESSAGE_RECEIVED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,s;return(0,o.b)(this,(function(a){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageReceived&&n.onMessageReceived(d,i),c&&n.onMentionReceived&&n.onMentionReceived(d,i)}catch(e){r={error:e}}finally{try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Jt.label=3;case 3:return[3,79];case 4:return _=null,"MEDI"===e.code?_=e.as(s.a5):"FEDI"===e.code?_=e.as(s.a6):"AEDI"===e.code&&(_=e.as(u.U)),_?(v=_.message,m=_.mentionCountChange,v.channelType!==o.C.GROUP?[3,6]:(M=this._groupChannelCache.isCachedInMemory(v.channelUrl),[4,this.getChannel(v.channelUrl,!0)])):[3,6];case 5:g=Jt.sent(),y=v instanceof s.a4&&v.sender.userId===this._sdkState.userId,b=!1,y?(E=v.sender,(w=this._sessionManager.currentUser)&&(w.nickname=E.nickname,w.plainProfileUrl=E.plainProfileUrl,w.metaData=E.metaData)):g.isReadMessage(v)||0!==m&&!v.silent&&M&&(g._updateUnreadCount(g.unreadMessageCount,g.unreadMentionCount+m),b=!0),g._updateLastMessage(v)?b=!0:(null===(n=g.lastMessage)||void 0===n?void 0:n.isIdentical(v))&&(M?g._updateLastMessage(v)&&(b=!0):b=!0),C=!1,g.lastPinnedMessage&&g.lastPinnedMessage.messageId===v.messageId&&(g.lastPinnedMessage=v,b=!0,C=!0),b&&(this._dispatcher.dispatch(new R({channels:[g],source:C?o.Z.EVENT_PINNED_MESSAGE_UPDATED:o.Z.EVENT_MESSAGE_UPDATED})),v.silent&&!y||(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(g)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),C&&(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPinnedMessageUpdated&&n.onPinnedMessageUpdated(g)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),this._dispatcher.dispatch(new o.ai({messages:[v],source:o.Z.EVENT_MESSAGE_UPDATED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageUpdated&&n.onMessageUpdated(g,v),0!==m&&n.onMentionReceived&&n.onMentionReceived(g,v)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Jt.label=6;case 6:return[3,79];case 7:return T=e.as(s.a3),re=T.channelUrl,ie=T.channelType,A=T.messageId,ie!==o.C.GROUP?[3,9]:[4,this.getChannel(re,!0)];case 8:S=Jt.sent(),this._dispatcher.dispatch(new o.aQ({messageIds:[A],source:o.Z.EVENT_MESSAGE_DELETED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onMessageDeleted&&n.onMessageDeleted(S,A)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Jt.label=9;case 9:return[3,79];case 10:return(I=e.as(Ae).readStatus).channelType!==o.C.GROUP?[3,12]:(M=this._groupChannelCache.isCachedInMemory(I.channelUrl),[4,this.getChannel(I.channelUrl,!0)]);case 11:N=Jt.sent(),M&&N._updateUnreadMemberState(I.reader.userId,I.readAt),I.reader.userId===this._sdkState.userId?M?(N.unreadMessageCount>0||N.unreadMentionCount>0)&&(N._updateUnreadCount(0,0),this._dispatcher.dispatch(new R({channels:[N],source:o.Z.EVENT_CHANNEL_READ})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(N)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))):0!==N.unreadMessageCount&&0!==N.unreadMentionCount||(this._dispatcher.dispatch(new R({channels:[N],source:o.Z.EVENT_CHANNEL_READ})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(N)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))):(this._dispatcher.dispatch(new R({channels:[N],source:o.Z.EVENT_CHANNEL_READ})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onUnreadMemberStatusUpdated&&n.onUnreadMemberStatusUpdated(N)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),Jt.label=12;case 12:return[3,79];case 13:return k=e.as(Ne),re=k.channelUrl,x=k.deliveredStateUpdate,O=void 0===x?{}:x,M=this._groupChannelCache.isCachedInMemory(re),[4,this.getChannel(re,!0)];case 14:if(U=Jt.sent(),M)for(L in O)U._updateUndeliveredMemberState(L,O[L]);return Object.keys(O).some((function(e){return e!==Xt._sdkState.userId}))&&(this._dispatcher.dispatch(new R({channels:[U],source:o.Z.EVENT_CHANNEL_DELIVERED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onUndeliveredMemberStatusUpdated&&n.onUndeliveredMemberStatusUpdated(U)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),[3,79];case 15:return P=e.as(u.R),re=P.channelUrl,ie=P.channelType,F=P.event,ie!==o.C.GROUP?[3,18]:[4,this.getChannel(re,!0)];case 16:return j=Jt.sent(),[4,this.getMessageFromCache(F.messageId)];case 17:(V=Jt.sent())?V instanceof s.a2&&(V.applyReactionEvent(F),this._dispatcher.dispatch(new o.ai({messages:[V],source:o.Z.EVENT_MESSAGE_REACTION_UPDATED}))):this._dispatcher.dispatch(new o.aL({event:F,source:o.Z.EVENT_MESSAGE_REACTION_UPDATED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onReactionUpdated&&n.onReactionUpdated(j,F)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Jt.label=18;case 18:return[3,79];case 19:return(q=e.as(u.T).event).channelType!==o.C.GROUP?[3,22]:[4,this.getChannel(q.channelUrl,!0)];case 20:return H=Jt.sent(),[4,this.getMessageFromCache(q.targetMessageId)];case 21:(V=Jt.sent())?V instanceof s.a2&&(V.applyThreadInfoUpdateEvent(q),this._dispatcher.dispatch(new o.ai({messages:[V],source:o.Z.EVENT_MESSAGE_THREADINFO_UPDATED}))):this._dispatcher.dispatch(new o.aM({event:q,source:o.Z.EVENT_MESSAGE_THREADINFO_UPDATED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onThreadInfoUpdated&&n.onThreadInfoUpdated(H,q)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Jt.label=22;case 22:return[3,79];case 23:B=e.as(u.M).groupChannelMemberCounts,z=[],Jt.label=24;case 24:Jt.trys.push([24,29,30,31]),G=(0,o.s)(B),W=G.next(),Jt.label=25;case 25:return W.done?[3,28]:(K=W.value,re=K.channelUrl,Ge=K.memberCount,We=K.joinedMemberCount,Q=K.updatedAt,[4,this.getChannelFromCache(re)]);case 26:(Z=Jt.sent())&&Z._setLatestMemberCount(Ge,We,Q)&&z.push(Z),Jt.label=27;case 27:return W=G.next(),[3,25];case 28:return[3,31];case 29:return Y=Jt.sent(),zt={error:Y},[3,31];case 30:try{W&&!W.done&&(Gt=G.return)&&Gt.call(G)}finally{if(zt)throw zt.error}return[7];case 31:return z.length>0&&(this._dispatcher.dispatch(new R({channels:z,source:o.Z.EVENT_CHANNEL_MEMBER_COUNT_UPDATED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelMemberCountChanged&&n.onChannelMemberCountChanged(z)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}))),[3,79];case 32:return $=e.as(u.P),X=$.event,J=$.status,re=$.channelUrl,ie=$.channelType,re&&ie===o.C.GROUP?[4,this.getChannel(re,!0)]:[3,34];case 33:ee=Jt.sent(),this._dispatcher.dispatch(new o.aN({event:X,source:o.Z.EVENT_POLL_UPDATED})),(0,o.F)(J===o.b9?function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollDeleted&&n.onPollDeleted(ee,X.pollId)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}:function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollUpdated&&n.onPollUpdated(ee,X)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))}),Jt.label=34;case 34:return[3,79];case 35:return te=e.as(s.a1),ne=te.event,re=te.channelUrl,ie=te.channelType,re&&ie===o.C.GROUP?[4,this.getChannel(re,!0)]:[3,37];case 36:se=Jt.sent(),this._dispatcher.dispatch(new o.aG({event:ne,source:o.Z.EVENT_POLL_VOTED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollVoted&&n.onPollVoted(se,ne)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Jt.label=37;case 37:return[3,79];case 38:if(!(ue=e.as(u.C).event).isGroupChannelEvent)return[3,77];switch(ue.category){case u.a.CHANNEL_JOIN:return[3,39];case u.a.CHANNEL_LEAVE:return[3,41];case u.a.CHANNEL_OPERATOR_UPDATE:return[3,45];case u.a.CHANNEL_INVITE:return[3,47];case u.a.CHANNEL_DECLINE_INVITE:return[3,49];case u.a.TYPING_START:case u.a.TYPING_END:return[3,51];case u.a.USER_CHANNEL_MUTE:case u.a.USER_CHANNEL_UNMUTE:return[3,53];case u.a.USER_CHANNEL_BAN:return[3,55];case u.a.USER_CHANNEL_UNBAN:return[3,59];case u.a.CHANNEL_FREEZE:case u.a.CHANNEL_UNFREEZE:return[3,61];case u.a.CHANNEL_HIDE:return[3,63];case u.a.CHANNEL_UNHIDE:return[3,65];case u.a.CHANNEL_DELETED:return[3,67];case u.a.CHANNEL_PROP_CHANGED:return[3,69];case u.a.CHANNEL_META_DATA_CHANGED:return[3,71];case u.a.CHANNEL_META_COUNTERS_CHANGED:return[3,73];case u.a.PINNED_MESSAGE_CHANGED:return[3,75]}return[3,77];case 39:return[4,this.getChannel(ue.channelUrl,!0)];case 40:return ce=Jt.sent(),de=e.as(oe),fe=de.memberCount,pe=de.joinedMemberCount,_e=de.members,me=!1,_e.forEach((function(e){ce.isExclusive||ce.isSuper||ce.isBroadcast?me=me||ce._setLatestMemberCount(fe,pe,ue.ts):(e.state=r.JOINED,ce.addMember(e,ue.ts),Xt._updateJoinedMemberCount(ce)),e.userId===Xt._sdkState.userId&&(ce.myMemberState=r.JOINED)})),this._dispatcher.dispatch(new R({channels:[ce],source:o.Z.EVENT_CHANNEL_JOINED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){var t,n;try{for(var r=(0,o.s)(_e),i=r.next();!i.done;i=r.next()){var s=i.value;e.onUserJoined&&e.onUserJoined(ce,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}ce.isBroadcast&&me&&e.onChannelMemberCountChanged&&e.onChannelMemberCountChanged([ce])})),[2]}))}))})),[3,77];case 41:return(it=this._leftChannels.get(ue.channelUrl))?(we=it.channel,[3,44]):[3,42];case 42:return[4,this.getChannel(ue.channelUrl,!0)];case 43:we=Jt.sent(),Jt.label=44;case 44:return ye=we,Te=e.as(ae),Ge=Te.memberCount,We=Te.joinedMemberCount,Se=Te.member,Ie=!1,ke=o.V.of(this._iid).appInfo,ye.isExclusive||ye.isSuper||ye.isBroadcast?Ie=ye._setLatestMemberCount(Ge,We,ue.ts):((null==ke?void 0:ke.enabledChannelMemberShipHistory)?((xe=ye.members.find((function(e){return e.userId===xe.userId})))&&(xe.state=r.LEFT),ye.memberCount=Ge):ye.removeMember(Se),this._updateJoinedMemberCount(ye)),Se.userId===this._sdkState.userId?(ye.myMemberState=r.NONE,ye.invitedAt=0,ye.joinedAt=0,ye._updateUnreadCount(0,0),ye.isPublic?this._dispatcher.dispatch(new R({channels:[ye],source:o.Z.EVENT_CHANNEL_LEFT})):(this._markAsLeave(ye),this._dispatcher.dispatch(new D({channelUrls:[ye.url],source:o.Z.EVENT_CHANNEL_LEFT})))):this._dispatcher.dispatch(new R({channels:[ye],source:o.Z.EVENT_CHANNEL_LEFT})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserLeft&&e.onUserLeft(ye,Se),ye.isBroadcast&&Ie&&e.onChannelMemberCountChanged&&e.onChannelMemberCountChanged([ye])})),[2]}))}))})),[3,77];case 45:return[4,this.getChannel(ue.channelUrl,!0)];case 46:Oe=Jt.sent(),Me=e.as(u.O).operators,Re=Me.map((function(e){return e.userId}));try{for(De=(0,o.s)(Oe.members),Ue=De.next();!Ue.done;Ue=De.next())(rt=Ue.value).role=Re.includes(rt.userId)?o.a3.OPERATOR:o.a3.NONE}catch(e){Wt={error:e}}finally{try{Ue&&!Ue.done&&(Kt=De.return)&&Kt.call(De)}finally{if(Wt)throw Wt.error}}return Oe.myRole=Re.includes(this._sdkState.userId)?o.a3.OPERATOR:o.a3.NONE,this._dispatcher.dispatch(new R({channels:[Oe],source:o.Z.EVENT_CHANNEL_OPERATOR_UPDATED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onOperatorUpdated&&e.onOperatorUpdated(Oe,Me)})),[2]}))}))})),[3,77];case 47:return[4,this.getChannel(ue.channelUrl,!0)];case 48:Le=Jt.sent(),Pe=e.as(le),Ge=Pe.memberCount,We=Pe.joinedMemberCount,Fe=Pe.inviter,(je=Pe.invitees).forEach((function(e){return e.state=r.INVITED}));try{for(qe=(0,o.s)(je),He=qe.next();!He.done;He=qe.next())Ve=He.value,Le.isExclusive||Le.isSuper||Le.isBroadcast?Le._setLatestMemberCount(Ge,We,ue.ts):Le.addMember(Ve,ue.ts),this._sdkState.userId===Ve.userId&&(Le.hiddenState=Dt.UNHIDDEN,Le.myMemberState!==r.JOINED&&(Le.myMemberState=r.INVITED),Le.invitedAt=ue.ts)}catch(e){Qt={error:e}}finally{try{He&&!He.done&&(Zt=qe.return)&&Zt.call(qe)}finally{if(Qt)throw Qt.error}}return this._dispatcher.dispatch(new R({channels:[Le],source:o.Z.EVENT_CHANNEL_INVITED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserReceivedInvitation&&e.onUserReceivedInvitation(Le,Fe,je)})),[2]}))}))})),[3,77];case 49:return[4,this.getChannel(ue.channelUrl,!0)];case 50:return Be=Jt.sent(),ze=e.as(he),Ge=ze.memberCount,We=ze.joinedMemberCount,Ke=ze.inviter,Qe=ze.invitee,Be.isExclusive||Be.isSuper||Be.isBroadcast?Be._setLatestMemberCount(Ge,We,ue.ts):Be.removeMember(Qe),this._sdkState.userId===Qe.userId?(Be.invitedAt=0,Be.myMemberState=r.NONE,Be.isPublic?this._dispatcher.dispatch(new R({channels:[Be],source:o.Z.EVENT_CHANNEL_DECLINED_INVITE})):this._dispatcher.dispatch(new D({channelUrls:[Be.url],source:o.Z.EVENT_CHANNEL_DECLINED_INVITE}))):this._dispatcher.dispatch(new R({channels:[Be],source:o.Z.EVENT_CHANNEL_DECLINED_INVITE})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserDeclinedInvitation&&e.onUserDeclinedInvitation(Be,Ke,Qe)})),[2]}))}))})),[3,77];case 51:return[4,this.getChannel(ue.channelUrl,!0)];case 52:return Ze=Jt.sent(),Ye=ue.category===u.a.TYPING_START,$e=e.as(Ye?ge:be).user,Ze._updateTypingStatus($e,Ye?ue.ts:0),this._dispatcher.dispatch(new R({channels:[Ze],source:o.Z.EVENT_CHANNEL_TYPING_STATUS_UPDATE})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onTypingStatusUpdated&&e.onTypingStatusUpdated(Ze)})),[2]}))}))})),[3,77];case 53:return[4,this.getChannel(ue.channelUrl,!0)];case 54:Xe=Jt.sent(),Je=ue.category===u.a.USER_CHANNEL_MUTE,(et=e.as(Je?s.$:s.a0).user).userId===this._sdkState.userId&&(Xe.myMutedState=Je?o.b5.MUTED:o.b5.UNMUTED,Xe._myMutedRemainingTime=et.restrictionInfo.remainingDuration);try{for(tt=(0,o.s)(Xe.members),nt=tt.next();!nt.done;nt=tt.next())if((rt=nt.value).userId===et.userId){rt.isMuted=Je;break}}catch(e){Yt={error:e}}finally{try{nt&&!nt.done&&($t=tt.return)&&$t.call(tt)}finally{if(Yt)throw Yt.error}}return this._dispatcher.dispatch(new R({channels:[Xe],source:Je?o.Z.EVENT_CHANNEL_MUTED:o.Z.EVENT_CHANNEL_UNMUTED,data:et.userId})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){Je?e.onUserMuted&&e.onUserMuted(Xe,et):e.onUserUnmuted&&e.onUserUnmuted(Xe,et)})),[2]}))}))})),[3,77];case 55:return(it=this._leftChannels.get(ue.channelUrl))?(st=it.channel,[3,58]):[3,56];case 56:return[4,this.getChannel(ue.channelUrl,!0)];case 57:st=Jt.sent(),Jt.label=58;case 58:return ot=st,this._markAsLeave(ot),(at=e.as(s._).user).userId===this._sdkState.userId&&this._dispatcher.dispatch(new D({channelUrls:[ot.url],source:o.Z.EVENT_CHANNEL_BANNED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserBanned&&e.onUserBanned(ot,at)})),[2]}))}))})),[3,77];case 59:return[4,this.getChannel(ue.channelUrl,!0)];case 60:return ut=Jt.sent(),(ct=e.as(s.Z).user).userId===this._sdkState.userId&&this._dispatcher.dispatch(new D({channelUrls:[ut.url],source:o.Z.EVENT_CHANNEL_UNBANNED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onUserUnbanned&&e.onUserUnbanned(ut,ct)})),[2]}))}))})),[3,77];case 61:return[4,this.getChannel(ue.channelUrl,!0)];case 62:return lt=Jt.sent(),dt=e.as(s.Y).freeze,lt.isFrozen=dt,this._dispatcher.dispatch(new R({channels:[lt],source:dt?o.Z.EVENT_CHANNEL_FROZEN:o.Z.EVENT_CHANNEL_UNFROZEN})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){dt?e.onChannelFrozen&&e.onChannelFrozen(lt):e.onChannelUnfrozen&&e.onChannelUnfrozen(lt)})),[2]}))}))})),[3,77];case 63:return[4,this.getChannel(ue.channelUrl,!0)];case 64:return ht=Jt.sent(),ft=e.as(ve),pt=ft.allowAutoUnhide,_t=ft.hidePreviousMessages,vt=ft.messageOffsetTimestamp,null!==pt&&(ht.hiddenState=pt?Dt.HIDDEN_ALLOW_AUTO_UNHIDE:Dt.HIDDEN_PREVENT_AUTO_UNHIDE),null!==_t&&_t&&ht._updateUnreadCount(0,0),null!==vt&&(ht.messageOffsetTimestamp=vt),this._dispatcher.dispatch(new R({channels:[ht],source:o.Z.EVENT_CHANNEL_HIDDEN})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelHidden&&e.onChannelHidden(ht)})),[2]}))}))})),[3,77];case 65:return[4,this.getChannel(ue.channelUrl,!0)];case 66:return(mt=Jt.sent()).hiddenState=Dt.UNHIDDEN,this._dispatcher.dispatch(new R({channels:[mt],source:o.Z.EVENT_CHANNEL_UNHIDDEN})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(mt)})),[2]}))}))})),[3,77];case 67:return[4,this.getChannel(ue.channelUrl,!0)];case 68:return gt=Jt.sent(),this._dispatcher.dispatch(new D({channelUrls:[ue.channelUrl],source:o.Z.EVENT_CHANNEL_DELETED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelDeleted&&e.onChannelDeleted(gt.url,gt.channelType)})),[2]}))}))})),[3,77];case 69:return[4,this.getChannelWithoutCache(ue.channelUrl,!0)];case 70:return yt=Jt.sent(),this._dispatcher.dispatch(new R({channels:[yt],source:o.Z.EVENT_CHANNEL_UPDATED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(yt)})),[2]}))}))})),[3,77];case 71:return[4,this.getChannel(ue.channelUrl,!0)];case 72:return bt=Jt.sent(),Et=e.as(s.X),wt=Et.created,Ct=Et.updated,Tt=Et.deleted,wt&&(bt._upsertCachedMetaData(wt,ue.ts),this._dispatcher.dispatch(new R({channels:[bt],source:o.Z.EVENT_CHANNEL_METADATA_CREATED}))),Ct&&(bt._upsertCachedMetaData(Ct,ue.ts),this._dispatcher.dispatch(new R({channels:[bt],source:o.Z.EVENT_CHANNEL_METADATA_UPDATED}))),Tt&&(bt._removeFromCachedMetaData(Tt,ue.ts),this._dispatcher.dispatch(new R({channels:[bt],source:o.Z.EVENT_CHANNEL_METADATA_DELETED}))),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){wt&&e.onMetaDataCreated&&e.onMetaDataCreated(bt,wt),Ct&&e.onMetaDataUpdated&&e.onMetaDataUpdated(bt,Ct),Tt&&e.onMetaDataDeleted&&e.onMetaDataDeleted(bt,Tt)})),[2]}))}))})),[3,77];case 73:return[4,this.getChannel(ue.channelUrl,!0)];case 74:return At=Jt.sent(),St=e.as(s.W),It=St.created,Nt=St.updated,kt=St.deleted,It&&this._dispatcher.dispatch(new R({channels:[At],source:o.Z.EVENT_CHANNEL_METACOUNTER_CREATED})),Nt&&this._dispatcher.dispatch(new R({channels:[At],source:o.Z.EVENT_CHANNEL_METACOUNTER_UPDATED})),kt&&this._dispatcher.dispatch(new R({channels:[At],source:o.Z.EVENT_CHANNEL_METACOUNTER_DELETED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){It&&e.onMetaCounterCreated&&e.onMetaCounterCreated(At,It),Nt&&e.onMetaCounterUpdated&&e.onMetaCounterUpdated(At,Nt),kt&&e.onMetaCounterDeleted&&e.onMetaCounterDeleted(At,kt)})),[2]}))}))})),[3,77];case 75:return[4,this.getChannel(ue.channelUrl,!0)];case 76:return xt=Jt.sent(),Ot=e.as(Ce),Mt=Ot.pinnedMessageIds,Rt=Ot.latestPinnedMessage,(Ut=Ot.ts)>xt._pinnedMessagesUpdatedAt&&(xt.pinnedMessageIds=Mt,xt.lastPinnedMessage=Rt,xt._pinnedMessagesUpdatedAt=Ut,this._dispatcher.dispatch(new R({channels:[xt],source:o.Z.EVENT_PINNED_MESSAGE_UPDATED})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){try{for(e=(0,o.s)(this._groupChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelChanged&&n.onChannelChanged(xt)}catch(e){r={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),(0,o.F)((function(){return(0,o._)(Xt,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._groupChannelHandlers.forEach((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(xt)})),[2]}))}))}))),[3,77];case 77:return[3,79];case 78:switch((Lt=e.as(a.U).event).category){case a.a.USER_BLOCK:Pt=a.b.getDataAsUserBlockEvent(this._iid,Lt),jt=Pt.blocker,qt=Pt.blockee,this._groupChannelCache.block(jt.userId,qt.userId);break;case a.a.USER_UNBLOCK:Ft=a.b.getDataAsUserBlockEvent(this._iid,Lt),jt=Ft.blocker,qt=Ft.blockee,this._groupChannelCache.unblock(jt.userId,qt.userId)}return[3,79];case 79:return[3,81];case 80:if(Ht=Jt.sent(),(0,o.N)(Ht))throw Ht;return[3,81];case 81:return[2]}}))}))},t.prototype._markAsLeave=function(e){var t,n=this,r=null!==(t=this._leftChannels.get(e.url))&&void 0!==t?t:{channel:e,ref:0};r.ref++,this._leftChannels.set(e.url,r),setTimeout((function(){r.ref--,0===r.ref&&n._leftChannels.delete(e.url)}),1e4)},t.prototype.addHandler=function(e,t){this._groupChannelHandlers.set(e,t)},t.prototype.removeHandler=function(e){this._groupChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._groupChannelHandlers.clear()},t.prototype.subscribeChannelEvent=function(e,t){this._groupChannelBroadcast.subscribe(e,t)},t.prototype.unsubscribeChannelEvent=function(e){this._groupChannelBroadcast.unsubscribe(e)},t.prototype._updateJoinedMemberCount=function(e){e.joinedMemberCount=e.members.filter((function(e){return e.state===r.JOINED})).length},t.prototype.getChannel=function(e,t){return void 0===t&&(t=!1),(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(n=r.sent())?[2,n]:[3,4];case 3:return r.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e,t)];case 5:return[2,r.sent()]}}))}))},t.prototype.getChannelWithoutCache=function(e,t){return void 0===t&&(t=!1),(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),n=new F({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(n)];case 1:switch(r=u.sent(),i=r.as(j).channel,s=i.unreadMessageCount,a=i.unreadMentionCount,i.myCountPreference){case Rt.UNREAD_MESSAGE_COUNT_ONLY:a=0;break;case Rt.UNREAD_MENTION_COUNT_ONLY:s=0;break;case Rt.OFF:s=0,a=0}return i._updateUnreadCount(s,a),[4,this.upsertChannelsToCache([i])];case 2:return[2,u.sent()[0]]}}))}))},t.prototype.refreshChannel=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=o.Z.REFRESH_CHANNEL),(0,o._)(this,void 0,void 0,(function(){var i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,5,,6]),i=new F({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(i)];case 1:return s=l.sent(),(a=s.as(j).channel).myMemberState!==r.NONE?[3,2]:(this._dispatcher.dispatch(new D({channelUrls:[a.url],source:n})),[3,4]);case 2:return[4,this.upsertChannelsToCache([a])];case 3:u=l.sent(),this._dispatcher.dispatch(new R({channels:u,source:n})),l.label=4;case 4:return[3,6];case 5:return(c=l.sent()).code!==o.ah.NON_AUTHORIZED&&c.code!==o.ah.NOT_FOUND_IN_DATABASE||this._dispatcher.dispatch(new D({channelUrls:[e],source:n})),[3,6];case 6:return[2]}}))}))},t.prototype.getMyGroupChannels=function(e,t,n,r){return void 0===r&&(r=o.Z.REQUEST_CHANNEL),(0,o._)(this,void 0,void 0,(function(){var i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return t.createdAfter&&(t.createdAfter=Math.floor(t.createdAfter/1e3)),t.createdBefore&&(t.createdBefore=Math.floor(t.createdBefore/1e3)),i=new H((0,o.g)((0,o.g)({},t),{userId:this._sdkState.userId,token:e,limit:n})),[4,this._requestQueue.send(i)];case 1:return s=l.sent(),a=s.as(V),u=a.channels,c=a.token,this._dispatcher.dispatch(new R({channels:u,source:r})),[2,{channels:u,token:c}]}}))}))},t.prototype.getMyGroupChannelChangeLogs=function(e,t,n){return void 0===n&&(n=o.Z.REQUEST_CHANNEL_CHANGELOGS),(0,o._)(this,void 0,void 0,(function(){var r,i,s,a,u,c,l,d;return(0,o.b)(this,(function(h){switch(h.label){case 0:return r=(0,o.g)((0,o.g)({},T),t),(0,o.t)(((0,o.a)("string",e)||(0,o.a)("number",e))&&A(r)).throw(o.r.invalidParameters),i=new L((0,o.u)({userId:this._sdkState.userId,ts:"number"==typeof e?e:null,token:"string"==typeof e?e:null,filter:r})),[4,this._requestQueue.send(i)];case 1:return s=h.sent(),a=s.as(P),u=a.updatedChannels,c=a.deletedChannelUrls,l=a.hasMore,d=a.ts,u.length>0&&this._dispatcher.dispatch(new R({channels:u,source:n,ts:d})),c.length>0&&this._dispatcher.dispatch(new D({channelUrls:c,source:n})),[2,{updatedChannels:u,deletedChannelUrls:c,hasMore:l,token:a.token}]}}))}))},t.prototype.getGroupChannelCount=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return t=(0,o.g)((0,o.g)({},S),e),(0,o.t)(I(t)).throw(o.r.invalidParameters),n=new B({userId:this._sdkState.userId,filter:t}),[4,this._requestQueue.send(n)];case 1:return[2,r.sent().as(z).groupChannelCount]}}))}))},t.prototype.getUnreadItemCount=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c,l,d,h,f,p,_,v,m;return(0,o.b)(this,(function(g){switch(g.label){case 0:return t=(0,o.g)((0,o.g)({},k),e),(0,o.t)(function(e){return(0,o.O)(y,e.keys)}(t)).throw(o.r.invalidParameters),n=o.V.of(this._iid),r=n.sdkState,i=n.requestQueue,s=new G({userId:r.userId,filter:t}),[4,i.send(s)];case 1:return a=g.sent(),u=a.as(W),c=u.groupChannelUnreadMentionCount,l=u.groupChannelUnreadMessageCount,d=u.groupChannelInvitationCount,h=u.superGroupChannelUnreadMentionCount,f=u.superGroupChannelUnreadMessageCount,p=u.superGroupChannelInvitationCount,_=u.nonSuperGroupChannelUnreadMentionCount,v=u.nonSuperGroupChannelUnreadMessageCount,m=u.nonSuperGroupChannelInvitationCount,[2,(0,o.e)({groupChannelUnreadMentionCount:c,groupChannelUnreadMessageCount:l,groupChannelInvitationCount:d,superGroupChannelUnreadMentionCount:h,superGroupChannelUnreadMessageCount:f,superGroupChannelInvitationCount:p,nonSuperGroupChannelUnreadMentionCount:_,nonSuperGroupChannelUnreadMessageCount:v,nonSuperGroupChannelInvitationCount:m})]}}))}))},t.prototype.getTotalUnreadChannelCount=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return e=o.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new K({userId:t.userId}),[4,n.send(r)];case 1:return[2,i.sent().as(Q).unreadCount]}}))}))},t.prototype.getTotalUnreadMessageCount=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return t=(0,o.g)((0,o.g)({},x),e),(0,o.t)(function(e){return(0,o.O)("string",e.channelCustomTypesFilter,!0)&&(0,o.T)(d,e.superChannelFilter)}(t)).throw(o.r.invalidParameters),n=o.V.of(this._iid),r=n.sdkState,i=n.requestQueue,s=new Z({userId:r.userId,filter:t}),[4,i.send(s)];case 1:return[2,a.sent().as(Y).unreadCount]}}))}))},t.prototype.getTotalScheduledMessageCount=function(e){return void 0===e&&(e={}),(0,o._)(this,void 0,void 0,(function(){var t,n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return t=(0,o.g)((0,o.g)({},O),e),(0,o.t)(function(e){return(0,o.a)("string",e.channelUrl,!0)&&(0,o.O)(s.L,e.scheduledStatus,!0)&&(0,o.T)(o.al,e.messageTypeFilter)}(t)).throw(o.r.invalidParameters),n=o.V.of(this._iid).requestQueue,r=new $(t),[4,n.send(r)];case 1:return[2,i.sent().as(X).count]}}))}))},t.prototype.getSubscribedTotalUnreadMessageCount=function(){var e=o.V.of(this._iid).subscribedUnreadMessageCount;return e.all>=0?e.all:0},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){var e=0,t=o.V.of(this._iid).subscribedUnreadMessageCount;for(var n in t.customTypes)e+=t.customTypes[n];return e},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){var t;return null!==(t=o.V.of(this._iid).subscribedUnreadMessageCount.customTypes[e])&&void 0!==t?t:0},t.prototype.createChannel=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return t=(0,o.g)((0,o.g)({},w),e),(0,o.t)(C(t)).throw(o.r.invalidParameters),t.isPublic||(t.accessCode=void 0),n=new ee((0,o.g)({userId:this._sdkState.userId},t)),[4,this._requestQueue.send(n)];case 1:return r=s.sent(),i=r.as(te).channel,[4,this.upsertChannelsToCache([i])];case 2:return s.sent(),[2,i]}}))}))},t.prototype.markAsReadAll=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return e=Date.now(),(0,o.t)(e-this._markAsReadAllLastSentAt>=1e3).throw(o.r.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=e,t=new ne({userId:this._sdkState.userId}),[4,this._requestQueue.send(t)];case 1:c.sent(),n=this._groupChannelCache.channels;try{for(r=(0,o.s)(n),i=r.next();!i.done;i=r.next())(s=i.value)._updateUnreadMemberState(this._sdkState.userId,e),s._updateUnreadCount(0,0)}catch(e){a={error:e}}finally{try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(a)throw a.error}}return n.length>0?[4,this.upsertChannelsToCache(n)]:[3,3];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))},t.prototype.markAsReadWithChannelUrls=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c,l;return(0,o.b)(this,(function(d){switch(d.label){case 0:return t=Date.now(),(0,o.t)((0,o.O)("string",e)&&t-this._markAsReadAllLastSentAt>=1e3).throw(o.r.markAsReadAllRateLimitExceeded),this._markAsReadAllLastSentAt=t,n=new ne({userId:this._sdkState.userId,channelUrls:e}),[4,this._requestQueue.send(n)];case 1:d.sent(),r=this._groupChannelCache.channels,i=[];try{for(s=(0,o.s)(r),a=s.next();!a.done;a=s.next())u=a.value,e.includes(u.url)&&(u._updateUnreadMemberState(this._sdkState.userId,t),u._updateUnreadCount(0,0),i.push(u))}catch(e){c={error:e}}finally{try{a&&!a.done&&(l=s.return)&&l.call(s)}finally{if(c)throw c.error}}return i.length>0?[4,this.upsertChannelsToCache(i)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[2]}}))}))},t.prototype.markAsDelivered=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this.getChannel(e)];case 1:return[4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},t.prototype.getMessageFromCache=function(e){var t;return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._messageCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(r){switch(r.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,filter:n,exactMatch:!0})];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessagesFromCache=function(e,t,n,r,i,a){return void 0===i&&(i=s.a9),void 0===a&&(a=!0),(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(o){switch(o.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,limit:i,filter:r,backward:"next"===n,inclusive:a})];case 1:return[2,o.sent()]}}))}))},t.prototype.getPollMessagesFromCache=function(e,t,n,r){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(i){switch(i.label){case 0:return[4,this._messageCache.fetch({channelUrl:e,token:t,limit:r,filter:n,backward:!1,isPollOnly:!0})];case 1:return[2,i.sent()]}}))}))},t.prototype.getCachedMessageCountBetween=function(e,t,n,r){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(i){switch(i.label){case 0:return[4,this._messageCache.countBetween(e,t,new ke({top:n,bottom:r}))];case 1:return[2,i.sent()]}}))}))},t.prototype.getUnsentMessagesFromCache=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._unsentMessageCache.fetch({channelUrl:e,filter:t})];case 1:return[2,n.sent()]}}))}))},t.prototype.removeFailedMessageFromCache=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._unsentMessageCache.remove([e])];case 1:return t.sent(),[2]}}))}))},t}(u.B),Me=function(e,t){return t instanceof s.a4?e.findIndex((function(e){return e instanceof s.a4&&t.isIdentical(e)})):e.findIndex((function(e){return e.isIdentical(t)}))},Re=function(e,t){return e.findIndex((function(e){return e instanceof s.a2?e.messageId===t:e instanceof s.aa?e.notificationId===t:void 0}))},De=function(e,t){if(e.length>0){for(var n=0,r=e.length-1,i=Math.floor((n+r)/2);n<r;){var o=e[i].createdAt-t.createdAt;if(o>0)r=i,i=Math.floor((n+r)/2);else{if(!(o<0))return i;n=i+1,i=Math.floor((n+r)/2)}}return e[i].createdAt>t.createdAt?i:i+1}return e.length};!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.END=2]="END"}(Ie||(Ie={}));var Ue,Le=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o._state=Ie.IDLE,o._retryCount=0,o._retryLimit=3,o.priority=0,o._worker=n,o}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"isIdle",{get:function(){return this._state===Ie.IDLE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRunning",{get:function(){return this._state===Ie.RUNNING},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDone",{get:function(){return this._state===Ie.END},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryCount",{get:function(){return this._retryCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"retryLimit",{get:function(){return this._retryLimit},enumerable:!1,configurable:!0}),t.prototype._run=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:if(!this.isRunning)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._worker(e)];case 2:return t=r.sent(),this._retryCount=0,this.dispatch("progress",t),t.hasNext?this._run(t.nextToken):this.end(),[3,4];case 3:return n=r.sent(),this.dispatch("error",n),this._retryCount<this._retryLimit?(this._retryCount++,this._run(e)):this.stop(),[3,4];case 4:return[2]}}))}))},t.prototype.start=function(e){this.isIdle&&(this._state=Ie.RUNNING,this._run(e))},t.prototype.stop=function(){this._state=Ie.IDLE,this.dispatch("stop")},t.prototype.end=function(){this._state=Ie.END,this.dispatch("end")},t}(o.E),Pe={},Fe=function(){function e(e){var t=e._iid,n=e.channel,r=e.limit,i=void 0===r?100:r,a=this;this.ref=0,this._iid=t,this._channel=n,this._limit=i,this._prevSyncLoopCount=0,this._nextSyncLoopCount=0;var u,c,l=o.V.of(this._iid),d=l.sdkState,h=l.cacheContext,f=l.dispatcher,p=l.logger,_=l.statLogCollector;this._metadataKey=(u=d.userId,c=n.url,"sendbird:".concat(u,"@groupchannel/").concat(c,"/message/sync.meta"));var v=function(e,t){return"sendbird:".concat(e,"@groupchannel/").concat(t,"/message/sync")}(d.userId,n.url);this._prevSync=new Le(v,(function(e){return(0,o._)(a,void 0,void 0,(function(){var t,r,i,a,u,c,l,d,f,v,m,g;return(0,o.b)(this,(function(y){switch(y.label){case 0:return t={hasNext:!0,nextToken:0},this._prevSyncLoopCount++,[4,this.loadMetadata(e)];case 1:if(y.sent(),p.debug("message background prev sync from",null===(c=this._metadata)||void 0===c?void 0:c.range.top),null===(l=this._metadata)||void 0===l?void 0:l.previousComplete)return[3,10];y.label=2;case 2:return y.trys.push([2,5,8,9]),[4,s.ab.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,(null===(f=null===(d=this._metadata)||void 0===d?void 0:d.range)||void 0===f?void 0:f.top)?this._metadata.range.top:e,{prevResultSize:this._limit,nextResultSize:0,replyType:o.at.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0},o.Z.SYNC_MESSAGE_BACKGROUND)];case 3:return(r=y.sent()).length>0&&(i=r.map((function(e){return e.createdAt})),(null===(v=this._metadata)||void 0===v?void 0:(u=v.range).intersect.apply(u,(0,o.o)([],(0,o.p)(i),!1)))?this.extendRange(r):this._metadata={range:new ke({top:Math.min.apply(Math,(0,o.o)([],(0,o.p)(i),!1)),bottom:Math.max.apply(Math,(0,o.o)([],(0,o.p)(i),!1))}),previousComplete:!1}),t.hasNext=r.length>=this._limit&&this._prevSyncLoopCount<1,this._metadata&&(t.nextToken=this._metadata.range.top,this._metadata.previousComplete=r.length<this._limit),p.debug("message background prev sync progress",t),[4,this.saveMetadata()];case 4:return y.sent(),[3,9];case 5:return a=y.sent(),p.debug("message background prev sync error",a),a instanceof o.r&&a.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:y.sent(),y.label=7;case 7:throw a;case 8:return _.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:n.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:null!==(g=null===(m=h.localCacheConfig)||void 0===m?void 0:m.maxSize)&&void 0!==g?g:0,use_local_cache:h.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 9:return[3,11];case 10:t.hasNext=!1,y.label=11;case 11:return[2,t]}}))}))})),this._nextSync=new Le(v,(function(e){return(0,o._)(a,void 0,void 0,(function(){var t,r,i,a,u,c,l,d,f,v,m;return(0,o.b)(this,(function(g){switch(g.label){case 0:return t={hasNext:!0,nextToken:0},this._nextSyncLoopCount++,[4,this.loadMetadata(e)];case 1:g.sent(),p.debug("message background next sync from",null===(c=this._metadata)||void 0===c?void 0:c.range.bottom),g.label=2;case 2:return g.trys.push([2,5,6,7]),[4,s.ab.of(this._iid).getMessagesByTimestamp(this._channel.url,this._channel.channelType,(null===(d=null===(l=this._metadata)||void 0===l?void 0:l.range)||void 0===d?void 0:d.bottom)?this._metadata.range.bottom:e,{prevResultSize:0,nextResultSize:this._limit,replyType:o.at.ALL,includeReactions:!0,includeMetaArray:!0,includeParentMessageInfo:!0,includeThreadInfo:!0},o.Z.SYNC_MESSAGE_BACKGROUND)];case 3:return(r=g.sent()).length>0&&(i=r.map((function(e){return e.createdAt})),(null===(f=this._metadata)||void 0===f?void 0:(u=f.range).intersect.apply(u,(0,o.o)([],(0,o.p)(i),!1)))?this.extendRange(r):this._metadata={range:new ke({top:Math.min.apply(Math,(0,o.o)([],(0,o.p)(i),!1)),bottom:Math.max.apply(Math,(0,o.o)([],(0,o.p)(i),!1))}),previousComplete:!1}),t.hasNext=r.length>=this._limit&&this._nextSyncLoopCount<1,this._metadata&&(t.nextToken=this._metadata.range.bottom),p.debug("message background next sync progress",t),[4,this.saveMetadata()];case 4:return g.sent(),[3,7];case 5:throw a=g.sent(),p.debug("message background next sync error",a),a;case 6:return _.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:n.url,measured_on:"back_sync",event:"cache_fetch",max_db_size:null!==(m=null===(v=h.localCacheConfig)||void 0===v?void 0:v.maxSize)&&void 0!==m?m:0,use_local_cache:h.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[2,t]}}))}))})),this._connectionEventContext=f.on((function(e){e instanceof o.B&&(e.stateType===o.D.CONNECTED?a.resume():a.pause())}))}return e.of=function(t,n){return Pe[t]||(Pe[t]={}),Pe[t][n.url]||(Pe[t][n.url]=new e({_iid:t,channel:n})),Pe[t][n.url].ref++,Pe[t][n.url]},e.clear=function(e,t){Pe[e]&&Pe[e][t]&&(Pe[e][t].close(),delete Pe[e])},Object.defineProperty(e.prototype,"range",{get:function(){var e,t;return null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.range)&&void 0!==t?t:new ke({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousComplete",{get:function(){var e;return!!(null===(e=this._metadata)||void 0===e?void 0:e.previousComplete)},enumerable:!1,configurable:!0}),e.prototype.isWrappingMessages=function(e){var t;return null===(t=this.range)||void 0===t?void 0:t.includes.apply(t,(0,o.o)([],(0,o.p)(e.map((function(e){return e.createdAt}))),!1))},e.prototype.extendRange=function(e){var t;this._metadata&&(t=this._metadata.range).extends.apply(t,(0,o.o)([],(0,o.p)(e.map((function(e){return e.createdAt}))),!1))},e.prototype.loadMetadata=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this._metadata?[3,2]:[4,o.V.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:(t=n.sent())?t.range.bottom<e?this._metadata={range:new ke({}),previousComplete:!1}:this._metadata={range:new ke(t.range),previousComplete:t.previousComplete}:this._metadata={range:new ke({}),previousComplete:!1},n.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return this._metadata?[4,o.V.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,o.V.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(e){var t,n,r,i;void 0===e&&(e=Date.now());var s=o.V.of(this._iid),a=s.logger;s.sessionManager.session.hasSession&&(a.debug("message background sync resume()"),this._prevSyncLoopCount=this._nextSyncLoopCount=0,this._metadata&&this._metadata.previousComplete||this._prevSync.start(null!==(n=null===(t=this._metadata)||void 0===t?void 0:t.range.top)&&void 0!==n?n:e),this._nextSync.start(null!==(i=null===(r=this._metadata)||void 0===r?void 0:r.range.bottom)&&void 0!==i?i:e))},e.prototype.pause=function(){o.V.of(this._iid).logger.debug("message background sync stop()"),this._prevSync.stop(),this._nextSync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Pe[this._iid][this._channel.url])},e}(),je={},qe=function(){function e(e){var t=e._iid,n=e.channel,r=e.includeParams,i=this;this.ref=0,this._iid=t,this._channel=n,this._includeParams=r;var a,u,c=o.V.of(this._iid),l=c.logger,d=c.sdkState,h=c.dispatcher;this._metadataKey=(a=d.userId,u=n.url,"sendbird:".concat(a,"@groupchannel/").concat(u,"/message/changelogs.meta"));var f=function(e,t){return"sendbird:".concat(e,"@groupchannel/").concat(t,"/message/changelogs")}(d.userId,this._channel.url);this._sync=new Le(f,(function(){return(0,o._)(i,void 0,void 0,(function(){var e,t,n,r,i,a,u,c;return(0,o.b)(this,(function(d){switch(d.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:d.sent(),l.debug("message changelog sync from",null===(c=this._metadata)||void 0===c?void 0:c.token),d.label=2;case 2:return d.trys.push([2,5,,8]),[4,s.ab.of(this._iid).getMessageChangelogs(this._channel.url,this._channel.channelType,this._metadata.token,(0,o.g)({replyType:o.at.ALL},this._includeParams),o.Z.SYNC_MESSAGE_CHANGELOGS)];case 3:return t=d.sent(),n=t.updatedMessages,r=t.deletedMessageIds,i=t.hasMore,a=t.token,e.hasNext=i,e.nextToken=a,(n.length>0||r.length>0)&&this._metadata&&(this._metadata.token=a),l.debug("message changelog sync progress",e),[4,this.saveMetadata()];case 4:return d.sent(),[3,8];case 5:return u=d.sent(),l.debug("message changelog sync error",u),u instanceof o.r&&u.isInvalidTokenError?[4,this.clearMetadata()]:[3,7];case 6:d.sent(),d.label=7;case 7:throw u;case 8:return[2,e]}}))}))})),this._connectionEventContext=h.on((function(e){e instanceof o.B&&(e.stateType===o.D.CONNECTED?i.resume():i.pause())}))}return e.of=function(t,n,r){return je[t]||(je[t]={}),je[t][n.url]||(je[t][n.url]=new e({_iid:t,channel:n,includeParams:r})),je[t][n.url].ref++,je[t][n.url]},e.clear=function(e,t){je[e]&&je[e][t]&&(je[e][t].close(),delete je[e])},e.prototype.loadMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return this._metadata?[3,2]:(e=o.V.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=i.sent(),this._metadata={token:r?r.token:n},i.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return this._metadata?[4,o.V.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,o.V.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){var e=o.V.of(this._iid),t=e.logger;e.sessionManager.session.hasSession&&(t.debug("message changelog sync resume()"),this._sync.start(0))},e.prototype.pause=function(){o.V.of(this._iid).logger.debug("message changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete je[this._iid][this._channel.url])},e}(),He={},Ve=function(){function e(e){var t=e._iid,n=e.channel,r=e.hasPollMessage,i=this;this.ref=0,this._iid=t,this._channel=n;var s,a,u=o.V.of(this._iid),c=u.logger,l=u.sdkState,d=u.dispatcher;this._metadataKey=(s=l.userId,a=n.url,"sendbird:".concat(s,"@groupchannel/").concat(a,"/poll/changelogs.meta"));var h=function(e,t){return"sendbird:".concat(e,"@groupchannel/").concat(t,"/poll/changelogs")}(l.userId,this._channel.url);this._sync=new Le(h,(function(){return(0,o._)(i,void 0,void 0,(function(){var e,t,n,i,s,a,u,l;return(0,o.b)(this,(function(d){switch(d.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:return d.sent(),c.debug("poll changelog sync from",null===(l=this._metadata)||void 0===l?void 0:l.token),(t=!this._metadata||!this._metadata.token)?[4,r()]:[3,3];case 2:t=!d.sent(),d.label=3;case 3:if(t)return[2,{hasNext:!1,nextToken:0}];this._metadata||(n=o.V.of(this._iid).firstConnectedAt,this._metadata={token:n}),d.label=4;case 4:return d.trys.push([4,7,,10]),[4,o.aH.of(this._iid).getPollChangeLogs(this._channel.url,this._channel.channelType,this._metadata.token)];case 5:return i=d.sent(),s=i.hasMore,a=i.token,e.hasNext=s,e.nextToken=a,this._metadata.token=a,c.debug("poll changelog sync progress",e),[4,this.saveMetadata()];case 6:return d.sent(),[3,10];case 7:return u=d.sent(),c.debug("poll changelog sync error",u),u instanceof o.r&&u.isInvalidTokenError?[4,this.clearMetadata()]:[3,9];case 8:d.sent(),d.label=9;case 9:throw u;case 10:return[2,e]}}))}))})),this._connectionEventContext=d.on((function(e){e instanceof o.B&&(e.stateType===o.D.CONNECTED?i.resume():i.pause())}))}return e.of=function(t,n,r){return He[t]||(He[t]={}),He[t][n.url]||(He[t][n.url]=new e({_iid:t,channel:n,hasPollMessage:r})),He[t][n.url].ref++,He[t][n.url]},e.prototype.loadMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,o.V.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata=e?{token:e.token}:void 0,t.label=2;case 2:return[2]}}))}))},e.prototype.saveMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return this._metadata?[4,o.V.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.clearMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,o.V.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){o.V.of(this._iid).logger.debug("poll changelog sync resume()"),this._sync.start(0)},e.prototype.pause=function(){o.V.of(this._iid).logger.debug("poll changelog sync pause()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete He[this._iid][this._channel.url])},e}(),Be=function(e){function t(t){var n=t.channels,r=t.source,i=t.isWebSocketEventComing,o=void 0!==i&&i,s=t.data,a=void 0===s?null:s,u=e.call(this)||this;return u.channels=n,u.source=r,u.isWebSocketEventComing=o,u.data=a,u}return(0,o.c)(t,e),t}(o.b0),ze=(function(e){function t(t){var n=t.channelUrls,r=t.source,i=t.isWebSocketEventComing,o=void 0!==i&&i,s=e.call(this)||this;return s.channelUrls=n,s.source=r,s.isWebSocketEventComing=o,s}(0,o.c)(t,e)}(o.b0),function(e){function t(t){var n,r,i,s,a,u,c,l,d,h,f=this;return(f=e.call(this)||this).method=o.A.GET,f.path="".concat((0,o.ag)(t.channelType),"/").concat(t.channelUrl,"/messages_gap"),f.params=(0,o.e)({prev_start_ts:t.prevStart,prev_end_ts:t.prevEnd,prev_cache_count:t.prevCount,next_start_ts:t.nextStart,next_end_ts:t.nextEnd,next_cache_count:t.nextCount,huge_gap_threshold:null!==(n=t.threshold)&&void 0!==n?n:null,reverse:!0,custom_types:null!==(r=t.customTypes)&&void 0!==r?r:["*"],message_type:null!==(i=t.messageType)&&void 0!==i?i:null,include_reply_type:null!==(s=t.replyType)&&void 0!==s?s:o.at.NONE,include_reactions:null===(a=t.includeReactions)||void 0===a||a,include_meta_array:null===(u=t.includeMetaArray)||void 0===u||u,include_thread_info:null===(c=t.includeThreadInfo)||void 0===c||c,include_parent_message_info:null===(l=t.includeParentMessageInfo)||void 0===l||l,with_sorted_meta_array:null===(d=t.includeMetaArray)||void 0===d||d,show_subchannel_messages_only:null!==(h=t.showSubchannelMessagesOnly)&&void 0!==h&&h,include_poll_details:!0,checking_continuous_messages:t.checkingContinuousMessages}),f}return(0,o.c)(t,e),t}(o.f)),Ge=function(e){function t(t,n){var r,i,o,a,u,c,l=this;return(l=e.call(this,t,n)||this).isHugeGap=n.is_huge_gap,l.prevMessages=(null!==(r=n.prev_messages)&&void 0!==r?r:[]).map((function(e){return(0,s.K)(t,e)})),l.prevHasMore=null!==(i=n.prev_hasmore)&&void 0!==i&&i,l.isContinuousPrevMessages=null!==(o=n.is_continuous_prev_messages)&&void 0!==o&&o,l.nextMessages=(null!==(a=n.next_messages)&&void 0!==a?a:[]).map((function(e){return(0,s.K)(t,e)})),l.nextHasmore=null!==(u=n.next_hasmore)&&void 0!==u&&u,l.isContinuousNextMessages=null!==(c=n.is_continuous_next_messages)&&void 0!==c&&c,l}return(0,o.c)(t,e),t}(o.h),We=function(e){this.source=e},Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.c)(t,e),t}(We),Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.c)(t,e),t}(We),Ze=function(e){this.source=e},Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.c)(t,e),t}(Ze),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.c)(t,e),t}(Ze),Xe=6e5,Je={includeMetaArray:!0,includeReactions:!0,includeThreadInfo:!0,includeParentMessageInfo:!0};!function(e){e.CACHE_AND_REPLACE_BY_API="cache_and_replace_by_api"}(Ue||(Ue={}));var et,tt,nt,rt=function(){function e(){this._onCacheResult=o.av,this._onApiResult=o.av}return e.prototype._invokeResponse=function(e,t,n){var r=this;(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(r){switch(e){case"local":this._onCacheResult(t,n);break;case"remote":this._onApiResult(t,n)}return[2]}))}))}))},e.prototype.onCacheResult=function(e){return this._onCacheResult=e,this},e.prototype.onApiResult=function(e){return this._onApiResult=e,this},e}(),it=function(){function e(e,t){var n=t.filter,r=t.startingPoint,i=t.limit,a=t.prevResultLimit,u=t.nextResultLimit,c=t.channel,l=t.channelManager,d=t.disableBackgroundSync,h=void 0!==d&&d,f=this;this._messages=[],this._unsentMessages=[],this._isLoadingPrevious=!1,this._isLoadingNext=!1,this._iid=e,this._key="mc-".concat((0,o.m)()),this._isDisposed=!1,this.filter=null!=n?n:new s.H,this._channel=c,this._syncRange=new ke({}),this._hasPrevious=!0,this._hasNext=!0,this._startingPoint="number"==typeof r&&Number.isFinite(r)?r:Date.now()+Xe,this._limit=i||s.a9,this._prevResultLimit=null!=a?a:Math.floor(this._limit/2),this._nextResultLimit=null!=u?u:Math.floor(this._limit/2),this._channelManager=l,this._channelManager.subscribeChannelEvent(this._key,{onUpdate:function(e,t,n){var r=e.findIndex((function(e){return e.isIdentical(f.channel)}));r>=0&&(f._replaceChannelOfCollection(e[r]),f.channel._runIfHandleableWithGroupChannel((function(e){switch(t){case o.Z.EVENT_CHANNEL_UPDATED:var r=!1;for(var i in f._messages)if(f._messages[i].createdAt>=e.messageOffsetTimestamp){r=!0;var s=parseInt(i);if(s>0){var a=f._messages.splice(0,s);f._removeMessagesFromView(a.map((function(e){return f.keyOf(e)})),o.Z.EVENT_MESSAGE_OFFSET_UPDATED)}break}!r&&f._messages.length>0&&f._removeMessagesFromView(f._messages.map((function(e){return f.keyOf(e)})),o.Z.EVENT_MESSAGE_OFFSET_UPDATED);break;case o.Z.EVENT_CHANNEL_UNMUTED:var u=o.V.of(f._iid).sdkState,c=n;u.userId===c&&f._clearCheckMyMutedTimer();break;case o.Z.EVENT_CHANNEL_MUTED:u=o.V.of(f._iid).sdkState;var l=n;u.userId===l&&-1!==e._myMutedRemainingTime&&f._startCheckMyMutedTimer(e._myMutedRemainingTime);break;case o.Z.EVENT_CHANNEL_LEFT:e.isPublic&&f._clearCheckMyMutedTimer()}(0,o.F)((function(){return(0,o._)(f,void 0,void 0,(function(){var e,n;return(0,o.b)(this,(function(r){return e=this._createChannelEventContext(t),M(t)&&(null===(n=this._handler)||void 0===n?void 0:n.onChannelUpdated)&&this._handler.onChannelUpdated(e,this.channel),[2]}))}))}))})),f._postprocessChannelUpdateEvent(e[r],t))},onRemove:function(e,t){var n=e.indexOf(f.channel.url);n>=0&&(f._clearCheckMyMutedTimer(),(0,o.F)((function(){return(0,o._)(f,void 0,void 0,(function(){var e,n;return(0,o.b)(this,(function(r){return e=this._createChannelEventContext(t),(null===(n=this._handler)||void 0===n?void 0:n.onChannelDeleted)&&this._handler.onChannelDeleted(e,this.channel.url),[2]}))}))})),f._postprocessChannelRemoveEvent(e[n]))}}),this._channelManager.subscribeMessageEvent(this._key,{onUpdate:function(e,t){var n,r,i=[],s=[];try{for(var a=(0,o.s)(e),u=a.next();!u.done;u=a.next()){var c=u.value;c.channelUrl===f._channel.url&&(f.filter.match(c)?i.push(c):s.push(f.keyOf(c)))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}if((0,o.bb)(t)){if(i.length>0)switch(t){case o.Z.LOCAL_MESSAGE_CANCELED:case o.Z.LOCAL_MESSAGE_RESEND_STARTED:case o.Z.EVENT_MESSAGE_SENT_FAILED:case o.Z.EVENT_MESSAGE_SENT_SUCCESS:case o.Z.EVENT_MESSAGE_UPDATED:case o.Z.EVENT_MESSAGE_THREADINFO_UPDATED:case o.Z.EVENT_MESSAGE_REACTION_UPDATED:case o.Z.EVENT_MESSAGE_FEEDBACK_ADDED:case o.Z.EVENT_MESSAGE_FEEDBACK_UPDATED:case o.Z.EVENT_MESSAGE_FEEDBACK_DELETED:case o.Z.SYNC_MESSAGE_CHANGELOGS:f._updateMessagesToView(i,t);break;case o.Z.EVENT_MESSAGE_SENT_PENDING:f._addMessagesToView(i,t);break;case o.Z.EVENT_MESSAGE_RECEIVED:f.hasNext||f._addMessagesToView(i,t);break;case o.Z.SYNC_MESSAGE_FILL:f._addMessagesToView(i,t)}s.length>0&&f._removeMessagesFromView(s,t)}f._postprocessMessageUpdateEvent(e,t)},onRemove:function(e,t){f._removeMessagesFromView(e,t),f._postprocessMessageRemoveEvent(e)},onRemoveUnsent:function(e,t){f._removeUnsentMessageFromView(e,t)},onPollChangeLogUpdate:function(e,t){f._updatePollsToView(e,t)},onPollUpdate:function(e,t){f._applyPollUpdateEventToView(e,t)},onPollVote:function(e,t){f._applyPollVoteEventToView(e,t)},onReactionUpdate:function(e,t){f._applyReactionEventToview(e,t)},onThreadInfoUpdate:function(e,t){f._applyThreadInfoEventToview(e,t)}});var p=o.V.of(this._iid),_=p.cacheContext,v=p.dispatcher;this._channel._updateMessageCollectionLastAccessedAt();var m=this._createChannelUpdateEventCommand(o.Z.CHANNEL_LASTACCESSEDAT_UPDATED);m&&v.dispatch(m),!h&&this._shouldStartBackgroundSync()&&(this._backgroundSync=Fe.of(this._iid,this._channel),this._backgroundSync.resume(this._startingPoint)),this._changelogSync=qe.of(this._iid,this._channel,this.changelogIncludeParams),this._changelogSync.resume(),this._pollChangelogSync=Ve.of(this._iid,this._channel,this._hasPollMessage.bind(this)),this._pollChangelogSync.resume(),this._prevFill=new Le(this._key,(function(e){return(0,o._)(f,void 0,void 0,(function(){var t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return[4,this._getRemoteMessages(e,{prevLimit:this._prevResultLimit,source:o.Z.SYNC_MESSAGE_FILL,checkingContinuousMessages:_.localCacheEnabled})];case 1:return t=c.sent(),n=t.messages,r=t.isContinuousMessages,n.length>0?(i=Math.min.apply(Math,(0,o.o)([],(0,o.p)(n.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(i),r&&(null===(s=this._backgroundSync)||void 0===s||s.range.extends(i)),[2,{hasNext:n.length>=this._prevResultLimit&&this.viewTop<i,nextToken:this._syncRange.top}]):(g.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(u=null===(a=_.localCacheConfig)||void 0===a?void 0:a.maxSize)&&void 0!==u?u:0,use_local_cache:_.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}}))}))})),this._nextFill=new Le(this._key,(function(e){return(0,o._)(f,void 0,void 0,(function(){var t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return[4,this._getRemoteMessages(e,{nextLimit:this._nextResultLimit,source:o.Z.SYNC_MESSAGE_FILL,checkingContinuousMessages:_.localCacheEnabled})];case 1:return t=c.sent(),n=t.messages,r=t.isContinuousMessages,n.length>0?(i=Math.max.apply(Math,(0,o.o)([],(0,o.p)(n.map((function(e){return e.createdAt}))),!1)),this._syncRange.extends(i),r&&(null===(s=this._backgroundSync)||void 0===s||s.range.extends(i)),[2,{hasNext:!(n.length>=this._nextResultLimit&&this._hasNext)||this.viewBottom>i,nextToken:this._syncRange.bottom}]):(g.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(u=null===(a=_.localCacheConfig)||void 0===a?void 0:a.maxSize)&&void 0!==u?u:0,use_local_cache:_.localCacheEnabled,starting_point:0,message_init_policy:""}})),[2,{hasNext:!1,nextToken:0}])}}))}))})),this._connectionEventContext=v.on((function(e){if(e instanceof o.B)switch(e.stateType){case o.D.CONNECTED:(0,o.z)((function(){return(0,o._)(f,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._activate(),[2]}))}))}));break;case o.D.LOGOUT:f.dispose();break;default:f._clearCheckMyMutedTimer(),f._prevFill.stop(),f._nextFill.stop()}}));var g=o.V.of(this._iid).statLogCollector;g.put(new o.b1({type:o.b2.FEATURE_LOCALCACHE,data:{use_local_cache:_.localCacheEnabled,collection_interface:{message:!0}}}))}return e.prototype.keyOf=function(e){return 0},Object.defineProperty(e.prototype,"changelogIncludeParams",{get:function(){return{includeReactions:!0,includeThreadInfo:!0,includeMetaArray:!0,includeParentMessageInfo:!0}},enumerable:!1,configurable:!0}),e.prototype._postprocessChannelUpdateEvent=function(e,t){},e.prototype._postprocessChannelRemoveEvent=function(e){},e.prototype._postprocessMessageUpdateEvent=function(e,t){},e.prototype._postprocessMessageRemoveEvent=function(e){},Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"succeededMessages",{get:function(){return(0,o.o)([],(0,o.p)(this._messages),!1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===o.aj.FAILED}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pendingMessages",{get:function(){return this._unsentMessages.filter((function(e){return e.sendingStatus===o.aj.PENDING}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return this._hasPrevious},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewTop",{get:function(){return Math.min.apply(Math,(0,o.o)((0,o.o)([],(0,o.p)(this._messages.map((function(e){return e.createdAt}))),!1),[Number.MAX_SAFE_INTEGER],!1))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewBottom",{get:function(){return Math.max.apply(Math,(0,o.o)((0,o.o)([],(0,o.p)(this._messages.map((function(e){return e.createdAt}))),!1),[0],!1))},enumerable:!1,configurable:!0}),e.prototype._activate=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return o.V.of(this._iid).logger.debug("check huge gap"),this._checkHugeGap(),[4,this._refreshChannel(o.Z.SYNC_CHANNEL_CHANGELOGS)];case 1:return e.sent(),[2]}}))}))},e.prototype._replaceChannelOfCollection=function(e){this._channel.isGroupChannel()?this._channel=e:this._channel.isFeedChannel()&&(this._channel._groupChannel=e._groupChannel)},e.prototype._shouldStartBackgroundSync=function(){var e=o.V.of(this._iid).cacheContext;return this.channel.isGroupChannel()?e.localCacheEnabled&&!this.channel.isSuper:e.localCacheEnabled},e.prototype._createChannelEventContext=function(e){switch(!0){case this.channel.isGroupChannel():return new Ke(e);case this.channel.isFeedChannel():return new Qe(e);default:throw new o.r({code:o.ah.WRONG_CHANNEL_TYPE,message:"Wrong channel type"})}},e.prototype._createMessageEventContext=function(e){switch(!0){case this.channel.isGroupChannel():return new Ye(e);case this.channel.isFeedChannel():return new $e(e);default:throw new o.r({code:o.ah.WRONG_CHANNEL_TYPE,message:"Wrong channel type"})}},e.prototype._createChannelUpdateEventCommand=function(e){switch(!0){case this.channel.isGroupChannel():return new R({channels:[this._channel],source:e});case this.channel.isFeedChannel():return new Be({channels:[this._channel],source:e});default:return null}},e.prototype._setBaseMessageCollectionHandler=function(e){this._handler=e},e.prototype._filterUnderOffsetMessage=function(e){return e},e.prototype._updateChildMessagesInView=function(e){var t=[];return this._messages.forEach((function(n){n instanceof s.a2&&n.parentMessageId===e.messageId&&n.applyParentMessage(e)&&t.push(n)})),t},e.prototype._updatePollsToView=function(e,t){var n,r,i=this,s=[];try{for(var a=(0,o.s)(e),u=a.next();!u.done;u=a.next()){var c=u.value,l=Re(this._messages,c.messageId);if(l>=0){var d=this._messages[l];d.isUserMessage()&&d.applyPoll(c),s.push(d)}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return s.length>0&&(0,o.bb)(t)&&(0,o.F)((function(){return(0,o._)(i,void 0,void 0,(function(){var e,n,r;return(0,o.b)(this,(function(i){return e=this._createMessageEventContext(t),s.length>0&&(null===(r=(n=this._handler).onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,s)),[2]}))}))})),s},e.prototype._applyPollUpdateEventToView=function(e,t){var n=this,r=Re(this._messages,e.messageId);if(r>=0){var i=this._messages[r];i&&i.isUserMessage()&&i.poll&&i.poll.applyPollUpdateEvent(e)&&(0,o.bb)(t)&&(0,o.F)((function(){return(0,o._)(n,void 0,void 0,(function(){var e,n,r;return(0,o.b)(this,(function(o){return e=this._createMessageEventContext(t),null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))}))}},e.prototype._applyPollVoteEventToView=function(e,t){var n=this,r=Re(this._messages,e.messageId);if(r>=0){var i=this._messages[r];i&&i.isUserMessage()&&i.poll&&i.poll.applyPollVoteEvent(e)&&(0,o.bb)(t)&&(0,o.F)((function(){return(0,o._)(n,void 0,void 0,(function(){var e,n,r;return(0,o.b)(this,(function(o){return e=this._createMessageEventContext(t),null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))}))}},e.prototype._applyReactionEventToview=function(e,t){var n=this,r=Re(this._messages,e.messageId);if(r>=0){var i=this._messages[r];i&&(i.isUserMessage()||i.isFileMessage())&&(0,o.bb)(t)&&(i.applyReactionEvent(e),(0,o.F)((function(){return(0,o._)(n,void 0,void 0,(function(){var e,n,r;return(0,o.b)(this,(function(o){return e=this._createMessageEventContext(t),null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))})))}},e.prototype._applyThreadInfoEventToview=function(e,t){var n=this,r=Re(this._messages,e.targetMessageId);if(r>=0){var i=this._messages[r];i&&(i.isUserMessage()||i.isFileMessage())&&(0,o.bb)(t)&&(i.applyThreadInfoUpdateEvent(e),(0,o.F)((function(){return(0,o._)(n,void 0,void 0,(function(){var e,n,r;return(0,o.b)(this,(function(o){return e=this._createMessageEventContext(t),null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,[i]),[2]}))}))})))}},e.prototype._removeMessagesFromView=function(e,t){var n,r,i=this,s=[],a=[],u=function(e){var t=c._messages.findIndex((function(t){return i.keyOf(t)===e}));if(t>=0){var n=c._messages[t];s.push(c.keyOf(n)),a.push(n),c._messages.splice(t,1)}},c=this;try{for(var l=(0,o.s)(e),d=l.next();!d.done;d=l.next())u(d.value)}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return(0,o.bb)(t)&&a.length>0&&(0,o.F)((function(){return(0,o._)(i,void 0,void 0,(function(){var e,n,r;return(0,o.b)(this,(function(i){return e=this._createMessageEventContext(t),null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesDeleted)||void 0===r||r.call(n,e,this.channel,s,a),[2]}))}))})),s},e.prototype._removeUnsentMessageFromView=function(e,t){var n=this._unsentMessages.findIndex((function(t){return t.reqId===e}));n>=0&&this._unsentMessages.splice(n,1)},e.prototype._getLocalMessages=function(e,t){var n=t.prevLimit,r=void 0===n?0:n,i=t.nextLimit,s=void 0===i?0:i,a=t.inclusive,u=void 0===a||a;return(0,o._)(this,void 0,void 0,(function(){var t,n,i,a,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return t=[],u?[4,this._channelManager.getExactlyMatchingMessagesForTokenFromCache(this._channel.url,e,this.filter)]:[3,2];case 1:t=l.sent(),l.label=2;case 2:return r>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,e,"prev",this.filter,r,!1)]:[3,4];case 3:return i=l.sent(),[3,5];case 4:i=[],l.label=5;case 5:return n=i,s>0?[4,this._channelManager.getMessagesFromCache(this._channel.url,e,"next",this.filter,s,!1)]:[3,7];case 6:return c=l.sent(),[3,8];case 7:c=[],l.label=8;case 8:return a=c,[2,(0,o.o)((0,o.o)((0,o.o)([],(0,o.p)(t),!1),(0,o.p)(n),!1),(0,o.p)(a),!1).sort((function(e,t){return t.createdAt-e.createdAt}))]}}))}))},e.prototype._getRemoteMessages=function(e,t){var n=t.prevLimit,r=void 0===n?0:n,i=t.nextLimit,a=void 0===i?0:i,u=t.source,c=void 0===u?o.Z.REQUEST_MESSAGE:u,l=t.reverse,d=void 0!==l&&l,h=t.checkingHasNext,f=void 0!==h&&h,p=t.checkingContinuousMessages,_=void 0!==p&&p;return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(i){switch(i.label){case 0:return t=s.ab.of(this._iid),r>0||a>0?[4,t._getMessagesByTimestampForCollection(this._channel.url,this._channel.channelType,e,(0,o.u)((0,o.g)((0,o.g)((0,o.g)({},this.filter),Je),{isInclusive:!0,reverse:d,prevResultSize:r,nextResultSize:a})),c,f,_)]:[3,2];case 1:return n=i.sent(),[3,3];case 2:n={messages:[],isContinuousMessages:!1},i.label=3;case 3:return[2,n]}}))}))},e.prototype._checkHugeGap=function(){var e,t,n,r,i;return(0,o._)(this,void 0,void 0,(function(){var s,a,u,c,l,d,h,f,p,_,v,m,g,y,b,E,w,C,T,A,S,I,N,k,x,O=this;return(0,o.b)(this,(function(M){switch(M.label){case 0:return s=o.V.of(this._iid),a=s.dispatcher,u=s.requestQueue,c=s.cacheContext,l=s.statLogCollector,d=s.logger,this._messages.length>0?(h=this._syncRange.top,f=this.viewTop,p=this._syncRange.bottom,_=this.hasNext?this.viewBottom:Number.MAX_SAFE_INTEGER,[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,f,h)]):[3,8];case 1:return v=M.sent(),[4,this._channelManager.getCachedMessageCountBetween(this._channel.url,this.filter,p,_)];case 2:m=M.sent(),M.label=3;case 3:return M.trys.push([3,5,6,7]),[4,(0,o.bc)((function(){return(0,o._)(O,void 0,void 0,(function(){var e,t,n,r,i,s,l,d,g,y,b,E,w,C,T,A,S,I=this;return(0,o.b)(this,(function(N){switch(N.label){case 0:return e=new ze((0,o.g)((0,o.g)({channelUrl:this._channel.url,channelType:this._channel.channelType,prevStart:f,prevEnd:h,prevCount:v,nextStart:p,nextEnd:_,nextCount:m,checkingContinuousMessages:c.localCacheEnabled},this.filter),Je)),[4,u.send(e)];case 1:return t=N.sent(),n=t.as(Ge),r=n.isHugeGap,i=n.prevMessages,s=void 0===i?[]:i,l=n.prevHasMore,d=n.isContinuousPrevMessages,g=n.nextMessages,y=void 0===g?[]:g,b=n.nextHasmore,E=n.isContinuousNextMessages,r?(0,o.F)((function(){return(0,o._)(I,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){return(null===(e=this._handler)||void 0===e?void 0:e.onHugeGapDetected)&&this._handler.onHugeGapDetected(),[2]}))}))})):(w=this.viewTop,C=this.viewBottom,T=Math.min.apply(Math,(0,o.o)([Number.MAX_SAFE_INTEGER,w],(0,o.p)(s.map((function(e){return e.createdAt}))),!1)),A=Math.max.apply(Math,(0,o.o)([0,C],(0,o.p)(y.map((function(e){return e.createdAt}))),!1)),a.dispatch(new o.ai({messages:s,source:o.Z.SYNC_MESSAGE_FILL})),a.dispatch(new o.ai({messages:y,source:o.Z.SYNC_MESSAGE_FILL})),this._syncRange.extends(T,A),(d||E)&&(null===(S=this._backgroundSync)||void 0===S||S.range.extends(T,A)),l&&this._prevFill.start(T),b&&this._nextFill.start(A)),[2]}}))}))}),1)];case 4:return M.sent(),[3,7];case 5:return g=M.sent(),d.debug("Failed HugeGap Check ",g),[3,7];case 6:return l.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(t=null===(e=c.localCacheConfig)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 7:return[3,13];case 8:y=Date.now(),M.label=9;case 9:return M.trys.push([9,11,12,13]),[4,this._getRemoteMessages(y,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit,source:o.Z.SYNC_MESSAGE_FILL,checkingHasNext:!0,checkingContinuousMessages:c.localCacheEnabled})];case 10:if(b=M.sent(),E=b.messages,w=b.isContinuousMessages,C=b.hasNext,E.length>0){for(T=E.map((function(e){return e.createdAt})),A=0,S=0,I=0;I<T.length;I++)(N=T[I])<=y?A++:N>=y&&S++;this._hasPrevious=A>=this._prevResultLimit,this._hasNext=null!=C?C:S>=this._nextResultLimit,(x=this._syncRange).extends.apply(x,(0,o.o)([],(0,o.p)(T),!1)),w&&(null===(n=this._backgroundSync)||void 0===n||n.range.extends(this._syncRange.top,this._syncRange.bottom)),this._addMessagesToView(E,o.Z.SYNC_MESSAGE_FILL)}else this._hasPrevious=!1,this._hasNext=!1;return[3,13];case 11:return(k=M.sent())instanceof o.r&&k.code===o.ah.NOT_FOUND_IN_DATABASE&&(this._hasPrevious=!1,this._hasNext=!1),[3,13];case 12:return l.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,measured_on:"gap_check",event:"cache_fetch",max_db_size:null!==(i=null===(r=c.localCacheConfig)||void 0===r?void 0:r.maxSize)&&void 0!==i?i:0,use_local_cache:c.localCacheEnabled,starting_point:0,message_init_policy:""}})),[7];case 13:return[2]}}))}))},e.prototype._loadUnsentMessages=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return e=this,[4,this._channelManager.getUnsentMessagesFromCache(this._channel.url,this.filter)];case 1:return e._unsentMessages=t.sent(),[2]}}))}))},e.prototype._hasPollMessage=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._channelManager.getPollMessagesFromCache(this._channel.url,Date.now()+Xe,this.filter,1)];case 1:return e.sent().length>0?[2,!0]:[2,!1]}}))}))},e.prototype._refreshChannel=function(e){var t=this;(0,o.z)((function(){return(0,o._)(t,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._channelManager.refreshChannel(this.channel.url,!0,e)];case 1:return t.sent(),[2]}}))}))}))},e.prototype._startCheckMyMutedTimer=function(e){var t=this;this._clearCheckMyMutedTimer(),this._checkMyMutedStateTimer=setTimeout((function(){return(0,o._)(t,void 0,void 0,(function(){var e,t,n=this;return(0,o.b)(this,(function(r){switch(r.label){case 0:this._checkMyMutedStateTimer=void 0,e=!0,r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,this._channel.getMyMutedInfo()];case 2:return t=r.sent(),e=!t.isMuted,[3,5];case 3:return r.sent(),e=!0,[3,5];case 4:return e&&this.channel._runIfHandleableWithGroupChannel((function(e){var t,r;e.myMutedState=o.b5.UNMUTED;var i=n._createChannelEventContext(o.Z.EVENT_CHANNEL_UNMUTED);null===(r=null===(t=n._handler)||void 0===t?void 0:t.onChannelUpdated)||void 0===r||r.call(t,i,n.channel)})),[7];case 5:return[2]}}))}))}),e+1e3)},e.prototype._clearCheckMyMutedTimer=function(){this._checkMyMutedStateTimer&&(clearTimeout(this._checkMyMutedStateTimer),this._checkMyMutedStateTimer=void 0)},e.prototype.initialize=function(e){var t=this,n=new rt;this._messages=[],this._unsentMessages=[],this._syncRange=new ke({}),this._hasNext=!0,this._hasPrevious=!0,this._refreshChannel(o.Z.REFRESH_CHANNEL);var r=o.V.of(this._iid),i=r.cacheContext,s=r.statLogCollector;return e===Ue.CACHE_AND_REPLACE_BY_API&&this._getLocalMessages(this._startingPoint,{prevLimit:this._prevResultLimit,nextLimit:this._nextResultLimit}).then((function(e){return(0,o._)(t,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(r){switch(r.label){case 0:return t=this._filterUnderOffsetMessage(e),this._addMessagesToView(t,o.Z.REQUEST_MESSAGE),[4,this._loadUnsentMessages()];case 1:return r.sent(),n._invokeResponse("local",null,t),[2]}}))}))})).catch((function(e){if((0,o.N)(e))throw e;n._invokeResponse("local",e,null)})).finally((function(){var r=o.V.of(t._iid).cacheContext;t._getRemoteMessages(t._startingPoint,{prevLimit:t._prevResultLimit,nextLimit:t._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:r.localCacheEnabled}).then((function(i){var a,u,c,l,d,h,f=i.messages,p=i.isContinuousMessages,_=i.hasNext,v=t._filterUnderOffsetMessage(f),m=!0;if(t._messages.length===v.length){var g=t._messages.map((function(e){return t.keyOf(e)}));for(var y in v)if(!g.includes(t.keyOf(v[y]))){m=!1;break}}else m=!1;if(t._messages=[],v.length>0){var b=v.map((function(e){return e.createdAt})),E=0,w=0;for(y=0;y<b.length;y++){var C=b[y];C<t._startingPoint?E++:C>t._startingPoint&&w++}t._hasPrevious=E>=t._prevResultLimit,t._hasNext=null!=_?_:w>=t._nextResultLimit,(a=t._syncRange).extends.apply(a,(0,o.o)([],(0,o.p)(v.map((function(e){return e.createdAt}))),!1)),p&&(null===(u=t._backgroundSync)||void 0===u||u.range.extends(t._syncRange.top,t._syncRange.bottom)),t._addMessagesToView(v,o.Z.REQUEST_MESSAGE)}else t._hasPrevious=!1,t._hasNext=!1;s.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:t.channel.url,starting_point:t._startingPoint,measured_on:"initial_load",event:m?"cache_hit":"cache_miss",max_db_size:null!==(l=null===(c=r.localCacheConfig)||void 0===c?void 0:c.maxSize)&&void 0!==l?l:0,message_init_policy:e,use_local_cache:r.localCacheEnabled,collection_id:t._key}})),s.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:t.channel.url,starting_point:t._startingPoint,measured_on:"initial_load",event:"cache_fetch",max_db_size:null!==(h=null===(d=r.localCacheConfig)||void 0===d?void 0:d.maxSize)&&void 0!==h?h:0,message_init_policy:e,use_local_cache:r.localCacheEnabled,collection_id:t._key}})),n._invokeResponse("remote",null,v)})).catch((function(e){if((0,o.N)(e))throw e;n._invokeResponse("remote",e,null)}))})),s.put(new o.b1({type:o.b2.FEATURE_LOCALCACHE,data:{use_local_cache:i.localCacheEnabled,collection_interface:{message_init_policy:e}}})),n},e.prototype.loadPrevious=function(){var e,t,n;return(0,o._)(this,void 0,void 0,(function(){var r,i,s,a,u,c,l,d=this;return(0,o.b)(this,(function(h){switch(h.label){case 0:if(this._isDisposed)throw new o.r({code:o.ah.COLLECTION_DISPOSED,message:"Collection has been disposed."});return r=o.V.of(this._iid),i=r.cacheContext,s=r.statLogCollector,a=r.logger,this._hasPrevious?this._isLoadingPrevious?(a.warn("Messages are already fetching."),[2,[]]):(this._isLoadingPrevious=!0,u=this.viewTop,c=[],[4,(0,o.z)((function(){return(0,o._)(d,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return e=this._filterUnderOffsetMessage,[4,this._getLocalMessages(u,{prevLimit:this._prevResultLimit,inclusive:!1})];case 1:return c=e.apply(this,[t.sent()]),[2]}}))}))}))]):[2,[]];case 1:return h.sent(),l=c.length>=this._prevResultLimit,s.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:l?"cache_hit":"cache_miss",max_db_size:null!==(t=null===(e=i.localCacheConfig)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:0,use_local_cache:i.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),l&&(null===(n=this._backgroundSync)||void 0===n?void 0:n.isWrappingMessages(c))?[3,3]:[4,(0,o.z)((function(){return(0,o._)(d,void 0,void 0,(function(){var e,t,n,r,i,a,l,d=this;return(0,o.b)(this,(function(h){switch(h.label){case 0:return e=o.V.of(this._iid).cacheContext,[4,this._getRemoteMessages(u,{prevLimit:this._prevResultLimit,reverse:!0,checkingContinuousMessages:e.localCacheEnabled})];case 1:return t=h.sent(),(c=this._filterUnderOffsetMessage(t.messages)).length>0&&((n=this._syncRange).extends.apply(n,(0,o.o)([],(0,o.p)(c.map((function(e){return e.createdAt}))),!1)),(null===(r=this._backgroundSync)||void 0===r?void 0:r.range.overlap(this._syncRange))&&t.isContinuousMessages&&(null===(i=this._backgroundSync)||void 0===i||i.range.extends(this._syncRange.top))),c=c.filter((function(e){return Me(d._messages,e)<0})),this._hasPrevious=c.length>=this._prevResultLimit,s.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_prev",event:"cache_fetch",max_db_size:null!==(l=null===(a=e.localCacheConfig)||void 0===a?void 0:a.maxSize)&&void 0!==l?l:0,use_local_cache:e.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}}))}))}))];case 2:return h.sent(),this._addMessagesToView(c,o.Z.REQUEST_MESSAGE),[3,4];case 3:this._hasPrevious=c.length>=this._prevResultLimit,c.length>0&&this._addMessagesToView(c,o.Z.REQUEST_MESSAGE),h.label=4;case 4:return this._isLoadingPrevious=!1,[2,c]}}))}))},e.prototype.loadNext=function(){var e,t,n;return(0,o._)(this,void 0,void 0,(function(){var r,i,s,a,u,c,l,d=this;return(0,o.b)(this,(function(h){switch(h.label){case 0:if(this._isDisposed)throw new o.r({code:o.ah.COLLECTION_DISPOSED,message:"Collection has been disposed."});return r=o.V.of(this._iid),i=r.cacheContext,s=r.statLogCollector,a=r.logger,this._hasNext?this._isLoadingNext?(a.warn("Messages are already fetching."),[2,[]]):(this._isLoadingNext=!0,u=this.viewBottom,c=[],[4,(0,o.z)((function(){return(0,o._)(d,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return e=this._filterUnderOffsetMessage,[4,this._getLocalMessages(u,{nextLimit:this._nextResultLimit,inclusive:!1})];case 1:return c=e.apply(this,[t.sent()]),[2]}}))}))}))]):[2,[]];case 1:return h.sent(),l=c.length>=this._nextResultLimit,s.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:l?"cache_hit":"cache_miss",max_db_size:null!==(t=null===(e=i.localCacheConfig)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:0,use_local_cache:i.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),l&&(null===(n=this._backgroundSync)||void 0===n?void 0:n.isWrappingMessages(c))?[3,3]:[4,(0,o.z)((function(){return(0,o._)(d,void 0,void 0,(function(){var e,t,n,r,i,a,l,d,h=this;return(0,o.b)(this,(function(f){switch(f.label){case 0:return e=o.V.of(this._iid).cacheContext,[4,this._getRemoteMessages(u,{nextLimit:this._nextResultLimit,reverse:!0,checkingHasNext:!0,checkingContinuousMessages:e.localCacheEnabled})];case 1:return t=f.sent(),(c=this._filterUnderOffsetMessage(t.messages)).length>0&&((n=this._syncRange).extends.apply(n,(0,o.o)([],(0,o.p)(c.map((function(e){return e.createdAt}))),!1)),(null===(r=this._backgroundSync)||void 0===r?void 0:r.range.overlap(this._syncRange))&&t.isContinuousMessages&&(null===(i=this._backgroundSync)||void 0===i||i.range.extends(this._syncRange.bottom))),c=c.filter((function(e){return Me(h._messages,e)<0})),this._hasNext=null!==(a=t.hasNext)&&void 0!==a?a:c.length>=this._nextResultLimit,s.put(new o.ba({type:o.b2.FEATURE_LOCALCACHE_EVENT,ts:Date.now(),data:{channel_url:this.channel.url,starting_point:this._startingPoint,measured_on:"load_next",event:"cache_fetch",max_db_size:null!==(d=null===(l=e.localCacheConfig)||void 0===l?void 0:l.maxSize)&&void 0!==d?d:0,use_local_cache:e.localCacheEnabled,collection_id:this._key,message_init_policy:""}})),[2]}}))}))}))];case 2:return h.sent(),this._addMessagesToView(c,o.Z.REQUEST_MESSAGE),[3,4];case 3:this._hasNext=c.length>=this._nextResultLimit,c.length>0&&this._addMessagesToView(c,o.Z.REQUEST_MESSAGE),h.label=4;case 4:return this._isLoadingNext=!1,[2,c]}}))}))},e.prototype.removeFailedMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:if(this._isDisposed)throw new o.r({code:o.ah.COLLECTION_DISPOSED,message:"Collection has been disposed."});return[4,this._channelManager.removeFailedMessageFromCache(e)];case 1:return n.sent(),(t=this._unsentMessages.findIndex((function(t){return t.reqId===e})))>-1&&this._unsentMessages.splice(t,1),[2]}}))}))},e.prototype.dispose=function(){var e,t,n,i=this;if(!this._isDisposed){this._isDisposed=!0;var s=o.V.of(this._iid),a=s.cacheContext,u=s.dispatcher;this._messages=[],this._clearCheckMyMutedTimer(),this._channel._runIfHandleableWithGroupChannel((function(e){if(e.myMemberState!==r.NONE){i._channel._updateMessageCollectionLastAccessedAt();var t=i._createChannelUpdateEventCommand(o.Z.CHANNEL_LASTACCESSEDAT_UPDATED);t&&u.dispatch(t)}})),a.localCacheEnabled&&(this._prevFill.stop(),this._nextFill.stop()),null===(e=this._backgroundSync)||void 0===e||e.close(),null===(t=this._changelogSync)||void 0===t||t.close(),null===(n=this._pollChangelogSync)||void 0===n||n.close(),this._channelManager.unsubscribeChannelEvent(this._key),this._channelManager.unsubscribeMessageEvent(this._key),this._connectionEventContext&&this._connectionEventContext.close()}},e}(),ot=function(e){function t(t,n){return e.call(this,t,(0,o.g)((0,o.g)({},n),{channelManager:Oe.of(t)}))||this}return(0,o.c)(t,e),t.prototype.keyOf=function(e){return e.messageId},t.prototype.initialize=function(t){var n=this;return(0,o.z)((function(){return(0,o._)(n,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(e=t.sent()).isMuted&&-1!==e.remainingDuration&&this._startCheckMyMutedTimer(e.remainingDuration),[2]}}))}))})),e.prototype.initialize.call(this,t)},t.prototype.setMessageCollectionHandler=function(e){this._setBaseMessageCollectionHandler(e)},t.prototype._activate=function(){return(0,o._)(this,void 0,void 0,(function(){var t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,e.prototype._activate.call(this)];case 1:return n.sent(),[4,(0,o.z)((function(){return(0,o._)(t,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this.channel.getMyMutedInfo()];case 1:return(e=t.sent()).isMuted&&-1!==e.remainingDuration&&this._startCheckMyMutedTimer(e.remainingDuration),[2]}}))}))}))];case 2:return n.sent(),[2]}}))}))},t.prototype._addMessagesToView=function(e,t){var n,r,i=this,a=this._filterUnderOffsetMessage(e),u=[],c=[];try{for(var l=(0,o.s)(a),d=l.next();!d.done;d=l.next()){var h=d.value;if(t===o.Z.SYNC_MESSAGE_FILL)if(h.messageId>0){if((v=Me(this._messages,h))<0){Me(this._unsentMessages,h)<0&&u.push(h);var f=De(this._messages,h);this._messages.splice(f,0,h)}}else h instanceof s.a4&&(v=Me(this._unsentMessages,h))<0&&Me(this._messages,h)<0&&(this._unsentMessages.push(h),u.push(h));else if(h.messageId>0){if((v=Me(this._messages,h))<0){var p=Me(this._unsentMessages,h);p<0?u.push(h):(this._unsentMessages.splice(p,1),c.push(h)),f=De(this._messages,h),this._messages.splice(f,0,h)}else c.push(h),this._messages[v]=h;if(h.updatedAt>0){var _=this._updateChildMessagesInView(h);c.push.apply(c,(0,o.o)([],(0,o.p)(_),!1))}}else if(h instanceof s.a4){var v;(v=Me(this._unsentMessages,h))<0?Me(this._messages,h)<0&&(this._unsentMessages.push(h),u.push(h)):(c.push(h),this._unsentMessages[v]=h)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}(0,o.bb)(t)&&(0,o.F)((function(){return(0,o._)(i,void 0,void 0,(function(){var e,n,r,i,s;return(0,o.b)(this,(function(o){return e=this._createMessageEventContext(t),u.length>0&&(null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesAdded)||void 0===r||r.call(n,e,this.channel,u)),c.length>0&&(null===(s=null===(i=this._handler)||void 0===i?void 0:i.onMessagesUpdated)||void 0===s||s.call(i,e,this.channel,c)),[2]}))}))}))},t.prototype._updateMessagesToView=function(e,t){var n,r,i=this,a=[],u=[],c=[];try{for(var l=(0,o.s)(e),d=l.next();!d.done;d=l.next()){var h,f=d.value;if(f.messageId>0)if((h=Me(this._messages,f))>=0)u.push(f),this._messages[h]=f;else{var p=Me(this._unsentMessages,f);if(p>=0){var _=(0,o.p)(this._unsentMessages.splice(p,1),1)[0];if(this.hasNext&&_)c.push(_);else{u.push(f);var v=De(this._messages,f);this._messages.splice(v,0,f)}}else{var m=this._messages.map((function(e){return e.createdAt}));(f.createdAt<Math.min.apply(Math,(0,o.o)([],(0,o.p)(m),!1))&&!this._hasPrevious||f.createdAt>Math.max.apply(Math,(0,o.o)([],(0,o.p)(m),!1))&&!this._hasNext)&&a.push(f)}}else f instanceof s.a4&&(h=Me(this._unsentMessages,f))>=0&&(u.push(f),this._unsentMessages[h]=f)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return(0,o.bb)(t)&&(0,o.F)((function(){return(0,o._)(i,void 0,void 0,(function(){var e,n,r,i,s;return(0,o.b)(this,(function(o){return e=this._createMessageEventContext(t),u.length>0?null===(r=null===(n=this._handler)||void 0===n?void 0:n.onMessagesUpdated)||void 0===r||r.call(n,e,this.channel,u):c.length>0?null===(s=null===(i=this._handler)||void 0===i?void 0:i.onMessagesDeleted)||void 0===s||s.call(i,e,this.channel,[],c):a.length>0&&this._addMessagesToView(a,t),[2]}))}))})),u},t}(it),st={coverUrl:void 0,coverImage:void 0,isDistinct:void 0,isPublic:void 0,isDiscoverable:void 0,accessCode:void 0,name:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,messageSurvivalSeconds:void 0},at=function(e){function t(t){var n=this,r=t.channelUrl,i=t.token,s=t.limit,a=t.order,u=t.mutedMemberFilter,c=t.memberStateFilter,l=t.nicknameStartsWithFilter,d=t.operatorFilter;return(n=e.call(this)||this).method=o.A.GET,n.path="".concat(o.au,"/").concat(encodeURIComponent(r),"/members"),n.params={token:i,limit:s,order:a,muted_member_filter:u,member_state_filter:c,nickname_startswith:l,operator_filter:d,show_member_is_muted:!0,show_read_receipt:!0,show_delivery_receipt:!0},n}return(0,o.c)(t,e),t}(o.f),ut=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.members=[];var i=n.next,o=n.members;return r.token=i,o&&o.length>0&&(r.members=o.map((function(e){return new m(t,e)}))),r}return(0,o.c)(t,e),t}(o.h);!function(e){e.ALL="all",e.MUTED="muted",e.UNMUTED="unmuted"}(et||(et={})),function(e){e.MEMBER_NICKNAME_ALPHABETICAL="member_nickname_alphabetical",e.OPERATOR_THEN_MEMBER_ALPHABETICAL="operator_then_member_alphabetical"}(tt||(tt={})),function(e){e.ALL="all",e.JOINED="joined_only",e.INVITED="invited_only",e.INVITED_BY_FRIEND="invited_by_friend",e.INVITED_BY_NON_FRIEND="invited_by_non_friend"}(nt||(nt={}));var ct=function(e){function t(t,n,r){var i,s,a,u,c=this;return(c=e.call(this,t,n,o.C.GROUP,r)||this).mutedMemberFilter=et.ALL,c.memberStateFilter=nt.ALL,c.nicknameStartsWithFilter=null,c.operatorFilter=p.ALL,c.order=tt.MEMBER_NICKNAME_ALPHABETICAL,c.mutedMemberFilter=null!==(i=r.mutedMemberFilter)&&void 0!==i?i:et.ALL,c.memberStateFilter=null!==(s=r.memberStateFilter)&&void 0!==s?s:nt.ALL,c.nicknameStartsWithFilter=null!==(a=r.nicknameStartsWithFilter)&&void 0!==a?a:null,c.order=null!==(u=r.order)&&void 0!==u?u:tt.MEMBER_NICKNAME_ALPHABETICAL,c}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,o.T)(et,this.mutedMemberFilter)&&(0,o.T)(nt,this.memberStateFilter)&&((0,o.a)("string",this.nicknameStartsWithFilter)||null===this.nicknameStartsWithFilter)&&(0,o.T)(p,this.operatorFilter)&&(0,o.T)(tt,this.order)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=o.V.of(this._iid).requestQueue,t=new at((0,o.u)((0,o.g)((0,o.g)({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=a.sent(),r=n.as(ut),i=r.members,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aw),lt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.userId,s=t.accessCode;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat(o.au,"/").concat(encodeURIComponent(r),"/accept"),n.params={user_id:i,access_code:s},n}return(0,o.c)(t,e),t}(o.f),dt=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.channel=new Ht(t,n),i.channel.myMemberState=r.JOINED,i}return(0,o.c)(t,e),t}(o.h),ht=function(e){function t(t){var n=this,r=t.channelUrl,i=t.isDistinct,s=t.isPublic,a=t.isDiscoverable,u=t.coverUrl,c=t.coverImage,l=t.accessCode,d=t.name,h=t.data,f=t.customType,p=t.operatorUserIds,_=t.messageSurvivalSeconds;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat(o.au,"/").concat(encodeURIComponent(r)),n.params=(0,o.e)({is_distinct:i,is_public:s,is_discoverable:a,name:d,data:h,custom_type:f,cover_url:u,cover_file:c,access_code:l,operator_ids:p,message_survival_seconds:_}),n}return(0,o.c)(t,e),t}(o.f),ft=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new Ht(t,n),r}return(0,o.c)(t,e),t}(o.h),pt=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=o.A.DELETE,n.path="".concat(o.au,"/").concat(encodeURIComponent(r)),n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){return e.call(this,t,n)||this}),e)}(o.h);var _t=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=o.A.DELETE,n.path="".concat(o.au,"/").concat(encodeURIComponent(r),"/hide"),n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var vt=function(e){function t(t){var n=t.userId,r=t.channelUrl,i=t.countPreference,s=e.call(this)||this;return s.method=o.A.PUT,s.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/count_preference/").concat(encodeURIComponent(r)),s.params={count_preference:i},s}return(0,o.c)(t,e),t}(o.f),mt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.countPreference=n.count_preference,r}return(0,o.c)(t,e),t}(o.h),gt=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat(o.au,"/").concat(encodeURIComponent(r),"/reset_user_history"),n}return(0,o.c)(t,e),t}(o.f),yt=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts_message_offset;return r.messageOffsetTimestamp=i,r}return(0,o.c)(t,e),t}(o.h),bt=(0,o.g)((0,o.g)({},s.ac),{scheduledAt:void 0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),Et=(0,o.g)((0,o.g)({},s.ae),{scheduledAt:void 0}),wt=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===o.ae.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var a=t.channelType,u=t.channelUrl,c=t.scheduledMessageId;return r.method=o.A.PUT,r.path="".concat((0,o.ag)(a),"/").concat(encodeURIComponent(u),"/scheduled_messages/").concat(encodeURIComponent(c)),r.params=(0,o.e)((0,o.u)({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:o.aA.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:t.thumbnailSizes?t.thumbnailSizes.map((function(e){return s.ag.payloadify(e)})):[],custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return s.ah.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?s.ai.payloadify(t.appleCriticalAlertOptions):null,push_option:t.pushNotificationDeliveryOption})),r}return(0,o.c)(t,e),t}(o.f),Ct=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new s.V(t,n),r}return(0,o.c)(t,e),t}(o.h),Tt=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===o.ae.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var a=t.channelType,u=t.channelUrl,c=t.scheduledMessageId;return r.method=o.A.PUT,r.path="".concat((0,o.ag)(a),"/").concat(encodeURIComponent(u),"/scheduled_messages/").concat(encodeURIComponent(c)),r.params=(0,o.e)((0,o.u)({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:o.aA.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return s.ah.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?s.ai.payloadify(t.appleCriticalAlertOptions):null,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption})),r}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){var r=e.call(this,t,n)||this;return r.message=new s.T(t,n),r}),e)}(o.h);var At=function(e){function t(t){var n=e.call(this)||this,r=t.channelType,i=t.channelUrl,s=t.scheduledMessageId;return n.method=o.A.DELETE,n.path="".concat((0,o.ag)(r),"/").concat(encodeURIComponent(i),"/scheduled_messages/").concat(encodeURIComponent(s)),n}return(0,o.c)(t,e),t}(o.f),St=function(e){function t(t){var n=e.call(this)||this,r=t.channelType,i=t.channelUrl,s=t.scheduledMessageId;return n.method=o.A.POST,n.path="".concat((0,o.ag)(r),"/").concat(encodeURIComponent(i),"/scheduled_messages/").concat(encodeURIComponent(s),"/send_now"),n}return(0,o.c)(t,e),t}(o.f),It=function(e){function t(t){var n=t.userId,r=t.channelUrl,i=t.pushTriggerOption,s=e.call(this)||this;return s.method=o.A.PUT,s.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/push_preference/").concat(encodeURIComponent(r)),s.params={push_trigger_option:i},s}return(0,o.c)(t,e),t}(o.f),Nt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r.enabled=n.enable,r}return(0,o.c)(t,e),t}(o.h),kt=function(e){function t(t){var n=t.userId,r=t.channelUrl,i=e.call(this)||this;return i.method=o.A.GET,i.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/push_preference/").concat(encodeURIComponent(r)),i}return(0,o.c)(t,e),t}(o.f),xt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r.enabled=n.enable,r}return(0,o.c)(t,e),t}(o.h),Ot=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=e.call(this)||this;return s.method=o.A.POST,s.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/pin"),s}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){return e.call(this,t,n)||this}),e)}(o.h);var Mt=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=e.call(this)||this;return s.method=o.A.DELETE,s.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/pin"),s}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){return e.call(this,t,n)||this}),e)}(o.h);var Rt,Dt,Ut=function(e){function t(t,n){var r=e.call(this,t)||this;return r.message=null,r.message=(0,s.K)(t,n.message),r}return(0,o.c)(t,e),t}(o.aa),Lt=function(e){function t(t){var n=this,r=t.channelType,i=t.channelUrl,s=t.limit,a=t.token,u=t.includeReactions,c=t.includeMetaArray,l=t.includeParentMessageInfo,d=t.includeThreadInfo,h=t.includePollDetails;return(n=e.call(this)||this).method=o.A.GET,n.path="".concat((0,o.ag)(r),"/").concat(encodeURIComponent(i),"/pinned_messages"),n.params=(0,o.e)({limit:s,token:a,include_reactions:u,with_sorted_meta_array:c,include_thread_info:d,include_parent_message_info:l,include_poll_details:h}),n}return(0,o.c)(t,e),t}(o.f),Pt=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.pinned_messages,o=n.has_more,s=n.next;return r.pinnedMessages=i.map((function(e){return new Ut(t,e)})),r.hasMore=o,r.token=s,r}return(0,o.c)(t,e),t}(o.h),Ft=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;return o.includeMetaArray=i.includeMetaArray,o.includeReactions=i.includeReactions,o.includeParentMessageInfo=i.includeParentMessageInfo,o.includeThreadInfo=i.includeThreadInfo,o.includePollDetails=i.includePollDetails,o}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,o.a)("boolean",this.includeMetaArray,!0)&&(0,o.a)("boolean",this.includeReactions,!0)&&(0,o.a)("boolean",this.includeParentMessageInfo,!0)&&(0,o.a)("boolean",this.includeThreadInfo,!0)&&(0,o.a)("boolean",this.includePollDetails,!0)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=o.V.of(this._iid).requestQueue,t=new Lt((0,o.g)((0,o.g)({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=u.sent(),r=n.as(Pt),i=r.pinnedMessages,s=r.hasMore,a=r.token,this._token=a,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aw),jt=function(e){function t(t,n){var r,i,s=this;return(s=e.call(this,t)||this).channelUrl=null!==(r=n.channel_url)&&void 0!==r?r:"",s.channelType=null!==(i=n.channel_type)&&void 0!==i?i:o.C.GROUP,s.member=new o.U(s._iid,n.user),s.deliveryAt=n.ts,s}return(0,o.c)(t,e),t}(o.aa);!function(e){e.ALL="all",e.UNREAD_MESSAGE_COUNT_ONLY="unread_message_count_only",e.UNREAD_MENTION_COUNT_ONLY="unread_mention_count_only",e.OFF="off"}(Rt||(Rt={})),function(e){e.UNHIDDEN="unhidden",e.HIDDEN_ALLOW_AUTO_UNHIDE="hidden_allow_auto_unhide",e.HIDDEN_PREVENT_AUTO_UNHIDE="hidden_prevent_auto_unhide"}(Dt||(Dt={}));var qt,Ht=function(e){function t(t,n){var i,a,u,c,l,d,h,f,p,_,v,g,y,b,E,w,C,T,A,S,I=this;return(I=e.call(this,t,n)||this)._unreadMemberStateMap=new Map,I._undeliveredMemberStateMap=new Map,I._typingStatus=new Map,I._lastMemberCountUpdated=0,I._typingStarted=0,I._typingEnded=0,I.isDistinct=!1,I.isSuper=!1,I.isBroadcast=!1,I.isExclusive=!1,I.isPublic=!1,I.isDiscoverable=!0,I.isChatNotification=!1,I.isAccessCodeRequired=!1,I.isPushEnabled=!1,I.unreadMessageCount=0,I.unreadMentionCount=0,I.members=[],I.memberCount=0,I.joinedMemberCount=0,I.hiddenState=Dt.UNHIDDEN,I.lastMessage=null,I.messageOffsetTimestamp=0,I.messageSurvivalSeconds=-1,I.myMemberState=r.NONE,I.myRole=o.a3.NONE,I.myMutedState=o.b5.UNMUTED,I.myLastRead=0,I.myCountPreference=Rt.ALL,I.myPushTriggerOption=o.X.DEFAULT,I.inviter=null,I.invitedAt=0,I.joinedAt=0,I.pinnedMessageIds=[],I.lastPinnedMessage=null,I._pinnedMessagesUpdatedAt=0,I._myMutedRemainingTime=-1,I.channelType=o.C.GROUP,I.isDistinct=null!==(a=n.is_distinct)&&void 0!==a&&a,I.isSuper=null!==(u=n.is_super)&&void 0!==u&&u,I.isBroadcast=null!==(c=n.is_broadcast)&&void 0!==c&&c,I.isExclusive=null!==(l=n.is_exclusive)&&void 0!==l&&l,I.isPublic=null!==(d=n.is_public)&&void 0!==d&&d,I.isDiscoverable=null!==(h=n.is_discoverable)&&void 0!==h?h:I.isPublic,I.isChatNotification=null!==(f=n.is_chat_notification)&&void 0!==f&&f,I.isAccessCodeRequired=null!==(p=n.is_access_code_required)&&void 0!==p&&p,I.isPushEnabled=null!==(_=n.is_push_enabled)&&void 0!==_&&_,Array.isArray(n.members)&&(i=I.members).push.apply(i,(0,o.o)([],(0,o.p)(n.members.map((function(e){return new m(I._iid,e)}))),!1)),I.memberCount=null!==(v=n.member_count)&&void 0!==v?v:0,I.joinedMemberCount=null!==(g=n.joined_member_count)&&void 0!==g?g:0,I.hiddenState=(0,o.T)(Dt,n.hidden_state)?n.hidden_state:Dt.UNHIDDEN,I.messageOffsetTimestamp=null!==(y=n.ts_message_offset)&&void 0!==y?y:0,I.messageSurvivalSeconds=null!==(b=n.message_survival_seconds)&&void 0!==b?b:-1,I.lastMessage=n.last_message?(0,s.K)(I._iid,(0,o.g)({channel_type:I.channelType},n.last_message)):null,n.read_receipt&&Object.keys(n.read_receipt).forEach((function(e){(0,o.a)("number",n.read_receipt[e])&&I._updateUnreadMemberState(e,n.read_receipt[e])})),n.delivery_receipt&&Object.keys(n.delivery_receipt).forEach((function(e){(0,o.a)("number",n.delivery_receipt[e])&&I._updateUndeliveredMemberState(e,n.delivery_receipt[e])})),I.myMemberState=(0,o.T)(r,n.member_state)?n.member_state:r.NONE,I.myRole=(0,o.T)(o.a3,n.my_role)?n.my_role:o.a3.NONE,(0,o.T)(o.b5,n.is_muted)?I.myMutedState=n.is_muted:(0,o.a)("boolean",n.is_muted)?I.myMutedState=n.is_muted?o.b5.MUTED:o.b5.UNMUTED:I.myMutedState=o.b5.UNMUTED,I.myCountPreference=(0,o.T)(Rt,n.count_preference)?n.count_preference:Rt.ALL,I.myPushTriggerOption=(0,o.T)(o.X,n.push_trigger_option)?n.push_trigger_option:o.X.ALL,I.myLastRead=null!==(E=n.user_last_read)&&void 0!==E?E:0,I.inviter=n.inviter?new o.U(I._iid,n.inviter):null,I.invitedAt=null!==(w=n.invited_at)&&void 0!==w?w:0,I.joinedAt=null!==(C=n.joined_ts)&&void 0!==C?C:0,I._updateUnreadCount(null!==(T=n.unread_message_count)&&void 0!==T?T:0,null!==(A=n.unread_mention_count)&&void 0!==A?A:0),I.pinnedMessageIds=null!==(S=n.pinned_message_ids)&&void 0!==S?S:[],I.lastPinnedMessage=n.latest_pinned_message?(0,s.K)(I._iid,(0,o.g)({channel_type:I.channelType},n.latest_pinned_message)):null,I}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"isHidden",{get:function(){return this.hiddenState!==Dt.UNHIDDEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTyping",{get:function(){return this._typingStatus.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUnreadMemberState",{get:function(){var e,t,n={};try{for(var r=(0,o.s)(this._unreadMemberStateMap),i=r.next();!i.done;i=r.next()){var s=(0,o.p)(i.value,2),a=s[0],u=s[1];n[a]=u}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedUndeliveredMemberState",{get:function(){var e,t,n={};try{for(var r=(0,o.s)(this._undeliveredMemberStateMap),i=r.next();!i.done;i=r.next()){var s=(0,o.p)(i.value,2),a=s[0],u=s[1];n[a]=u}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{is_access_code_required:t.isAccessCodeRequired,is_distinct:t.isDistinct,is_super:t.isSuper,is_broadcast:t.isBroadcast,is_exclusive:t.isExclusive,is_public:t.isPublic,is_discoverable:t.isDiscoverable,is_muted:t.myMutedState,is_push_enabled:t.isPushEnabled,unread_message_count:t.unreadMessageCount,unread_mention_count:t.unreadMentionCount,push_trigger_option:t.myPushTriggerOption,count_preference:t.myCountPreference,hidden_state:t.hiddenState,member_count:t.memberCount,joined_member_count:t.joinedMemberCount,member_state:t.myMemberState,my_role:t.myRole,user_last_read:t.myLastRead,ts_message_offset:t.messageOffsetTimestamp,message_survival_seconds:t.messageSurvivalSeconds,read_receipt:t.cachedUnreadMemberState,delivery_receipt:t.cachedUndeliveredMemberState,members:t.members.map((function(e){return m.payloadify(e)})),last_message:t.lastMessage?(0,s.aj)(t.lastMessage):null,inviter:t.inviter?o.U.payloadify(t.inviter):null,invited_at:t.invitedAt,joined_ts:t.joinedAt,pinned_message_ids:t.pinnedMessageIds,latest_pinned_message:t.lastPinnedMessage?(0,s.aj)(t.lastPinnedMessage):null})))},t.prototype._shouldUpdateLastMessageWith=function(e){return!(e instanceof s.a4&&e.parentMessageId>0&&!e.replyToChannel)&&!e.silent&&(!this.lastMessage||this.lastMessage.createdAt<e.createdAt||this.lastMessage.createdAt===e.createdAt&&this.lastMessage.messageId===e.messageId&&this.lastMessage.updatedAt<e.updatedAt)},t.prototype._tryUpdateLastMessageAndCallEvents=function(e,t){var n=o.V.of(this._iid).dispatcher,r=Oe.of(this._iid);this._updateLastMessage(t),r.handlers.map((function(t){t.onChannelChanged&&t.onChannelChanged(e)})),n.dispatch(new R({channels:[e],source:o.Z.EVENT_MESSAGE_SENT}))},t.prototype._updateLastMessage=function(e){return!!this._shouldUpdateLastMessageWith(e)&&(this.lastMessage=e,!0)},t.prototype._updateUnreadCount=function(e,t){if("number"==typeof e&&e>=0)if(this.myCountPreference===Rt.ALL||this.myCountPreference===Rt.UNREAD_MESSAGE_COUNT_ONLY)if(this.isExclusive||this.isSuper||this.isBroadcast){var n=o.V.of(this._iid).maxSuperGroupChannelUnreadCount;this.unreadMessageCount=n&&e>=n?n:e}else this.unreadMessageCount=e;else this.unreadMessageCount=0;else this.unreadMessageCount=0;"number"==typeof t&&t>=0&&(this.myCountPreference===Rt.ALL||this.myCountPreference===Rt.UNREAD_MENTION_COUNT_ONLY)?this.unreadMentionCount=t:this.unreadMentionCount=0},t.prototype._updateUnreadMemberState=function(e,t){var n=this._unreadMemberStateMap.get(e);return(!n||n<t)&&(this._unreadMemberStateMap.set(e,t),o.V.of(this._iid).sdkState.userId===e&&(this.myLastRead=t),!0)},t.prototype._updateUndeliveredMemberState=function(e,t){var n=this._undeliveredMemberStateMap.get(e);return(!n||n<t)&&(this._undeliveredMemberStateMap.set(e,t),!0)},t.prototype._updateTypingStatus=function(e,t){void 0===t&&(t=(new Date).getTime()),t>0?this._typingStatus.set(e.userId,{user:e,ts:t}):this._typingStatus.delete(e.userId)},t.prototype._clearTypingStatus=function(){this._typingStatus.clear(),this._typingStarted=0,this._typingEnded=0},t.prototype._setLatestMemberCount=function(e,t,n){var r=!1;return n>=this._lastMemberCountUpdated&&(this._lastMemberCountUpdated=n,r=e!==this.memberCount||t!==this.joinedMemberCount,this.memberCount=e,this.joinedMemberCount=t),r},t.prototype.isReadMessage=function(e){var t=o.V.of(this._iid).sdkState,n=this._unreadMemberStateMap.get(t.userId);return!!n&&n>=e.createdAt},t.prototype.serialize=function(){var e=this;return(0,o.ad)(this,(function(t){t.cachedUnreadMemberState=e.cachedUnreadMemberState,t.cachedUndeliveredMemberState=e.cachedUndeliveredMemberState}))},t.prototype.createMessageCollection=function(e){return void 0===e&&(e={}),new ot(this._iid,(0,o.g)((0,o.g)({},e),{channel:this}))},t.prototype.createMemberListQuery=function(e){return void 0===e&&(e={}),new ct(this._iid,this.url,e)},t.prototype.createPinnedMessageListQuery=function(e){return void 0===e&&(e={}),new Ft(this._iid,this.url,this.channelType,e)},t.prototype.addMember=function(e,t){if(void 0===t&&(t=0),!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var n=this.members.findIndex((function(t){return t.userId===e.userId}));if(n>-1){var i=this.members[n];i.state===r.JOINED&&(e.state=i.state),this.members.splice(n,1),this.memberCount--}this.members.push(e),this.memberCount++,this._updateUnreadMemberState(e.userId,t),this._updateUndeliveredMemberState(e.userId,t)}},t.prototype.removeMember=function(e){if(!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var t=e instanceof m?e.userId:e,n=this.members.findIndex((function(e){return e.userId===t}));if(n>-1)return this.members.splice(n,1),this.memberCount--,!0}return!1},t.prototype.getUnreadMemberCount=function(e){var t,n;if(e instanceof s.a4&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var i=o.V.of(this._iid).sdkState,a=e.createdAt,u=0;try{for(var c=(0,o.s)(this.members),l=c.next();!l.done;l=c.next()){var d=l.value;i.userId!==d.userId&&d.state===r.JOINED&&e.sender.userId!==d.userId&&(this.cachedUnreadMemberState[d.userId]||0)<a&&u++}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return u}return 0},t.prototype.getUndeliveredMemberCount=function(e){var t,n;if(e instanceof s.a4&&!this.isExclusive&&!this.isSuper&&!this.isBroadcast){var i=o.V.of(this._iid).sdkState,a=e.createdAt,u=0;try{for(var c=(0,o.s)(this.members),l=c.next();!l.done;l=c.next()){var d=l.value;i.userId!==d.userId&&d.state===r.JOINED&&e.sender.userId!==d.userId&&(this.cachedUndeliveredMemberState[d.userId]||0)<a&&u++}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return u}return 0},t.prototype.getReadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=o.V.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var i=e instanceof s.a4?e.sender:null,a=[];return this.members.forEach((function(o){if(t||o.userId!==r.userId&&o.userId!==(null==i?void 0:i.userId)){var s=n._unreadMemberStateMap.get(o.userId);s&&s>=e.createdAt&&a.push(o)}})),a},t.prototype.getUnreadMembers=function(e,t){var n=this;void 0===t&&(t=!1);var r=o.V.of(this._iid).sdkState;if(!r.userId||this.isExclusive||this.isSuper||this.isBroadcast)return[];var i=e instanceof s.a4?e.sender:null,a=[];return this.members.forEach((function(o){if(t||o.userId!==r.userId&&o.userId!==(null==i?void 0:i.userId)){var s=n._unreadMemberStateMap.get(o.userId);s&&s<e.createdAt&&a.push(o)}})),a},t.prototype.getReadStatus=function(e){var t=this;void 0===e&&(e=!1);var n=o.V.of(this._iid).sdkState;if(!n.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var r={};return this.members.forEach((function(i){if(e||i.userId!==n.userId){var o=t._unreadMemberStateMap.get(i.userId);r[i.userId]=new g(t._iid,{channel_url:t.url,channel_type:t.channelType,user:m.payloadify(i),ts:null!=o?o:0})}})),r},t.prototype.getDeliveryStatus=function(e){var t=this;void 0===e&&(e=!0);var n=o.V.of(this._iid).sdkState;if(!n.userId||this.isExclusive||this.isSuper||this.isBroadcast)return null;var r={};return this.members.forEach((function(i){if(e||i.userId!==n.userId){var o=t._undeliveredMemberStateMap.get(i.userId);r[i.userId]=new jt(t._iid,{channel_url:t.url,channel_type:t.channelType,user:m.payloadify(i),ts:null!=o?o:0})}})),r},t.prototype.getTypingUsers=function(){var e=[];return this._typingStatus.forEach((function(t){var n=t.user;e.push(n)})),e},t.prototype.invalidateTypingStatus=function(){var e=this,t=o.V.of(this._iid).typingIndicatorInvalidateTime,n=Date.now(),r=!1;return this._typingStatus.forEach((function(i,o){var s=i.ts;n-s>=t&&(e._typingStatus.delete(o),r=!0)})),r},t.prototype.refresh=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,this._refresh()]}))}))},t.prototype._refresh=function(e){return void 0===e&&(e=!1),(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return t=o.V.of(this._iid),n=t.requestQueue,r=t.dispatcher,i=new F({channelUrl:this.url}),[4,n.send(i)];case 1:return s=u.sent(),a=s.as(j).channel,this._update(a),e||r.dispatch(new R({channels:[a],source:o.Z.REFRESH_CHANNEL})),[2,this]}}))}))},t.prototype.freeze=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,e.prototype.freeze.call(this)];case 1:return t.sent(),o.V.of(this._iid).dispatcher.dispatch(new R({channels:[this],source:o.Z.EVENT_CHANNEL_FROZEN,isWebSocketEventComing:!0})),[2]}}))}))},t.prototype.unfreeze=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,e.prototype.unfreeze.call(this)];case 1:return t.sent(),o.V.of(this._iid).dispatcher.dispatch(new R({channels:[this],source:o.Z.EVENT_CHANNEL_UNFROZEN,isWebSocketEventComing:!0})),[2]}}))}))},t.prototype.updateChannel=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return t=(0,o.g)((0,o.g)({},st),e),(0,o.t)(function(e){return(0,o.a)("string",e.coverUrl,!0)&&((0,o.i)(e.coverImage)||(0,o.a)("string",e.coverImage,!0))&&(0,o.a)("boolean",e.isDistinct,!0)&&(0,o.a)("boolean",e.isPublic,!0)&&(0,o.a)("boolean",e.isDiscoverable,!0)&&(0,o.a)("string",e.accessCode,!0)&&(0,o.a)("string",e.name,!0)&&(0,o.a)("string",e.data,!0)&&(0,o.a)("string",e.customType,!0)&&(0,o.O)("string",e.operatorUserIds,!0)&&(0,o.a)("number",e.messageSurvivalSeconds,!0)}(t)).throw(o.r.invalidParameters),n=o.V.of(this._iid),r=n.dispatcher,i=n.requestQueue,s=new ht((0,o.g)({channelUrl:this.url},t)),[4,i.send(s)];case 1:return a=c.sent(),u=a.as(ft).channel,this._update(u),r.dispatch(new R({channels:[u],source:o.Z.EVENT_CHANNEL_UPDATED,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.invite=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return(0,o.t)(e.every((function(e){return e instanceof o.U}))).throw(o.r.invalidParameters),[2,this.inviteWithUserIds(e.map((function(e){return e.userId})))]}))}))},t.prototype.inviteWithUserIds=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return(0,o.t)((0,o.O)("string",e)).throw(o.r.invalidParameters),t=o.V.of(this._iid),n=t.dispatcher,r=t.requestQueue,i=new ue({channelUrl:this.url,userIds:e}),[4,r.send(i)];case 1:return s=u.sent(),a=s.as(ce).channel,this._update(a),n.dispatch(new R({channels:[a],source:o.Z.EVENT_CHANNEL_INVITED,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.join=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return(0,o.t)((0,o.a)("string",e,!0)).throw(o.r.invalidParameters),t=o.V.of(this._iid),n=t.dispatcher,i=t.sdkState,s=t.requestQueue,a=new re({channelUrl:this.url,userId:i.userId,accessCode:e}),[4,s.send(a)];case 1:return u=l.sent(),(c=u.as(ie).channel).myMemberState=this.myMemberState=r.JOINED,this._update(c),n.dispatch(new R({channels:[c],source:o.Z.EVENT_CHANNEL_JOINED,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.leave=function(e){return void 0===e&&(e=!1),(0,o._)(this,void 0,void 0,(function(){var t,n,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return t=o.V.of(this._iid),n=t.sdkState,i=t.requestQueue,s=new se({channelUrl:this.url,userId:n.userId,shouldRemoveOperatorStatus:e}),[4,i.send(s)];case 1:return a.sent(),this.myMemberState=r.NONE,[2]}}))}))},t.prototype.acceptInvitation=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return(0,o.t)((0,o.a)("string",e,!0)).throw(o.r.invalidParameters),t=o.V.of(this._iid),n=t.dispatcher,i=t.sdkState,s=t.requestQueue,a=new lt({channelUrl:this.url,userId:i.userId,accessCode:e}),[4,s.send(a)];case 1:return u=l.sent(),(c=u.as(dt).channel).myMemberState=this.myMemberState=r.JOINED,this._update(c),n.dispatch(new R({channels:[c],source:o.Z.EVENT_CHANNEL_ACCEPTED_INVITE,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.declineInvitation=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return e=o.V.of(this._iid),t=e.sdkState,n=e.requestQueue,i=new de({channelUrl:this.url,userId:t.userId}),[4,n.send(i)];case 1:return s.sent(),this.myMemberState=r.NONE,[2,this]}}))}))},t.prototype.sendUserMessage=function(t){var n=this,r=new s.av,i=o.V.of(this._iid).dispatcher,u=a.A.of(this._iid);return e.prototype.sendUserMessage.call(this,t).onPending((function(e){u.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){t&&u.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){n.hiddenState===Dt.HIDDEN_ALLOW_AUTO_UNHIDE&&(n.hiddenState=Dt.UNHIDDEN),u.completeCurrentAndProcessNextAutoResend(e),n._updateLastMessage(e),Oe.of(n._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new R({channels:[n],source:o.Z.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},t.prototype.updateUserMessage=function(t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i,s,a,u=this;return(0,o.b)(this,(function(c){switch(c.label){case 0:return r=o.V.of(this._iid).dispatcher,[4,e.prototype.updateUserMessage.call(this,t,n)];case 1:return i=c.sent(),s=this._updateLastMessage(i),a=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,s=!0,a=!0),s&&(Oe.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(u)})),r.dispatch(new R({channels:[this],source:a?o.Z.EVENT_PINNED_MESSAGE_UPDATED:o.Z.EVENT_MESSAGE_UPDATED}))),a&&Oe.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(u)})),r.dispatch(new o.ai({messages:[i],source:o.Z.EVENT_MESSAGE_UPDATED})),[2,i]}}))}))},t.prototype._autoResendUserMessage=function(t){var n=this,r=new s.av,i=o.V.of(this._iid).dispatcher,u=a.A.of(this._iid);return e.prototype._autoResendUserMessage.call(this,t).onPending((function(e){u.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){u.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=Oe.of(n._iid);u.completeCurrentAndProcessNextAutoResend(e),n._updateLastMessage(e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new R({channels:[n],source:o.Z.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},t.prototype.sendFileMessage=function(t){var n=this,r=new s.av,i=o.V.of(this._iid).dispatcher,u=a.A.of(this._iid);return e.prototype.sendFileMessage.call(this,t).onPending((function(e){u.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){t&&u.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=Oe.of(n._iid);u.completeCurrentAndProcessNextAutoResend(e),n._updateLastMessage(e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new R({channels:[n],source:o.Z.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},t.prototype.sendMultipleFilesMessage=function(t){var n=this,r=new s.ak,i=o.V.of(this._iid).dispatcher;return e.prototype.sendMultipleFilesMessage.call(this,t).onPending((function(e){r._trigger(e)})).onFailed((function(e,t){r._triggerFailed(e,t)})).onSucceeded((function(e){var t=Oe.of(n._iid);n._updateLastMessage(e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new R({channels:[n],source:o.Z.EVENT_MESSAGE_SENT})),r._trigger(e)})).onFileUploaded((function(e,t,n,i){r._triggerOnFileUploaded(e,t,n,i)})),r},t.prototype.updateFileMessage=function(t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i,s,a,u=this;return(0,o.b)(this,(function(c){switch(c.label){case 0:return r=o.V.of(this._iid).dispatcher,[4,e.prototype.updateFileMessage.call(this,t,n)];case 1:return i=c.sent(),s=this._updateLastMessage(i),a=!1,this.lastPinnedMessage&&this.lastPinnedMessage.messageId===i.messageId&&(this.lastPinnedMessage=i,s=!0,a=!0),s&&(Oe.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(u)})),r.dispatch(new R({channels:[this],source:a?o.Z.EVENT_PINNED_MESSAGE_UPDATED:o.Z.EVENT_MESSAGE_UPDATED}))),a&&Oe.of(this._iid).handlers.map((function(e){e.onPinnedMessageUpdated&&e.onPinnedMessageUpdated(u)})),r.dispatch(new o.ai({messages:[i],source:o.Z.EVENT_MESSAGE_UPDATED})),[2,i]}}))}))},t.prototype._autoResendFileMessage=function(t){var n=this,r=new s.av,i=o.V.of(this._iid).dispatcher,u=a.A.of(this._iid);return e.prototype._autoResendFileMessage.call(this,t).onPending((function(e){u.completeCurrentAndProcessNextAutoResend(e),r._trigger(e)})).onFailed((function(e,t){u.completeCurrentAndProcessNextAutoResend(t),r._triggerFailed(e,t)})).onSucceeded((function(e){var t=Oe.of(n._iid);u.completeCurrentAndProcessNextAutoResend(e),n._updateLastMessage(e),t.handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(n)})),i.dispatch(new R({channels:[n],source:o.Z.EVENT_MESSAGE_SENT})),r._trigger(e)})),r},t.prototype.deleteMessage=function(t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,e.prototype.deleteMessage.call(this,t)];case 1:return n.sent(),0===t.messageId&&t instanceof s.a4&&o.V.of(this._iid).dispatcher.dispatch(new o.aP({reqId:t.reqId,source:o.Z.EVENT_MESSAGE_DELETED})),[2]}}))}))},t.prototype.hide=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return t=(0,o.g)((0,o.g)({},fe),e),(0,o.t)(function(e){return(0,o.a)("boolean",e.hidePreviousMessages,!0)&&(0,o.a)("boolean",e.allowAutoUnhide,!0)}(t)).throw(o.r.invalidParameters),n=o.V.of(this._iid),r=n.dispatcher,i=n.sdkState,s=n.requestQueue,a=new pe((0,o.g)({channelUrl:this.url,userId:i.userId},t)),[4,s.send(a)];case 1:return u=l.sent(),c=u.as(_e).messageOffsetTimestamp,this.hiddenState=t.allowAutoUnhide?Dt.HIDDEN_ALLOW_AUTO_UNHIDE:Dt.HIDDEN_PREVENT_AUTO_UNHIDE,t.hidePreviousMessages&&this._updateUnreadCount(0,0),c&&(this.messageOffsetTimestamp=c),r.dispatch(new R({channels:[this],source:o.Z.EVENT_CHANNEL_HIDDEN,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.unhide=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return e=o.V.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=new _t({channelUrl:this.url}),[4,n.send(r)];case 1:return i.sent(),this.hiddenState=Dt.UNHIDDEN,t.dispatch(new R({channels:[this],source:o.Z.EVENT_CHANNEL_UNHIDDEN,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.delete=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return e=o.V.of(this._iid).requestQueue,t=new pt({channelUrl:this.url}),[4,e.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.markAsRead=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u=this;return(0,o.b)(this,(function(c){switch(c.label){case 0:return e=o.V.of(this._iid),t=e.sdkState,n=e.dispatcher,r=e.requestQueue,i=new Te({channelUrl:this.url}),[4,r.send(i)];case 1:return s=c.sent(),a=s.as(Ae).readStatus,this._updateUnreadMemberState(t.userId,a.readAt),(this.unreadMessageCount>0||this.unreadMentionCount>0)&&(this._updateUnreadCount(0,0),Oe.of(this._iid).handlers.map((function(e){e.onChannelChanged&&e.onChannelChanged(u)}))),n.dispatch(new R({channels:[this],source:o.Z.EVENT_CHANNEL_READ})),[2]}}))}))},t.prototype.markAsDelivered=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return e=o.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Se({channelUrl:this.url,userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),[2]}}))}))},t.prototype.startTyping=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return e=o.V.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingStarted>=n?(this._typingStarted=r,this._typingEnded=0,i=new me({channelUrl:this.url,time:this._typingStarted}),[4,t.send(i)]):[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}}))}))},t.prototype.endTyping=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return e=o.V.of(this._iid),t=e.requestQueue,n=e.typingIndicatorThrottle,(r=(new Date).getTime())-this._typingEnded>=n?(this._typingStarted=0,this._typingEnded=r,i=new ye({channelUrl:this.url,time:this._typingStarted}),[4,t.send(i)]):[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}}))}))},t.prototype.createScheduledUserMessage=function(e){e=(0,o.g)((0,o.g)({},s.al),e),(0,o.t)((0,s.am)(e)).throw(o.r.invalidParameters);var t=new s.av;return this._createScheduledUserMessage(e,t),t},t.prototype.updateScheduledUserMessage=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i;return(0,o.b)(this,(function(a){switch(a.label){case 0:return n=(0,o.g)((0,o.g)({},Et),t),(0,o.t)(function(e){return(0,s.af)(e)&&(0,o.a)("number",e.scheduledAt,!0)}(n)).throw(o.r.invalidParameters),r=o.V.of(this._iid).requestQueue,i=new Tt((0,o.g)({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},n)),[4,r.send(i)];case 1:return[2,a.sent().as(s.aw).message]}}))}))},t.prototype.createScheduledFileMessage=function(e){var t=this;e=(0,o.g)((0,o.g)({},s.an),e),(0,o.t)((0,s.ao)(e)).throw(o.r.invalidParameters);var n=Date.now(),r=this._generateRequestId(),i=new s.av;return(0,o.ar)(s.ax).then((function(){var s=t._createPendingScheduledFileMessage(e,r,n);(0,o.F)((function(){return(0,o._)(t,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,i._trigger(s)]}))}))}))})),(0,o.i)(e.file)?this._uploadFileAndUpdateParams(e).then((function(){return t._createScheduledFileMessage(e,i,r,n)})):this._createScheduledFileMessage(e,i,r,n),i},t.prototype.updateScheduledFileMessage=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return n=(0,o.g)((0,o.g)({},bt),t),(0,o.t)(function(e){return(0,s.ad)(e)&&(0,o.a)("number",e.scheduledAt,!0)&&((0,o.i)(e.file)||(0,o.a)("string",e.fileUrl))&&(0,o.a)("string",e.fileName,!0)&&(0,o.a)("string",e.mimeType,!0)&&(0,o.a)("number",e.fileSize,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||e.thumbnailSizes.every((function(e){return(0,o.a)("object",e)&&e.maxWidth>0&&e.maxHeight>0})))}(n)).throw(o.r.invalidParameters),(0,o.i)(n.file)?[4,this._uploadFileAndUpdateParams(n)]:[3,2];case 1:i.sent(),i.label=2;case 2:return r=new wt((0,o.g)({reqId:this._generateRequestId(),scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url},n)),[4,o.V.of(this._iid).requestQueue.send(r)];case 3:return[2,i.sent().as(Ct).message]}}))}))},t.prototype.cancelScheduledMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return t=new At({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,o.V.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.sendScheduledMessageNow=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return t=new St({scheduledMessageId:e,channelType:this.channelType,channelUrl:this.url}),[4,o.V.of(this._iid).requestQueue.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.getMyPushTriggerOption=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return e=o.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new kt({userId:t.userId,channelUrl:this.url}),[4,n.send(r)];case 1:return i=a.sent(),s=i.as(xt).pushTriggerOption,this.myPushTriggerOption=s,[2,s]}}))}))},t.prototype.setMyPushTriggerOption=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return(0,o.t)((0,o.T)(o.X,e)).throw(o.r.invalidParameters),t=o.V.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,s=new It({userId:r.userId,channelUrl:this.url,pushTriggerOption:e}),[4,i.send(s)];case 1:return a=c.sent(),u=a.as(Nt).pushTriggerOption,this.myPushTriggerOption=u,n.dispatch(new R({channels:[this],source:o.Z.EVENT_CHANNEL_UPDATED,isWebSocketEventComing:!0})),[2,u]}}))}))},t.prototype.setMyCountPreference=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return(0,o.t)((0,o.T)(Rt,e)).throw(o.r.invalidParameters),t=o.V.of(this._iid),n=t.dispatcher,r=t.sdkState,i=t.requestQueue,s=new vt({channelUrl:this.url,userId:r.userId,countPreference:e}),[4,i.send(s)];case 1:return a=c.sent(),u=a.as(mt).countPreference,this.myCountPreference=u,this._updateUnreadCount(this.unreadMessageCount,this.unreadMentionCount),n.dispatch(new R({channels:[this],source:o.Z.EVENT_CHANNEL_UPDATED,isWebSocketEventComing:!0})),[2,u]}}))}))},t.prototype.resetMyHistory=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return e=o.V.of(this._iid),t=e.dispatcher,n=e.requestQueue,r=new gt({channelUrl:this.url}),[4,n.send(r)];case 1:return i=a.sent(),s=i.as(yt).messageOffsetTimestamp,this.messageOffsetTimestamp=s,this.lastMessage&&this.lastMessage.createdAt<s&&(this.lastMessage=null),t.dispatch(new R({channels:[this],source:o.Z.EVENT_CHANNEL_RESET_HISTORY,isWebSocketEventComing:!0})),[2,this]}}))}))},t.prototype.pinMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return(0,o.t)((0,o.a)("number",e)&&e>0).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new Ot({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.unpinMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return(0,o.t)((0,o.a)("number",e)&&e>0).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new Mt({channelType:this.channelType,channelUrl:this.url,messageId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype._uploadFileAndUpdateParams=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,a,u,c,l,d,h;return(0,o.b)(this,(function(f){switch(f.label){case 0:return(0,o.i)(e.file)?(t=o.V.of(this._iid).requestQueue,n=new s.az({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:this._generateRequestId()}),[4,t.send(n)]):[3,2];case 1:r=f.sent(),i=r.as(s.ay),a=i.url,u=i.fileSize,c=void 0===u?e.fileSize:u,l=i.thumbnails,d=i.requireAuth,h=void 0!==d&&d,e.fileUrl=a,e.fileSize=c,e.thumbnailSizes=null==l?void 0:l.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),e.requireAuth=h,f.label=2;case 2:return[2]}}))}))},t.prototype.resendMessage=function(e,t){var n,r=this;if((0,o.t)(e instanceof s.a4&&!e.scheduledInfo&&e.isResendable).throw(o.r.invalidParameters),e.isUserMessage()){var i=null!==(n=e.messageParams)&&void 0!==n?n:(0,s.ap)(e),a=new s.av;return this._sendUserMessage(i,s.aq.RESEND,e.reqId).onPending((function(e){a._trigger(e)})).onFailed((function(e,t){a._triggerFailed(e,t)})).onSucceeded((function(e){r._tryUpdateLastMessageAndCallEvents(r,e),a._trigger(e)})),a}if(e.isFileMessage()){var u=this._validateFailedFileMessageHasFile(e,t);(0,o.t)(u).throw(o.r.invalidParameters),i=(0,s.ar)(e,t);var c=new s.av;return this._sendFileMessage(i,s.aq.RESEND,e.reqId).onPending((function(e){c._trigger(e)})).onFailed((function(e,t){c._triggerFailed(e,t)})).onSucceeded((function(e){r._tryUpdateLastMessageAndCallEvents(r,e),c._trigger(e)})),c}if(e.isMultipleFilesMessage()){i=e.messageParams;var l=new s.ak;return this._sendMultipleFilesMessage(i,s.aq.RESEND,e.reqId).onPending((function(e){l._trigger(e)})).onFailed((function(e,t){l._triggerFailed(e,t)})).onSucceeded((function(e){r._tryUpdateLastMessageAndCallEvents(r,e),l._trigger(e)})).onFileUploaded((function(e,t,n,r){l._triggerOnFileUploaded(e,t,n,r)})),l}},t.prototype.copyMessage=function(e,t){var n=this;if((0,o.t)(e instanceof s.x&&t instanceof s.a4&&t.sendingStatus===o.aj.SUCCEEDED&&this.url===t.channelUrl&&!t.scheduledInfo).throw(o.r.invalidParameters),t.isUserMessage()){(0,o.t)(!t.poll).throw(o.r.notSupportedError);var r=(0,s.as)(t),i=new s.av;return e._sendUserMessage(r).onPending((function(e){i._trigger(e)})).onFailed((function(e,t){i._triggerFailed(e,t)})).onSucceeded((function(t){e.isGroupChannel()&&n._tryUpdateLastMessageAndCallEvents(e,t),i._trigger(t)})),i}if(t.isFileMessage()){r=(0,s.at)(t);var a=new s.av;return e._sendFileMessage(r).onPending((function(e){a._trigger(e)})).onFailed((function(e,t){a._triggerFailed(e,t)})).onSucceeded((function(t){e.isGroupChannel()&&n._tryUpdateLastMessageAndCallEvents(e,t),a._trigger(t)})),a}if(t.isMultipleFilesMessage()){if(e.isGroupChannel()){r=(0,s.au)(t);var u=new s.ak;return e._sendMultipleFilesMessage(r,s.aq.COPY).onPending((function(e){u._trigger(e)})).onFailed((function(e,t){u._triggerFailed(e,t)})).onSucceeded((function(t){n._tryUpdateLastMessageAndCallEvents(e,t),u._trigger(t)})).onFileUploaded((function(e,t,n,r){u._triggerOnFileUploaded(e,t,n,r)})),u}throw o.r.channelTypeNotSupportedError}},t}(s.x),Vt=n(3818),Bt={},zt=function(){function e(e){var t=e._iid,n=e.limit,r=void 0===n?100:n,i=this;this.ref=0,this._iid=t,this._limit=r;var s,u=o.V.of(this._iid),c=u.sdkState,l=u.dispatcher,d=u.logger,h=u.cacheContext;this._metadataKey=(s=c.userId,"sendbird:".concat(s,"@groupchannel/sync.meta"));var f=function(e){return"sendbird:".concat(e,"@groupchannel/sync")}(c.userId);this._sync=new Le(f,(function(){return(0,o._)(i,void 0,void 0,(function(){var e,t,n,r,i,s,u,l,f,p,_,v;return(0,o.b)(this,(function(m){switch(m.label){case 0:return e={hasNext:!0,nextToken:""},[4,this.loadMetadata()];case 1:if(m.sent(),d.debug("channel background sync from",null===(f=this._metadata)||void 0===f?void 0:f.token),null===(p=this._metadata)||void 0===p?void 0:p.completed)return[3,13];m.label=2;case 2:if(m.trys.push([2,9,,12]),(t={includeEmpty:!0,order:a.G.CHRONOLOGICAL}).order!==a.G.LATEST_LAST_MESSAGE)return[3,6];m.label=3;case 3:return m.trys.push([3,5,,6]),[4,h.preference.get((0,o.J)(c.appId))];case 4:return n=m.sent(),t.includeChatNotification=Boolean(n),[3,6];case 5:return m.sent(),t.includeChatNotification=!1,[3,6];case 6:return[4,Oe.of(this._iid).getMyGroupChannels(null!==(v=null===(_=this._metadata)||void 0===_?void 0:_.token)&&void 0!==v?v:"",t,this._limit,o.Z.SYNC_CHANNEL_BACKGROUND)];case 7:return r=m.sent(),i=r.channels,s=r.token,e.hasNext=i.length>=this._limit&&!!s,e.nextToken=s,this._metadata&&(this._metadata.token=s,(l=this._metadata.range).extends.apply(l,(0,o.o)([],(0,o.p)(i.map((function(e){return e.createdAt}))),!1)),this._metadata.completed=!e.hasNext),d.debug("channel background sync progress",e),[4,this.saveMetadata()];case 8:return m.sent(),[3,12];case 9:return u=m.sent(),d.debug("channel background sync error",u),u instanceof o.r&&u.isInvalidTokenError?[4,this.clearMetaData()]:[3,11];case 10:m.sent(),m.label=11;case 11:throw u;case 12:return[3,14];case 13:e.hasNext=!1,e.nextToken="",m.label=14;case 14:return[2,e]}}))}))})),this._connectionEventContext=l.on((function(e){e instanceof o.B&&(e.stateType===o.D.CONNECTED?i.resume():i.pause())}))}return e.of=function(t){return Bt[t]||(Bt[t]=new e({_iid:t})),Bt[t].ref++,Bt[t]},e.clear=function(e){Bt[e]&&(Bt[e].close(),delete Bt[e])},Object.defineProperty(e.prototype,"range",{get:function(){var e,t;return null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.range)&&void 0!==t?t:new ke({})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completed",{get:function(){var e;return!!(null===(e=this._metadata)||void 0===e?void 0:e.completed)},enumerable:!1,configurable:!0}),e.prototype.loadMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return this._metadata?[3,2]:[4,o.V.of(this._iid).cacheContext.preference.get(this._metadataKey)];case 1:e=t.sent(),this._metadata={token:e?e.token:"",range:new ke(e?e.range:{top:Number.MAX_SAFE_INTEGER,bottom:0}),completed:!!e&&e.completed},t.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return this._metadata?[4,o.V.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetaData=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,o.V.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){var e,t,n=o.V.of(this._iid),r=n.logger;n.sessionManager.session.hasSession&&(r.debug("channel background sync resume()"),this._sync.start(null!==(t=null===(e=this._metadata)||void 0===e?void 0:e.token)&&void 0!==t?t:""))},e.prototype.pause=function(){o.V.of(this._iid).logger.debug("channel background sync stop()"),this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Bt[this._iid])},e}(),Gt={},Wt=function(){function e(e){var t=e._iid,n=this;this.ref=0,this._iid=t;var r,i=o.V.of(this._iid),s=i.logger,a=i.sdkState,u=i.dispatcher,c=i.cacheContext;this._metadataKey=(r=a.userId,"sendbird:".concat(r,"@groupchannel/changelogs.meta"));var l=function(e){return"sendbird:".concat(e,"@groupchannel/changelogs")}(a.userId);this._sync=new Le(l,(function(){return(0,o._)(n,void 0,void 0,(function(){var e,t,n,r,i,u,l,d,h,f;return(0,o.b)(this,(function(p){switch(p.label){case 0:return e={hasNext:!0,nextToken:0},[4,this.loadMetadata()];case 1:p.sent(),s.debug("channel changelog sync from",null===(d=this._metadata)||void 0===d?void 0:d.token),p.label=2;case 2:p.trys.push([2,9,,12]),t={includeEmpty:!0},p.label=3;case 3:return p.trys.push([3,5,,6]),[4,c.preference.get((0,o.J)(a.appId))];case 4:return n=p.sent(),t.includeChatNotification=Boolean(n),[3,6];case 5:return p.sent(),t.includeChatNotification=!1,[3,6];case 6:return[4,Oe.of(this._iid).getMyGroupChannelChangeLogs(null!==(f=null===(h=this._metadata)||void 0===h?void 0:h.token)&&void 0!==f?f:"",t,o.Z.SYNC_CHANNEL_CHANGELOGS)];case 7:return r=p.sent(),i=r.hasMore,u=r.token,e.hasNext=i,e.nextToken=u,this._metadata&&(this._metadata.token=u),s.debug("channel changelog sync progress",e),[4,this.saveMetadata()];case 8:return p.sent(),[3,12];case 9:return l=p.sent(),s.debug("channel changelog sync error",l),l instanceof o.r&&l.isInvalidTokenError?[4,this.clearMetadata()]:[3,11];case 10:p.sent(),p.label=11;case 11:throw l;case 12:return[2,e]}}))}))})),this._connectionEventContext=u.on((function(e){e instanceof o.B&&(e.stateType===o.D.CONNECTED?n.resume():n.pause())}))}return e.of=function(t){return Gt[t]||(Gt[t]=new e({_iid:t})),Gt[t].ref++,Gt[t]},e.clear=function(e){Gt[e]&&(Gt[e].close(),delete Gt[e])},e.prototype.loadMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return this._metadata?[3,2]:(e=o.V.of(this._iid),t=e.cacheContext,n=e.firstConnectedAt,[4,t.preference.get(this._metadataKey)]);case 1:r=i.sent(),this._metadata={token:r?r.token:n},i.label=2;case 2:return[2,this._metadata]}}))}))},e.prototype.saveMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return this._metadata?[4,o.V.of(this._iid).cacheContext.preference.set(this._metadataKey,this._metadata)]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}}))}))},e.prototype.clearMetadata=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,o.V.of(this._iid).cacheContext.preference.remove(this._metadataKey)];case 1:return e.sent(),this._metadata=void 0,[2]}}))}))},e.prototype.resume=function(){o.V.of(this._iid).sessionManager.session.hasSession&&this._sync.start(0)},e.prototype.pause=function(){this._sync.stop()},e.prototype.close=function(){this.ref--,this.ref<=0&&(this.ref=0,this.pause(),this._connectionEventContext.close(),delete Gt[this._iid])},e}(),Kt=function(e,t){return e.findIndex((function(e){return e.isIdentical(t)}))},Qt=function(e,t,n){if(e.length>0){for(var r=Kt(e,t),i=0,o=e.length-1,s=Math.floor((i+o)/2);i<o;){var a=Zt(e[s],t,n);if(a>0)o=s,s=Math.floor((i+o)/2);else{if(!(a<0))return{place:s,oldPosition:r};i=s+1,s=Math.floor((i+o)/2)}}return{place:Zt(e[s],t,n)>=0?s:s+1,oldPosition:r}}return{place:e.length,oldPosition:-1}},Zt=function(e,t,n){switch(n){case a.G.LATEST_LAST_MESSAGE:return e.lastMessage&&t.lastMessage?t.lastMessage.createdAt-e.lastMessage.createdAt:e.lastMessage?-1:t.lastMessage?1:t.createdAt-e.createdAt;case a.G.CHRONOLOGICAL:return t.createdAt-e.createdAt;case a.G.CHANNEL_NAME_ALPHABETICAL:var r=e.name.localeCompare(t.name);return 0===r?e.createdAt-t.createdAt:r;default:return 0}},Yt=function(){function e(e,t){var n=t.filter,r=t.order,i=t.limit,u=this;this.channels=[],this._iid=e,this._key="gcc-".concat((0,o.m)()),this._isDisposed=!1,this._isGetRemoteChannelsSucceeded=!0,this.filter=null!=n?n:new b,this.order=null!=r?r:a.G.LATEST_LAST_MESSAGE,this._hasMore=!0,this._token="",this._limit=null!=i?i:s.J;var c=o.V.of(this._iid),l=c.sdkState,d=c.cacheContext,h=c.dispatcher;d.localCacheEnabled&&(this._backgroundSync=zt.of(e),this._backgroundSync.resume()),this._changelogSync=Wt.of(e),this._changelogSync.resume(),Oe.of(this._iid).subscribeChannelEvent(this._key,{onUpdate:function(e,t){if(M(t)){var n=e.filter((function(e){return u.filter.match(e,l.userId)})),r=e.filter((function(e){return!u.filter.match(e,l.userId)})).map((function(e){return e.url}));n.length>0&&u._addChannelsToView(n,t),r.length>0&&u._removeChannelsFromView(r,t)}},onRemove:function(e,t){u._removeChannelsFromView(e,t)}}),o.V.of(this._iid).statLogCollector.put(new o.b1({type:o.b2.FEATURE_LOCALCACHE,data:{use_local_cache:d.localCacheEnabled,collection_interface:{group_channel:!0}}})),h.on((function(e){e instanceof o.B&&(e.stateType===o.D.CONNECTED?u._isGetRemoteChannelsSucceeded||(0,o._)(u,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._revokeLoadMore()];case 1:return e.sent(),[2]}}))})):e.stateType===o.D.LOGOUT&&u.dispose())}))}return Object.defineProperty(e.prototype,"hasMore",{get:function(){return!this._isDisposed&&this._hasMore},enumerable:!1,configurable:!0}),e.prototype.setGroupChannelCollectionHandler=function(e){this._handler=e},e.prototype._addChannelsToView=function(e,t,n){var r,i,s,u,c=this;void 0===n&&(n=!1);var l=[],d=[],h=[];try{for(var f=(0,o.s)(e),p=f.next();!p.done;p=f.next()){var _=p.value,v=Kt(this.channels,_);v>=0&&this.channels.splice(v,1);var m=Qt(this.channels,_,this.order).place;if(v<0)m===this.channels.length?!n&&this._hasMore||(l.push(_),this.channels.push(_)):(l.push(_),this.channels.splice(m,0,_));else switch(t){case o.Z.EVENT_CHANNEL_UPDATED:case o.Z.EVENT_MESSAGE_RECEIVED:case o.Z.SYNC_CHANNEL_CHANGELOGS:case o.Z.EVENT_MESSAGE_SENT:this.order===a.G.CHANNEL_NAME_ALPHABETICAL&&this._hasMore&&this.channels.length>1&&m===this.channels.length?h.push(_):(this.channels.splice(m,0,_),d.push(_));break;default:this.channels.splice(m,0,_),d.push(_)}}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}if(h.length>0)try{for(var g=(0,o.s)(h),y=g.next();!y.done;y=g.next()){_=y.value;var b=Kt(this.channels,_);-1!==b&&this.channels.splice(b,1)}}catch(e){s={error:e}}finally{try{y&&!y.done&&(u=g.return)&&u.call(g)}finally{if(s)throw s.error}}M(t)&&(0,o.F)((function(){return(0,o._)(c,void 0,void 0,(function(){var e,n,r,i;return(0,o.b)(this,(function(o){return e=new Ke(t),l.length>0&&(null===(n=this._handler)||void 0===n?void 0:n.onChannelsAdded)&&this._handler.onChannelsAdded(e,l),d.length>0&&(null===(r=this._handler)||void 0===r?void 0:r.onChannelsUpdated)&&this._handler.onChannelsUpdated(e,d),h.length>0&&(null===(i=this._handler)||void 0===i?void 0:i.onChannelsDeleted)&&this._handler.onChannelsDeleted(e,h.map((function(e){return e.url}))),[2]}))}))}))},e.prototype._removeChannelsFromView=function(e,t){var n,r,i=this,s=[],a=function(e){var t=u.channels.findIndex((function(t){return t.url===e}));t>=0&&(s.push(u.channels[t].url),u.channels.splice(t,1))},u=this;try{for(var c=(0,o.s)(e),l=c.next();!l.done;l=c.next())a(l.value)}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return M(t)&&s.length>0&&(0,o.F)((function(){return(0,o._)(i,void 0,void 0,(function(){var e,n;return(0,o.b)(this,(function(r){return e=new Ke(t),(null===(n=this._handler)||void 0===n?void 0:n.onChannelsDeleted)&&this._handler.onChannelsDeleted(e,s),[2]}))}))})),s},e.prototype._getLocalChannels=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return e=Oe.of(this._iid),t=this.channels.length>0?function(e,t){var n,r,i,o;switch(t){case a.G.LATEST_LAST_MESSAGE:return null!==(r=null===(n=e.lastMessage)||void 0===n?void 0:n.createdAt)&&void 0!==r?r:e.createdAt;case a.G.CHRONOLOGICAL:return e.createdAt;case a.G.CHANNEL_NAME_ALPHABETICAL:return e.name;default:return null!==(o=null===(i=e.lastMessage)||void 0===i?void 0:i.createdAt)&&void 0!==o?o:e.createdAt}}(this.channels[this.channels.length-1],this.order):null,[4,e.getChannelsFromCache(t,this.filter,this.order,this._limit,t?this.channels[this.channels.length-1].url:void 0)];case 1:return[2,n.sent()]}}))}))},e.prototype._getRemoteChannels=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return[4,Oe.of(this._iid).getMyGroupChannels(this._token,(0,o.u)((0,o.g)((0,o.g)({},this.filter),{order:this.order})),this._limit)];case 1:return e=r.sent(),t=e.channels,n=e.token,this._token=n,this._hasMore=!!n,[2,t]}}))}))},e.prototype._revokeLoadMore=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:if(this._isDisposed)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this._getRemoteChannels()];case 2:return e=t.sent(),this._isGetRemoteChannelsSucceeded=!0,this._addChannelsToView(e,o.Z.REQUEST_CHANNEL,!0),[3,4];case 3:return t.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,4];case 4:return[2]}}))}))},e.prototype.loadMore=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i=this;return(0,o.b)(this,(function(s){switch(s.label){case 0:if(this._isDisposed)throw new o.r({code:o.ah.COLLECTION_DISPOSED,message:"Collection has been disposed."});return this._hasMore?(e=o.V.of(this._iid),t=e.cacheContext,n=e.connectionManager,r=[],!t.localCacheEnabled||n.isConnected&&!this._backgroundSync.completed?[3,2]:[4,(0,o.z)((function(){return(0,o._)(i,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._getLocalChannels()];case 1:return r=e.sent(),[2]}}))}))}))]):[3,6];case 1:return s.sent(),this._hasMore=r.length>=this._limit,[3,5];case 2:return s.trys.push([2,4,,5]),[4,this._getRemoteChannels()];case 3:return r=s.sent(),this._isGetRemoteChannelsSucceeded=!0,[3,5];case 4:return s.sent(),this._isGetRemoteChannelsSucceeded=!1,[3,5];case 5:return this._addChannelsToView(r,o.Z.REQUEST_CHANNEL,!0),[2,r];case 6:return[2,[]]}}))}))},e.prototype.dispose=function(){var e,t;this._isDisposed||(this._isDisposed=!0,this.channels.length>0&&this.channels.splice(0,this.channels.length),null===(e=this._backgroundSync)||void 0===e||e.close(),null===(t=this._changelogSync)||void 0===t||t.close(),Oe.of(this._iid).unsubscribeChannelEvent(this._key))},e}(),$t=function(e){function t(t){var n=this,r=t.token,i=t.limit,s=t.order,a=t.includeEmpty,u=t.membershipFilter,l=t.channelNameContainsFilter,d=t.channelUrlsFilter,h=t.customTypesFilter,f=t.customTypeStartsWithFilter,p=t.superChannelFilter,_=t.metadataOrderKeyFilter,v=t.metadataKey,m=t.metadataValues,g=t.metadataValueStartsWith,y=t.includeFrozen,b=t.includeMetaData;return(n=e.call(this)||this).method=o.A.GET,n.path=o.au,n.params=(0,o.e)((0,o.u)({token:r,limit:i,order:s,show_member:!0,show_read_receipt:!0,show_delivery_receipt:!0,show_empty:a,public_mode:c.PUBLIC,public_membership_mode:u,name_contains:l,channel_urls:d,custom_types:h,custom_type_startswith:f,super_mode:p,metadata_order_key:_,metadata_key:v,metadata_values:m,metadata_value_startswith:g,show_frozen:y,show_metadata:b})),n}return(0,o.c)(t,e),t}(o.f),Xt=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,o=n.channels,s=n.ts;return r.token=i,o&&o.length>0&&(r.channels=o.map((function(e){return e.ts=s,new Ht(t,e)}))),r.ts="number"==typeof s?s:0,r}return(0,o.c)(t,e),t}(o.h);!function(e){e.ALL="all",e.JOINED="joined"}(qt||(qt={}));var Jt=function(e){function t(t,n){var r,i,o,s,u,c,l,h,f,p,_,v,m,g,y=this;return(y=e.call(this,t,n)||this).includeEmpty=!1,y.includeFrozen=!0,y.includeMetaData=!0,y.channelUrlsFilter=null,y.customTypesFilter=null,y.customTypeStartsWithFilter=null,y.channelNameContainsFilter=null,y.membershipFilter=qt.ALL,y.superChannelFilter=d.ALL,y.metadataKey=null,y.metadataValues=null,y.metadataOrderKeyFilter=null,y.metadataValueStartsWith=null,y.order=a.P.CHRONOLOGICAL,y.includeEmpty=null!==(r=n.includeEmpty)&&void 0!==r&&r,y.includeFrozen=null===(i=n.includeFrozen)||void 0===i||i,y.includeMetaData=null===(o=n.includeMetaData)||void 0===o||o,y.channelUrlsFilter=null!==(s=n.channelUrlsFilter)&&void 0!==s?s:null,y.customTypesFilter=null!==(u=n.customTypesFilter)&&void 0!==u?u:null,y.customTypeStartsWithFilter=null!==(c=n.customTypeStartsWithFilter)&&void 0!==c?c:null,y.channelNameContainsFilter=null!==(l=n.channelNameContainsFilter)&&void 0!==l?l:null,y.membershipFilter=null!==(h=n.membershipFilter)&&void 0!==h?h:qt.ALL,y.superChannelFilter=null!==(f=n.superChannelFilter)&&void 0!==f?f:d.ALL,y.metadataKey=null!==(p=n.metadataKey)&&void 0!==p?p:null,y.metadataValues=null!==(_=n.metadataValues)&&void 0!==_?_:null,y.metadataOrderKeyFilter=null!==(v=n.metadataOrderKeyFilter)&&void 0!==v?v:null,y.metadataValueStartsWith=null!==(m=n.metadataValueStartsWith)&&void 0!==m?m:null,y.order=null!==(g=n.order)&&void 0!==g?g:a.P.CHRONOLOGICAL,y}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,o.a)("boolean",this.includeEmpty)&&(0,o.a)("boolean",this.includeFrozen)&&(0,o.a)("boolean",this.includeMetaData)&&(0,o.a)("string",this.channelNameContainsFilter,!0)&&(0,o.O)("string",this.channelUrlsFilter,!0)&&(0,o.O)("string",this.customTypesFilter,!0)&&(0,o.a)("string",this.customTypeStartsWithFilter,!0)&&(0,o.T)(qt,this.membershipFilter)&&(0,o.T)(d,this.superChannelFilter)&&(0,o.T)(a.P,this.order)&&(0,o.a)("string",this.metadataOrderKeyFilter,!0)&&(0,o.a)("string",this.metadataKey,!0)&&(0,o.O)("string",this.metadataValues,!0)&&(0,o.a)("string",this.metadataValueStartsWith,!0)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=o.V.of(this._iid),n=t.requestQueue,t.dispatcher,r=new $t((0,o.u)((0,o.g)((0,o.g)({},this),{token:this._token}))),[4,n.send(r)]):[3,2]):[3,5];case 1:return i=c.sent(),s=i.as(Xt),a=s.channels,u=s.token,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,a];case 2:return[2,e];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aI),en=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return(0,o.c)(t,e),t}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onUserJoined=o.av,t.onUserLeft=o.av,t.onUserReceivedInvitation=o.av,t.onUserDeclinedInvitation=o.av,t.onChannelHidden=o.av,t.onUnreadMemberStatusUpdated=o.av,t.onUndeliveredMemberStatusUpdated=o.av,t.onTypingStatusUpdated=o.av,t.onPollUpdated=o.av,t.onPollVoted=o.av,t.onPollDeleted=o.av,t.onPinnedMessageUpdated=o.av,t}return(0,o.c)(t,e),t}(Vt.B)),tn=function(e){function t(t){var n=this,r=t.token,i=t.limit,s=t.order,a=t.reverse,u=t.channelUrl,c=t.messageTypeFilter,l=t.scheduledStatus;return(n=e.call(this)||this).method=o.A.GET,n.path="".concat(o.b3),n.params=(0,o.e)((0,o.u)({token:r,limit:i,reverse:a,channel_url:u,order:s,message_type:c,status:l})),n}return(0,o.c)(t,e),t}(o.f),nn=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.scheduledMessages=[];var i=n.next,o=n.scheduled_messages;return r.token=i,r.scheduledMessages=o.map((function(e){return(0,s.K)(t,e)})),r}return(0,o.c)(t,e),t}(o.h),rn=function(e){function t(t,n){var r,i,s,a,u,c=this;return(c=e.call(this,t,n)||this).channelUrl=null,c.order=null,c.reverse=!1,c.scheduledStatus=null,c.messageTypeFilter=o.al.ALL,c.channelUrl=null!==(r=n.channelUrl)&&void 0!==r?r:null,c.order=null!==(i=n.order)&&void 0!==i?i:null,c.reverse=null!==(s=n.reverse)&&void 0!==s&&s,c.scheduledStatus=null!==(a=n.scheduledStatus)&&void 0!==a?a:null,c.messageTypeFilter=null!==(u=n.messageTypeFilter)&&void 0!==u?u:o.al.ALL,c}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,o.a)("string",this.channelUrl,!0)&&((0,o.T)(a.S,this.order)||null===this.order)&&(0,o.a)("boolean",this.reverse)&&((0,o.O)(s.L,this.scheduledStatus)||null===this.scheduledStatus)&&(0,o.T)(o.al,this.messageTypeFilter)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=o.V.of(this._iid).requestQueue,t=new tn((0,o.u)((0,o.g)((0,o.g)({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=a.sent(),r=n.as(nn),i=r.scheduledMessages,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aI),on=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="groupChannel",t}return(0,o.c)(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,o=n.sessionManager,s=n.requestQueue,a=n.logger,u=n.onlineDetector,c=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:o,requestQueue:s,logger:a,onlineDetector:u,cacheContext:c}),this._manager=new Oe(t,{sdkState:r,cacheContext:c,dispatcher:i,sessionManager:o,requestQueue:s,logger:a})},t.prototype.createGroupChannelCollection=function(e){return void 0===e&&(e={}),new Yt(this._iid,e)},t.prototype.createMyGroupChannelListQuery=function(e){return void 0===e&&(e={}),new we(this._iid,e)},t.prototype.createPublicGroupChannelListQuery=function(e){return void 0===e&&(e={}),new Jt(this._iid,e)},t.prototype.createScheduledMessageListQuery=function(e){return void 0===e&&(e={}),new rn(this._iid,e)},t.prototype.addGroupChannelHandler=function(e,t){(0,o.t)((0,o.a)("string",e)&&t instanceof en).throw(o.r.invalidParameters),this._manager.addHandler(e,t)},t.prototype.removeGroupChannelHandler=function(e){(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),this._manager.removeHandler(e)},t.prototype.removeAllGroupChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildGroupChannelFromSerializedData=function(e){return this._manager.buildGroupChannelFromSerializedData(e)},t.prototype.buildGroupChannelListQueryFromSerializedData=function(e){return this._manager.buildGroupChannelListQueryFromSerializedData(e)},t.prototype.buildMemberFromSerializedData=function(e){return this._manager.buildMemberFromSerializedData(e)},t.prototype.getChannel=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),[2,this._manager.getChannel(e)]}))}))},t.prototype.getChannelWithoutCache=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),[2,this._manager.getChannelWithoutCache(e)]}))}))},t.prototype.getMyGroupChannelChangeLogsByToken=function(e,t){return void 0===t&&(t={}),(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},T),t),(0,o.t)((0,o.a)("string",e)&&A(n)).throw(o.r.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMyGroupChannelChangeLogsByTimestamp=function(e,t){return void 0===t&&(t={}),(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},T),t),(0,o.t)((0,o.a)("number",e)&&A(n)).throw(o.r.invalidParameters),[4,this._manager.getMyGroupChannelChangeLogs(e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getGroupChannelCount=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){return t=(0,o.g)((0,o.g)({},S),e),(0,o.t)(I(t)).throw(o.r.invalidParameters),[2,this._manager.getGroupChannelCount(t)]}))}))},t.prototype.getUnreadItemCount=function(e){return void 0===e&&(e={}),(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._manager.getUnreadItemCount(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getTotalUnreadChannelCount=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._manager.getTotalUnreadChannelCount()];case 1:return[2,e.sent()]}}))}))},t.prototype.getTotalUnreadMessageCount=function(e){return void 0===e&&(e={}),(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._manager.getTotalUnreadMessageCount(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getTotalScheduledMessageCount=function(e){return void 0===e&&(e={}),(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._manager.getTotalScheduledMessageCount(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getSubscribedTotalUnreadMessageCount=function(){return this._manager.getSubscribedTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeTotalUnreadMessageCount=function(){return this._manager.getSubscribedCustomTypeTotalUnreadMessageCount()},t.prototype.getSubscribedCustomTypeUnreadMessageCount=function(e){return this._manager.getSubscribedCustomTypeUnreadMessageCount(e)},t.prototype.createChannel=function(e){return void 0===e&&(e={}),(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){return t=(0,o.g)((0,o.g)({},w),e),(0,o.t)(C(t)).throw(o.r.invalidParameters),[2,this._manager.createChannel(t)]}))}))},t.prototype.createDistinctChannelIfNotExist=function(e){return void 0===e&&(e={}),(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){return t=(0,o.g)((0,o.g)({},w),e),(0,o.t)(C(t)).throw(o.r.invalidParameters),t&&(t.isDistinct=!0),[2,this.createChannel(t)]}))}))},t.prototype.createChannelWithUserIds=function(e,t,n,r,i,s){return void 0===t&&(t=!1),void 0===i&&(i=""),void 0===s&&(s=""),(0,o._)(this,void 0,void 0,(function(){var a;return(0,o.b)(this,(function(u){return a=(0,o.g)((0,o.g)({},w),{invitedUserIds:e,isDistinct:t,name:n,data:i,customType:s}),"string"==typeof r?a.coverUrl=r:a.coverImage=r,[2,this.createChannel(a)]}))}))},t.prototype.markAsReadAll=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._manager.markAsReadAll(),[2]}))}))},t.prototype.markAsReadWithChannelUrls=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return(0,o.t)((0,o.O)("string",e)).throw(o.r.invalidParameters),this._manager.markAsReadWithChannelUrls(e),[2]}))}))},t.prototype.markAsDelivered=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),[4,this.getChannel(e)];case 1:return[4,t.sent().markAsDelivered()];case 2:return t.sent(),[2]}}))}))},t}(o.aS)},278:function(e,t,n){n.d(t,{Cu:function(){return i.C},Nb:function(){return o.C},KN:function(){return i.q},H7:function(){return o.S},Ai:function(){return o.U},Ay:function(){return _e}});var r,i=n(9851),o=n(8777),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="poll",t}return(0,i.c)(t,e),t.prototype.init=function(t,n){var r=n.sdkState,o=n.dispatcher,s=n.sessionManager,a=n.requestQueue,u=n.logger,c=n.onlineDetector,l=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:o,sessionManager:s,requestQueue:a,logger:u,onlineDetector:c,cacheContext:l}),this._manager=new i.aH(t,{sdkState:r,dispatcher:o,sessionManager:s,requestQueue:a,logger:u,onlineDetector:c,cacheContext:l})},t.prototype.create=function(e){return(0,i._)(this,void 0,void 0,(function(){var t;return(0,i.b)(this,(function(n){return t=(0,i.g)((0,i.g)({},i.aU),e),(0,i.t)((0,i.aV)(t)).throw(i.r.invalidParameters),[2,this._manager.create(t)]}))}))},t.prototype.get=function(e){return(0,i._)(this,void 0,void 0,(function(){var t;return(0,i.b)(this,(function(n){return t=(0,i.g)((0,i.g)({},i.aW),e),(0,i.t)((0,i.aX)(t)).throw(i.r.invalidParameters),[2,this._manager.get(t)]}))}))},t.prototype.getOption=function(e){return(0,i._)(this,void 0,void 0,(function(){var t;return(0,i.b)(this,(function(n){return t=(0,i.g)((0,i.g)({},i.aY),e),(0,i.t)((0,i.aZ)(t)).throw(i.r.invalidParameters),[2,this._manager.getOption(t)]}))}))},t.prototype.buildPollFromSerializedData=function(e){return this._manager.buildPollFromSerializedData(e)},t}(i.aS),a=n(4445),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.c)(t,e),t}(i.b0),c=function(e){this.key=e.key,this.url=e.url},l=function(e){this.id=e.id,this.name=e.name,this.url=e.url,this.emojis=e.emojis?e.emojis.map((function(e){return new c(e)})):[]},d=function(e){this.emojiHash=e.emoji_hash||"",this.emojiCategories=e.emoji_categories?e.emoji_categories.map((function(e){return new l(e)})):[]},h={profileImage:void 0,profileUrl:void 0,nickname:void 0},f=function(e){return function(t,n){return(0,i._)(void 0,void 0,void 0,(function(){var r,s,u,c,l;return(0,i.b)(this,(function(d){switch(d.label){case 0:switch(t){case 1:case 2:case 3:return[3,1];case 4:return[3,2];case 5:return[3,9]}return[3,13];case 1:return n(),[3,14];case 2:return d.trys.push([2,7,,8]),[4,e.clear()];case 3:return d.sent(),r=function(e){return{v2:function(){return(0,i._)(void 0,void 0,void 0,(function(){return(0,i.b)(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:o.a,keyName:o.b,index:[(0,a.g)(a.G.LATEST_LAST_MESSAGE),(0,a.g)(a.G.CHRONOLOGICAL),(0,a.g)(a.G.CHANNEL_NAME_ALPHABETICAL)]},{collectionName:o.N,keyName:o.c,index:[(0,o.g)(o.M.CHANNEL_LATEST),(0,o.g)(o.M.NEWEST_CHILD_MESSAGE)]},{collectionName:o.d,keyName:o.e,index:[(0,o.g)(o.M.CHANNEL_LATEST),(0,o.g)(o.M.NEWEST_CHILD_MESSAGE)]},{collectionName:o.f,keyName:o.h}])];case 1:return[2,t.sent()]}}))}))},v3:function(){return(0,i._)(void 0,void 0,void 0,(function(){return(0,i.b)(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:o.i,keyName:o.j,index:[["-lastMessageUpdatedAt","-createdAt","syncIndex"]]}])];case 1:return[2,t.sent()]}}))}))},v4:function(){return(0,i._)(void 0,void 0,void 0,(function(){return(0,i.b)(this,(function(t){switch(t.label){case 0:return[4,e.commitSchema([{collectionName:o.k,keyName:o.l,index:[(0,o.m)()]}])];case 1:return[2,t.sent()]}}))}))}}}(e),s=r.v2,u=r.v3,c=r.v4,[4,s()];case 4:return d.sent(),[4,u()];case 5:return d.sent(),[4,c()];case 6:return d.sent(),n(),[3,8];case 7:return l=d.sent(),n(l),[3,8];case 8:return[3,14];case 9:return d.trys.push([9,11,,12]),[4,e.collection(o.N).removeIf({where:{channelType:i.C.OPEN}})];case 10:case 11:return d.sent(),[3,12];case 12:return n(),[3,14];case 13:n(),d.label=14;case 14:return[2]}}))}))}},p=function(){return"undefined"!=typeof document?document.visibilityState:"visible"},_=function(e){function t(t){var n=t.getVisibilityState,r=void 0===n?p:n,i=t.initialState,o=void 0===i?"visible":i,s=t.isEnabled,a=void 0===s||s,u=t.pauseCheckDelay,c=void 0===u?3e4:u,l=e.call(this)||this;return l._pauseCheckDelay=3e4,l._currentState="visible",l._getVisibilityState=r,l._pauseCheckDelay=c,l._currentState=o,l._isEnabled=a,l._boundToggleState=l._toggleState.bind(l),l}return(0,i.c)(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAvailable",{get:function(){return"undefined"!=typeof window&&!!window.addEventListener&&!!window.removeEventListener},enumerable:!1,configurable:!0}),t.prototype._toggleState=function(){var e=this,t=this._getVisibilityState();"hidden"!==t?"hidden"===this._currentState&&(this._pauseDelayTimer&&(clearTimeout(this._pauseDelayTimer),this._pauseDelayTimer=void 0),this.dispatch("resume")):"hidden"!==this._currentState&&(this._pauseDelayTimer=setTimeout((function(){e._pauseDelayTimer=void 0,e.dispatch("pause")}),this._pauseCheckDelay)),this._currentState=t},t.prototype.start=function(){this._isEnabled&&this.isAvailable&&(this._boundToggleState=this._toggleState.bind(this),window.addEventListener("visibilitychange",this._boundToggleState,{capture:!0}))},t.prototype.stop=function(){this._isEnabled&&this.isAvailable&&this._boundToggleState&&window.removeEventListener("visibilitychange",this._boundToggleState,{capture:!0})},t}(i.E),v=function(){function e(e){var t=e.logger,n=e.connectionDelegate,r=void 0===n?null:n,i=this;this._onlineWorker=function(){var e;return null===(e=i.connectionDelegate)||void 0===e?void 0:e.reconnect()},this._offlineWorker=function(){var e;return null===(e=i.connectionDelegate)||void 0===e?void 0:e.disconnect()},this.unsubscribes=[],this._onlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("online",e),function(){return window.removeEventListener("online",e,!1)}},this._offlineListener=function(e){if(i.isAvailableOnWeb)return window.addEventListener("offline",e),function(){return window.removeEventListener("offline",e,!1)}},this.logger=t,r&&(this.connectionDelegate=r)}return Object.defineProperty(e.prototype,"isAvailableOnWeb",{get:function(){return"undefined"!=typeof window&&!!window.addEventListener&&"ononline"in window&&"onoffline"in window&&"undefined"!=typeof navigator&&void 0!==navigator.onLine},enumerable:!1,configurable:!0}),e.prototype.setOnlineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._onlineListener=e)},e.prototype.setOfflineListener=function(e){Boolean(e)&&"function"==typeof e&&(this._offlineListener=e)},e.prototype.start=function(){this.unsubscribes=[this._onlineListener(this._onlineWorker),this._offlineListener(this._offlineWorker)]},e.prototype.stop=function(){var e=this;this.unsubscribes.forEach((function(t){try{null==t||t()}catch(t){e.logger.warn(t.message)}})),this.unsubscribes=[]},e.prototype.isOnline=function(){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this.isAvailableOnWeb?[2,navigator.onLine]:[2,new Promise((function(e){fetch("https://www.google.com",{method:i.A.GET,mode:"no-cors"}).then((function(){return e(!0)})).catch((function(){return e(!1)}))}))]}))}))},e}(),m=function(e){function t(t){var n=t.userId,r=t.nickname,o=t.profileUrl,s=t.profileImage,a=t.preferredLanguages,u=e.call(this)||this;return u.method=i.A.PUT,u.path="".concat(i.d,"/").concat(encodeURIComponent(n)),u.params=(0,i.e)((0,i.u)({nickname:r,profile_url:o,profile_file:s,preferred_languages:a})),u}return(0,i.c)(t,e),t}(i.f),g=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.user=new i.U(t,(0,i.g)({},n)),r}return(0,i.c)(t,e),t}(i.h),y=function(e){function t(t){var n=t.userId,r=t.token,o=e.call(this)||this;return o.method=i.A.POST,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push/apns"),o.params={apns_device_token:r,always_push:!0},o}return(0,i.c)(t,e),t}(i.f);r=i.h,(0,i.c)((function(e,t){var n=r.call(this,e,t)||this;return n.token=t.token,n.type=t.type?i.P[t.type.toLowerCase()]:i.P.UNKNOWN,n.user=new i.U(e,t.user),n}),r);var b=function(e){function t(t){var n=t.userId,r=t.token,o=e.call(this)||this;return o.method=i.A.POST,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push/gcm"),o.params={gcm_reg_token:r,always_push:!0},o}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.type=n.type?i.P[n.type.toLowerCase()]:i.P.UNKNOWN,r.user=new i.U(t,n.user),r}),e)}(i.h);var E=function(e){function t(t){var n=t.userId,r=t.token,o=e.call(this)||this;return o.method=i.A.DELETE,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push/apns/").concat(encodeURIComponent(r)),o}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.user=new i.U(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(i.h);var w=function(e){function t(t){var n=t.userId,r=t.token,o=e.call(this)||this;return o.method=i.A.DELETE,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push/gcm/").concat(encodeURIComponent(r)),o}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(t,n){var r=e.call(this,t,n)||this;return r.token=n.token,r.user=new i.U(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(i.h);var C=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=i.A.DELETE,r.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push/apns"),r}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(t,n){var r=e.call(this,t,n)||this;return r.type=n.type?i.P[n.type.toLowerCase()]:i.P.UNKNOWN,r.user=new i.U(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(i.h);var T=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=i.A.DELETE,r.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push/gcm"),r}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(t,n){var r=e.call(this,t,n)||this;return r.type=n.type?i.P[n.type.toLowerCase()]:i.P.UNKNOWN,r.user=new i.U(t,n.user),r.lastDeletedAt=n.device_token_last_deleted_at,r}),e)}(i.h);var A=function(e){function t(t){var n=t.userId,r=t.type,o=t.token,s=t.ts,a=e.call(this)||this;return a.method=i.A.GET,a.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push/").concat(encodeURIComponent(r),"/device_tokens"),a.params={created_ts:s,token:o},a}return(0,i.c)(t,e),t}(i.f),S=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTokens={type:n.type?i.P[n.type.toLowerCase()]:i.P.UNKNOWN,deviceTokens:n.device_tokens,hasMore:n.has_more,token:n.token},r}return(0,i.c)(t,e),t}(i.h),I=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=i.A.GET,r.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),r}return(0,i.c)(t,e),t}(i.f),N=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r}return(0,i.c)(t,e),t}(i.h),k=function(e){function t(t){var n=t.userId,r=t.willAutoAccept,o=e.call(this)||this;return o.method=i.A.PUT,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/channel_invitation_preference"),o.params={auto_accept:r},o}return(0,i.c)(t,e),t}(i.f),x=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoAccept=n.auto_accept,r}return(0,i.c)(t,e),t}(i.h),O=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=i.A.GET,r.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push_preference"),r}return(0,i.c)(t,e),t}(i.f),M=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r}return(0,i.c)(t,e),t}(i.h),R=function(e){function t(t){var n=t.userId,r=t.doNotDisturbOn,o=t.startHour,s=t.startMin,a=t.endHour,u=t.endMin,c=t.timezone,l=e.call(this)||this;return l.method=i.A.PUT,l.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push_preference"),l.params={do_not_disturb:r,start_hour:o,start_min:s,end_hour:a,end_min:u,timezone:c},l}return(0,i.c)(t,e),t}(i.f),D=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.preference={doNotDisturbOn:n.do_not_disturb,startHour:n.start_hour,startMin:n.start_min,endHour:n.end_hour,endMin:n.end_min,timezone:n.timezone},r}return(0,i.c)(t,e),t}(i.h),U=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=i.A.GET,r.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push_preference"),r}return(0,i.c)(t,e),t}(i.f),L=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r}return(0,i.c)(t,e),t}(i.h),P=function(e){function t(t){var n=t.userId,r=t.snoozeOn,o=t.startTs,s=t.endTs,a=e.call(this)||this;return a.method=i.A.PUT,a.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push_preference"),a.params={snooze_enabled:r,snooze_start_ts:o,snooze_end_ts:s},a}return(0,i.c)(t,e),t}(i.f),F=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.snoozePeriod={isSnoozeOn:n.snooze_enabled},"number"==typeof n.snooze_start_ts&&(r.snoozePeriod.startTs=n.snooze_start_ts),"number"==typeof n.snooze_end_ts&&(r.snoozePeriod.endTs=n.snooze_end_ts),r}return(0,i.c)(t,e),t}(i.h),j=function(e){function t(t){var n=t.userId,r=t.blockedUserId,o=e.call(this)||this;return o.method=i.A.POST,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/block"),o.params={target_id:r},o}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(t,n){var r=e.call(this,t,n)||this;return r.user=new i.U(t,n),r}),e)}(i.h);var q=function(e){function t(t){var n=t.userId,r=t.unblockedUserId,o=e.call(this)||this;return o.method=i.A.DELETE,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/block/").concat(encodeURIComponent(r)),o}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(i.h);var H=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=i.A.GET,r.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push_preference"),r}return(0,i.c)(t,e),t}(i.f),V=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r}return(0,i.c)(t,e),t}(i.h),B=function(e){function t(t){var n=t.userId,r=t.pushTriggerOption,o=e.call(this)||this;return o.method=i.A.PUT,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push_preference"),o.params={push_trigger_option:r},o}return(0,i.c)(t,e),t}(i.f),z=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pushTriggerOption=n.push_trigger_option,r}return(0,i.c)(t,e),t}(i.h),G=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=i.A.GET,r.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push/template"),r}return(0,i.c)(t,e),t}(i.f),W=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r}return(0,i.c)(t,e),t}(i.h),K=function(e){function t(t){var n=t.userId,r=t.templateName,o=e.call(this)||this;return o.method=i.A.PUT,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/push/template"),o.params={name:r},o}return(0,i.c)(t,e),t}(i.f),Q=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.name=n.name,r}return(0,i.c)(t,e),t}(i.h),Z=function(e){function t(t){var n=t.userId,r=t.token,o=e.call(this)||this;return o.method=i.A.GET,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/friends/changelogs"),o.params={token:r},o}return(0,i.c)(t,e),t}(i.f),Y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.changelogs={addedUsers:n.added.map((function(e){return new i.U(t,e)})),updatedUsers:n.updated.map((function(e){return new i.U(t,e)})),deletedUserIds:n.deleted,hasMore:n.has_more,token:n.next},r}return(0,i.c)(t,e),t}(i.h),$=function(e){function t(t){var n=t.userId,r=t.discoveries,o=e.call(this)||this;return o.method=i.A.PUT,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/friend_discoveries"),o.params={friend_discoveries:r.map((function(e){return{friend_discovery_key:e.friendDiscoveryKey,friend_name:e.friendName}}))},o}return(0,i.c)(t,e),t}(i.f),X=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.friendDiscoveryRequestId=n.friend_discovery_request_id,r}return(0,i.c)(t,e),t}(i.h),J=function(e){function t(t){var n=t.userId,r=t.discoveryKeys,o=e.call(this)||this;return o.method=i.A.DELETE,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/friend_discoveries"),o.params={friend_discovery_keys:r},o}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(i.h);var ee=function(e){function t(t){var n=t.userId,r=t.userIds,o=e.call(this)||this;return o.method=i.A.POST,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/friends"),o.params={user_ids:r},o}return(0,i.c)(t,e),t}(i.f),te=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map((function(e){return new i.U(t,e)})),r}return(0,i.c)(t,e),t}(i.h),ne=function(e){function t(t){var n=t.userId,r=t.userIds,o=e.call(this)||this;return o.method=i.A.DELETE,o.path="".concat(i.d,"/").concat(encodeURIComponent(n),"/friends"),o.params={user_ids:r},o}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(i.h);var re=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=i.A.GET,r.path="".concat(i.d,"/").concat(n,"/allow_friend_discovery"),r.params={},r}return(0,i.c)(t,e),t}(i.f),ie=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.allowFriendDiscovery=n.allow_friend_discovery,r}return(0,i.c)(t,e),t}(i.h),oe=function(e){function t(t){var n=t.userId,r=t.allowFriendDiscovery,o=e.call(this)||this;return o.method=i.A.PUT,o.path="".concat(i.d,"/").concat(n,"/allow_friend_discovery"),o.params={allow_friend_discovery:r},o}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(i.h);var se,ae=function(e){function t(){var t=e.call(this)||this;return t.method=i.A.GET,t.path=i.j,t}return(0,i.c)(t,e),t}(i.f),ue=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiContainer=new d(n),r}return(0,i.c)(t,e),t}(i.h),ce=function(e){function t(t){var n=t.categoryId,r=e.call(this)||this;return r.method=i.A.GET,r.path="".concat(i.j,"/").concat(n),r}return(0,i.c)(t,e),t}(i.f),le=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emojiCategory=new l(n),r}return(0,i.c)(t,e),t}(i.h),de=function(e){function t(t){var n=t.key,r=e.call(this)||this;return r.method=i.A.GET,r.path="".concat(i.k,"/").concat(n),r}return(0,i.c)(t,e),t}(i.f),he=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.emoji=new c(n),r}return(0,i.c)(t,e),t}(i.h),fe=function(e){function t(){var t=e.call(this)||this;return t.method=i.A.GET,t.path="".concat(i.l),t}return(0,i.c)(t,e),t}(i.f),pe=function(e){function t(t,n){var r,i=this,o=null!=n?n:{};return(i=e.call(this,t,n)||this).uikitConfiguration={string:JSON.stringify(o),json:o},i.updatedAt=null!==(r=null==n?void 0:n.updated_at)&&void 0!==r?r:0,i}return(0,i.c)(t,e),t}(i.h),_e=function(){function e(e,t,n){var r=this;this._storeInitialized=!1,this._iid=e,this.options=t;var o=i.V.of(e),s=o.sdkState,c=o.cacheContext,l=o.dispatcher,d=o.sessionManager,h=o.requestQueue,f=o.logger,p=o.userEventHandlers,m=o.appStateToggleEnabled;this._onlineDetector=new v({logger:f,connectionDelegate:{reconnect:function(){return(0,i._)(r,void 0,void 0,(function(){var t,n,r,o,s,a;return(0,i.b)(this,(function(c){switch(c.label){case 0:if(t=i.V.of(e),n=t.sdkState,r=t.connectionManager,(o=t.sessionManager).session.hasSession)return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,r.connect(o.session.authToken)];case 2:return c.sent(),[3,4];case 3:if(s=c.sent(),(0,i.N)(s))throw s;return f.debug("connect failed by reconnect event = ",s),[3,4];case 4:return[3,9];case 5:if("foreground"!==n.appState)return[3,9];c.label=6;case 6:return c.trys.push([6,8,,9]),[4,r.resetAndReconnect()];case 7:return c.sent(),[3,9];case 8:if(a=c.sent(),(0,i.N)(a))throw a;return f.debug("resetAndReconnect failed by reconnect event = ",a),[3,9];case 9:return l.dispatch(new u),[2]}}))}))},disconnect:function(){(0,i.z)((function(){return(0,i._)(r,void 0,void 0,(function(){return(0,i.b)(this,(function(t){switch(t.label){case 0:return[4,i.V.of(e).connectionManager.disconnect()];case 1:return t.sent(),[2]}}))}))}))}}});var g=new a.A(e,{localCacheEnabled:c.localCacheEnabled,enableAutoResend:c.localCacheConfig.enableAutoResend,dispatcher:l,sdkState:s,logger:f});n.forEach((function(t){t.init(e,{sdkState:s,cacheContext:c,dispatcher:l,sessionManager:d,requestQueue:h,logger:f,onlineDetector:r._onlineDetector}),r[t.name]=t})),this._appStateChangeDetector=new _({isEnabled:m}),this._appStateChangeDetector.on("resume",(function(){f.debug("the page resumes from freeze"),r.setForegroundState()})).on("pause",(function(){f.debug("the page freezes"),r.setBackgroundState()})),l.on((function(t){var n;if(t instanceof i.B)t.stateType===i.D.CONNECTED&&g.processNonAutoResendRegisteredPendingMessages();else if(t instanceof i.W){if("USEV"===t.code){var o=t.as(a.U).event;if(o.category===a.a.FRIEND_DISCOVERED){var u=a.b.getDataAsFriendDiscoveredEvent(e,o).friendDiscoveries;(0,i.F)((function(){return(0,i._)(r,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return[2,p.forEach((function(e){e.onFriendsDiscovered&&e.onFriendsDiscovered(u)}))]}))}))}))}}}else if(t instanceof i.G){var l=i.V.of(r._iid).subscribedUnreadMessageCount,d=!1,h=t.ts;if("number"==typeof h&&h>l.ts){if(l.all!==t.all&&(d=!0),l.all=t.all>=0?t.all:0,t.customTypes)for(var _ in t.customTypes)l.customTypes[_]!==t.customTypes[_]&&(d=!0),l.customTypes[_]=t.customTypes[_];d=d&&l.ts>0,l.ts=h}d&&(0,i.F)((function(){return(0,i._)(r,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return[2,p.forEach((function(e){e.onTotalUnreadMessageCountChanged&&e.onTotalUnreadMessageCountChanged({groupChannelCount:l.all,feedChannelCount:l.feed,customTypeUnreadCount:l.customTypes}),e.onTotalUnreadMessageCountUpdated&&e.onTotalUnreadMessageCountUpdated(l.all,l.customTypes)}))]}))}))}))}else t instanceof i.H?(c.preference.set(r._getUserProfileCacheKey(s.userId),i.I.payloadify(t.userProfile)),(null===(n=t.userProfile.appInfo.notificationInfo)||void 0===n?void 0:n.isEnabled)&&c.preference.set((0,i.J)(r.appId),{value:!0})):t instanceof i.K&&t.error&&t.error.isSessionInvalidatedError&&(f.debug("session revoked."),r.disconnect())}))}return e.init=function(t){var n=t.appId,r=t.appVersion,a=t.modules,u=void 0===a?[]:a,c=t.options,l=void 0===c?new i.S:c,d=t.debugMode,h=void 0!==d&&d,f=t.customApiHost,p=t.customWebSocketHost,_=t.newInstance,v=void 0!==_&&_,m=t.logLevel,g=t.localCacheEnabled,y=void 0!==g&&g,b=t.localCacheConfig,E=void 0===b?new i.L:b,w=t.localCacheEncryption,C=t.useAsyncStorageStore,T=void 0===C?null:C,A=t.appStateToggleEnabled,S=void 0===A||A;if(!se||v){var I="su-".concat((0,i.m)()),N=null!=w?w:{encrypt:function(e){return e},decrypt:function(e){return e}},k=new o.n({encryption:N});h||(k=(0,i.n)()?T?new o.A({AsyncStorage:T,encryption:N}):new o.n({encryption:N}):new o.I({encryption:N})),new i.V(I,{appId:n,appVersion:r,options:l,apiHost:null!=f?f:"https://api-".concat(n,".sendbird.com"),websocketHost:null!=p?p:"wss://ws-".concat(n,".sendbird.com"),store:k,encryption:N,logLevel:m,localCacheEnabled:y,localCacheConfig:E,debugMode:h,appStateToggleEnabled:S});var x=[new o.o,new s],O=new e(I,l,(0,i.o)((0,i.o)([],(0,i.p)(u),!1),(0,i.p)(x),!1));return se||(se=O),O}return se},Object.defineProperty(e,"instance",{get:function(){return se},enumerable:!1,configurable:!0}),Object.defineProperty(e,"version",{get:function(){return i.v},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appId",{get:function(){return i.V.of(this._iid).sdkState.appId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appInfo",{get:function(){var e=i.V.of(this._iid).appInfo;return null!=e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appVersion",{get:function(){var e;return null!==(e=i.V.of(this._iid).sdkState.appVersion)&&void 0!==e?e:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"debugMode",{get:function(){return!!i.V.of(this._iid).debugMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logLevel",{get:function(){return i.V.of(this._iid).logger.level},set:function(e){i.V.of(this._iid).logger.level=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCacheEnabled",{get:function(){return i.V.of(this._iid).cacheContext.localCacheEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCacheConfig",{get:function(){var e=i.V.of(this._iid).cacheContext;return e.localCacheEnabled?e.localCacheConfig:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ekey",{get:function(){return i.V.of(this._iid).sessionManager.ekey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentUser",{get:function(){var e;return null!==(e=i.V.of(this._iid).sessionManager.currentUser)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionState",{get:function(){var e=i.V.of(this._iid).connectionManager;return e.isConnected?i.q.OPEN:e.isConnecting?i.q.CONNECTING:i.q.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastConnectedAt",{get:function(){var e=i.V.of(this._iid),t=e.connectedAt;return e.connectionManager.isConnected?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fcmPushToken",{get:function(){var e;return null!==(e=this._fcmPushToken)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apnsPushToken",{get:function(){var e;return null!==(e=this._apnsPushToken)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),e.prototype._getNestDBVersion=function(){return 6},e.prototype._getPreferenceCacheKey=function(e){return"sendbird@".concat(this.appId,"/").concat(e,".pref")},e.prototype._getUserProfileCacheKey=function(e){return"sendbird@".concat(this.appId,"/").concat(e,".profile")},e.prototype.getMemoryStoreForDebugging=function(){var e=i.V.of(this._iid),t=e.debugMode,n=e.cacheContext;if(t)return n.store instanceof o.n?n.store:null;throw i.r.debugModeRequired},e.prototype.addExtension=function(e,t){var n=i.V.of(this._iid).sdkState;["sb_uikit","sb_syncmanager","device-os-platform"].indexOf(e)>-1&&n.extensions&&(n.extensions[e]=t)},e.prototype.addSendbirdExtensions=function(e,t,n){var r,o,s=i.V.of(this._iid),a=s.logger,u=s.sdkState,c=new RegExp(i.M);if(0===e.length)return a.debug("sb.addSendbirdExtensions() has failed because the given sendbirdExtensions is empty."),!1;if(e.find((function(e){return!c.test(e.version)})))return a.debug("sb.addSendbirdExtensions() has failed because the given version did not satisfy the SemVer specification."),!1;if(n)try{for(var l=(0,i.s)(Object.entries(n)),d=l.next();!d.done;d=l.next()){var h=(0,i.p)(d.value,2),f=h[0],p=h[1];if(/&|=/.test(f)||/&|=/.test(p))return a.debug("sb.addSendbirdExtensions() has failed because the given customData includes at least one invalid character: = or &."),!1}}catch(e){r={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}return u.sendbirdRuntimeEnvironment={sendbirdExtensions:e,deviceOS:t,customData:n},!0},e.prototype.setOnlineListener=function(e){this._onlineDetector.setOnlineListener(e)},e.prototype.setOfflineListener=function(e){this._onlineDetector.setOfflineListener(e)},e.prototype._safeInitializeStore=function(e){return(0,i._)(this,void 0,void 0,(function(){var t;return(0,i.b)(this,(function(n){switch(n.label){case 0:t=i.V.of(this._iid).cacheContext,n.label=1;case 1:return n.trys.push([1,3,,5]),[4,t.store.init(e)];case 2:return n.sent(),this._storeInitialized=!0,[3,5];case 3:return n.sent(),t.replaceStore(new o.n),[4,this._safeInitializeStore(e)];case 4:return n.sent(),[3,5];case 5:return[2]}}))}))},e.prototype.initializeCache=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,s,u,c,l,d,h;return(0,i.b)(this,(function(p){switch(p.label){case 0:if(t=i.V.of(this._iid),n=t.sdkState,r=t.cacheContext,s=t.dispatcher,u=t.logger,n.userId&&n.userId===e)return[3,9];if(c="sendbird@".concat(n.appId,"/").concat(e,".db"),!r.localCacheEnabled)return[3,7];p.label=1;case 1:return p.trys.push([1,4,,6]),r.nestdb&&r.nestdb.state!==o.v.CLOSED&&r.nestdb.name===c?[3,3]:(l="sendbird@".concat(n.appId,"/").concat(e,".db"),(d=r.nestdb=new o.r({name:l,version:this._getNestDBVersion(),store:r.store,config:new o.s({dbname:l,itemSizeLimit:61440})})).on("upgrade",f(d)),d.on("storeReplaced",(function(e){r.replaceStore(e),r.localCacheEnabled=!1,d.on("upgrade",f(d))})),[4,d.open()]);case 2:p.sent(),this._storeInitialized=!0,s.dispatch(new a.D(this._iid,{userId:e})),p.label=3;case 3:return n.userId=e,[3,6];case 4:return h=p.sent(),u.warn("Nest DB Open Failed. ",h),r.store instanceof o.n||(r.replaceStore(new o.n),r.localCacheEnabled=!1),[4,this._safeInitializeStore(c)];case 5:throw p.sent(),n.userId=e,i.r.databaseError;case 6:return[3,9];case 7:return[4,this._safeInitializeStore(c)];case 8:p.sent(),n.userId=e,p.label=9;case 9:return[2]}}))}))},e.prototype.getCacheDataSize=function(){return(0,i._)(this,void 0,void 0,(function(){var e;return(0,i.b)(this,(function(t){switch(t.label){case 0:return(e=i.V.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.estimateUsage()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,0]}}))}))},e.prototype.clearCachedData=function(){return(0,i._)(this,void 0,void 0,(function(){var e;return(0,i.b)(this,(function(t){switch(t.label){case 0:return(e=i.V.of(this._iid).cacheContext).localCacheEnabled&&e.nestdb?[4,e.nestdb.clear()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this._storeInitialized?[4,e.preference.clear()]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},e.prototype.clearCachedMessages=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r=this;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.O)("string",e)).throw(i.r.invalidParameters),t=o.t.of(this._iid),n=o.u.of(this._iid),t&&n?[4,Promise.all(e.map((function(e){return(0,i._)(r,void 0,void 0,(function(){return(0,i.b)(this,(function(r){switch(r.label){case 0:return[4,t.removeMessagesOfChannel(e)];case 1:return r.sent(),[4,n.removeMessagesOfChannel(e)];case 2:return r.sent(),[2]}}))}))})))]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}}))}))},e.prototype._setupPreference=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o,s;return(0,i.b)(this,(function(a){switch(a.label){case 0:return t=i.V.of(this._iid),n=t.sdkState,r=t.cacheContext,o=t.statLogCollector,[4,r.preference.init(this._getPreferenceCacheKey(e),this._getNestDBVersion())];case 1:return a.sent(),[4,r.preference.get(this._getUserProfileCacheKey(e))];case 2:return(s=a.sent())&&new i.I(this._iid,s).apply(),[4,o.init("sendbird@".concat(n.appId,"/").concat(e,".statlog"))];case 3:return a.sent(),[2]}}))}))},e.prototype._ready=function(e,t,n){return void 0===n&&(n={}),(0,i._)(this,void 0,void 0,(function(){var r,o,s,u,c,l;return(0,i.b)(this,(function(d){switch(d.label){case 0:return(0,i.t)((0,i.a)("string",e)&&(0,i.a)("string",t,!0)).throw(i.r.invalidParameters),r=i.V.of(this._iid),o=r.sdkState,s=r.cacheContext,u=r.connectionManager,c=n.errorForOtherUser,o.userId&&o.userId!==e?c?[3,2]:[4,u.logout()]:[3,3];case 1:return d.sent(),[3,3];case 2:throw c;case 3:return d.trys.push([3,5,6,8]),[4,this.initializeCache(e)];case 4:return d.sent(),i.V.of(this._iid).dispatcher.dispatch(new a.R),[3,8];case 5:return d.sent(),l=i.V.of(this._iid).logger,s.localCacheEnabled=!1,l.warn("Cache initialization failed - cache is not available."),[3,8];case 6:return[4,this._setupPreference(e)];case 7:return d.sent(),[7];case 8:return[2]}}))}))},e.prototype.authenticateFeed=function(e,t){return(0,i._)(this,void 0,void 0,(function(){var n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return n=i.V.of(this._iid),r=n.sessionManager,o=n.connectionManager,[4,this._ready(e,t,{errorForOtherUser:o.isConnected?i.r.alreadyConnectedAsAnotherUser:void 0})];case 1:return s.sent(),r.session.hasLessServiceScopeThan([i.Q.FEED])?[4,r.authenticateFeed(e,t)]:[3,3];case 2:s.sent(),s.label=3;case 3:return[2,this.currentUser]}}))}))},e.prototype.connect=function(e,t){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(n){switch(n.label){case 0:return[4,this._ready(e,t)];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,,4,5]),[4,i.V.of(this._iid).connectionManager.connect(t)];case 3:return n.sent(),[3,5];case 4:return this._onlineDetector.start(),this._appStateChangeDetector.start(),[7];case 5:return[2,this.currentUser]}}))}))},e.prototype.reconnect=function(){var e=i.V.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.sessionManager.session.hasSession;return r&&(this._appStateChangeDetector.start(),this._onlineDetector.start(),t.resetAndReconnect().then((function(){n.appState="foreground"})).catch((function(){}))),r},e.prototype.disconnect=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,i.b)(this,(function(o){switch(o.label){case 0:return e=i.V.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),r.cancelAll(),[4,t.logout()];case 1:return o.sent(),[4,this.clearCachedData()];case 2:return o.sent(),n.appState="foreground",[2]}}))}))},e.prototype.disconnectWebSocket=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n;return(0,i.b)(this,(function(r){switch(r.label){case 0:return e=i.V.of(this._iid),t=e.connectionManager,n=e.requestQueue,this._appStateChangeDetector.stop(),this._onlineDetector.stop(),n.cancelAll(),[4,t.disconnectWebSocket(!0)];case 1:return r.sent(),[2]}}))}))},e.prototype.setBackgroundState=function(){var e=i.V.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.logger;"foreground"===n.appState&&(n.appState="background",r.debug("going background state"),t.background().catch((function(e){r.debug("setBackgroundState error = ",e)})))},e.prototype.setForegroundState=function(){var e=i.V.of(this._iid),t=e.connectionManager,n=e.sdkState,r=e.dispatcher,o=e.logger;"background"===n.appState&&(n.appState="foreground",o.debug("going foreground state"),t.resetAndReconnect().catch((function(e){o.debug("setForgroundState error = ",e)})),r.dispatch(new u))},e.prototype.setSessionHandler=function(e){(0,i.t)(e instanceof o.S).throw(i.r.invalidParameters),i.V.of(this._iid).sessionManager.handler=e},e.prototype.addUserEventHandler=function(e,t){(0,i.t)((0,i.a)("string",e)&&t instanceof o.U).throw(i.r.invalidParameters),i.V.of(this._iid).userEventHandlers.set(e,t)},e.prototype.removeUserEventHandler=function(e){i.V.of(this._iid).userEventHandlers.delete(e)},e.prototype.removeAllUserEventHandler=function(){i.V.of(this._iid).userEventHandlers.clear()},e.prototype.addConnectionHandler=function(e,t){(0,i.t)((0,i.a)("string",e)&&t instanceof o.C).throw(i.r.invalidParameters),i.V.of(this._iid).connectionHandlers.set(e,t)},e.prototype.removeConnectionHandler=function(e){i.V.of(this._iid).connectionHandlers.delete(e)},e.prototype.removeAllConnectionHandler=function(){i.V.of(this._iid).connectionHandlers.clear()},e.prototype.createApplicationUserListQuery=function(e){return void 0===e&&(e={}),new o.p(this._iid,e)},e.prototype.createBlockedUserListQuery=function(e){return void 0===e&&(e={}),new o.B(this._iid,e)},e.prototype.createFriendListQuery=function(e){return void 0===e&&(e={}),new o.F(this._iid,e)},e.prototype.createMessageSearchQuery=function(e){return new o.q(this._iid,e)},e.prototype.createPollListQuery=function(e){return new i.w(this._iid,(0,i.g)({},e))},e.prototype.createPollVoterListQuery=function(e){return new i.x(this._iid,(0,i.g)({},e))},e.prototype.buildUserFromSerializedData=function(e){var t=(0,i.y)(e);return new i.U(this._iid,i.U.payloadify(t))},e.prototype.updateCurrentUserInfo=function(e){return void 0===e&&(e={}),(0,i._)(this,void 0,void 0,(function(){var t,n,r,o,s,a,u;return(0,i.b)(this,(function(c){switch(c.label){case 0:return t=(0,i.g)((0,i.g)({},h),e),(0,i.t)(function(e){return(0,i.i)(e.profileImage,!0)&&(0,i.a)("string",e.profileUrl,!0)&&(0,i.a)("string",e.nickname,!0)}(t)).throw(i.r.invalidParameters),this.currentUser?(n=i.V.of(this._iid),r=n.sdkState,o=n.requestQueue,s=new m((0,i.g)({userId:r.userId},t)),[4,o.send(s)]):[3,2];case 1:return a=c.sent(),u=a.as(g).user,this.currentUser&&(t.nickname&&(this.currentUser.nickname=u.nickname),(t.profileUrl||t.profileImage)&&(this.currentUser.plainProfileUrl=u.profileUrl)),[2,u];case 2:throw i.r.connectionRequired}}))}))},e.prototype.updateCurrentUserInfoWithPreferredLanguages=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o,s,a;return(0,i.b)(this,(function(u){switch(u.label){case 0:return(0,i.t)((0,i.O)("string",e)).throw(i.r.invalidParameters),this.currentUser?(t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new m({userId:n.userId,preferredLanguages:e}),[4,r.send(o)]):[3,2];case 1:return s=u.sent(),a=s.as(g).user,this.currentUser&&(this.currentUser.preferredLanguages=a.preferredLanguages),[2,a];case 2:throw i.r.connectionRequired}}))}))},e.prototype.registerFCMPushTokenForCurrentUser=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o,s,a=this;return(0,i.b)(this,(function(u){switch(u.label){case 0:if((0,i.t)((0,i.a)("string",e)).throw(i.r.invalidParameters),!this.currentUser)return[3,6];u.label=1;case 1:return u.trys.push([1,4,,5]),t=i.V.of(this._iid),n=t.sessionManager,r=t.sdkState,o=t.requestQueue,n.hasDeviceToken(i.P.FCM,e)?[2,i.R.SUCCESS]:(s=new b({userId:r.userId,token:e}),[4,o.send(s)]);case 2:return u.sent(),[4,(0,i.z)((function(){return(0,i._)(a,void 0,void 0,(function(){return(0,i.b)(this,(function(t){switch(t.label){case 0:return n.setDeviceToken(i.P.FCM,e),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return u.sent(),this._fcmPushToken="",[2,i.R.SUCCESS];case 4:return u.sent(),[2,i.R.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=e,[2,i.R.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterFCMPushTokenForCurrentUser=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o,s,a,u=this;return(0,i.b)(this,(function(c){switch(c.label){case 0:if((0,i.t)((0,i.a)("string",e)).throw(i.r.invalidParameters),!this.currentUser)return[3,6];c.label=1;case 1:return c.trys.push([1,4,,5]),t=i.V.of(this._iid),n=t.sessionManager,r=t.sdkState,o=t.requestQueue,s=new w({userId:r.userId,token:e}),[4,o.send(s)];case 2:return a=c.sent().lastDeletedAt,[4,(0,i.z)((function(){return(0,i._)(u,void 0,void 0,(function(){return(0,i.b)(this,(function(t){switch(t.label){case 0:return n.unsetDeviceToken(i.P.FCM,e),n.setDeviceTokenDeletedAt(a),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return c.sent(),this._fcmPushToken="",[2,i.R.SUCCESS];case 4:return c.sent(),[2,i.R.ERROR];case 5:return[3,7];case 6:return this._fcmPushToken=e,[2,i.R.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterFCMPushTokenAllForCurrentUser=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r,o,s,a=this;return(0,i.b)(this,(function(u){switch(u.label){case 0:return this.currentUser?(e=i.V.of(this._iid),t=e.sessionManager,n=e.sdkState,r=e.requestQueue,o=new T({userId:n.userId}),[4,r.send(o)]):[3,3];case 1:return s=u.sent().lastDeletedAt,[4,(0,i.z)((function(){return(0,i._)(a,void 0,void 0,(function(){return(0,i.b)(this,(function(e){switch(e.label){case 0:return t.unsetDeviceTokens(i.P.FCM),t.setDeviceTokenDeletedAt(s),[4,t.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))}))];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},e.prototype.registerAPNSPushTokenForCurrentUser=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o,s,a=this;return(0,i.b)(this,(function(u){switch(u.label){case 0:if((0,i.t)((0,i.a)("string",e)).throw(i.r.invalidParameters),!this.currentUser)return[3,6];u.label=1;case 1:return u.trys.push([1,4,,5]),t=i.V.of(this._iid),n=t.sessionManager,r=t.sdkState,o=t.requestQueue,n.hasDeviceToken(i.P.APNS,e)?[2,i.R.SUCCESS]:(s=new y({userId:r.userId,token:e}),[4,o.send(s)]);case 2:return u.sent(),[4,(0,i.z)((function(){return(0,i._)(a,void 0,void 0,(function(){return(0,i.b)(this,(function(t){switch(t.label){case 0:return n.setDeviceToken(i.P.APNS,e),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return u.sent(),this._apnsPushToken="",[2,i.R.SUCCESS];case 4:return u.sent(),[2,i.R.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=e,[2,i.R.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterAPNSPushTokenForCurrentUser=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o,s,a,u=this;return(0,i.b)(this,(function(c){switch(c.label){case 0:if((0,i.t)((0,i.a)("string",e)).throw(i.r.invalidParameters),!this.currentUser)return[3,6];c.label=1;case 1:return c.trys.push([1,4,,5]),t=i.V.of(this._iid),n=t.sessionManager,r=t.sdkState,o=t.requestQueue,s=new E({userId:r.userId,token:e}),[4,o.send(s)];case 2:return a=c.sent().lastDeletedAt,[4,(0,i.z)((function(){return(0,i._)(u,void 0,void 0,(function(){return(0,i.b)(this,(function(t){switch(t.label){case 0:return n.unsetDeviceToken(i.P.APNS,e),n.setDeviceTokenDeletedAt(a),[4,n.saveDeviceToken()];case 1:return t.sent(),[2]}}))}))}))];case 3:return c.sent(),this._apnsPushToken="",[2,i.R.SUCCESS];case 4:return c.sent(),[2,i.R.ERROR];case 5:return[3,7];case 6:return this._apnsPushToken=e,[2,i.R.PENDING];case 7:return[2]}}))}))},e.prototype.unregisterAPNSPushTokenAllForCurrentUser=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r,o,s,a=this;return(0,i.b)(this,(function(u){switch(u.label){case 0:return this.currentUser?(e=i.V.of(this._iid),t=e.sessionManager,n=e.sdkState,r=e.requestQueue,o=new C({userId:n.userId}),[4,r.send(o)]):[3,3];case 1:return s=u.sent().lastDeletedAt,[4,(0,i.z)((function(){return(0,i._)(a,void 0,void 0,(function(){return(0,i.b)(this,(function(e){switch(e.label){case 0:return t.unsetDeviceTokens(i.P.APNS),t.setDeviceTokenDeletedAt(s),[4,t.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))}))];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},e.prototype.getChannelInvitationPreference=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,i.b)(this,(function(o){switch(o.label){case 0:return e=i.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new I({userId:t.userId}),[4,n.send(r)];case 1:return[2,{autoAccept:o.sent().as(N).autoAccept}]}}))}))},e.prototype.setChannelInvitationPreference=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.a)("boolean",e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new k({userId:n.userId,willAutoAccept:e}),[4,r.send(o)];case 1:return[2,{autoAccept:s.sent().as(x).autoAccept}]}}))}))},e.prototype.getDoNotDisturb=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,i.b)(this,(function(o){switch(o.label){case 0:return e=i.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new O({userId:t.userId}),[4,n.send(r)];case 1:return[2,o.sent().as(M).preference]}}))}))},e.prototype.setDoNotDisturb=function(e,t,n,r,o,s){return void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=""),(0,i._)(this,void 0,void 0,(function(){var a,u,c,l;return(0,i.b)(this,(function(d){switch(d.label){case 0:return(0,i.t)((0,i.a)("boolean",e)&&(0,i.a)("number",t)&&(0,i.a)("number",n)&&(0,i.a)("number",r)&&(0,i.a)("number",o)&&(0,i.a)("string",s)).throw(i.r.invalidParameters),a=i.V.of(this._iid),u=a.sdkState,c=a.requestQueue,l=new R({userId:u.userId,doNotDisturbOn:e,startHour:t,startMin:n,endHour:r,endMin:o,timezone:s}),[4,c.send(l)];case 1:return[2,d.sent().as(D).preference]}}))}))},e.prototype.getSnoozePeriod=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,i.b)(this,(function(o){switch(o.label){case 0:return e=i.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new U({userId:t.userId}),[4,n.send(r)];case 1:return[2,o.sent().as(L).snoozePeriod]}}))}))},e.prototype.setSnoozePeriod=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),(0,i._)(this,void 0,void 0,(function(){var r,o,s,a;return(0,i.b)(this,(function(u){switch(u.label){case 0:return(0,i.t)((0,i.a)("boolean",e)&&(0,i.a)("number",t)&&(0,i.a)("number",n)).throw(i.r.invalidParameters),r=i.V.of(this._iid),o=r.sdkState,s=r.requestQueue,a=new P({userId:o.userId,snoozeOn:e,startTs:t,endTs:n}),[4,s.send(a)];case 1:return[2,u.sent().as(F).snoozePeriod]}}))}))},e.prototype.getMyPushTokensByToken=function(e,t){return(0,i._)(this,void 0,void 0,(function(){var n,r,o,s,a,u,c,l,d,h,f,p;return(0,i.b)(this,(function(_){switch(_.label){case 0:return(0,i.t)((0,i.a)("string",e)&&(0,i.T)(i.P,t)).throw(i.r.invalidParameters),n=i.V.of(this._iid),r=n.sdkState,o=n.requestQueue,s=n.sessionManager,a=new A({userId:r.userId,type:t,token:e}),[4,o.send(a)];case 1:u=_.sent(),c=u.as(S).pushTokens;try{for(l=(0,i.s)(c.deviceTokens),d=l.next();!d.done;d=l.next())h=d.value,s.setDeviceToken(c.type,h)}catch(e){f={error:e}}finally{try{d&&!d.done&&(p=l.return)&&p.call(l)}finally{if(f)throw f.error}}return[4,s.saveDeviceToken()];case 2:return _.sent(),[2,c]}}))}))},e.prototype.getPushTriggerOption=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,i.b)(this,(function(o){switch(o.label){case 0:return e=i.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new H({userId:t.userId}),[4,n.send(r)];case 1:return[2,o.sent().as(V).pushTriggerOption]}}))}))},e.prototype.setPushTriggerOption=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.T)(i.X,e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new B({userId:n.userId,pushTriggerOption:e}),[4,r.send(o)];case 1:return[2,s.sent().as(z).pushTriggerOption]}}))}))},e.prototype.getPushTemplate=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,i.b)(this,(function(o){switch(o.label){case 0:return e=i.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new G({userId:t.userId}),[4,n.send(r)];case 1:return[2,o.sent().as(W).name]}}))}))},e.prototype.setPushTemplate=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.T)(i.Y,e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new K({userId:n.userId,templateName:e}),[4,r.send(o)];case 1:return[2,s.sent().as(Q).name]}}))}))},e.prototype.blockUser=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)(e instanceof i.U||(0,i.a)("string",e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new j({userId:n.userId,blockedUserId:e instanceof i.U?e.userId:e}),[4,r.send(o)];case 1:return s.sent(),[2]}}))}))},e.prototype.blockUserWithUserId=function(e){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){return[2,this.blockUser(e)]}))}))},e.prototype.unblockUser=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)(e instanceof i.U||(0,i.a)("string",e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new q({userId:n.userId,unblockedUserId:e instanceof i.U?e.userId:e}),[4,r.send(o)];case 1:return s.sent(),[2]}}))}))},e.prototype.unblockUserWithUserId=function(e){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){return[2,this.unblockUser(e)]}))}))},e.prototype.getFriendChangeLogsByToken=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.a)("string",e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new Z({userId:n.userId,token:e}),[4,r.send(o)];case 1:return[2,s.sent().as(Y).changelogs]}}))}))},e.prototype.getAllowFriendDiscovery=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,i.b)(this,(function(o){switch(o.label){case 0:return e=i.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new re({userId:t.userId}),[4,n.send(r)];case 1:return[2,o.sent().as(ie).allowFriendDiscovery]}}))}))},e.prototype.setAllowFriendDiscovery=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.a)("boolean",e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new oe({userId:n.userId,allowFriendDiscovery:e}),[4,r.send(o)];case 1:return s.sent(),[2,e]}}))}))},e.prototype.uploadFriendDiscoveries=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new $({userId:n.userId,discoveries:e}),[4,r.send(o)];case 1:return[2,s.sent().as(X).friendDiscoveryRequestId]}}))}))},e.prototype.deleteFriendDiscovery=function(e){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){return[2,this.deleteFriendDiscoveries([e])]}))}))},e.prototype.deleteFriendDiscoveries=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.O)("string",e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new J({userId:n.userId,discoveryKeys:e}),[4,r.send(o)];case 1:return s.sent(),[2]}}))}))},e.prototype.addFriends=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.O)("string",e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new ee({userId:n.userId,userIds:e}),[4,r.send(o)];case 1:return[2,s.sent().as(te).users]}}))}))},e.prototype.deleteFriend=function(e){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){return[2,this.deleteFriends([e])]}))}))},e.prototype.deleteFriends=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.O)("string",e)).throw(i.r.invalidParameters),t=i.V.of(this._iid),n=t.sdkState,r=t.requestQueue,o=new ne({userId:n.userId,userIds:e}),[4,r.send(o)];case 1:return s.sent(),[2]}}))}))},e.prototype.getAllEmoji=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t;return(0,i.b)(this,(function(n){switch(n.label){case 0:return e=i.V.of(this._iid).requestQueue,t=new ae,[4,e.send(t)];case 1:return[2,n.sent().as(ue).emojiContainer]}}))}))},e.prototype.getEmojiCategory=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n;return(0,i.b)(this,(function(r){switch(r.label){case 0:return t=i.V.of(this._iid).requestQueue,n=new ce({categoryId:e}),[4,t.send(n)];case 1:return[2,r.sent().as(le).emojiCategory]}}))}))},e.prototype.getEmoji=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n;return(0,i.b)(this,(function(r){switch(r.label){case 0:return t=i.V.of(this._iid).requestQueue,n=new de({key:e}),[4,t.send(n)];case 1:return[2,r.sent().as(he).emoji]}}))}))},e.prototype.getUIKitConfiguration=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n;return(0,i.b)(this,(function(r){switch(r.label){case 0:return e=i.V.of(this._iid),(0,i.t)(e.hasExtension("sb_uikit")).throw(i.r.notSupportedError),t=e.requestQueue,n=new fe,[4,t.send(n)];case 1:return[2,r.sent().as(pe).uikitConfiguration]}}))}))},e}()},3762:function(e,t,n){n.r(t),n.d(t,{xmlHttpRequest:function(){return i}});var r=n(9851),i=function(e,t){return new Promise((function(n,i){if("undefined"!=typeof XMLHttpRequest){var o=r.V.of(e),s=o.dispatcher,a=o.logger,u=t.requestId,c=t.method,l=t.url,d=t.headers,h=void 0===d?{}:d,f=t.data,p=void 0===f?"":f,_=t.uploadProgressHandler,v=!1,m=new XMLHttpRequest;for(var g in m.open(c,l),h)m.setRequestHeader(g,h[g]);_&&m.upload.addEventListener("progress",(function(e){e.lengthComputable?_(u,e.loaded,e.total):a.debug("Progress computing failed: `Content-Length` header is not given.")})),m.onabort=function(){i(r.r.requestCanceled)},m.onerror=function(e){i(r.r.networkError)},m.onreadystatechange=function(){if(m.readyState===XMLHttpRequest.DONE&&!v)if(0===m.status||m.status>=200&&m.status<400)try{var t=JSON.parse(m.responseText);n(new r.h(e,t))}catch(a){i(r.r.networkError)}else try{var o=JSON.parse(m.responseText);if(o){var a=new r.r(o);if(a.isSessionExpiredError){if(s.dispatch(new r.K({reason:a.code})),!(m instanceof r.bh)){var u=new r.as;return s.dispatch(new r.bi({request:m,deferred:u,error:a})),u.promise}}else a.isSessionInvalidatedError&&s.dispatch(new r.K({reason:a.code}));i(a)}else i(r.r.requestFailed)}catch(a){i(r.r.requestFailed)}},s.on((function(e){e instanceof r.aq&&(e.requestId&&e.requestId!==u||(v=!0,m.abort()))})),m.send(p)}else i(r.r.xmlHttpRequestNotSupported)}))}},5122:function(e,t,n){var r;n.r(t),r=function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}var a=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return n(t,[{key:"addEventListener",value:function(e,t,n){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:n})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,i=n.length;r<i;r++)if(n[r].callback===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),n=0,r=t.length;n<r;n++){var i=t[n];try{i.callback.call(this,e)}catch(e){Promise.resolve().then((function(){throw e}))}i.options&&i.options.once&&this.removeEventListener(e.type,i.callback)}return!e.defaultPrevented}}}]),t}(),u=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(c,t);var u=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=r(e);if(t){var s=r(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)}(this,n)}}(c);function c(){var t;return e(this,c),(t=u.call(this)).listeners||a.call(o(t)),Object.defineProperty(o(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(o(t),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(o(t),"reason",{value:void 0,writable:!0,configurable:!0}),t}return n(c,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),s(r(c.prototype),"dispatchEvent",this).call(this,e)}}]),c}(a),c=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new u,writable:!0,configurable:!0})}return n(t,[{key:"abort",value:function(e){var t;try{t=new Event("abort")}catch(e){"undefined"!=typeof document?document.createEvent?(t=document.createEvent("Event")).initEvent("abort",!1,!1):(t=document.createEventObject()).type="abort":t={type:"abort",bubbles:!1,cancelable:!1}}var n=e;if(void 0===n)if("undefined"==typeof document)(n=new Error("This operation was aborted")).name="AbortError";else try{n=new DOMException("signal is aborted without reason")}catch(e){(n=new Error("This operation was aborted")).name="AbortError"}this.signal.reason=n,this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();function l(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(c.prototype[Symbol.toStringTag]="AbortController",u.prototype[Symbol.toStringTag]="AbortSignal"),function(e){if(l(e))if(e.fetch){var t=function(e){"function"==typeof e&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,i=void 0===r?n.Request:r,o=t.AbortController,s=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,a=void 0!==s&&s;if(!l({fetch:n,Request:i,AbortController:o,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:a}))return{fetch:n,Request:u};var u=i;(u&&!u.prototype.hasOwnProperty("signal")||a)&&((u=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);var r=new i(e,t);return n&&Object.defineProperty(r,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),r}).prototype=i.prototype);var c=n;return{fetch:function(e,t){var n=u&&u.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(n){var r;try{r=new DOMException("Aborted","AbortError")}catch(e){(r=new Error("Aborted")).name="AbortError"}if(n.aborted)return Promise.reject(r);var i=new Promise((function(e,t){n.addEventListener("abort",(function(){return t(r)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([i,c(e,t)])}return c(e,t)},Request:u}}(e),n=t.fetch,r=t.Request;e.fetch=n,e.Request=r,Object.defineProperty(e,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:c}),Object.defineProperty(e,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:u})}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill")}("undefined"!=typeof self?self:global)},"function"==typeof define&&define.amd?define(r):r()},8777:function(e,t,n){n.d(t,{$:function(){return bt},A:function(){return Fr},B:function(){return Ln},C:function(){return Nn},D:function(){return _e},F:function(){return jn},H:function(){return Hr},I:function(){return Pr},J:function(){return cn},K:function(){return W},L:function(){return T},M:function(){return jr},N:function(){return fn},P:function(){return ve},Q:function(){return A},S:function(){return kn},T:function(){return q},U:function(){return xn},V:function(){return K},W:function(){return vt},X:function(){return ot},Y:function(){return Nt},Z:function(){return St},_:function(){return Tt},a:function(){return ln},a0:function(){return wt},a1:function(){return un},a2:function(){return R},a3:function(){return jt},a4:function(){return D},a5:function(){return Ut},a6:function(){return Pt},a7:function(){return Rt},a8:function(){return $},a9:function(){return hn},aA:function(){return ii},aB:function(){return P},aC:function(){return d},aD:function(){return ai},aa:function(){return z},ab:function(){return si},ac:function(){return De},ad:function(){return Ue},ae:function(){return Le},af:function(){return Pe},ag:function(){return s},ah:function(){return y},ai:function(){return _},aj:function(){return G},ak:function(){return Tn},al:function(){return Gr},am:function(){return Wr},an:function(){return Kr},ao:function(){return Qr},ap:function(){return Te},aq:function(){return wn},ar:function(){return Me},as:function(){return we},at:function(){return xe},au:function(){return En},av:function(){return me},aw:function(){return Kt},ax:function(){return An},ay:function(){return u},az:function(){return a},b:function(){return dn},c:function(){return pn},d:function(){return Zr},e:function(){return Yr},f:function(){return mn},g:function(){return Br},h:function(){return gn},i:function(){return yn},j:function(){return bn},k:function(){return _n},l:function(){return vn},m:function(){return zr},n:function(){return Dr},o:function(){return fi},p:function(){return Rn},q:function(){return di},r:function(){return qr},s:function(){return Hn},t:function(){return ei},u:function(){return Xr},v:function(){return Lr},x:function(){return In}});var r,i,o=n(9851),s=function(){function e(e,t,n){var r,i;this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this._requireAuth=!1,this._iid=e,this.plainUrl=t.url,this.width=t.width,this.height=t.height,this.realWidth=null!==(r=t.real_width)&&void 0!==r?r:t.width,this.realHeight=null!==(i=t.real_height)&&void 0!==i?i:t.height,this._requireAuth=n}return e.payloadify=function(e){return(0,o.e)((0,o.u)({url:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}))},Object.defineProperty(e.prototype,"url",{get:function(){var e=o.V.of(this._iid).sessionManager;return this._requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),e}(),a=function(e){function t(t){var n=e.call(this)||this;if(n.method=o.A.POST,n.path="".concat(o.a9),n.params=(0,o.e)({file:t.file,channel_url:t.channelUrl}),t.thumbnailSizes)for(var r=0;r<t.thumbnailSizes.length;r++){var i=t.thumbnailSizes[r],s=i.maxWidth,a=i.maxHeight;n.params["thumbnail".concat(r+1)]="".concat(s,",").concat(a)}return n.requestId=t.requestId,n}return(0,o.c)(t,e),t}(o.f),u=function(e){function t(t,n){var r,i,o,a,u=this;return(u=e.call(this,t,n)||this).url=n.url,u.fileSize=null!==(r=n.file_size)&&void 0!==r?r:0,u.thumbnails=null!==(o=null===(i=n.thumbnails)||void 0===i?void 0:i.map((function(e){return new s(t,e,!1)})))&&void 0!==o?o:[],u.requireAuth=null!==(a=n.require_auth)&&void 0!==a&&a,u}return(0,o.c)(t,e),t}(o.h),c=function(e){function t(t,n){var r,i,s,a=this;return(a=e.call(this,t)||this).replyCount=0,a.lastRepliedAt=0,a.updatedAt=0,a.replyCount=null!==(r=n.reply_count)&&void 0!==r?r:0,a.mostRepliedUsers=n.most_replies&&(0,o.O)("object",n.most_replies)?n.most_replies.map((function(e){return new o.U(a._iid,e)})):[],a.lastRepliedAt=null!==(i=n.last_replied_at)&&void 0!==i?i:0,a.updatedAt=null!==(s=n.updated_at)&&void 0!==s?s:0,a}return(0,o.c)(t,e),t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{reply_count:t.replyCount,most_replies:Array.isArray(t.mostRepliedUsers)?t.mostRepliedUsers.map((function(e){return o.U.payloadify(e)})):[],last_replied_at:t.lastRepliedAt,updated_at:t.updatedAt})))},t}(o.aa);(i=r||(r={})).ADD="add",i.DELETE="delete";var l,d=function(e){this.messageId=0,this.operation=null,this.updatedAt=0;var t=(0,o.a)("string",e.msg_id)?parseInt(e.msg_id):e.msg_id,n=e.user_id,i=e.operation?e.operation.toLowerCase():null,s=e.reaction,a=e.updated_at;t&&(0,o.a)("string",n)&&(0,o.a)("string",i)&&(0,o.T)(r,i)&&(0,o.a)("string",s)&&s&&(0,o.a)("number",a)&&(this.messageId=t,this.userId=n,this.key=s,this.operation=i,this.updatedAt=a)},h=function(){function e(e){var t,n,r,i=e.key,s=null!==(r=(0,o.o)([],(0,o.p)(e.user_ids),!1))&&void 0!==r?r:[],a=e.updated_at;(0,o.a)("string",i)&&i&&(0,o.O)("string",s)&&s.length>0&&(0,o.a)("number",a)&&(this.key=i,this.userIds=s,this.updatedAt=a);var u={};try{for(var c=(0,o.s)(this.userIds),l=c.next();!l.done;l=c.next())u[l.value]=this.updatedAt}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}this._version=u}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.userIds.length},enumerable:!1,configurable:!0}),e.payloadify=function(e){return(0,o.e)((0,o.u)({key:e.key,user_ids:e.userIds,updated_at:e.updatedAt}))},e.prototype.applyEvent=function(e){if(e.key===this.key&&this.updatedAt<=e.updatedAt){if(!this._version[e.userId]||this._version[e.userId]<=e.updatedAt){var t=this.userIds.indexOf(e.userId);switch(e.operation){case r.ADD:t<0&&this.userIds.push(e.userId);break;case r.DELETE:t>=0&&this.userIds.splice(t,1)}this._version[e.userId]=e.updatedAt}this.updatedAt=Math.max(this.updatedAt,e.updatedAt)}},e}(),f=function(){function e(e){this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=e.url,e.secure_url&&(this.secureUrl=e.secure_url),e.type&&(this.type=e.type),e.width&&(this.width=e.width),e.height&&(this.height=e.height),e.alt&&(this.alt=e.alt)}return e.payloadify=function(e){var t,n;return(0,o.e)((0,o.u)({url:e.url,secure_url:e.secureUrl,type:e.type,width:null!==(t=e.width)&&void 0!==t?t:0,height:null!==(n=e.height)&&void 0!==n?n:0,alt:e.alt}))},e}(),p=function(){function e(e){this.title=null,this.url=null,this.description=null,this.defaultImage=null,e["og:title"]&&(this.title=e["og:title"]),e["og:url"]&&(this.url=e["og:url"]),e["og:description"]&&(this.description=e["og:description"]),e["og:image"]&&(this.defaultImage=new f(e["og:image"]))}return e.payloadify=function(e){return(0,o.e)((0,o.u)({"og:title":e.title,"og:url":e.url,"og:description":e.description,"og:image":e.defaultImage?f.payloadify(e.defaultImage):null}))},e}(),_=function(){function e(e){var t,n;this.volume=0,this.name=null!==(t=e.name)&&void 0!==t?t:"default",this.volume=null!==(n=e.volume)&&void 0!==n?n:1}return e.prototype.serialize=function(){return{name:this.name,volume:this.volume}},e.payloadify=function(e){return(0,o.e)((0,o.u)({name:e.name,volume:e.volume}))},e}();!function(e){e.GOOD="good",e.BAD="bad"}(l||(l={}));var v,m=function(){function e(e){this.id=e.id,this.rating=e.rating,this.comment=e.comment}return e.parseFeedbackStatusFromPayload=function(e){return null==e?"NOT_APPLICABLE":null!=e.id&&null!=e.rating?"SUBMITTED":"NO_FEEDBACK"},e.payloadify=function(e){return(0,o.e)((0,o.u)({id:e.id,rating:e.rating,comment:e.comment}))},e}(),g=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).isBlockedByMe=!1,i.role=(0,o.T)(o.a3,n.role)?n.role:o.a3.NONE,i.isBlockedByMe=null!==(r=n.is_blocked_by_me)&&void 0!==r&&r,i}return(0,o.c)(t,e),t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{role:t.role,is_blocked_by_me:t.isBlockedByMe})))},t}(o.U),y=function(){function e(e){this.key=e.key,this.value=(0,o.O)("string",e.value)?(0,o.o)([],(0,o.p)(e.value),!1):[]}return e.payloadify=function(e){var t;return(0,o.e)((0,o.u)({key:e.key,value:null!==(t=e.value)&&void 0!==t?t:[]}))},e}(),b=function(e){switch(e){case o.ac.BASE:return"";case o.ac.USER:return"MESG";case o.ac.FILE:return"FILE";case o.ac.ADMIN:return"ADMM"}},E=function(e){function t(t,n){var r,i,s,a,u,c,l,d,h,f,p=this;(p=e.call(this,t)||this).channelType=o.C.BASE,p.messageType=o.ac.BASE,p.mentionType=null,p.mentionedUsers=null,p.mentionedUserIds=null,p.metaArrays=[],p.extendedMessage={},p.createdAt=0,p.updatedAt=0,p.channelUrl=n.channel_url,p.channelType=(0,o.T)(o.C,n.channel_type)?n.channel_type:o.C.GROUP,n.channel&&(n.channel.channel_url&&(p.channelUrl=n.channel.channel_url),n.channel.channel_type&&(p.channelType=n.channel.channel_type)),p.data=null!==(r=n.data)&&void 0!==r?r:"",p.customType=null!==(i=n.custom_type)&&void 0!==i?i:"",p.mentionType=(0,o.T)(o.ae,n.mention_type)?n.mention_type:null,p.mentionedUsers=n.mentioned_users?n.mentioned_users.map((function(e){return new o.U(p._iid,e)})):null,p.mentionedUserIds=null!==(s=n.mentioned_user_ids)&&void 0!==s?s:null,p.mentionedUsers&&!p.mentionedUserIds&&(p.mentionedUserIds=p.mentionedUsers.map((function(e){return e.userId}))),p.mentionedMessageTemplate=null!==(a=n.mentioned_message_template)&&void 0!==a?a:"";var _=null!==(u=n.metaarray)&&void 0!==u?u:{},v=null!==(c=n.metaarray_key_order)&&void 0!==c?c:Object.keys(_).sort((function(e,t){return e.localeCompare(t)}));p.metaArrays=[];for(var m=0;m<v.length;m++){var g=v[m];p.metaArrays.push(new y({key:g,value:_[g]||[]}))}return n.sorted_metaarray&&(p.metaArrays=n.sorted_metaarray.map((function(e){return new y(e)}))),p.extendedMessage=null!==(l=n.extended_message)&&void 0!==l?l:{},p.extendedMessagePayload=n.extended_message_payload,p.createdAt=null!==(h=null!==(d=n.created_at)&&void 0!==d?d:n.ts)&&void 0!==h?h:0,p.updatedAt=null!==(f=n.updated_at)&&void 0!==f?f:0,p}return(0,o.c)(t,e),t.payloadify=function(t){var n,r;return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{channel_url:t.channelUrl,channel_type:t.channelType,type:b(t.messageType),data:t.data,custom_type:t.customType,mention_type:t.mentionType,mentioned_user_ids:t.mentionedUserIds,mentioned_users:null===(n=t.mentionedUsers)||void 0===n?void 0:n.map((function(e){return o.U.payloadify(e)})),mentioned_message_template:t.mentionedMessageTemplate,sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map((function(e){return y.payloadify(e)})),extended_message:t.extendedMessage,extended_message_payload:t.extendedMessagePayload,created_at:t.createdAt,updated_at:t.updatedAt})))},t.prototype.isIdentical=function(e){return!0},t.prototype.isEqual=function(e){return(0,o.ab)(this,e)},t.prototype.isUserMessage=function(){return this.messageType===o.ac.USER},t.prototype.isFileMessage=function(){return this.messageType===o.ac.FILE&&!Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isMultipleFilesMessage=function(){return this.messageType===o.ac.FILE&&Object.prototype.hasOwnProperty.call(this,"fileInfoList")},t.prototype.isAdminMessage=function(){return this.messageType===o.ac.ADMIN},t.prototype.hasForm=function(){var e,t;return!!(null===(t=null===(e=this.extendedMessagePayload)||void 0===e?void 0:e.forms)||void 0===t?void 0:t[0])},t.prototype.serialize=function(){return(0,o.ad)(this)},t.prototype.getMetaArraysByKeys=function(e){return this.metaArrays.filter((function(t){return e.includes(t.key)}))},t}(o.aa),w=function(){function e(e,t,n){this.messageId=e,this.formKey=t,this.fields=n}return Object.defineProperty(e.prototype,"isSubmitted",{get:function(){return void 0!==this.answers&&Object.keys(this.answers).length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSubmittable",{get:function(){return this.fields.every((function(e){return e.isSubmittable}))},enumerable:!1,configurable:!0}),e.prototype.getFieldAnswer=function(e){var t;return null===(t=this.answers)||void 0===t?void 0:t[e]},e.parseFormKeyFromPayload=function(e){return(0,o.g)((0,o.g)({},e),{form_key:e.key,fields:e.fields.map((function(e){return C.parseFieldKeyFromPayload(e)}))})},e.payloadify=function(e){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e),{fields:e.fields.map((function(e){return C.payloadify(e)}))})))},e}(),C=function(){function e(e){this.fieldKey=e.field_key,this.inputType=e.input_type,this.title=e.title,this.required=e.required,this.regex=e.regex,this.placeholder=e.placeholder}return e.prototype.isValid=function(e){var t,n;try{return null===(n=null===(t=this.regex)||void 0===t?void 0:t.test(e))||void 0===n||n}catch(e){return!0}},Object.defineProperty(e.prototype,"isSubmittable",{get:function(){return!(null!=this.temporaryAnswer&&!this.isValid(this.temporaryAnswer)||this.required&&null==this.temporaryAnswer)},enumerable:!1,configurable:!0}),e.parseFieldKeyFromPayload=function(e){return(0,o.g)((0,o.g)({},e),{field_key:e.key})},e.payloadify=function(e){return(0,o.e)((0,o.u)(e))},e}();!function(e){e.Text="text",e.Phone="phone",e.Email="email",e.Password="password"}(v||(v={}));var T,A,S=function(e){function t(t){var n=e.call(this)||this;return n.method=o.A.POST,n.path=(0,o.af)(t.channelUrl,t.messageId),n.params=(0,o.e)({forms:t.forms}),n}return(0,o.c)(t,e),t}(o.f),I=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.rating,a=t.comment,u=e.call(this)||this;return u.method=o.A.POST,u.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/feedbacks"),u.params={rating:s,comment:a},u}return(0,o.c)(t,e),t}(o.f),N=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.feedback=new m(n),r}return(0,o.c)(t,e),t}(o.h),k=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.feedbackId,a=t.rating,u=t.comment,c=e.call(this)||this;return c.method=o.A.PUT,c.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/feedbacks/").concat(s),c.params={rating:a,comment:u},c}return(0,o.c)(t,e),t}(o.f),x=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.feedback=new m(n),r}return(0,o.c)(t,e),t}(o.h),O=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.feedbackId,a=e.call(this)||this;return a.method=o.A.DELETE,a.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/feedbacks/").concat(s),a}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){var r=e.call(this,t,n)||this;return r.feedback=new m(n),r}),e)}(o.h),function(e){e.PENDING="pending",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled"}(T||(T={})),function(e){e.PENDING="pending",e.IN_QUEUE="in_queue",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled",e.REMOVED="removed"}(A||(A={}));var M,R=function(e){function t(t,n){var r,i,o,s,a,u,l,d,f,v,g,y=this;return(y=e.call(this,t,n)||this).parentMessage=null,y.silent=!1,y.isOperatorMessage=!1,y.threadInfo=null,y.reactions=[],y.appleCriticalAlertOptions=null,y.scheduledInfo=null,y.suggestedReplies=null,y.myFeedback=null,y.myFeedbackStatus="NOT_APPLICABLE",y.forms=null,y._isContinuousMessages=!1,y._scheduledStatus=null,y.messageId=null!==(i=null!==(r=n.msg_id)&&void 0!==r?r:n.message_id)&&void 0!==i?i:0,y.parentMessageId=null!==(o="string"==typeof n.parent_message_id?parseInt(n.parent_message_id):n.parent_message_id)&&void 0!==o?o:0,y.threadInfo=n.thread_info?new c(y._iid,n.thread_info):null,y.reactions=n.reactions?n.reactions.map((function(e){return new h(e)})):[],y.ogMetaData=n.og_tag?new p(n.og_tag):null,y.silent=null!==(s=n.silent)&&void 0!==s&&s,y.isOperatorMessage=null!==(a=n.is_op_msg)&&void 0!==a&&a,y.appleCriticalAlertOptions=n.apple_critical_alert_options?new _(n.apple_critical_alert_options):null,"number"==typeof n.scheduled_message_id&&"number"==typeof n.scheduled_at&&n.scheduled_status&&(y.scheduledInfo={scheduledMessageId:n.scheduled_message_id,scheduledAt:n.scheduled_at},y._scheduledStatus=n.scheduled_status),y._isContinuousMessages=null!==(u=n.is_continuous_messages)&&void 0!==u&&u,y.myFeedback=(null===(l=n.feedback)||void 0===l?void 0:l.id)?new m(n.feedback):null,y.myFeedbackStatus=m.parseFeedbackStatusFromPayload(n.feedback),y.suggestedReplies=null!==(f=null===(d=n.extended_message_payload)||void 0===d?void 0:d.suggested_replies)&&void 0!==f?f:null,y.forms=(null===(g=null===(v=n.extended_message_payload)||void 0===v?void 0:v.forms)||void 0===g?void 0:g[0])?n.extended_message_payload.forms.map((function(e){var t=w.parseFormKeyFromPayload(e);return new w(y.messageId,t.form_key,t.fields.map((function(e){return new C(e)})))})):null,y}return(0,o.c)(t,e),t.payloadify=function(t){var n,r,i,s,a;return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{message_id:t.messageId,parent_message_id:t.parentMessageId,thread_info:t.threadInfo?c.payloadify(t.threadInfo):null,reactions:t.reactions.map((function(e){return h.payloadify(e)})),og_tag:t.ogMetaData?p.payloadify(t.ogMetaData):null,silent:t.silent,is_op_msg:t.isOperatorMessage,apple_critical_alert_options:t.appleCriticalAlertOptions?_.payloadify(t.appleCriticalAlertOptions):null,scheduled_message_id:null===(n=t.scheduledInfo)||void 0===n?void 0:n.scheduledMessageId,scheduled_at:null===(r=t.scheduledInfo)||void 0===r?void 0:r.scheduledAt,scheduled_status:t._scheduledStatus,feedback:t.myFeedback?m.payloadify(t.myFeedback):null,suggested_replies:null===(i=t.extendedMessagePayload)||void 0===i?void 0:i.suggested_replies,forms:null!=(null===(a=null===(s=t.extendedMessagePayload)||void 0===s?void 0:s.forms)||void 0===a?void 0:a[0])?t.extendedMessagePayload.forms.map((function(e){return w.payloadify(e)})):null})))},t._getParentMessageInfoPayload=function(e){return(0,o.e)((0,o.u)({type:b(e.messageType),ts:e.createdAt,user:e.sender?g.payloadify(e.sender):null,message:e.message,file:{url:e.plainUrl,name:e.name,type:e.type,require_auth:e.requireAuth}}))},t.prototype.isIdentical=function(e){return this.messageId===e.messageId},t.prototype.applyThreadInfoUpdateEvent=function(e){return this.messageId===e.targetMessageId&&(this.threadInfo=e.threadInfo),!1},t.prototype.applyReactionEvent=function(e){if(this.messageId===e.messageId){for(var t=!1,n=0;n<this.reactions.length;n++)if(this.reactions[n].key===e.key){this.reactions[n].applyEvent(e),this.reactions[n].isEmpty&&this.reactions.splice(n,1),t=!0;break}t||"add"!==e.operation||this.reactions.push(new h(h.payloadify({key:e.key,userIds:[e.userId],updatedAt:e.updatedAt})))}},t.prototype.applyParentMessage=function(e){if(!this.parentMessage)return this.parentMessage=e,!0;if(this.parentMessageId===e.messageId){var t=this.parentMessage.updatedAt;if(e.updatedAt>=t)return this.parentMessage=e,!0}return!1},t.prototype.submitForm=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return t=o.V.of(this._iid),n=t.requestQueue,r=t.sdkState,i=t.logger,e.formId&&e.answers?(i.warn("The submitForm method with formId and answers is deprecated. Use submitForm({ form: Form }) instead."),s=new S({userId:r.userId,channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,forms:[{form_key:e.formId,data:e.answers}]}),[4,n.send(s)]):[3,2];case 1:case 3:return l.sent(),[2];case 2:if(!(a=e.form).isSubmittable||a.isSubmitted)throw new o.r({code:o.ah.INVALID_PARAMETER,message:a.isSubmitted?"The given form is already submitted.":"The given form is not submittable."});if(a.messageId!=this.messageId)throw new o.r({code:o.ah.INVALID_PARAMETER,message:"This form does not belong to the message."});return u=a.fields.reduce((function(e,t){return e[t.fieldKey]=t.temporaryAnswer,e}),{}),c=new S({userId:r.userId,channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,forms:[{form_key:a.formKey,data:u}]}),[4,n.send(c)]}}))}))},t.prototype.submitFeedback=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return t=o.V.of(this._iid),n=t.requestQueue,r=t.dispatcher,i=new I({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,rating:e.rating,comment:e.comment}),[4,n.send(i)];case 1:return s=u.sent(),a=s.as(N),this.myFeedback=a.feedback,this.myFeedbackStatus="SUBMITTED",r.dispatch(new o.ai({messages:[this],source:o.Z.EVENT_MESSAGE_FEEDBACK_ADDED})),[2]}}))}))},t.prototype.updateFeedback=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return t=o.V.of(this._iid),n=t.requestQueue,r=t.dispatcher,i=new k({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:e.id,rating:e.rating,comment:e.comment}),[4,n.send(i)];case 1:return s=u.sent(),a=s.as(x),this.myFeedback=a.feedback,this.myFeedbackStatus="SUBMITTED",r.dispatch(new o.ai({messages:[this],source:o.Z.EVENT_MESSAGE_FEEDBACK_UPDATED})),[2]}}))}))},t.prototype.deleteFeedback=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return t=o.V.of(this._iid),n=t.requestQueue,r=t.dispatcher,i=new O({channelUrl:this.channelUrl,channelType:this.channelType,messageId:this.messageId,feedbackId:e}),[4,n.send(i)];case 1:return s.sent(),this.myFeedback=null,this.myFeedbackStatus="NO_FEEDBACK",r.dispatch(new o.ai({messages:[this],source:o.Z.EVENT_MESSAGE_FEEDBACK_DELETED})),[2]}}))}))},t}(E),D=function(e){function t(t,n){var r,i,s,a,u=this;if((u=e.call(this,t,n)||this).reqId="",u.replyToChannel=!1,u.errorCode=0,u.sender=n.user?new g(u._iid,n.user):n.sender_id,u.reqId=null!==(i=null!==(r=n.req_id)&&void 0!==r?r:n.request_id)&&void 0!==i?i:"",u.replyToChannel=null!==(s=n.is_reply_to_channel)&&void 0!==s&&s,n.request_state&&(0,o.T)(o.aj,n.request_state)&&(u.sendingStatus=n.request_state),!u.sendingStatus)if(u.messageId>0)u.sendingStatus=o.aj.SUCCEEDED;else if(u.scheduledInfo)switch(n.scheduled_status&&(u._scheduledStatus=n.scheduled_status),n.scheduled_status){case A.SENT:case A.IN_QUEUE:u.sendingStatus=o.aj.SUCCEEDED;break;case A.PENDING:u.sendingStatus=o.aj.SCHEDULED;break;case A.FAILED:case A.REMOVED:u.sendingStatus=o.aj.FAILED;break;case A.CANCELED:u.sendingStatus=o.aj.CANCELED}else u.sendingStatus=o.aj.PENDING;return u.errorCode=null!==(a=n.error_code)&&void 0!==a?a:0,u}return(0,o.c)(t,e),t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{user:g.payloadify(t.sender),req_id:t.reqId,is_reply_to_channel:t.replyToChannel,request_state:t.sendingStatus,error_code:t.errorCode})))},Object.defineProperty(t.prototype,"isResendable",{get:function(){return(this.sendingStatus===o.aj.FAILED||this.sendingStatus===o.aj.CANCELED)&&(0,o.ak)(this.errorCode)},enumerable:!1,configurable:!0}),t.prototype.isIdentical=function(e){return this.messageId>0&&e.messageId>0?this.messageId===e.messageId:this.reqId===e.reqId},t}(R),U={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:o.al.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},L=function(e){return(0,o.a)("number",e.prevResultSize)&&(0,o.a)("number",e.nextResultSize)&&(0,o.a)("boolean",e.isInclusive)&&(0,o.a)("boolean",e.reverse)&&(0,o.a)("string",e.messageTypeFilter)&&(0,o.T)(o.al,e.messageTypeFilter)&&(0,o.O)("string",e.customTypesFilter,!0)&&(0,o.O)("string",e.senderUserIdsFilter,!0)&&(0,o.a)("boolean",e.includeMetaArray)&&(0,o.a)("boolean",e.includeReactions)&&(0,o.a)("boolean",e.includeParentMessageInfo)},P=function(e){function t(t,n){var r,i,s,a,u=this;if((u=e.call(this,t,n)||this).translations={},u.message=null!==(r=n.message)&&void 0!==r?r:"",u.messageType=o.ac.ADMIN,u.translations=null!==(i=n.translations)&&void 0!==i?i:{},n.parent_message_info){var c=n.parent_message_info;u.parentMessage=W(t,(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},c),{message_id:u.parentMessageId,channel_url:u.channelUrl,channel_type:u.channelType,file:c.file,url:null===(s=c.file)||void 0===s?void 0:s.url,require_auth:null===(a=c.file)||void 0===a?void 0:a.require_auth}))))}return u}return(0,o.c)(t,e),t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},U),t),(0,o.t)(this.messageId>0&&(0,o.a)("number",e)&&L(n)).throw(o.r.invalidParameters),[4,si.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t}(R),F=function(){function e(e){var t,n;this.detail={},this.type=null!==(t=e.type)&&void 0!==t?t:"",this.vendor=null!==(n=e.vendor)&&void 0!==n?n:"",e.detail&&(0,o.a)("object",e.detail)&&!Array.isArray(e.detail)&&(this.detail=e.detail)}return e.payloadify=function(e){return(0,o.e)((0,o.u)({type:e.type,vendor:e.vendor,detail:e.detail}))},e}(),j=function(){function e(e){this.status=e.status,e.original_message_info&&(this.originalMessageInfo={createdAt:e.original_message_info.ts,messageId:e.original_message_info.id})}return e.payloadify=function(e){return(0,o.e)({status:e.status,original_message_info:e.originalMessageInfo?{id:e.originalMessageInfo.messageId,ts:e.originalMessageInfo.createdAt}:void 0})},e}(),q=function(e){function t(t,n){var r,i,s,a,u,c,l,d=this;if((d=e.call(this,t,n)||this).message="",d.messageParams=null,d.translations={},d.translationTargetLanguages=[],d.messageSurvivalSeconds=-1,d.plugins=[],d._poll=null,d.message=n.message,d.messageType=o.ac.USER,d.translations=null!==(s=n.translations)&&void 0!==s?s:{},d.translationTargetLanguages=null!==(a=n.target_langs)&&void 0!==a?a:[],0===Object.keys(d.translations).length&&d.translationTargetLanguages.length>0)try{for(var h=(0,o.s)(d.translationTargetLanguages),f=h.next();!f.done;f=h.next()){var p=f.value;d.translations[p]=""}}catch(e){r={error:e}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}if(d.messageSurvivalSeconds=null!==(u=n.message_survival_seconds)&&void 0!==u?u:-1,d.plugins=n.plugins?n.plugins.map((function(e){return new F(e)})):[],d._poll=n.poll?new o.am(d._iid,n.poll):null,n.parent_message_info){var _=n.parent_message_info;d.parentMessage=W(t,(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},_),{created_at:_.ts,message_id:d.parentMessageId,channel_url:d.channelUrl,channel_type:d.channelType,file:_.file,url:null===(c=_.file)||void 0===c?void 0:c.url,require_auth:null===(l=_.file)||void 0===l?void 0:l.require_auth}))))}return n.review_info&&(d.messageReviewInfo=new j(n.review_info)),d}return(0,o.c)(t,e),t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,message_survival_seconds:t.messageSurvivalSeconds,plugins:t.plugins.map((function(e){return F.payloadify(e)})),poll:t._poll?o.am.payloadify(t._poll):null,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null,review_info:t.messageReviewInfo?j.payloadify(t.messageReviewInfo):void 0})))},t.prototype.getThreadedMessagesByTimestamp=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},U),t),(0,o.t)(this.messageId>0&&(0,o.a)("number",e)&&L(n)).throw(o.r.invalidParameters),[4,si.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.applyPoll=function(e){return!(this._poll&&this._poll.id===e.id&&this._poll.updatedAt>e.updatedAt||(this._poll=e,0))},Object.defineProperty(t.prototype,"poll",{get:function(){return this._poll},enumerable:!1,configurable:!0}),t}(D),H=function(e){function t(t,n){var r,i,a,u,c,l=this;return(l=e.call(this,t)||this).plainUrl="",l.fileName=null,l.mimeType=null,l.fileSize=0,l.thumbnails=[],l._requireAuth=!1,l.plainUrl=null!==(r=n.url)&&void 0!==r?r:"",l.fileName=null!==(i=n.file_name)&&void 0!==i?i:null,l.mimeType=null!==(a=n.file_type)&&void 0!==a?a:null,l.fileSize=null!==(u=n.file_size)&&void 0!==u?u:0,l._requireAuth=null!==(c=n.require_auth)&&void 0!==c&&c,l.thumbnails=n.thumbnails?n.thumbnails.map((function(e){var t;return new s(l._iid,"string"==typeof e?{url:e,width:0,height:0}:(0,o.g)((0,o.g)({},e),{url:(null!==(t=e.url)&&void 0!==t?t:"").split("auth=")[0]}),l._requireAuth)})):[],l}return(0,o.c)(t,e),t.payloadify=function(e){var t;return(0,o.e)((0,o.u)({url:e.plainUrl,file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:null===(t=e.thumbnails)||void 0===t?void 0:t.map((function(e){var t;return{url:(null!==(t=e.plainUrl)&&void 0!==t?t:"").split("auth=")[0],width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight}})),require_auth:e._requireAuth}))},Object.defineProperty(t.prototype,"url",{get:function(){var e=o.V.of(this._iid).sessionManager;return this._requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t}(o.aa),V=function(e){function t(t,n){var r,i,s,a,u,c=this;if((c=e.call(this,t,n)||this).messageParams=null,c.fileInfoList=[],c.messageSurvivalSeconds=-1,c.messageType=o.ac.FILE,c.fileInfoList=null!==(i=null===(r=n.files)||void 0===r?void 0:r.map((function(e){return new H(t,e)})))&&void 0!==i?i:[],c.messageSurvivalSeconds=null!==(s=n.message_survival_seconds)&&void 0!==s?s:-1,n.parent_message_info){var l=n.parent_message_info;c.parentMessage=W(t,(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},l),{created_at:l.ts,message_id:c.parentMessageId,channel_url:c.channelUrl,channel_type:c.channelType,file:l.file,url:null===(a=l.file)||void 0===a?void 0:a.url,require_auth:null===(u=l.file)||void 0===u?void 0:u.require_auth}))))}return c}return(0,o.c)(t,e),t.prototype.getThreadedMessagesByTimestamp=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},U),t),(0,o.t)(this.messageId>0&&(0,o.a)("number",e)&&L(n)).throw(o.r.invalidParameters),[4,si.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{files:t.fileInfoList&&t.fileInfoList&&Array.isArray(t.fileInfoList)?t.fileInfoList.map((function(e){return H.payloadify(e)})):null,message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},t._isMultipleFilesMessagePayload=function(e){var t=e.files;return Array.isArray(t)&&t.length>=2},t._isMultipleFilesMessageSerializedData=function(e){var t=e.fileInfoList;return Array.isArray(t)},t}(D);!function(e){e.SENT="SENT",e.READ="READ"}(M||(M={}));var B,z=function(e){function t(t,n){var r,i=this;if((i=e.call(this,t,n)||this).notificationData=null,i.notificationId=n.notification_message_id,i.messageType=o.ac.ADMIN,i.messageStatus=null!==(r=n.message_status)&&void 0!==r?r:M.SENT,0===i.extendedMessage.sub_type)try{var s=JSON.parse(i.extendedMessage.sub_data),a=s.label,u=s.tags,c=void 0===u?[]:u,l=s.template_key,d=s.template_variables;i.notificationData={label:a,tags:c,templateKey:l,templateVariables:d}}catch(t){}return i}return(0,o.c)(t,e),t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{notification_message_id:t.notificationId,message_status:t.messageStatus})))},t.prototype.isIdentical=function(e){return this.notificationId===e.notificationId},t}(E),G=function(e){if(e.notificationId)return z.payloadify(e);switch(e.messageType){case o.ac.USER:return q.payloadify(e);case o.ac.FILE:return e.fileInfoList?V.payloadify(e):K.payloadify(e);case o.ac.ADMIN:return P.payloadify(e);default:throw o.r.unknown}},W=function(e,t){if(t.notification_message_id)return new z(e,t);switch(t.type){case"MESG":return new q(e,t);case"FILE":return V._isMultipleFilesMessagePayload(t)?new V(e,t):new K(e,t);case"ADMM":case"BRDM":return new P(e,t);default:return null}},K=function(e){function t(t,n){var r,i,a,u,c,l,d,h,f,p,_,v,m,g,y=this;(y=e.call(this,t,n)||this).messageParams=null,y.plainUrl="",y.requireAuth=!1,y.thumbnails=[],y.messageSurvivalSeconds=-1,y.messageType=o.ac.FILE;var b=n.file;if(y.plainUrl=(null!==(i=null!==(r=null==b?void 0:b.url)&&void 0!==r?r:n.url)&&void 0!==i?i:"").split("?auth=")[0],y.name=null!==(u=null!==(a=null==b?void 0:b.name)&&void 0!==a?a:n.name)&&void 0!==u?u:"File",y.size=null!==(l=null!==(c=null==b?void 0:b.size)&&void 0!==c?c:n.size)&&void 0!==l?l:0,y.data=null!==(h=null!==(d=null==b?void 0:b.data)&&void 0!==d?d:n.custom)&&void 0!==h?h:"",y.type=b?null!==(f=b.type)&&void 0!==f?f:"":null!==(p=n.type)&&void 0!==p?p:"",y.requireAuth=null!==(_=n.require_auth)&&void 0!==_&&_,y.thumbnails=n.thumbnails?n.thumbnails.map((function(e){var t;return new s(y._iid,"string"==typeof e?{url:e,width:0,height:0}:(0,o.g)((0,o.g)({},e),{url:(null!==(t=e.url)&&void 0!==t?t:"").split("auth=")[0]}),y.requireAuth)})):[],y.messageSurvivalSeconds=null!==(v=n.message_survival_seconds)&&void 0!==v?v:-1,n.parent_message_info){var E=n.parent_message_info;y.parentMessage=W(t,(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},E),{created_at:E.ts,message_id:y.parentMessageId,channel_url:y.channelUrl,channel_type:y.channelType,file:E.file,url:null===(m=E.file)||void 0===m?void 0:m.url,require_auth:null===(g=E.file)||void 0===g?void 0:g.require_auth}))))}return y}return(0,o.c)(t,e),t.payloadify=function(t){var n;return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{url:t.plainUrl,require_auth:t.requireAuth,file:{name:t.name,size:t.size,type:t.type,data:t.data},thumbnails:null===(n=t.thumbnails)||void 0===n?void 0:n.map((function(e){return{url:e.plainUrl,width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight}})),message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:t.parentMessage?e._getParentMessageInfoPayload.call(this,t.parentMessage):null})))},Object.defineProperty(t.prototype,"url",{get:function(){var e=o.V.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),t.prototype.getThreadedMessagesByTimestamp=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},U),t),(0,o.t)(this.messageId>0&&(0,o.a)("number",e)&&L(n)).throw(o.r.invalidParameters),[4,si.of(this._iid).getThreadedMessagesByTimestamp(this,e,n)];case 1:return[2,r.sent()]}}))}))},t}(D),Q=function(e){function t(t,n){var r=n.file,i=n.fileUrl,o=n.fileName,s=n.fileSize,a=n.mimeType,u=n.thumbnailSizes,c=n._uploadedMetaData,l=e.call(this,t)||this;return l._plainUrl=i,l.file=r,l.fileName=o,l.fileSize=s,l.mimeType=a,l.thumbnailSizes=u,l._uploadedMetaData=c,l}return(0,o.c)(t,e),t.getPlainUrl=function(e){return e instanceof t?e._plainUrl:e.fileUrl},Object.defineProperty(t.prototype,"fileUrl",{get:function(){var e;if(this._plainUrl&&(null===(e=this._uploadedMetaData)||void 0===e?void 0:e.requireAuth)){var t=o.V.of(this._iid).sessionManager;return"".concat(this._plainUrl,"?auth=").concat(t.ekey)}return this._plainUrl},set:function(e){this._plainUrl=e},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{file:this.file,fileUrl:this._plainUrl,fileName:this.fileName,fileSize:this.fileSize,mimeType:this.mimeType,thumbnailSizes:this.thumbnailSizes,_uploadedMetaData:this._uploadedMetaData}},t}(o.aa),Z=function(e){function t(t){var n,r,i,s=[];return t.mentionType===o.ae.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"FILE",ackRequired:!0,payload:(0,o.e)((0,o.u)({channel_url:t.channelUrl,files:t.files?J(t.files):null,url:t.url,name:null!==(n=t.fileName)&&void 0!==n?n:"",type:null!==(r=t.mimeType)&&void 0!==r?r:"",size:null!==(i=t.fileSize)&&void 0!==i?i:0,custom:t.data,custom_type:t.customType,thumbnails:t.thumbnailSizes,require_auth:t.requireAuth,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:s,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==o.an.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions?_.payloadify(t.appleCriticalAlertOptions):null,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,pin_message:t.isPinnedMessage}))})||this}return(0,o.c)(t,e),t}(o.ao),Y=function(e){function t(t){var n,r,i=this;i=e.call(this)||this;var a=[];return t.mentionType===o.ae.USERS&&(t.mentionedUserIds?a=t.mentionedUserIds:t.mentionedUsers&&(a=t.mentionedUsers.map((function(e){return e.userId})))),i.method=o.A.POST,i.path="".concat((0,o.ag)(t.channelType),"/").concat(encodeURIComponent(t.channelUrl),"/messages"),i.params=(0,o.e)((0,o.u)({message_type:o.ac.FILE,user_id:t.userId,files:t.files?J(t.files):null,url:t.fileUrl,mention_type:t.mentionType,mentioned_user_ids:a,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,data:t.data,custom_type:t.customType,thumbnails:null===(n=t.thumbnailSizes)||void 0===n?void 0:n.map((function(e){return s.payloadify(e)})),require_auth:t.requireAuth,sorted_metaarray:null===(r=t.metaArrays)||void 0===r?void 0:r.map((function(e){return y.payloadify(e)})),push_option:t.pushNotificationDeliveryOption,parent_message_id:t.parentMessageId?t.parentMessageId:null,apple_critical_alert_options:t.appleCriticalAlertOptions?_.payloadify(t.appleCriticalAlertOptions):null,reply_to_channel:t.isReplyToChannel,req_id:t.reqId,pin_message:t.isPinnedMessage})),i}return(0,o.c)(t,e),t}(o.f),$=function(e){function t(t,n,r){var i,s,a,u,c=this;(c=e.call(this,t,"FILE",r)||this).message=r.files&&r.files.length>=2?new V(t,r):new K(t,r);var l=o.V.of(t).sdkState;return c.isMentioned=(0,o.ap)(c.message.mentionType,null!==(a=null!==(i=c.message.mentionedUserIds)&&void 0!==i?i:null===(s=c.message.mentionedUsers)||void 0===s?void 0:s.map((function(e){return e.userId})))&&void 0!==a?a:[],l.userId),c.forceUpdateLastMessage=null!==(u=r.force_update_last_message)&&void 0!==u&&u,c}return(0,o.c)(t,e),t}(o.W),X=function(e){function t(t,n){var r,i,s,a,u=this;(u=e.call(this,t,n)||this).message=n.files&&n.files.length>=2?new V(t,n):new K(t,n);var c=o.V.of(t).sdkState;return u.isMentioned=(0,o.ap)(u.message.mentionType,null!==(s=null!==(r=u.message.mentionedUserIds)&&void 0!==r?r:null===(i=u.message.mentionedUsers)||void 0===i?void 0:i.map((function(e){return e.userId})))&&void 0!==s?s:[],c.userId),u.forceUpdateLastMessage=null!==(a=n.force_update_last_message)&&void 0!==a&&a,u}return(0,o.c)(t,e),t}(o.h);function J(e){return e.map((function(e){var t,n;return(0,o.e)((0,o.u)({url:Q.getPlainUrl(e),file_name:e.fileName,file_type:e.mimeType,file_size:e.fileSize,thumbnails:null===(t=e.thumbnailSizes)||void 0===t?void 0:t.map((function(e){return s.payloadify(e)})),require_auth:null===(n=e._uploadedMetaData)||void 0===n?void 0:n.requireAuth}))}))}!function(e){e[e.PENDING=0]="PENDING",e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.SENDING=3]="SENDING",e[e.FAILED=4]="FAILED"}(B||(B={}));var ee,te=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,s=t.onlineDetector,a=t.cacheContext,u=this;this._queueMap=new Map,this._iid=e,this._sdkState=n,this._requestQueue=i,this._cacheContext=a,this._dispatcher=r,this._dispatcher.on((function(e){e instanceof o.B&&(u._connectionState=e.stateType)})),this._onlineDetector=s}return Object.defineProperty(e.prototype,"_shouldSendThroughWebSocket",{get:function(){return this._connectionState===o.D.CONNECTED||this._connectionState===o.D.CONNECTING||this._connectionState===o.D.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype._sendFileMessage=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return n=this._createSendFileMessageRequestParams(e,t),this._shouldSendThroughWebSocket?(r=new Z(n),[4,this._requestQueue.send(r)]):[3,2];case 1:return[2,i.sent().as($).message];case 2:return r=new Y((0,o.g)((0,o.g)({},n),{userId:this._sdkState.userId})),[4,this._requestQueue.send(r)];case 3:return[2,i.sent().as(X).message]}}))}))},e.prototype._createSendFileMessageRequestParams=function(e,t){var n=(0,o.g)((0,o.g)({},t.params),{channelUrl:e.url,channelType:e.channelType,reqId:t.requestId,url:""});if(t.multipleFileUploadInfo){var r=t.params;n.files=r.fileInfoList}else r=t.params,n.url=r.fileUrl,n.requireAuth=r.requireAuth;return n},e.prototype._resolveMessageQueue=function(e){var t;return(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,l,d,h,f,p,_;return(0,o.b)(this,(function(v){switch(v.label){case 0:if(!(n=this._queueMap.get(e.url)))return[3,21];if(n.isResolving)return[3,20];n.isResolving=!0,r=[],i=!0,v.label=1;case 1:v.trys.push([1,15,16,17]),s=(0,o.s)(n.messageQueue),a=s.next(),v.label=2;case 2:if(a.done)return[3,14];switch((u=a.value).state){case B.PENDING:case B.UPLOADING:return[3,3];case B.UPLOADED:return[3,4];case B.FAILED:return[3,12]}return[3,13];case 3:return i=!1,r.push(u),[3,13];case 4:if(!i)return[3,10];v.label=5;case 5:return v.trys.push([5,8,,9]),u.state=B.SENDING,[4,this._sendFileMessage(e,u)];case 6:return c=v.sent(),u.deferred.resolve(c),[4,(0,o.ar)(100)];case 7:return v.sent(),[3,9];case 8:return l=v.sent(),u.deferred.reject(l),[3,9];case 9:return[3,11];case 10:r.push(u),v.label=11;case 11:return[3,13];case 12:return d=null!==(t=u.error)&&void 0!==t?t:o.r.unknown,u.deferred.reject(d.code===o.ah.REQUEST_CANCELED?o.r.fileUploadCanceled:d),[3,13];case 13:return a=s.next(),[3,2];case 14:return[3,17];case 15:return h=v.sent(),p={error:h},[3,17];case 16:try{a&&!a.done&&(_=s.return)&&_.call(s)}finally{if(p)throw p.error}return[7];case 17:return f=n.isResolveRequestPending,n.messageQueue=r,n.isResolving=!1,n.isResolveRequestPending=!1,f?[4,this._resolveMessageQueue(e)]:[3,19];case 18:v.sent(),v.label=19;case 19:return[3,21];case 20:n.isResolveRequestPending=!0,v.label=21;case 21:return[2]}}))}))},e.prototype._uploadNextPendingItem=function(e){var t;return(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,l,d,h;return(0,o.b)(this,(function(f){switch(f.label){case 0:return(n=this._queueMap.get(e.url))&&(r=n.messageQueue.find((function(e){return e.state===B.PENDING})))?r.multipleFileUploadInfo?(i=r.multipleFileUploadInfo,s=i.uploadIndex,a=i.uploadCount,u=i.requestHandler,h=r.params,c=h.fileInfoList[s],!(0,o.i)(c.file)||(null===(t=c._uploadedMetaData)||void 0===t?void 0:t.isUploaded)?[3,2]:[4,this._tryUploadNextItemAndUpdateItemState(e,n,r)]):[3,4]:[3,9];case 1:return f.sent(),[3,3];case 2:r.state=s<a-1?B.PENDING:B.UPLOADED,f.label=3;case 3:return l=h.fileInfoList[s],d=r.multipleFileUploadInfo.uploadIndex++,r.multipleFileUploadInfo.isCopy||null==u||u._triggerOnFileUploaded(r.requestId,d,l,r.error),[3,7];case 4:return h=r.params,(0,o.i)(h.file)?[4,this._tryUploadNextItemAndUpdateItemState(e,n,r)]:[3,6];case 5:return f.sent(),[3,7];case 6:h.thumbnailSizes=[],r.state=B.UPLOADED,f.label=7;case 7:return this._uploadNextPendingItem(e),[4,this._resolveMessageQueue(e)];case 8:f.sent(),f.label=9;case 9:return[2]}}))}))},e.prototype._tryUploadNextItemAndUpdateItemState=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return[4,this._onlineDetector.isOnline()];case 1:if(r=l.sent(),!o.V.of(this._iid).sessionManager.currentUser||!r)return n.error=o.r.connectionRequired,n.state=B.FAILED,[2];if(!(t.uploadQueue.length<6))return[3,9];n.state=B.UPLOADING,t.uploadQueue.push(n),l.label=2;case 2:return l.trys.push([2,7,,8]),n.multipleFileUploadInfo?(i=n.multipleFileUploadInfo,s=i.uploadIndex,a=i.uploadCount,u=n.params,[4,this._uploadNextFileForMultipleFilesItemAndUpdateParams(e,n,u)]):[3,4];case 3:return l.sent(),n.state=s<a-1?B.PENDING:B.UPLOADED,[3,6];case 4:return u=n.params,[4,this._uploadNextFileForSingleFileItemAndUpdateParams(e,n,u)];case 5:l.sent(),n.state=B.UPLOADED,l.label=6;case 6:return[3,8];case 7:switch((c=l.sent()).code){case o.ah.REQUEST_FAILED:n.error=new o.r({code:o.ah.NETWORK_ERROR,message:"Failed to upload a file."});break;case o.ah.REQUEST_CANCELED:n.error=o.r.fileUploadCanceled;break;default:n.error=c}return n.state=B.FAILED,[3,8];case 8:this._dequeueUploadItem(t,n),l.label=9;case 9:return[2]}}))}))},e.prototype._dequeueUploadItem=function(e,t){var n=e.uploadQueue.findIndex((function(e){return e.requestId===t.requestId}));n>=0&&e.uploadQueue.splice(n,1)},e.prototype._uploadNextFileForSingleFileItemAndUpdateParams=function(e,t,n){var r,i,s;return(0,o._)(this,void 0,void 0,(function(){var c,l,d,h,f,p,_,v,m,g;return(0,o.b)(this,(function(o){switch(o.label){case 0:return c=new a({file:n.file,channelUrl:e.url,thumbnailSizes:n.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(c)];case 1:return l=o.sent(),d=l.as(u),h=d.url,f=d.fileSize,p=void 0===f?n.fileSize:f,_=d.thumbnails,v=void 0===_?[]:_,m=d.requireAuth,g=void 0!==m&&m,n.fileName=null!==(r=n.fileName)&&void 0!==r?r:n.file.name,n.mimeType=null!==(i=n.mimeType)&&void 0!==i?i:n.file.type,n.fileSize=null!==(s=n.fileSize)&&void 0!==s?s:n.file.size,n.fileUrl=h,n.fileSize=p,n.thumbnailSizes=null==v?void 0:v.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),n.requireAuth=g,[2]}}))}))},e.prototype._uploadNextFileForMultipleFilesItemAndUpdateParams=function(e,t,n){var r,i,s;return(0,o._)(this,void 0,void 0,(function(){var c,l,d,h,f,p,_,v,m,g,y;return(0,o.b)(this,(function(b){switch(b.label){case 0:return c=t.multipleFileUploadInfo.uploadIndex,l=n.fileInfoList[c],d=new a({file:l.file,channelUrl:e.url,thumbnailSizes:l.thumbnailSizes,requestId:t.requestId}),[4,this._requestQueue.send(d)];case 1:return h=b.sent(),f=h.as(u),p=f.url,_=f.fileSize,v=void 0===_?l.fileSize:_,m=f.thumbnails,g=f.requireAuth,y=void 0!==g&&g,l.fileName=null!==(r=l.fileName)&&void 0!==r?r:l.file.name,l.mimeType=null!==(i=l.mimeType)&&void 0!==i?i:l.file.type,l.fileSize=null!==(s=l.fileSize)&&void 0!==s?s:l.file.size,l.file=void 0,l.fileUrl=p,l.fileSize=v,l.thumbnailSizes=null==m?void 0:m.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),l._uploadedMetaData=(0,o.g)((0,o.g)({},l._uploadedMetaData),{requireAuth:y,isUploaded:!0}),l instanceof Q||(n.fileInfoList[c]=new Q(this._iid,l)),[2]}}))}))},e.prototype.request=function(e,t,n,r){return void 0===r&&(r={}),(0,o._)(this,void 0,void 0,(function(){var i,s,a,u,c;return(0,o.b)(this,(function(l){return this._queueMap.has(e.url)||(i={messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1},this._queueMap.set(e.url,i)),s=this._queueMap.get(e.url),a=new o.as,u={requestId:t,params:n,state:B.PENDING,deferred:a},function(e){return"fileInfoList"in e}(n)&&(c=(0,o.g)({uploadIndex:0,uploadCount:n.fileInfoList.length},r),u.multipleFileUploadInfo=c),s.messageQueue.push(u),this._uploadNextPendingItem(e),[2,a.promise]}))}))},e.prototype.cancel=function(e,t){var n,r,i=this._queueMap.get(e.url);if(i){var s=t?[i.messageQueue.find((function(e){return e.requestId===t}))]:(0,o.o)([],(0,o.p)(i.messageQueue),!1);try{for(var a=(0,o.s)(s),u=a.next();!u.done;u=a.next()){var c=u.value;if(c)switch(c.state){case B.PENDING:if(c.state=B.FAILED,c.error=o.r.requestCanceled,c.multipleFileUploadInfo&&!c.multipleFileUploadInfo.isCopy){var l=c.multipleFileUploadInfo,d=l.uploadIndex,h=l.requestHandler,f=c.params.fileInfoList[d];null==h||h._triggerOnFileUploaded(c.requestId,d,f,o.r.fileUploadCanceled)}this._resolveMessageQueue(e);break;case B.UPLOADING:this._requestQueue.cancel(c.requestId),this._dispatcher.dispatch(new o.aq({requestId:c.requestId}))}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}else t&&(this._requestQueue.cancel(t),this._dispatcher.dispatch(new o.aq({requestId:t})))},e}(),ne={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:o.al.ALL,customTypesFilter:void 0,senderUserIdsFilter:void 0,replyType:o.at.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},re=function(e){return(0,o.a)("number",e.prevResultSize)&&(0,o.a)("number",e.nextResultSize)&&(0,o.a)("boolean",e.isInclusive)&&(0,o.a)("boolean",e.reverse)&&(0,o.a)("string",e.messageTypeFilter)&&(0,o.T)(o.al,e.messageTypeFilter)&&(0,o.O)("string",e.customTypesFilter,!0)&&(0,o.O)("string",e.senderUserIdsFilter,!0)&&(0,o.T)(o.at,e.replyType)&&(0,o.a)("boolean",e.includeMetaArray)&&(0,o.a)("boolean",e.includeReactions)&&(0,o.a)("boolean",e.includeParentMessageInfo)&&(0,o.a)("boolean",e.includeThreadInfo)&&(0,o.a)("boolean",e.showSubchannelMessagesOnly)},ie={replyType:o.at.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},oe=function(e){return(0,o.T)(o.at,e.replyType)&&(0,o.a)("boolean",e.includeReactions)&&(0,o.a)("boolean",e.includeMetaArray)&&(0,o.a)("boolean",e.includeParentMessageInfo)&&(0,o.a)("boolean",e.includeThreadInfo)},se=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.includeMetaArray,a=t.includeReactions,u=t.includeThreadInfo,c=t.includeParentMessageInfo,l=e.call(this)||this;return l.method=o.A.GET,l.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i)),l.params={is_sdk:!0,with_sorted_meta_array:s,include_reactions:a,include_thread_info:u,include_parent_message_info:c,include_poll_details:!0},l}return(0,o.c)(t,e),t}(o.f),ae=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?W(t,(0,o.g)({},n)):null,r}return(0,o.c)(t,e),t}(o.h),ue=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,s=t.token,a=t.prevResultSize,u=t.nextResultSize,c=t.isInclusive,l=t.reverse,d=t.messageTypeFilter,h=t.customTypesFilter,f=t.senderUserIdsFilter,p=t.replyType,_=t.includeMetaArray,v=t.includeReactions,m=t.parentMessageId,g=t.includeThreadInfo,y=t.includeParentMessageInfo,b=t.showSubchannelMessagesOnly,E=t.checkingHasNext,w=t.checkingContinuousMessages,C=e.call(this)||this;return C.method=o.A.GET,C.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages"),C.params=(0,o.e)((0,o.u)({is_sdk:!0,prev_limit:a,next_limit:u,include:c,reverse:l,message_ts:i,message_id:s,message_type:null!=d?d:null,custom_types:h,sender_ids:f,include_reply_type:p,with_sorted_meta_array:_,include_reactions:v,parent_message_id:m,include_thread_info:g,include_parent_message_info:y,show_subchannel_message_only:b,include_poll_details:!0,checking_has_next:E,checking_continuous_messages:w})),C}return(0,o.c)(t,e),t}(o.f),ce=function(e){function t(t,n){var r=e.call(this,t,n)||this;return void 0!==n.is_continuous_messages&&(r.isContinuousMessages=n.is_continuous_messages),void 0!==n.has_next&&(r.hasNext=n.has_next),r.messages=n.messages.map((function(e){return W(t,e)})),r}return(0,o.c)(t,e),t}(o.h),le=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,s=t.token,a=t.replyType,u=t.includeMetaArray,c=t.includeReactions,l=t.includeThreadInfo,d=t.includeParentMessageInfo,h=e.call(this)||this;return h.method=o.A.GET,h.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/changelogs"),h.params={change_ts:i,token:s,with_sorted_meta_array:u,include_reactions:c,include_thread_info:l,include_reply_type:a,include_parent_message_info:d,include_poll_details:!0},h}return(0,o.c)(t,e),t}(o.f),de=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedMessages=n.updated.map((function(e){return W(t,e)})),r.deletedMessagesInfo=n.deleted.map((function(e){return{messageId:e.message_id,deletedAt:e.deleted_at}})),r.hasMore=n.has_more,r.nextToken=n.next,r}return(0,o.c)(t,e),t}(o.h),he=function(e){function t(t){var n=t.channelUrl,r=t.scheduledMessageId,i=e.call(this)||this;return i.method=o.A.GET,i.path="".concat(o.au,"/").concat(encodeURIComponent(n),"/scheduled_messages/").concat(encodeURIComponent(r)),i.params={},i}return(0,o.c)(t,e),t}(o.f),fe=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=n?W(t,(0,o.g)({},n)):null,r}return(0,o.c)(t,e),t}(o.h);!function(e){e.MUTED="muted",e.BANNED="banned"}(ee||(ee={}));var pe=function(){function e(e){var t,n,r,i;this.restrictionType=null,(0,o.T)(ee,e.restriction_type)&&(this.restrictionType=e.restriction_type),this.description=null!==(t=e.description)&&void 0!==t?t:null,this.endAt=null!==(r=null!==(n=e.end_at)&&void 0!==n?n:e.muted_end_at)&&void 0!==r?r:-1,this.remainingDuration=null!==(i=e.remaining_duration)&&void 0!==i?i:-1}return e.payloadify=function(e){return(0,o.e)((0,o.u)({restriction_type:e.restrictionType,description:e.description,end_at:e.endAt,remaining_duration:e.remainingDuration}))},e}(),_e=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.restrictionInfo=new pe(n),r}return(0,o.c)(t,e),t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),pe.payloadify(t.restrictionInfo))))},t}(o.U),ve=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).isMuted=!1,i.isMuted=null!==(r=n.is_muted)&&void 0!==r&&r,i}return(0,o.c)(t,e),t}(o.U),me=function(){function e(){this._onPending=o.av,this._onFailed=o.av,this._onSucceeded=o.av}return e.prototype._trigger=function(e){switch(null==e?void 0:e.sendingStatus){case o.aj.PENDING:0===e.errorCode&&this._onPending(e);break;case o.aj.SCHEDULED:case o.aj.SUCCEEDED:this._onSucceeded(e)}},e.prototype._triggerFailed=function(e,t){switch(null==t?void 0:t.sendingStatus){case o.aj.FAILED:case o.aj.CANCELED:this._onFailed(e,t.scheduledInfo?null:t)}},e.prototype.onPending=function(e){return this._onPending=e,this},e.prototype.onFailed=function(e){return this._onFailed=e,this},e.prototype.onSucceeded=function(e){return this._onSucceeded=e,this},e}(),ge={data:void 0,customType:void 0,mentionType:o.ae.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,mentionedMessageTemplate:void 0,metaArrays:void 0,parentMessageId:void 0,isReplyToChannel:!1,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0,isPinnedMessage:!1},ye=function(e){return(0,o.a)("string",e.data,!0)&&(0,o.a)("string",e.customType,!0)&&(0,o.T)(o.ae,e.mentionType)&&(0,o.O)("string",e.mentionedUserIds,!0)&&(0,o.O)(o.U,e.mentionedUsers,!0)&&(0,o.a)("string",e.mentionedMessageTemplate,!0)&&(0,o.O)(y,e.metaArrays,!0)&&(0,o.a)("number",e.parentMessageId,!0)&&(0,o.a)("boolean",e.isReplyToChannel)&&(0,o.T)(o.an,e.pushNotificationDeliveryOption,!0)&&(0,o.a)(_,e.appleCriticalAlertOptions,!0)&&(0,o.a)("boolean",e.isPinnedMessage,!0)},be=function(e){return{isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,pollId:e.pollId}},Ee=(0,o.g)((0,o.g)({},ge),{message:"",translationTargetLanguages:void 0,pollId:void 0});function we(e){var t,n,r;return null!==(t=e.messageParams)&&void 0!==t?t:(0,o.u)((0,o.g)((0,o.g)({},e),{mentionType:e.mentionType,mentionedUserIds:null!==(n=e.mentionedUserIds)&&void 0!==n?n:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return e.userId})),translationTargetLanguages:Object.keys(e.translations),pushNotificationDeliveryOption:o.an.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1}))}var Ce,Te=function(e){var t;return(0,o.e)((0,o.u)({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,mentionedMessageTemplate:e.mentionedMessageTemplate,metaArrays:e.metaArrays,pollId:null===(t=e.poll)||void 0===t?void 0:t.id,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,message:e.message,translationTargetLanguages:Object.keys(e.translations)}))},Ae=function(e){return ye(e)&&(0,o.a)("string",e.message)&&(0,o.O)("string",e.translationTargetLanguages,!0)&&(0,o.a)("number",e.pollId,!0)};!function(e){e.FILE="file",e.BLOB="blob",e.BLOB_LIKE_OBJECT="blobLikeObject",e.URL="url"}(Ce||(Ce={}));var Se=function(e){return"undefined"!=typeof window&&"Blob"in window&&"undefined"!=typeof Blob&&e instanceof Blob},Ie=function(e){return e===Ce.BLOB||e===Ce.FILE},Ne=function(e){return{file:e.file,fileKey:e.fileKey,fileType:e.fileType,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption}},ke=(0,o.g)((0,o.g)({},ge),{file:void 0,fileKey:void 0,fileUrl:void 0,fileName:void 0,fileType:void 0,fileSize:void 0,mimeType:void 0,thumbnailSizes:void 0,requireAuth:!1});function xe(e){var t,n,r,i;return null!==(t=e.messageParams)&&void 0!==t?t:(0,o.u)((0,o.g)((0,o.g)({},e),{fileUrl:e.plainUrl,fileName:e.name,fileSize:e.size,mimeType:e.type,mentionType:e.mentionType,mentionedUserIds:null!==(n=e.mentionedUserIds)&&void 0!==n?n:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return e.userId})),pushNotificationDeliveryOption:o.an.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:null===(i=e.thumbnails)||void 0===i?void 0:i.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),requireAuth:e.requireAuth,isPinnedMessage:!1}))}var Oe,Me=function(e,t){var n;return e.messageParams?(!e.url&&(0,o.i)(t)&&(e.messageParams.file=t),e.messageParams):(0,o.e)((0,o.u)({data:e.data,customType:e.customType,mentionType:e.mentionType,mentionedUsers:e.mentionedUsers,mentionedUserIds:e.mentionedUserIds,metaArrays:e.metaArrays,parentMessageId:e.parentMessageId,appleCriticalAlertOptions:e.appleCriticalAlertOptions,file:t,fileUrl:e.url,fileName:e.name,fileSize:e.size,mimeType:e.type,thumbnailSizes:null===(n=e.thumbnails)||void 0===n?void 0:n.map((function(e){return{maxWidth:e.width,maxHeight:e.height}}))}))},Re=function(e){return ye(e)&&((0,o.i)(e.file)||(0,o.a)("string",e.fileUrl))&&(0,o.a)("string",e.fileName,!0)&&(0,o.a)("string",e.mimeType,!0)&&(0,o.a)("number",e.fileSize,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every((function(e){return(0,o.a)("object",e)&&e.maxWidth>0&&e.maxHeight>0})))},De={data:void 0,customType:void 0,mentionType:o.ae.USERS,mentionedUserIds:void 0,mentionedUsers:void 0,mentionedMessageTemplate:void 0,metaArrays:void 0,pushNotificationDeliveryOption:void 0,appleCriticalAlertOptions:void 0},Ue=function(e){return(0,o.a)("string",e.data,!0)&&(0,o.a)("string",e.customType,!0)&&(0,o.T)(o.ae,e.mentionType)&&(0,o.O)("string",e.mentionedUserIds,!0)&&(0,o.O)(o.U,e.mentionedUsers,!0)&&(0,o.a)("string",e.mentionedMessageTemplate,!0)&&(0,o.O)(y,e.metaArrays,!0)&&(0,o.T)(o.an,e.pushNotificationDeliveryOption,!0)&&(0,o.a)(_,e.appleCriticalAlertOptions,!0)},Le=(0,o.g)((0,o.g)({},De),{message:void 0,translationTargetLanguages:void 0,pollId:void 0}),Pe=function(e){return Ue(e)&&(0,o.a)("string",e.message,!0)&&(0,o.O)("string",e.translationTargetLanguages,!0)&&(0,o.a)("number",e.pollId,!0)},Fe=(0,o.g)({},De),je=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.token,s=t.limit,a=e.call(this)||this;return a.method=o.A.GET,a.path="".concat((0,o.ag)(r),"/").concat(encodeURIComponent(n),"/operators"),a.params={token:i,limit:s},a}return(0,o.c)(t,e),t}(o.f),qe=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.operators=n.operators.map((function(e){return new o.U(t,e)})),r.token=n.next,r}return(0,o.c)(t,e),t}(o.h),He=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return this._validate()?this._isLoading?[3,3]:(e=[],this._hasNext?(this._isLoading=!0,t=o.V.of(this._iid).requestQueue,n=new je((0,o.g)((0,o.g)({},this),{channelUrl:this.channelUrl,token:this._token})),[4,t.send(n)]):[3,2]):[3,5];case 1:return r=u.sent(),i=r.as(qe),s=i.operators,a=i.token,this._token=a,this._hasNext=!!a,this._isLoading=!1,[2,s];case 2:return[2,e];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aw),Ve=function(e){function t(t,n,r,i){var s,a,u,c,l,d,h,f,p,_,v=this;return(v=e.call(this,t,n,r,i)||this).reverse=!1,v.messageTypeFilter=o.al.ALL,v.customTypesFilter=null,v.senderUserIdsFilter=null,v.replyType=o.at.NONE,v.includeMetaArray=!1,v.includeReactions=!1,v.includeParentMessageInfo=!1,v.includeThreadInfo=!1,v.showSubchannelMessagesOnly=!1,v._edge=Number.MAX_SAFE_INTEGER,v.reverse=null!==(s=i.reverse)&&void 0!==s&&s,v.messageTypeFilter=null!==(a=i.messageTypeFilter)&&void 0!==a?a:o.al.ALL,v.customTypesFilter=null!==(u=i.customTypesFilter)&&void 0!==u?u:null,v.senderUserIdsFilter=null!==(c=i.senderUserIdsFilter)&&void 0!==c?c:null,v.replyType=null!==(l=i.replyType)&&void 0!==l?l:o.at.NONE,v.includeMetaArray=null!==(d=i.includeMetaArray)&&void 0!==d&&d,v.includeReactions=null!==(h=i.includeReactions)&&void 0!==h&&h,v.includeParentMessageInfo=null!==(f=i.includeParentMessageInfo)&&void 0!==f&&f,v.includeThreadInfo=null!==(p=i.includeThreadInfo)&&void 0!==p&&p,v.showSubchannelMessagesOnly=null!==(_=i.showSubchannelMessagesOnly)&&void 0!==_&&_,v}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,o.a)("boolean",this.reverse)&&(0,o.T)(o.al,this.messageTypeFilter)&&(0,o.T)(o.at,this.replyType)&&(0,o.O)("string",this.customTypesFilter,!0)&&(0,o.O)("string",this.senderUserIdsFilter,!0)&&(0,o.a)("boolean",this.includeMetaArray)&&(0,o.a)("boolean",this.includeReactions)&&(0,o.a)("boolean",this.includeParentMessageInfo)&&(0,o.a)("boolean",this.includeThreadInfo)&&(0,o.a)("boolean",this.showSubchannelMessagesOnly)},t.prototype.load=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,si.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,(0,o.u)({prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly}))]):[3,2]:[3,5];case 1:return e=t.sent(),this._edge=Math.min.apply(Math,(0,o.o)([Number.MAX_SAFE_INTEGER],(0,o.p)(e.map((function(e){return e.createdAt}))),!1)),this._hasNext=e.length>=this.limit,this._isLoading=!1,[2,e];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aw),Be=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.limit,a=t.token;return(n=e.call(this)||this).method=o.A.GET,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={limit:s,token:a},n}return(0,o.c)(t,e),t}(o.f),ze=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.mutedUsers=[];var i=n.next,o=n.muted_list;return r.token=i,o&&o.length>0&&(r.mutedUsers=o.map((function(e){return new _e(t,e)}))),r}return(0,o.c)(t,e),t}(o.h),Ge=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return(0,o.c)(t,e),t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=o.V.of(this._iid).requestQueue,t=new Be((0,o.g)((0,o.g)({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=a.sent(),r=n.as(ze),i=r.mutedUsers,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aw),We=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.limit,a=t.token;return(n=e.call(this)||this).method=o.A.GET,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=(0,o.e)({limit:s,token:a}),n}return(0,o.c)(t,e),t}(o.f),Ke=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.bannedUsers=[];var i=n.next,o=n.banned_list;return r.token=i,o&&o.length>0&&(r.bannedUsers=o.map((function(e){return new _e(t,e.user)}))),r}return(0,o.c)(t,e),t}(o.h),Qe=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i)||this}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=o.V.of(this._iid).requestQueue,t=new We((0,o.g)((0,o.g)({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=a.sent(),r=n.as(Ke),i=r.bannedUsers,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aw);!function(e){e.SPAM="spam",e.HARASSING="harassing",e.SUSPICIOUS="suspicious",e.INAPPROPRIATE="inappropriate"}(Oe||(Oe={}));var Ze=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.operatorUserIds;return(n=e.call(this)||this).method=o.A.POST,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:s},n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var Ye=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.operatorUserIds;return(n=e.call(this)||this).method=o.A.DELETE,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/operators"),n.params={operator_ids:s},n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){return e.call(this,t,n)||this}),e)}(o.h);var $e=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId;return(n=e.call(this)||this).method=o.A.GET,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/mute/").concat(s),n}return(0,o.c)(t,e),t}(o.f),Xe=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.isMuted=!1,r.startAt=0,r.endAt=0;var i=n.is_muted,o=n.start_at,s=n.end_at,a=n.remaining_duration,u=n.description;return r.isMuted=i,r.startAt=o,r.endAt=s,r.remainingDuration=a,r.description=u,r}return(0,o.c)(t,e),t}(o.h),Je=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.keys;return(n=e.call(this)||this).method=o.A.GET,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={keys:s,include_ts:!0},n}return(0,o.c)(t,e),t}(o.f),et=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.metadata,o=n.ts;return r.metadata=i,r.ts=o,r}return(0,o.c)(t,e),t}(o.h),tt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metadata;return(n=e.call(this)||this).method=o.A.POST,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:s,include_ts:!0},n}return(0,o.c)(t,e),t}(o.f),nt=function(e){function t(t,n){var r,i,o=this;return(o=e.call(this,t,n)||this).metaData=null!==(r=n.metadata)&&void 0!==r?r:{},o.ts=null!==(i=n.ts)&&void 0!==i?i:null,o}return(0,o.c)(t,e),t}(o.h),rt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metadata,a=t.upsert;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={metadata:s,include_ts:!0,upsert:null!=a&&a},n}return(0,o.c)(t,e),t}(o.f),it=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.metadata,o=n.ts;return r.metadata=i,r.ts=o,r}return(0,o.c)(t,e),t}(o.h),ot=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i}return(0,o.c)(t,e),t}(o.W),st=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.key;return(n=e.call(this)||this).method=o.A.DELETE,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metadata/").concat(s),n.params={include_ts:!0},n}return(0,o.c)(t,e),t}(o.f),at=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts;return r.ts=i,r}return(0,o.c)(t,e),t}(o.h),ut=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return(n=e.call(this)||this).method=o.A.DELETE,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metadata"),n.params={include_ts:!0},n}return(0,o.c)(t,e),t}(o.f),ct=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.ts;return r.ts=i,r}return(0,o.c)(t,e),t}(o.h),lt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.keys;return(n=e.call(this)||this).method=o.A.GET,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={keys:s},n}return(0,o.c)(t,e),t}(o.f),dt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return(0,o.c)(t,e),t}(o.h),ht=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metaCounter;return(n=e.call(this)||this).method=o.A.POST,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:s},n}return(0,o.c)(t,e),t}(o.f),ft=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return(0,o.c)(t,e),t}(o.h),pt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.metaCounter,a=t.upsert,u=void 0!==a&&a,c=t.mode,l=void 0===c?"set":c;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={metacounter:s,upsert:u,mode:l},n}return(0,o.c)(t,e),t}(o.f),_t=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaCounter=n,r}return(0,o.c)(t,e),t}(o.h),vt=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return r.data&&(i.created=r.data.created,i.updated=r.data.updated,i.deleted=r.data.deleted),i}return(0,o.c)(t,e),t}(o.W),mt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.key;return(n=e.call(this)||this).method=o.A.DELETE,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metacounter/").concat(s),n.params={},n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){return e.call(this,t,n)||this}),e)}(o.h);var gt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType;return(n=e.call(this)||this).method=o.A.DELETE,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/metacounter"),n.params={},n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var yt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId,a=t.seconds,u=t.description;return(n=e.call(this)||this).method=o.A.POST,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/mute"),n.params={user_id:s,seconds:a,description:u},n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(t,n){return e.call(this,t,n)||this}),e)}(o.h);var bt=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new _e(t,r.data),i}return(0,o.c)(t,e),t}(o.W),Et=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId;return(n=e.call(this)||this).method=o.A.DELETE,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/mute/").concat(encodeURIComponent(s)),n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var wt=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new _e(t,r.data),i}return(0,o.c)(t,e),t}(o.W),Ct=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId,a=t.seconds,u=t.description;return(n=e.call(this)||this).method=o.A.POST,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/ban"),n.params=(0,o.e)({user_id:s,seconds:a,description:u}),n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var Tt=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new _e(t,r.data),r.data.member_count&&(i.memberCount=r.data.member_count),r.data.joined_member_count&&(i.joinedMemberCount=r.data.joined_member_count),i}return(0,o.c)(t,e),t}(o.W),At=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.userId;return(n=e.call(this)||this).method=o.A.DELETE,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/ban/").concat(encodeURIComponent(s)),n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var St=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.user=new _e(t,r.data),i}return(0,o.c)(t,e),t}(o.W),It=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.freezing;return(n=e.call(this)||this).method=o.A.PUT,n.path="".concat((0,o.ag)(i),"/").concat(encodeURIComponent(r),"/freeze"),n.params={freeze:s},n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var Nt=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.freeze=r.data.freeze,i}return(0,o.c)(t,e),t}(o.W),kt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.category,a=t.userId,u=t.description;return(n=e.call(this)||this).method=o.A.POST,n.path="".concat((0,o.ax)(i),"/").concat(encodeURIComponent(r)),n.params={report_category:s,reporting_user_id:a,report_description:u},n}return(0,o.c)(t,e),t}(o.f),xt=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.category,a=t.userId,u=t.offendingUserId,c=t.description;return(n=e.call(this)||this).method=o.A.POST,n.path="".concat(o.ay,"/users/").concat(u),n.params={channel_url:r,channel_type:i===o.C.OPEN?"open_channels":"group_channels",report_category:s,reporting_user_id:a,report_description:c},n}return(0,o.c)(t,e),t}(o.f),Ot=function(e){function t(t){var n=this,r=t.channelUrl,i=t.channelType,s=t.category,a=t.userId,u=t.offendingUserId,c=t.messageId,l=t.description;return(n=e.call(this)||this).method=o.A.POST,n.path="".concat((0,o.ax)(i),"/").concat(encodeURIComponent(r),"/messages/").concat(c),n.params={report_category:s,reporting_user_id:a,report_description:l,offending_user_id:u},n}return(0,o.c)(t,e),t}(o.f),Mt=function(e){function t(t){var n=[];return t.mentionType===o.ae.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"MESG",ackRequired:!0,payload:(0,o.e)((0,o.u)({channel_url:t.channelUrl,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:n,mentioned_message_template:t.mentionedMessageTemplate,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==o.an.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId?t.parentMessageId:null,req_id:t.reqId,poll_id:t.pollId,pin_message:t.isPinnedMessage}))})||this}return(0,o.c)(t,e),t}(o.ao),Rt=function(e){function t(t,n,r){var i,s,a,u,c=this;(c=e.call(this,t,"MESG",r)||this).message=new q(t,r);var l=o.V.of(t).sdkState;return c.isMentioned=(0,o.ap)(c.message.mentionType,null!==(a=null!==(i=c.message.mentionedUserIds)&&void 0!==i?i:null===(s=c.message.mentionedUsers)||void 0===s?void 0:s.map((function(e){return e.userId})))&&void 0!==a?a:[],l.userId),c.forceUpdateLastMessage=null!==(u=r.force_update_last_message)&&void 0!==u&&u,c}return(0,o.c)(t,e),t}(o.W),Dt=function(e){function t(t){var n=null;return t.mentionType===o.ae.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"MEDI",ackRequired:!0,payload:(0,o.e)((0,o.u)({channel_url:t.channelUrl,msg_id:t.messageId,message:t.message,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:n,mentioned_message_template:t.mentionedMessageTemplate,apple_critical_alert_options:t.appleCriticalAlertOptions?_.payloadify(t.appleCriticalAlertOptions):null,poll_id:t.pollId}))})||this}return(0,o.c)(t,e),t}(o.ao),Ut=function(e){function t(t,n,r){var i,s,a,u,c,l=this;(l=e.call(this,t,"MEDI",r)||this).message=new q(t,r);var d=o.V.of(t).sdkState;return l.mentionCountChange=(0,o.az)({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(a=null===(s=r.old_values)||void 0===s?void 0:s.mentioned_user_ids)&&void 0!==a?a:[]},(0,o.u)({mentionType:l.message.mentionType,mentionedUserIds:null!==(u=l.message.mentionedUserIds)&&void 0!==u?u:null===(c=l.message.mentionedUsers)||void 0===c?void 0:c.map((function(e){return e.userId}))}),d.userId),l}return(0,o.c)(t,e),t}(o.W),Lt=function(e){function t(t){var n=null;return t.mentionType===o.ae.USERS&&(t.mentionedUserIds?n=t.mentionedUserIds:t.mentionedUsers&&(n=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"FEDI",ackRequired:!0,payload:(0,o.e)((0,o.u)({channel_url:t.channelUrl,msg_id:t.messageId,data:t.data,custom_type:t.customType,metaarray:t.metaArrayParams,mention_type:t.mentionType,mentioned_user_ids:n,apple_critical_alert_options:t.appleCriticalAlertOptions}))})||this}return(0,o.c)(t,e),t}(o.ao),Pt=function(e){function t(t,n,r){var i,s,a,u,c,l=this;(l=e.call(this,t,"FEDI",r)||this).message=new K(t,r);var d=o.V.of(t).sdkState;return l.mentionCountChange=(0,o.az)({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(a=null===(s=r.old_values)||void 0===s?void 0:s.mentioned_user_ids)&&void 0!==a?a:[]},(0,o.u)({mentionType:l.message.mentionType,mentionedUserIds:null!==(u=l.message.mentionedUserIds)&&void 0!==u?u:null===(c=l.message.mentionedUsers)||void 0===c?void 0:c.map((function(e){return e.userId}))}),d.userId),l}return(0,o.c)(t,e),t}(o.W),Ft=function(e){function t(t){var n=e.call(this)||this;return n.method=o.A.DELETE,n.path="".concat((0,o.ag)(t.channelType),"/").concat(t.channelUrl,"/messages/").concat(t.messageId),n}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var jt=function(e){function t(t,n,r){var i=e.call(this,t,"DELM",r)||this;return i.channelUrl=r.channel_url,i.channelType=r.channel_type,i.messageId=Number(r.msg_id),i}return(0,o.c)(t,e),t}(o.W),qt=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.reactionKey,a=e.call(this)||this;return a.method=o.A.POST,a.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),a.params={reaction:s},a}return(0,o.c)(t,e),t}(o.f),Ht=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new d(n),r}return(0,o.c)(t,e),t}(o.h),Vt=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.reactionKey,a=e.call(this)||this;return a.method=o.A.DELETE,a.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(i,"/reactions"),a.params={reaction:s},a}return(0,o.c)(t,e),t}(o.f),Bt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.reactionEvent=new d((0,o.g)({},n)),r}return(0,o.c)(t,e),t}(o.h),zt=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.translationTargetLanguages,a=e.call(this)||this;return a.method=o.A.POST,a.path="".concat((0,o.ag)(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i),"/translation"),a.params={target_langs:s},a}return(0,o.c)(t,e),t}(o.f),Gt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new q(t,n),r}return(0,o.c)(t,e),t}(o.h),Wt=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===o.ae.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var s=t.channelType,a=t.channelUrl;return r.method=o.A.POST,r.path="".concat((0,o.ag)(s),"/").concat(encodeURIComponent(a),"/scheduled_messages"),r.params=(0,o.e)((0,o.u)({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:o.aA.USER,message:t.message,custom_type:t.customType,data:t.data,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return y.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?_.payloadify(t.appleCriticalAlertOptions):null,target_langs:t.translationTargetLanguages,push_option:t.pushNotificationDeliveryOption})),r}return(0,o.c)(t,e),t}(o.f),Kt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new q(t,n),r}return(0,o.c)(t,e),t}(o.h),Qt=function(e){function t(t){var n,r=this;r=e.call(this)||this;var i=[];t.mentionType===o.ae.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId}))));var a=t.channelType,u=t.channelUrl;return r.method=o.A.POST,r.path="".concat((0,o.ag)(a),"/").concat(encodeURIComponent(u),"/scheduled_messages"),r.params=(0,o.u)({req_id:t.reqId,scheduled_at:t.scheduledAt,message_type:o.aA.FILE,url:t.fileUrl,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,thumbnails:t.thumbnailSizes?t.thumbnailSizes.map((function(e){return s.payloadify(e)})):[],custom_type:t.customType,data:t.data,require_auth:t.requireAuth,mention_type:t.mentionType,mentioned_user_ids:i,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return y.payloadify(e)})),apple_critical_alert_options:t.appleCriticalAlertOptions?_.payloadify(t.appleCriticalAlertOptions):null,push_option:t.pushNotificationDeliveryOption}),r}return(0,o.c)(t,e),t}(o.f),Zt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.message=new K(t,n),r}return(0,o.c)(t,e),t}(o.h),Yt=function(e){function t(t){var n=t.pollId,r=t.title,i=t.data,s=t.allowUserSuggestion,a=t.allowMultipleVotes,u=t.closeAt,c=e.call(this)||this;return c.method=o.A.PUT,c.path="".concat(o.aC,"/").concat(encodeURIComponent(n)),c.params={title:r,data:i,allow_user_suggestion:s,allow_multiple_votes:a,close_at:u},c}return(0,o.c)(t,e),t}(o.f),$t=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new o.am(t,n),r}return(0,o.c)(t,e),t}(o.h),Xt=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=o.A.DELETE,r.path="".concat(o.aC,"/").concat(encodeURIComponent(n)),r}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var Jt=function(e){function t(t){var n=t.pollId,r=e.call(this)||this;return r.method=o.A.PUT,r.path="".concat(o.aC,"/").concat(encodeURIComponent(n),"/close"),r}return(0,o.c)(t,e),t}(o.f),en=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new o.am(t,n),r}return(0,o.c)(t,e),t}(o.h),tn=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,s=t.optionText,a=e.call(this)||this;return a.method=o.A.POST,a.path="".concat(o.aC,"/").concat(encodeURIComponent(i),"/options"),a.params={channel_url:n,channel_type:r,text:s},a}return(0,o.c)(t,e),t}(o.f),nn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new o.am(t,n),r}return(0,o.c)(t,e),t}(o.h),rn=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=t.optionText,s=e.call(this)||this;return s.method=o.A.PUT,s.path="".concat(o.aC,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),s.params={text:i},s}return(0,o.c)(t,e),t}(o.f),on=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new o.am(t,n),r}return(0,o.c)(t,e),t}(o.h),sn=function(e){function t(t){var n=t.pollId,r=t.pollOptionId,i=e.call(this)||this;return i.method=o.A.DELETE,i.path="".concat(o.aC,"/").concat(encodeURIComponent(n),"/options/").concat(encodeURIComponent(r)),i}return(0,o.c)(t,e),t}(o.f);!function(e){(0,o.c)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(o.h);var an=function(e){function t(t){var n=t.reqId,r=t.channelType,i=t.channelUrl,s=t.pollId,a=t.pollOptionIds;return e.call(this,{code:"VOTE",ackRequired:!0,payload:(0,o.e)({req_id:n,channel_type:r===o.C.OPEN?"open_channels":"group_channels",channel_url:i,poll_id:s,option_ids:a})})||this}return(0,o.c)(t,e),t}(o.ao),un=function(e){function t(t,n,r){var i=e.call(this,t,"VOTE",r)||this;return i.event=new o.aD(r),i.channelUrl=r.channel_url,i.channelType=r.channel_type,i}return(0,o.c)(t,e),t}(o.W),cn=100,ln="GroupChannel",dn="url",hn=100,fn="Message",pn="messageId",_n="NotificationMessage",vn="notificationId",mn="Poll",gn="pollId",yn="FeedChannel",bn="url";function En(e){var t,n,r;return null!==(t=e.messageParams)&&void 0!==t?t:(0,o.u)((0,o.g)((0,o.g)({},e),{isReplyToChannel:!1,mentionedUserIds:null!==(n=e.mentionedUserIds)&&void 0!==n?n:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return e.userId})),pushNotificationDeliveryOption:o.an.DEFAULT,isPinnedMessage:!1,fileInfoList:e.fileInfoList.map((function(e){var t;return{fileUrl:e.plainUrl,fileName:e.fileName,fileSize:e.fileSize,mimeType:e.mimeType,thumbnailSizes:null===(t=e.thumbnails)||void 0===t?void 0:t.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),_uploadedMetaData:{requireAuth:e._requireAuth,isUploaded:!0}}}))}))}var wn,Cn=(0,o.g)((0,o.g)({},ge),{fileInfoList:[]}),Tn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onFileUploaded=o.av,t}return(0,o.c)(t,e),t.prototype._triggerOnFileUploaded=function(e,t,n,r){this._onFileUploaded(e,t,n,r)},t.prototype.onFileUploaded=function(e){return this._onFileUploaded=e,this},t.prototype.onPending=function(t){return e.prototype.onPending.call(this,t),this},t.prototype.onFailed=function(t){return e.prototype.onFailed.call(this,t),this},t.prototype.onSucceeded=function(t){return e.prototype.onSucceeded.call(this,t),this},t}(me),An=2;!function(e){e.SEND="send",e.RESEND="resend",e.COPY="copy"}(wn||(wn={}));var Sn,In=function(e){function t(t,n){var r,i,s,a,u,c,l=this;return(l=e.call(this,t)||this)._name="",l._createdAt=0,l.channelType=o.C.BASE,l.coverUrl="",l.customType="",l.data="",l.isFrozen=!1,l.isEphemeral=!1,l.creator=null,l._messageCollectionLastAccessedAt=0,l._url=n.channel_url,l._name=null!==(r=n.name)&&void 0!==r?r:"",l._createdAt=1e3*n.created_at,l.coverUrl=null!==(i=n.cover_url)&&void 0!==i?i:"",l.customType=null!==(s=n.custom_type)&&void 0!==s?s:"",l.data=null!==(a=n.data)&&void 0!==a?a:"",l.isFrozen=null!==(u=n.freeze)&&void 0!==u&&u,l.isEphemeral=null!==(c=n.is_ephemeral)&&void 0!==c&&c,l.creator=n.created_by?new o.U(l._iid,n.created_by):null,n.metadata&&Object.keys(n.metadata).length>0&&n.ts&&(l._cachedMetaData=new Map,Object.keys(n.metadata).forEach((function(e){l._cachedMetaData.set(e,{value:n.metadata[e],isRemoved:!1,updatedAt:n.ts})}))),l}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"createdAt",{get:function(){return this._createdAt},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return(0,o.g)((0,o.g)({},this),{url:this._url,name:this._name,createdAt:this._createdAt})},t.payloadify=function(t){return(0,o.e)((0,o.u)((0,o.g)((0,o.g)({},e.payloadify.call(this,t)),{channel_url:t.url,name:t.name,cover_url:t.coverUrl,custom_type:t.customType,data:t.data,freeze:t.isFrozen,is_ephemeral:t.isEphemeral,created_by:t.creator?o.U.payloadify(t.creator):null,created_at:t.createdAt/1e3})))},t.prototype.isGroupChannel=function(){return this.channelType===o.C.GROUP},t.prototype.isOpenChannel=function(){return this.channelType===o.C.OPEN},t.prototype.isFeedChannel=function(){return this.channelType===o.C.FEED},Object.defineProperty(t.prototype,"cachedMetaData",{get:function(){var e={};return this._cachedMetaData?(this._cachedMetaData.forEach((function(t,n){t.isRemoved||(e[n]=t.value)})),e):e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"messageCollectionLastAccessedAt",{get:function(){return this._messageCollectionLastAccessedAt},enumerable:!1,configurable:!0}),t.prototype._updateMessageCollectionLastAccessedAt=function(){this._messageCollectionLastAccessedAt=Date.now()},t.prototype._update=function(e){var t=(0,o.e)(e);Object.assign(this,t)},t.prototype._upsertCachedMetaData=function(e,t){var n=this;Object.keys(e).forEach((function(r){n._cachedMetaData||(n._cachedMetaData=new Map);var i=n._cachedMetaData.get(r);(!i||i.updatedAt<=t)&&n._cachedMetaData.set(r,{value:e[r],isRemoved:!1,updatedAt:t})}))},t.prototype._updateCachedMetaData=function(e,t){var n=this;this._cachedMetaData?this._cachedMetaData.forEach((function(r,i){var o;r.updatedAt<=t&&n._cachedMetaData.set(i,{value:null!==(o=e[i])&&void 0!==o?o:r.value,isRemoved:!e[i],updatedAt:t})})):(this._cachedMetaData=new Map,Object.keys(e).forEach((function(r){n._cachedMetaData.set(r,{value:e[r],isRemoved:!1,updatedAt:t})})))},t.prototype._removeFromCachedMetaData=function(e,t){var n=this;this._cachedMetaData&&e.forEach((function(e){var r=n._cachedMetaData.get(e);r&&r.updatedAt<t&&(r.isRemoved=!0,r.updatedAt=t)}))},t.prototype._runIfHandleableWithGroupChannel=function(e){this.isGroupChannel()?e(this):this.isFeedChannel()&&e(this.groupChannel)},t.prototype._generateRequestId=function(){return"rq-".concat((0,o.m)())},t.prototype.isIdentical=function(e){return e&&this.url===e.url},t.prototype.isEqual=function(e){return(0,o.ab)(this,e)},t.prototype.createOperatorListQuery=function(e){return void 0===e&&(e={}),new He(this._iid,this.url,this.channelType,e)},t.prototype.createMutedUserListQuery=function(e){return void 0===e&&(e={}),new Ge(this._iid,this.url,this.channelType,e)},t.prototype.createBannedUserListQuery=function(e){return void 0===e&&(e={}),new Qe(this._iid,this.url,this.channelType,e)},t.prototype.createPreviousMessageListQuery=function(e){return void 0===e&&(e={}),new Ve(this._iid,this.url,this.channelType,e)},t.prototype.addOperators=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return(0,o.t)((0,o.O)("string",e)).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new Ze({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.removeOperators=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return(0,o.t)((0,o.O)("string",e)).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new Ye({channelUrl:this.url,channelType:this.channelType,operatorUserIds:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.getMyMutedInfo=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u,c,l,d;return(0,o.b)(this,(function(h){switch(h.label){case 0:return e=o.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new $e({channelUrl:this.url,channelType:this.channelType,userId:t.userId}),[4,n.send(r)];case 1:return i=h.sent(),s=i.as(Xe),a=s.isMuted,u=s.startAt,c=s.endAt,l=s.remainingDuration,d=s.description,[2,{isMuted:a,startAt:u,endAt:c,remainingDuration:l,description:d}]}}))}))},t.prototype.getMetaData=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return(0,o.t)((0,o.O)("string",e)).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new Je({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return r=u.sent(),i=r.as(et),s=i.metadata,a=i.ts,this._upsertCachedMetaData(s,a),[2,s]}}))}))},t.prototype.getAllMetaData=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return e=o.V.of(this._iid).requestQueue,t=new Je({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return n=a.sent(),r=n.as(et),i=r.metadata,s=r.ts,this._updateCachedMetaData(i,s),[2,i]}}))}))},t.prototype.createMetaData=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return t=o.V.of(this._iid).requestQueue,n=new tt({channelUrl:this.url,channelType:this.channelType,metadata:e}),[4,t.send(n)];case 1:return r=s.sent(),i=r.as(nt).metaData,this._upsertCachedMetaData(i,0),[2,i]}}))}))},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return n=o.V.of(this._iid).requestQueue,r=new rt({channelUrl:this.url,channelType:this.channelType,metadata:e,upsert:t}),[4,n.send(r)];case 1:return i=c.sent(),s=i.as(it),a=s.metadata,u=s.ts,this._upsertCachedMetaData(a,u),[2,a]}}))}))},t.prototype.deleteMetaData=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new st({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r=s.sent(),i=r.as(at).ts,this._removeFromCachedMetaData([e],i),[2]}}))}))},t.prototype.deleteAllMetaData=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return e=o.V.of(this._iid).requestQueue,t=new ut({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n=i.sent(),r=n.as(ct).ts,this._removeFromCachedMetaData((0,o.o)([],(0,o.p)(this._cachedMetaData.keys()),!1),r),[2]}}))}))},t.prototype.getMetaCounters=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return(0,o.t)((0,o.O)("string",e)).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new lt({channelUrl:this.url,channelType:this.channelType,keys:e}),[4,t.send(n)];case 1:return[2,r.sent().as(dt).metaCounter]}}))}))},t.prototype.getAllMetaCounters=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return e=o.V.of(this._iid).requestQueue,t=new lt({channelUrl:this.url,channelType:this.channelType,keys:[]}),[4,e.send(t)];case 1:return[2,n.sent().as(dt).metaCounter]}}))}))},t.prototype.createMetaCounters=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return t=o.V.of(this._iid).requestQueue,n=new ht({channelUrl:this.url,channelType:this.channelType,metaCounter:e}),[4,t.send(n)];case 1:return[2,r.sent().as(ft).metaCounter]}}))}))},t.prototype.updateMetaCounters=function(e,t){return void 0===t&&(t=!1),(0,o._)(this,void 0,void 0,(function(){var n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return n=o.V.of(this._iid).requestQueue,r=new pt({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:t}),[4,n.send(r)];case 1:return[2,i.sent().as(_t).metaCounter]}}))}))},t.prototype.increaseMetaCounters=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return t=o.V.of(this._iid).requestQueue,n=new pt({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"increase"}),[4,t.send(n)];case 1:return[2,r.sent().as(_t).metaCounter]}}))}))},t.prototype.decreaseMetaCounters=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return t=o.V.of(this._iid).requestQueue,n=new pt({channelUrl:this.url,channelType:this.channelType,metaCounter:e,upsert:!1,mode:"decrease"}),[4,t.send(n)];case 1:return[2,r.sent().as(_t).metaCounter]}}))}))},t.prototype.deleteMetaCounter=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new mt({channelUrl:this.url,channelType:this.channelType,key:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.deleteAllMetaCounters=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return e=o.V.of(this._iid).requestQueue,t=new gt({channelUrl:this.url,channelType:this.channelType}),[4,e.send(t)];case 1:return n.sent(),[2]}}))}))},t.prototype.muteUser=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(r){return[2,this.muteUserWithUserId(e.userId,t,n)]}))}))},t.prototype.muteUserWithUserId=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return(0,o.t)((0,o.a)("string",e)&&(0,o.a)("number",t,!0)&&(0,o.a)("string",n,!0)).throw(o.r.invalidParameters),r=o.V.of(this._iid).requestQueue,i=new yt({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return s.sent(),[2]}}))}))},t.prototype.unmuteUser=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return[2,this.unmuteUserWithUserId(e.userId)]}))}))},t.prototype.unmuteUserWithUserId=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new Et({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.banUser=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(r){return[2,this.banUserWithUserId(e.userId,t,n)]}))}))},t.prototype.banUserWithUserId=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return(0,o.t)((0,o.a)("string",e)&&(0,o.a)("number",t,!0)&&(0,o.a)("string",n,!0)).throw(o.r.invalidParameters),r=o.V.of(this._iid).requestQueue,i=new Ct({channelUrl:this.url,channelType:this.channelType,userId:e,seconds:t,description:n}),[4,r.send(i)];case 1:return s.sent(),[2]}}))}))},t.prototype.unbanUser=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return[2,this.unbanUserWithUserId(e.userId)]}))}))},t.prototype.unbanUserWithUserId=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),t=o.V.of(this._iid).requestQueue,n=new At({channelUrl:this.url,channelType:this.channelType,userId:e}),[4,t.send(n)];case 1:return r.sent(),[2]}}))}))},t.prototype.freeze=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return e=o.V.of(this._iid).requestQueue,t=new It({channelUrl:this.url,channelType:this.channelType,freezing:!0}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!0,[2]}}))}))},t.prototype.unfreeze=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return e=o.V.of(this._iid).requestQueue,t=new It({channelUrl:this.url,channelType:this.channelType,freezing:!1}),[4,e.send(t)];case 1:return n.sent(),this.isFrozen=!1,[2]}}))}))},t.prototype.getMessagesByMessageId=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},ne),t),(0,o.t)((0,o.a)("number",e)&&re(n)).throw(o.r.invalidParameters),[4,si.of(this._iid).getMessagesByMessageId(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessagesByTimestamp=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},ne),t),(0,o.t)((0,o.a)("number",e)&&re(n)).throw(o.r.invalidParameters),[4,si.of(this._iid).getMessagesByTimestamp(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessageChangeLogsSinceTimestamp=function(e,t){return void 0===t&&(t={}),(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},ie),t),(0,o.t)((0,o.a)("number",e)&&oe(n)).throw(o.r.invalidParameters),[4,si.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype.getMessageChangeLogsSinceToken=function(e,t){return void 0===t&&(t={}),(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return n=(0,o.g)((0,o.g)({},ie),t),(0,o.t)((0,o.a)("string",e)&&oe(n)).throw(o.r.invalidParameters),[4,si.of(this._iid).getMessageChangelogs(this.url,this.channelType,e,n)];case 1:return[2,r.sent()]}}))}))},t.prototype._createPendingSendableMessagePayload=function(e,t,n){var r,i=o.V.of(this._iid).sessionManager;return(0,o.e)((0,o.u)({channel_url:this.url,channel_type:this.channelType,msg_id:0,parent_message_id:e.parentMessageId,data:e.data,custom_type:e.customType,mention_type:e.mentionType,sorted_metaarray:e.metaArrays?e.metaArrays.map((function(e){return y.payloadify(e)})):null,apple_critical_alert_options:e.appleCriticalAlertOptions?_.payloadify(e.appleCriticalAlertOptions):null,created_at:n,user:i.currentUser?g.payloadify(i.currentUser):null,req_id:t,request_state:o.aj.PENDING,mentioned_user_ids:e.mentionedUserIds,mentioned_users:null===(r=e.mentionedUsers)||void 0===r?void 0:r.map((function(e){return o.U.payloadify(e)}))}))},t.prototype._createPendingUserMessage=function(e,t,n){var r,i,s={};if(e.translationTargetLanguages)try{for(var a=(0,o.s)(e.translationTargetLanguages),u=a.next();!u.done;u=a.next())s[u.value]=""}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}var c=(0,o.e)((0,o.g)((0,o.g)({},this._createPendingSendableMessagePayload(e,t,n)),{type:o.ac.USER,message:e.message,translations:s})),l=new q(this._iid,c);return l.messageParams=e,l},t.prototype._createPendingScheduledUserMessage=function(e,t,n){var r=this._createPendingUserMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r},t.prototype._createPendingFileMessage=function(e,t,n){var r,i,s,a,u,c,l=(0,o.e)((0,o.g)((0,o.g)({},this._createPendingSendableMessagePayload(e,t,n)),{type:o.ac.FILE,url:e.fileUrl,file:{name:null!==(r=e.fileName)&&void 0!==r?r:null===(i=e.file)||void 0===i?void 0:i.name,size:null!==(s=e.fileSize)&&void 0!==s?s:null===(a=e.file)||void 0===a?void 0:a.size,type:null!==(u=e.mimeType)&&void 0!==u?u:null===(c=e.file)||void 0===c?void 0:c.type,data:e.data},thumbnails:e.thumbnailSizes?e.thumbnailSizes.map((function(e){return{url:"",width:e.maxWidth,height:e.maxHeight}})):[]})),d=new K(this._iid,l);return d.messageParams=e,d},t.prototype._createPendingMultipleFilesMessage=function(e,t,n){var r=(0,o.e)((0,o.g)((0,o.g)({},this._createPendingSendableMessagePayload(e,t,n)),{type:o.ac.FILE})),i=new V(this._iid,r);return i.messageParams=e,i},t.prototype._validateFailedFileMessageHasFile=function(e,t){var n;return Boolean(e.url)||(0,o.i)(t)||(0,o.i)(null===(n=e.messageParams)||void 0===n?void 0:n.file)},t.prototype._createPendingScheduledFileMessage=function(e,t,n){var r=this._createPendingFileMessage(e,t,n);return r.scheduledInfo={scheduledMessageId:0,scheduledAt:e.scheduledAt,scheduledMessageParams:e},r},t.prototype._markMessageAsFailed=function(e,t,n){void 0===n&&(n=!1),e.errorCode=t.code,t.code===o.ah.REQUEST_CANCELED||t.code===o.ah.FILE_UPLOAD_CANCEL_FAILED?e.sendingStatus=o.aj.CANCELED:n||(e.sendingStatus=o.aj.FAILED)},t.prototype.sendUserMessage=function(e){var t=(0,o.g)((0,o.g)({},Ee),e);return(0,o.t)(Ae(t)).throw(o.r.invalidParameters),this._sendUserMessage(t)},t.prototype._sendUserMessage=function(e,t,n){var r=this;void 0===t&&(t=wn.SEND);var i=o.V.of(this._iid),s=i.dispatcher,a=i.requestQueue,u=null!=n?n:this._generateRequestId(),c=Date.now(),l=new me;return(0,o.ar)(2).then((function(){var n=r._createPendingUserMessage(e,u,c);s.dispatch(new o.ai({messages:[n],source:t===wn.RESEND?o.Z.LOCAL_MESSAGE_RESEND_STARTED:o.Z.EVENT_MESSAGE_SENT_PENDING})),(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,l._trigger(n)]}))}))}));var i=new Mt((0,o.g)((0,o.g)({},e),{channelUrl:r.url,channelType:r.channelType,reqId:u}));a.send(i).then((function(e){var t=e.as(Rt).message;s.dispatch(new o.ai({messages:[t],source:o.Z.EVENT_MESSAGE_SENT_SUCCESS})),(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,l._trigger(t)]}))}))}))})).catch((function(t){if((0,o.N)(t))throw t;(0,o.ar)(2).then((function(){var n=r._createPendingUserMessage(e,u,c),i=o.V.of(r._iid).cacheContext,a=i.localCacheEnabled&&i.localCacheConfig.enableAutoResend&&(0,o.aF)(t.code);r._markMessageAsFailed(n,t,a),s.dispatch(new o.ai({messages:[n],source:n.sendingStatus===o.aj.PENDING?o.Z.REQUEST_RESEND_MESSAGE:o.Z.EVENT_MESSAGE_SENT_FAILED})),(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,l._triggerFailed(t,n)]}))}))}))}))}))})),l},t.prototype._autoResendUserMessage=function(e){return(0,o.t)(e instanceof q&&!!e.messageParams).throw(o.r.invalidParameters),this._sendUserMessage(e.messageParams,wn.SEND,e.reqId)},t.prototype.resendUserMessage=function(e){var t;return(0,o._)(this,void 0,void 0,(function(){var n,r;return(0,o.b)(this,(function(i){return(0,o.t)(e instanceof q&&!e.scheduledInfo).throw(o.r.invalidParameters),n=new o.as,r=null!==(t=e.messageParams)&&void 0!==t?t:Te(e),this._sendUserMessage(r,wn.RESEND,e.reqId).onFailed((function(e){return n.reject(e)})).onSucceeded((function(e){return n.resolve(e)})),[2,n.promise]}))}))},t.prototype.updateUserMessage=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return n=(0,o.g)((0,o.g)({},Le),t),(0,o.t)((0,o.a)("number",e)&&Pe(n)).throw(o.r.invalidParameters),r=o.V.of(this._iid).requestQueue,i=new Dt((0,o.g)({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:n.metaArrays?{array:n.metaArrays,mode:"add",upsert:!0}:void 0},n)),[4,r.send(i)];case 1:return[2,s.sent().as(Ut).message]}}))}))},t.prototype.copyUserMessage=function(e,n){var r,i,s;return(0,o._)(this,void 0,void 0,(function(){var a,u;return(0,o.b)(this,(function(c){return(0,o.t)(e instanceof t&&n instanceof q&&n.sendingStatus===o.aj.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(o.r.invalidParameters),(0,o.t)(!n.poll).throw(o.r.notSupportedError),a=new o.as,u=null!==(r=n.messageParams)&&void 0!==r?r:(0,o.u)((0,o.g)((0,o.g)({},n),{mentionType:n.mentionType,mentionedUserIds:null!==(i=n.mentionedUserIds)&&void 0!==i?i:null===(s=n.mentionedUsers)||void 0===s?void 0:s.map((function(e){return e.userId})),translationTargetLanguages:Object.keys(n.translations),pushNotificationDeliveryOption:o.an.DEFAULT,parentMessageId:null,isReplyToChannel:!1,isPinnedMessage:!1})),e._sendUserMessage(u).onSucceeded((function(e){a.resolve(e)})).onFailed((function(e){return a.reject(e)})),[2,a.promise]}))}))},t.prototype.translateUserMessage=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return(0,o.t)(e instanceof q&&e.messageId>0&&(0,o.O)("string",t)).throw(o.r.invalidParameters),n=o.V.of(this._iid).requestQueue,r=new zt({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,translationTargetLanguages:t}),[4,n.send(r)];case 1:return[2,i.sent().as(Gt).message]}}))}))},t.prototype._createScheduledUserMessage=function(e,t){var n=this,r=o.V.of(this._iid).requestQueue,i=Date.now(),s=this._generateRequestId();(0,o.ar)(2).then((function(){var r=n._createPendingScheduledUserMessage(e,s,i);(0,o.F)((function(){return(0,o._)(n,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,t._trigger(r)]}))}))}))}));var a=new Wt((0,o.g)({reqId:s,channelType:this.channelType,channelUrl:this.url},e));r.send(a).then((function(e){var r=e.as(Kt).message;(0,o.F)((function(){return(0,o._)(n,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,t._trigger(r)]}))}))}))})).catch((function(r){if((0,o.N)(r))throw r;(0,o.ar)(2).then((function(){var a=n._createPendingScheduledUserMessage(e,s,i);n._markMessageAsFailed(a,r),(0,o.F)((function(){return(0,o._)(n,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,t._triggerFailed(r,a)]}))}))}))}))}))},t.prototype.sendFileMessage=function(e){var t=(0,o.g)((0,o.g)({},ke),e);return(0,o.t)(Re(t)).throw(o.r.invalidParameters),this._sendFileMessage(t)},t.prototype.sendMultipleFilesMessage=function(e){var t,n=(0,o.g)((0,o.g)({},Cn),e),r=o.V.of(this._iid);(0,o.t)(function(e,t){return void 0===t&&(t=o.aE),ye(e)&&Array.isArray(e.fileInfoList)&&e.fileInfoList.length>=2&&e.fileInfoList.length<=t&&e.fileInfoList.every((function(e){return function(e){return((0,o.i)(e.file)||(0,o.a)("string",e.fileUrl))&&(0,o.a)("string",e.fileName,!0)&&(0,o.a)("string",e.mimeType,!0)&&(0,o.a)("number",e.fileSize,!0)&&(void 0===e.thumbnailSizes||Array.isArray(e.thumbnailSizes)&&e.thumbnailSizes.every((function(e){return e.maxWidth>0&&e.maxHeight>0})))}(e)}))}(n,null===(t=r.appInfo)||void 0===t?void 0:t.multipleFilesMessageFileCountLimit)).throw(o.r.invalidParameters);var i=!!e.fileInfoList.find((function(e){var t=r.appInfo.uploadSizeLimit;return e.file instanceof Blob&&e.file.size>t||e.fileSize>t}));return(0,o.t)(!i).throw(o.r.fileSizeLimitExceededError),this._sendMultipleFilesMessage(n)},t.prototype._sendFileMessage=function(e,t,n){var r=this;void 0===t&&(t=wn.SEND);var i=o.V.of(this._iid).dispatcher,s=si.of(this._iid).fileMessageQueue,a=null!=n?n:this._generateRequestId(),u=Date.now(),c=new me;return(0,o.ar)(2).then((function(){var n=r._createPendingFileMessage(e,a,u);i.dispatch(new o.ai({messages:[n],source:t===wn.RESEND?o.Z.LOCAL_MESSAGE_RESEND_STARTED:o.Z.EVENT_MESSAGE_SENT_PENDING})),(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,c._trigger(n)]}))}))})),s.request(r,a,e).then((function(e){i.dispatch(new o.ai({messages:[e],source:o.Z.EVENT_MESSAGE_SENT_SUCCESS})),(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return[2,c._trigger(e)]}))}))}))})).catch((function(t){if((0,o.N)(t))throw t;(0,o.ar)(2).then((function(){var n=r._createPendingFileMessage(e,a,u),s=o.V.of(r._iid).cacheContext,l=s.localCacheEnabled&&s.localCacheConfig.enableAutoResend&&(0,o.aF)(t.code);r._markMessageAsFailed(n,t,l),i.dispatch(new o.ai({messages:[n],source:n.sendingStatus===o.aj.PENDING?o.Z.REQUEST_RESEND_MESSAGE:t.code===o.ah.FILE_UPLOAD_CANCEL_FAILED?o.Z.LOCAL_MESSAGE_CANCELED:o.Z.EVENT_MESSAGE_SENT_FAILED})),(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,c._triggerFailed(t,n)]}))}))}))}))}))})),c},t.prototype._autoResendFileMessage=function(e){(0,o.t)(e instanceof K&&!!e.messageParams).throw(o.r.invalidParameters);var t=o.V.of(this._iid).logger;return t.debug("autoResendFileMessage pending",e),this._sendFileMessage(e.messageParams,wn.SEND,e.reqId).onFailed((function(e){t.debug("autoResendFileMessage failed",e)})).onSucceeded((function(e){t.debug("autoResendFileMessage success",e)}))},t.prototype._sendMultipleFilesMessage=function(e,t,n){var r=this,i=o.V.of(this._iid).dispatcher,s=si.of(this._iid).fileMessageQueue,a=null!=n?n:this._generateRequestId(),u=Date.now(),c=new Tn;return(0,o.ar)(2).then((function(){var n=r._createPendingMultipleFilesMessage(e,a,u);i.dispatch(new o.ai({messages:[n],source:t===wn.RESEND?o.Z.LOCAL_MESSAGE_RESEND_STARTED:o.Z.EVENT_MESSAGE_SENT_PENDING})),(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,c._trigger(n)]}))}))})),s.request(r,a,e,{requestHandler:c,isCopy:t===wn.COPY}).then((function(e){i.dispatch(new o.ai({messages:[e],source:o.Z.EVENT_MESSAGE_SENT_SUCCESS})),(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return[2,c._trigger(e)]}))}))}))})).catch((function(t){if((0,o.N)(t))throw t;(0,o.ar)(2).then((function(){var n=r._createPendingMultipleFilesMessage(e,a,u);r._markMessageAsFailed(n,t),i.dispatch(new o.ai({messages:[n],source:o.Z.EVENT_MESSAGE_SENT_FAILED})),(0,o.F)((function(){return(0,o._)(r,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,c._triggerFailed(t,n)]}))}))}))}))}))})),c},t.prototype._createScheduledFileMessage=function(e,t,n,r){var i=this,s=o.V.of(this._iid).requestQueue,a=new Qt((0,o.g)((0,o.g)({reqId:n,channelType:this.channelType,channelUrl:this.url},e),{fileUrl:e.fileUrl,requireAuth:e.requireAuth}));s.send(a).then((function(e){var n=e.as(Zt).message;(0,o.F)((function(){return(0,o._)(i,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,t._trigger(n)]}))}))}))})).catch((function(s){if((0,o.N)(s))throw s;(0,o.ar)(2).then((function(){var a=i._createPendingScheduledFileMessage(e,n,r);i._markMessageAsFailed(a,s),(0,o.F)((function(){return(0,o._)(i,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,t._triggerFailed(s,a)]}))}))}))}))}))},t.prototype.sendFileMessages=function(e){var t,n;(0,o.t)(e.every((function(e){return Re((0,o.g)((0,o.g)({},ke),e))}))).throw(o.r.invalidParameters);var r=new me;try{for(var i=(0,o.s)(e),s=i.next();!s.done;s=i.next()){var a=s.value;this.sendFileMessage(a).onPending((function(e){return r._trigger(e)})).onFailed((function(e,t){return r._triggerFailed(e,t)})).onSucceeded((function(e){return r._trigger(e)}))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},t.prototype.resendFileMessage=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i;return(0,o.b)(this,(function(s){return n=this._validateFailedFileMessageHasFile(e,t),(0,o.t)(e instanceof K&&n&&!e.scheduledInfo).throw(o.r.invalidParameters),r=new o.as,i=Me(e,t),this._sendFileMessage(i,wn.RESEND,e.reqId).onFailed((function(e){return r.reject(e)})).onSucceeded((function(e){return r.resolve(e)})),[2,r.promise]}))}))},t.prototype.resendMessage=function(e,t){var n,r;if((0,o.t)(e instanceof D&&!e.scheduledInfo&&e.isResendable).throw(o.r.invalidParameters),e.isUserMessage()){var i=null!==(n=e.messageParams)&&void 0!==n?n:Te(e);return this._sendUserMessage(i,wn.RESEND,e.reqId)}if(e.isFileMessage()){var s=this._validateFailedFileMessageHasFile(e,t);return(0,o.t)(s).throw(o.r.invalidParameters),i=null!==(r=e.messageParams)&&void 0!==r?r:Me(e,t),this._sendFileMessage(i,wn.RESEND,e.reqId)}if(e.isMultipleFilesMessage())throw o.r.channelTypeNotSupportedError},t.prototype.updateFileMessage=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return n=(0,o.g)((0,o.g)({},Fe),t),(0,o.t)((0,o.a)("number",e)&&function(e){return Ue(e)}(n)).throw(o.r.invalidParameters),r=o.V.of(this._iid).requestQueue,i=new Lt((0,o.g)({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:n.metaArrays?{array:n.metaArrays,mode:"add",upsert:!0}:void 0},n)),[4,r.send(i)];case 1:return[2,s.sent().as(Pt).message]}}))}))},t.prototype.uploadFile=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,c,l;return(0,o.b)(this,(function(d){switch(d.label){case 0:return t=o.V.of(this._iid).requestQueue,n=(0,o.m)(),(r=new a({file:e.file,channelUrl:this.url,thumbnailSizes:e.thumbnailSizes,requestId:n})).uploadProgressHandler=e.progressHandler,e.uploadStartedHandler&&e.uploadStartedHandler(n),[4,t.send(r)];case 1:return i=d.sent(),s=i.as(u),c=s.url,l=s.thumbnails,[2,{requestId:n,url:c,thumbnails:l}]}}))}))},t.prototype.cancelUploadingFileMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return(0,o.t)((0,o.a)("string",e)).throw(o.r.invalidParameters),si.of(this._iid).fileMessageQueue.cancel(this,e),[2,!0]}))}))},t.prototype.copyFileMessage=function(e,n){var r,i,s;return(0,o._)(this,void 0,void 0,(function(){var a,u;return(0,o.b)(this,(function(c){return(0,o.t)(e instanceof t&&n instanceof K&&n.sendingStatus===o.aj.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(o.r.invalidParameters),a=new o.as,u=(0,o.u)((0,o.g)((0,o.g)({},n),{fileUrl:n.url,fileName:n.name,fileSize:n.size,mimeType:n.type,mentionType:n.mentionType,mentionedUserIds:null!==(r=n.mentionedUserIds)&&void 0!==r?r:null===(i=n.mentionedUsers)||void 0===i?void 0:i.map((function(e){return e.userId})),pushNotificationDeliveryOption:o.an.DEFAULT,parentMessageId:null,isReplyToChannel:!1,thumbnailSizes:null===(s=n.thumbnails)||void 0===s?void 0:s.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),requireAuth:n.requireAuth,isPinnedMessage:!1})),e._sendFileMessage(u).onSucceeded((function(e){return a.resolve(e)})).onFailed((function(e){return a.reject(e)})),[2,a.promise]}))}))},t.prototype.copyMessage=function(e,n){(0,o.t)(e instanceof t&&n instanceof D&&n.sendingStatus===o.aj.SUCCEEDED&&this.url===n.channelUrl&&!n.scheduledInfo).throw(o.r.invalidParameters);var r=n,i=e;if(r.isUserMessage()){(0,o.t)(!r.poll).throw(o.r.notSupportedError);var s=we(r);return i._sendUserMessage(s)}if(r.isFileMessage())return s=xe(r),i._sendFileMessage(s);if(n.isMultipleFilesMessage())throw o.r.channelTypeNotSupportedError},t.prototype.deleteMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return(0,o.t)(e instanceof R).throw(o.r.invalidParameters),e.messageId>0?(t=o.V.of(this._iid).requestQueue,n=new Ft({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId}),[4,t.send(n)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.addReaction=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return(0,o.t)(e instanceof R&&e.messageId>0&&(0,o.a)("string",t)).throw(o.r.invalidParameters),n=o.V.of(this._iid).requestQueue,r=new qt({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return[2,i.sent().as(Ht).reactionEvent]}}))}))},t.prototype.deleteReaction=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return(0,o.t)(e instanceof R&&e.messageId>0&&(0,o.a)("string",t)).throw(o.r.invalidParameters),n=o.V.of(this._iid).requestQueue,r=new Vt({channelType:this.channelType,channelUrl:this.url,messageId:e.messageId,reactionKey:t}),[4,n.send(r)];case 1:return[2,i.sent().as(Bt).reactionEvent]}}))}))},t.prototype._updateUserMessageMetaArray=function(e,t,n,r){return(0,o._)(this,void 0,void 0,(function(){var i,s,a,u,c,l;return(0,o.b)(this,(function(d){switch(d.label){case 0:return i=o.V.of(this._iid),s=i.dispatcher,a=i.requestQueue,u=new Dt({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,a.send(u)];case 1:return c=d.sent(),l=c.as(Ut).message,s.dispatch(new o.ai({messages:[l],source:o.Z.EVENT_MESSAGE_UPDATED})),[2,l]}}))}))},t.prototype._updateFileMessageMetaArray=function(e,t,n,r){return(0,o._)(this,void 0,void 0,(function(){var i,s,a,u,c,l;return(0,o.b)(this,(function(d){switch(d.label){case 0:return i=o.V.of(this._iid),s=i.dispatcher,a=i.requestQueue,u=new Lt({channelType:this.channelType,channelUrl:this.url,messageId:e,metaArrayParams:{array:t,mode:n,upsert:r}}),[4,a.send(u)];case 1:return c=d.sent(),l=c.as(Pt).message,s.dispatch(new o.ai({messages:[l],source:o.Z.EVENT_MESSAGE_UPDATED})),[2,l]}}))}))},t.prototype.createMessageMetaArrayKeys=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){return(0,o.t)(e instanceof R&&e.messageId>0&&(0,o.O)("string",t)).throw(o.r.invalidParameters),n=t.map((function(e){return new y({key:e})})),e instanceof K?[2,this._updateFileMessageMetaArray(e.messageId,n,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"add",!0)]}))}))},t.prototype.deleteMessageMetaArrayKeys=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n;return(0,o.b)(this,(function(r){return(0,o.t)(e instanceof R&&e.messageId>0&&(0,o.O)("string",t)).throw(o.r.invalidParameters),n=t.map((function(e){return new y({key:e})})),e instanceof K?[2,this._updateFileMessageMetaArray(e.messageId,n,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,n,"remove",!0)]}))}))},t.prototype.addMessageMetaArrayValues=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){return(0,o.t)(e instanceof R&&e.messageId>0&&t.every((function(e){return e instanceof y}))).throw(o.r.invalidParameters),e instanceof K?[2,this._updateFileMessageMetaArray(e.messageId,t,"add",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"add",!0)]}))}))},t.prototype.removeMessageMetaArrayValues=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){return(0,o.t)(e instanceof R&&e.messageId>0&&t.every((function(e){return e instanceof y}))).throw(o.r.invalidParameters),e instanceof K?[2,this._updateFileMessageMetaArray(e.messageId,t,"remove",!0)]:[2,this._updateUserMessageMetaArray(e.messageId,t,"remove",!0)]}))}))},t.prototype.report=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return(0,o.t)((0,o.T)(Oe,e)&&(0,o.a)("string",t)).throw(o.r.invalidParameters),n=o.V.of(this._iid),r=n.sdkState,i=n.requestQueue,s=new kt({channelUrl:this.url,channelType:this.channelType,userId:r.userId,category:e,description:t}),[4,i.send(s)];case 1:return a.sent(),[2]}}))}))},t.prototype.reportUser=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return(0,o.t)(e instanceof o.U&&(0,o.T)(Oe,t)&&(0,o.a)("string",n)).throw(o.r.invalidParameters),r=o.V.of(this._iid),i=r.sdkState,s=r.requestQueue,a=new xt({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.userId,category:t,description:n}),[4,s.send(a)];case 1:return u.sent(),[2]}}))}))},t.prototype.reportMessage=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return(0,o.t)(e instanceof D&&(0,o.T)(Oe,t)&&(0,o.a)("string",n)).throw(o.r.invalidParameters),r=o.V.of(this._iid),i=r.sdkState,s=r.requestQueue,a=new Ot({channelUrl:this.url,channelType:this.channelType,userId:i.userId,offendingUserId:e.sender.userId,messageId:e.messageId,category:t,description:n}),[4,s.send(a)];case 1:return u.sent(),[2]}}))}))},t.prototype.updatePoll=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return(0,o.t)((0,o.a)("number",e)&&function(e){return(0,o.a)("string",e.title,!0)&&(0,o.aB)(e.data)&&(0,o.a)("boolean",e.allowUserSuggestion,!0)&&(0,o.a)("boolean",e.allowMultipleVotes,!0)&&(0,o.a)("number",e.closeAt,!0)}(t)).throw(o.r.invalidParameters),n=o.V.of(this._iid).requestQueue,r=new Yt((0,o.g)({pollId:e},t)),[4,n.send(r)];case 1:return[2,i.sent().as($t).poll]}}))}))},t.prototype.deletePoll=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return t=(0,o.a)("number",e),(0,o.t)(t).throw(o.r.invalidParameters),n=o.V.of(this._iid).requestQueue,r=new Xt({pollId:e}),[4,n.send(r)];case 1:return i.sent(),[2]}}))}))},t.prototype.closePoll=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return t=(0,o.a)("number",e),(0,o.t)(t).throw(o.r.invalidParameters),n=o.V.of(this._iid).requestQueue,r=new Jt({pollId:e}),[4,n.send(r)];case 1:return[2,i.sent().as(en).poll]}}))}))},t.prototype.addPollOption=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return n=(0,o.a)("number",e)&&(0,o.a)("string",t)&&""!==t.trim(),(0,o.t)(n).throw(o.r.invalidParameters),r=o.V.of(this._iid).requestQueue,i=new tn({channelUrl:this.url,channelType:this.channelType,pollId:e,optionText:t}),[4,r.send(i)];case 1:return[2,s.sent().as(nn).poll]}}))}))},t.prototype.updatePollOption=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return r=(0,o.a)("number",e)&&(0,o.a)("number",t)&&(0,o.a)("string",n)&&""!==n.trim(),(0,o.t)(r).throw(o.r.invalidParameters),i=o.V.of(this._iid).requestQueue,s=new rn({pollId:e,pollOptionId:t,optionText:n}),[4,i.send(s)];case 1:return[2,a.sent().as(on).poll]}}))}))},t.prototype.deletePollOption=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return n=(0,o.a)("number",e)&&(0,o.a)("number",t),(0,o.t)(n).throw(o.r.invalidParameters),r=o.V.of(this._iid).requestQueue,i=new sn({pollId:e,pollOptionId:t}),[4,r.send(i)];case 1:return s.sent(),[2]}}))}))},t.prototype.votePoll=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return n=(0,o.a)("number",e)&&(0,o.O)("number",t),(0,o.t)(n).throw(o.r.invalidParameters),r=o.V.of(this._iid),i=r.requestQueue,s=r.dispatcher,a=new an({reqId:this._generateRequestId(),channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionIds:t}),[4,i.send(a)];case 1:return u=l.sent(),c=u.as(un).event,s.dispatch(new o.aG({event:c,source:o.Z.EVENT_POLL_VOTED})),[2,c]}}))}))},t.prototype.getPollChangeLogsSinceTimestamp=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return(0,o.t)((0,o.a)("number",e)).throw(o.r.invalidParameters),[4,o.aH.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,t.sent()]}}))}))},t.prototype.getPollChangeLogsSinceToken=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return(0,o.t)((0,o.a)("string",e,!0)),[4,o.aH.of(this._iid).getPollChangeLogs(this.url,this.channelType,e)];case 1:return[2,t.sent()]}}))}))},t.prototype.createPollListQuery=function(e){return void 0===e&&(e=10),new o.w(this._iid,{channelUrl:this.url,channelType:this.channelType,limit:e})},t.prototype.createPollVoterListQuery=function(e,t,n){return void 0===n&&(n=20),new o.x(this._iid,{channelUrl:this.url,channelType:this.channelType,pollId:e,pollOptionId:t,limit:n})},t}(o.aa),Nn=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return(0,o.c)(t,e),t}((function(){this.onConnected=o.av,this.onReconnectStarted=o.av,this.onReconnectSucceeded=o.av,this.onReconnectFailed=o.av,this.onDisconnected=o.av})),kn=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return(0,o.c)(t,e),t}((function(){this.onSessionExpired=o.av,this.onSessionTokenRequired=function(e){return e(null)},this.onSessionError=o.av,this.onSessionRefreshed=o.av,this.onSessionClosed=o.av})),xn=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return(0,o.c)(t,e),t}((function(){this.onFriendsDiscovered=o.av,this.onTotalUnreadMessageCountChanged=o.av,this.onTotalUnreadMessageCountUpdated=o.av})),On=function(e){function t(t){var n=t.limit,r=t.token,i=t.userIdsFilter,s=t.metaDataKeyFilter,a=t.metaDataValuesFilter,u=t.nicknameStartsWithFilter,c=e.call(this)||this;return c.method=o.A.GET,c.path=o.d,c.params=(0,o.e)({limit:n,token:r,user_ids:i,metadatakey:s,metadatavalues_in:a,nickname_startswith:u}),c}return(0,o.c)(t,e),t}(o.f),Mn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map((function(e){return new o.U(t,e)})),r.next=n.next,r}return(0,o.c)(t,e),t}(o.h),Rn=function(e){function t(t,n){var r,i,o,s=this;return(s=e.call(this,t,n)||this).userIdsFilter=null,s.metaDataKeyFilter=null,s.metaDataValuesFilter=null,s.nicknameStartsWithFilter=null,s.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,s.metaDataKeyFilter=null!==(i=n.metaDataKeyFilter)&&void 0!==i?i:null,s.metaDataValuesFilter=null!==(o=n.metaDataValuesFilter)&&void 0!==o?o:null,s.nicknameStartsWithFilter=n.nicknameStartsWithFilter||null,s}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,o.O)("string",this.userIdsFilter,!0)&&(0,o.a)("string",this.metaDataKeyFilter,!0)&&(0,o.O)("string",this.metaDataValuesFilter,!0)&&(0,o.a)("string",this.nicknameStartsWithFilter,!0)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=o.V.of(this._iid).requestQueue,t=new On((0,o.u)((0,o.g)((0,o.g)({},this),{token:this._token}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=a.sent(),r=n.as(Mn),i=r.users,s=r.next,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aI),Dn=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,s=t.userIdsFilter,a=e.call(this)||this;return a.method=o.A.GET,a.path="".concat(o.d,"/").concat(n,"/block"),a.params=(0,o.e)({limit:r,token:i,user_ids:s}),a}return(0,o.c)(t,e),t}(o.f),Un=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.users=n.users.map((function(e){return new o.U(t,e)})),r.next=n.next,r}return(0,o.c)(t,e),t}(o.h),Ln=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).userIdsFilter=null,i.userIdsFilter=null!==(r=n.userIdsFilter)&&void 0!==r?r:null,i}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,o.O)("string",this.userIdsFilter,!0)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=o.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Dn((0,o.u)((0,o.g)((0,o.g)({},this),{userId:t.userId,token:this._token}))),[4,n.send(r)]):[3,2]:[3,5];case 1:return i=c.sent(),s=i.as(Un),a=s.users,u=s.next,this._token=u,this._hasNext=!!u,this._isLoading=!1,[2,a];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aI),Pn=function(e){function t(t){var n=t.userId,r=t.limit,i=t.token,s=e.call(this)||this;return s.method=o.A.GET,s.path="".concat(o.d,"/").concat(encodeURIComponent(n),"/friends"),s.params={limit:r,token:i},s}return(0,o.c)(t,e),t}(o.f),Fn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.hasMore=n.has_more,r.users=n.users.map((function(e){return new o.U(t,e)})),r.next=n.next,r}return(0,o.c)(t,e),t}(o.h),jn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=o.V.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Pn((0,o.g)((0,o.g)({},this),{userId:t.userId,token:this._token})),[4,n.send(r)]):[3,2]:[3,5];case 1:return i=l.sent(),s=i.as(Fn),a=s.users,u=s.hasMore,c=s.next,this._token=c,this._hasNext=u,this._isLoading=!1,[2,a];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aI),qn={},Hn=function(){function e(e){var t=e.dbname,n=e.itemSizeLimit,r=void 0===n?1048576:n,i=e.cacheLimit,o=void 0===i?256:i,s=e.blockHashBase,a=void 0===s?2:s,u=e.blockHashMultiplier,c=void 0===u?10:u,l=e.blockHashConstant,d=void 0===l?11:l,h=e.transactionApplyDelay,f=void 0===h?200:h,p=e.disableLogger,_=void 0!==p&&p;return qn[t]||(this.itemSizeLimit=r,this.cacheLimit=o,this.blockHashBase=a,this.blockHashMultiplier=c,this.blockHashConstant=d,this.transactionApplyDelay=f,this.disableLogger=_,qn[t]=this),qn[t]}return e.get=function(e){return qn[e]},e}();!function(e){e[e.UNKNOWN_ERROR=6e7]="UNKNOWN_ERROR",e[e.STORE_NOT_DEFINED=61001e3]="STORE_NOT_DEFINED",e[e.STORE_NOT_AVAILABLE=61001001]="STORE_NOT_AVAILABLE",e[e.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING=61001002]="STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING",e[e.STORE_IS_FULL=61001003]="STORE_IS_FULL",e[e.STORE_NOT_INITIALIZED=61001004]="STORE_NOT_INITIALIZED",e[e.STORE_INVALID_KEY_TYPE=61002e3]="STORE_INVALID_KEY_TYPE",e[e.STORE_BROKEN_INTEGRITY=61002001]="STORE_BROKEN_INTEGRITY",e[e.STORE_BROKEN_BLOB=61002002]="STORE_BROKEN_BLOB",e[e.STORE_ENCRYPTION_INVALID=61002003]="STORE_ENCRYPTION_INVALID",e[e.STORE_ITEM_SIZE_LIMIT_EXCEEDED=61017e3]="STORE_ITEM_SIZE_LIMIT_EXCEEDED",e[e.STORE_READ_FAILED=61017001]="STORE_READ_FAILED",e[e.STORE_WRITE_FAILED=61017002]="STORE_WRITE_FAILED",e[e.DATABASE_SCHEMA_NOT_ON_UPGRADE=62002e3]="DATABASE_SCHEMA_NOT_ON_UPGRADE",e[e.COLLECTION_NOT_READY=63001e3]="COLLECTION_NOT_READY",e[e.COLLECTION_KEY_NOT_MATCH=63002e3]="COLLECTION_KEY_NOT_MATCH",e[e.COLLECTION_QUERY_NOT_VALID=63002001]="COLLECTION_QUERY_NOT_VALID",e[e.COLLECTION_KEY_NOT_FOUND=63004e3]="COLLECTION_KEY_NOT_FOUND",e[e.COLLECTION_KEY_NOT_GIVEN=63004001]="COLLECTION_KEY_NOT_GIVEN",e[e.COLLECTION_INSERT_DUPLICATE=63009e3]="COLLECTION_INSERT_DUPLICATE",e[e.COLLECTION_WRITE_FAILED=63017e3]="COLLECTION_WRITE_FAILED",e[e.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED=63017001]="COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED",e[e.INDEX_TABLE_IS_REQUIRED=65001e3]="INDEX_TABLE_IS_REQUIRED",e[e.INDEX_TYPE_NOT_MATCH=65002e3]="INDEX_TYPE_NOT_MATCH",e[e.COMPARE_TYPE_NOT_MATCH=69002001]="COMPARE_TYPE_NOT_MATCH",e[e.CIRCULAR_REFERENCE_FOUND=69002002]="CIRCULAR_REFERENCE_FOUND"}(Sn||(Sn={}));var Vn,Bn=function(e){function t(n){var r=n.code,i=void 0===r?Sn.UNKNOWN_ERROR:r,o=n.message,s=void 0===o?"Unknown error occurred.":o,a=e.call(this,s)||this;return a.code=i,Object.setPrototypeOf(a,t.prototype),a}return(0,o.c)(t,e),Object.defineProperty(t,"storeNotDefined",{get:function(){return new t({code:Sn.STORE_NOT_DEFINED,message:"Store is not defined. Specify the store on NestDB()"})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailable",{get:function(){return new t({code:Sn.STORE_NOT_AVAILABLE,message:"Store is not available. Check your environment settings."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotAvailableInPrivateBrowsing",{get:function(){return new t({code:Sn.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING,message:"Store is not available because it is in private browsing."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeIsFull",{get:function(){return new t({code:Sn.STORE_IS_FULL,message:"Store is full."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeNotInitialized",{get:function(){return new t({code:Sn.STORE_NOT_INITIALIZED,message:"Store is not initialized."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeKeyTypeIsInvalid",{get:function(){return new t({code:Sn.STORE_INVALID_KEY_TYPE,message:"Store key should be string type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenIntegrity",{get:function(){return new t({code:Sn.STORE_BROKEN_INTEGRITY,message:"Data should be in a store but it does not. Integrity is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeBrokenBlob",{get:function(){return new t({code:Sn.STORE_BROKEN_BLOB,message:"Data should be in a store but it does not. Blob data is broken."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeEncryptionInvalid",{get:function(){return new t({code:Sn.STORE_ENCRYPTION_INVALID,message:"Encryption algorithm has changed. All the store should reset."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeItemSizeExceeded",{get:function(){return new t({code:Sn.STORE_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that the store allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeReadFailed",{get:function(){return new t({code:Sn.STORE_READ_FAILED,message:"Failed to read from store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"storeWriteFailed",{get:function(){return new t({code:Sn.STORE_WRITE_FAILED,message:"Failed to write to store."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseSchemaNotOnUpgrade",{get:function(){return new t({code:Sn.DATABASE_SCHEMA_NOT_ON_UPGRADE,message:"Committing schema is not allowed when upgrade is not running."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionNotReady",{get:function(){return new t({code:Sn.COLLECTION_NOT_READY,message:"Collection is not ready due to an error during initialization."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotMatch",{get:function(){return new t({code:Sn.COLLECTION_KEY_NOT_MATCH,message:"keyName of collection could not change."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionQueryNotValid",{get:function(){return new t({code:Sn.COLLECTION_QUERY_NOT_VALID,message:"Query parameter is not a valid format."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionInsertDuplicate",{get:function(){return new t({code:Sn.COLLECTION_INSERT_DUPLICATE,message:"The key already exists."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotFound",{get:function(){return new t({code:Sn.COLLECTION_KEY_NOT_FOUND,message:"The key is not found."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionKeyNotGiven",{get:function(){return new t({code:Sn.COLLECTION_KEY_NOT_GIVEN,message:"The item should contain [keyName] property."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionWriteFailed",{get:function(){return new t({code:Sn.COLLECTION_WRITE_FAILED,message:"Failed to write an item."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"collectionItemSizeExceeded",{get:function(){return new t({code:Sn.COLLECTION_ITEM_SIZE_LIMIT_EXCEEDED,message:"The size of the item exceeds the limit that a collection allows."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTableIsRequired",{get:function(){return new t({code:Sn.INDEX_TABLE_IS_REQUIRED,message:"Index table is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"indexTypesNotMatch",{get:function(){return new t({code:Sn.INDEX_TYPE_NOT_MATCH,message:"Indexed column should have primitive type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"compareTypesNotMatch",{get:function(){return new t({code:Sn.COMPARE_TYPE_NOT_MATCH,message:"Values to compare have different types."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"circularReferenceFound",{get:function(){return new t({code:Sn.CIRCULAR_REFERENCE_FOUND,message:"Cannot handle circular referenced object."})},enumerable:!1,configurable:!0}),t}(Error);!function(e){e.INIT="init",e.READY="ready",e.CLOSED="closed"}(Vn||(Vn={}));var zn,Gn=function(e,t){if(void 0===t&&(t=new WeakMap),"object"==typeof e&&null!==e){if(t.has(e))throw Bn.circularReferenceFound;t.set(e,!0);var n=void 0;if(Array.isArray(e))n=e.map((function(e){return Gn(e,t)}));else if(e instanceof RegExp)n=e;else if(e instanceof Date)n=e;else for(var r in n={},e)n[r]=Gn(e[r],t);return t.delete(e),n}return e},Wn=function(e,t){if(null==t)return 1;if(null==e)return-1;if(typeof e!=typeof t)throw Bn.compareTypesNotMatch;var n=0;switch(typeof e){case"boolean":case"number":n=e-t;break;case"string":n=e.localeCompare(t)}return n},Kn=function(e,t){for(var n=0,r=0;r<e.length;r++)n=e.charCodeAt(r)+(n<<6)+(n<<16)-n;return(n>>>0)%t},Qn=function(e){return new Promise((function(t){setTimeout((function(){return t()}),e)}))},Zn=function(e,t){if(!t)return!1;if("function"!=typeof e){for(var n in e)if(["/and","&&"].includes(n)){if(e[n].some((function(e){return!Zn(e,t)})))return!1}else if(["/or","||"].includes(n)){if(e[n].every((function(e){return!Zn(e,t)})))return!1}else if("/where"===n){if(!(0,e[n])(t))return!1}else{var r=n;if("object"==typeof e[r]){var i=e[r];for(var o in i)switch(o){case"/eq":case"=":if((s=t[r])!==(a=i[o]))return!1;break;case"/neq":case"!=":if((s=t[r])===(a=i[o]))return!1;break;case"/gt":case">":var s=t[r],a=i[o];if(!(Wn(s,a)>0))return!1;break;case"/gte":case">=":if(s=t[r],a=i[o],!(Wn(s,a)>=0))return!1;break;case"/lt":case"<":if(s=t[r],a=i[o],!(Wn(s,a)<0))return!1;break;case"/lte":case"<=":if(s=t[r],a=i[o],!(Wn(s,a)<=0))return!1;break;case"/in":if(s=t[r],!(a=i[o]).includes(s))return!1;break;case"/nin":if(s=t[r],(a=i[o]).includes(s))return!1;break;case"/contain":if(s=t[r],a=i[o],!s.includes(a))return!1;break;case"/regex":if(s=t[r],!(a=i[o]).test(s))return!1;break;case"/where":if(s=t[r],!(0,i[o])(s))return!1}}else if("function"==typeof e[r]){if(!e[r](t[r]))return!1}else if(e[r]!==t[r])return!1}return!0}return e(t)},Yn=function(){},$n=function(){return Promise.resolve()},Xn=function(e){return e},Jn=function(e,t){t()};!function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD"}(zn||(zn={}));var er,tr,nr,rr=function(){function e(e){var t=e.initialPrevValue,n=void 0===t?null:t,r=e.initialNextValue,i=void 0===r?null:r,o=e.iterator,s=e.map,a=void 0===s?Xn:s,u=e.backward,c=void 0===u?$n:u,l=e.forward,d=void 0===l?$n:l,h=e.complete,f=void 0===h?Yn:h;this._prevValue=n,this._nextValue=i,this._error=null,this._map=a,this._backward=c,this._forward=d,this._iterator=o,this._complete=f}return Object.defineProperty(e.prototype,"prevValue",{get:function(){return this._map(this._prevValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextValue",{get:function(){return this._map(this._nextValue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPrevious",{get:function(){return!!this._prevValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNext",{get:function(){return!!this._nextValue},enumerable:!1,configurable:!0}),e.prototype.prev=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:if(!this.hasPrevious)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._prevValue,t=this,[4,this._backward()];case 2:return t._prevValue=r.sent()||null,this._nextValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:if(!this.hasNext)return[3,6];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this._nextValue,t=this,[4,this._forward()];case 2:return t._nextValue=r.sent()||null,this._prevValue=e,[3,4];case 3:return n=r.sent(),this._error=n,[3,4];case 4:return[4,this._iterator(this)];case 5:return[2,r.sent()];case 6:this._complete(),r.label=7;case 7:return[2]}}))}))},e.prototype.stop=function(){this._prevValue=null,this._nextValue=null,this._complete()},e}(),ir=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,o=e.blockManager,s=e.indexer;this.condition=n,this.backward=i,this._blockManager=o,this._indexer=s}return e.prototype.findOptimizedStartPosition=function(){var e=this,t=["=","/eq",">",">=","/gt","/gte"],n=["=","/eq","<","<=","/lt","/lte"];if(this.backward){var r=this._indexer.origin.length-1;if("function"!=typeof this.condition)for(var i in this._indexer.fields){var o=this._indexer.fields[i],s=1;if("-"===o[0]&&(o=o.slice(1),s=-1),this.condition[o])if("object"==typeof this.condition[o]){var a=s>0?n:t;for(var u in this.condition[o])if(a.includes(u))for(var c=r;c>=0;c--)if(s*Wn(this._indexer.origin[c].columnValues[i],this.condition[o][u])<=0){r=c;break}}else for(c=r;c>=0;c--)if(s*Wn(this._indexer.origin[c].columnValues[i],this.condition[o])<=0){r=c;break}}return Math.min(r+1,this._indexer.origin.length-1)}var l=0;if("function"!=typeof this.condition){var d=function(r){var i=h._indexer.fields[r],o=1;if("-"===i[0]&&(i=i.slice(1),o=-1),h.condition[i])if("object"==typeof h.condition[i])Object.keys(h.condition[i]).forEach((function(s){if((o>0?t:n).includes(s))for(var a=l;a<e._indexer.origin.length;a++)if(o*Wn(e._indexer.origin[a].columnValues[r],e.condition[i][s])>=0){l=a;break}}));else for(var s=l;s<h._indexer.origin.length;s++)if(o*Wn(h._indexer.origin[s].columnValues[r],h.condition[i])>=0){l=s;break}},h=this;for(i=0;i<this._indexer.fields.length;i++)d(i)}return Math.max(l-1,0)},e.prototype.each=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c=this;return(0,o.b)(this,(function(l){switch(l.label){case 0:if(t=this.findOptimizedStartPosition(),n=0,this.backward&&this._indexer.origin[t]&&(n=this._indexer.origin[t].keys.length-1),r=function(){if(c._indexer.origin[t]){if(!c._indexer.origin[t].keys[++n]){if(!c._indexer.origin[++t])return!1;n=0}return!0}return!1},i=function(){if(c._indexer.origin[t]){if(!c._indexer.origin[t].keys[--n]){if(!c._indexer.origin[--t])return!1;n=c._indexer.origin[t].keys.length-1}return!0}return!1},s=null,!this._indexer.origin[t])return[3,4];a=this.backward?i:r,l.label=1;case 1:return[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])];case 2:if((u=l.sent())&&Zn(this.condition,u))return s=u,[3,4];l.label=3;case 3:if(a())return[3,1];l.label=4;case 4:return[4,new Promise((function(a){var u=new rr({initialNextValue:Gn(s),iterator:e,forward:function(){return(0,o._)(c,void 0,void 0,(function(){var e,s;return(0,o.b)(this,(function(o){switch(o.label){case 0:e=this.backward?i:r,o.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return(s=o.sent())&&Zn(this.condition,s)?[2,Gn(s)]:[3,1];case 3:return[2,null]}}))}))},backward:function(){return(0,o._)(c,void 0,void 0,(function(){var e,s;return(0,o.b)(this,(function(o){switch(o.label){case 0:e=this.backward?r:i,o.label=1;case 1:return e()?[4,this._blockManager.getFromBlock(this._indexer.origin[t].keys[n])]:[3,3];case 2:return(s=o.sent())&&Zn(this.condition,s)?[2,Gn(s)]:[3,1];case 3:return[2,null]}}))}))},complete:a});e(u)}))];case 5:return[2,l.sent()]}}))}))},e}(),or=function(){function e(e){var t=e.condition,n=void 0===t?{}:t,r=e.backward,i=void 0!==r&&r,o=e.mutex,s=e.blockManager,a=e.indexer;this._mutex=o,this._iterator=new ir({condition:n,backward:i,blockManager:s,indexer:a})}return e.prototype.fetch=function(e){return void 0===e&&(e={}),(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s=this;return(0,o.b)(this,(function(a){switch(a.label){case 0:if(t=Math.max(e.offset||0,0),0===(n="number"==typeof e.limit?e.limit:Number.MAX_SAFE_INTEGER))return[2,[]];if(n<0)throw Bn.collectionQueryNotValid;a.label=1;case 1:return a.trys.push([1,4,,5]),r=[],[4,this._mutex.lock()];case 2:return a.sent(),[4,this._iterator.each((function(e){return(0,o._)(s,void 0,void 0,(function(){return(0,o.b)(this,(function(i){return e.error?e.stop():e.hasNext?0===t?(r.push(e.nextValue),0<n&&n<=r.length?e.stop():e.next()):(t--,e.next()):e.stop(),[2]}))}))}))];case 3:return a.sent(),this._mutex.unlock(),[2,r];case 4:throw i=a.sent(),this._mutex.unlock(),i;case 5:return[2]}}))}))},e.prototype.count=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n=this;return(0,o.b)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e=0,[4,this._mutex.lock()];case 1:return r.sent(),[4,this._iterator.each((function(t){return(0,o._)(n,void 0,void 0,(function(){return(0,o.b)(this,(function(n){return t.error?t.stop():t.hasNext?(e++,t.next()):t.stop(),[2]}))}))}))];case 2:return r.sent(),this._mutex.unlock(),[2,e];case 3:throw t=r.sent(),this._mutex.unlock(),t;case 4:return[2]}}))}))},e}(),sr=function(e){return"".concat("nest","@").concat(e)},ar=function(e,t){return"".concat(sr(e),"/").concat(t)},ur=function(e,t){return"".concat(ar(e,t),".metadata")},cr=function(e,t){return"".concat(ar(e,t),"/block.")},lr=function(e,t){return"".concat(ar(e,t),"/blob.")},dr=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this.dbname=t,this.collectionName=n,this.store=r}return e.prototype.get=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c,l;return(0,o.b)(this,(function(o){switch(o.label){case 0:return[4,this.store.get(e)];case 1:return(t=o.sent())?(n=t.data,r=t.type,"undefined"==typeof fetch?[3,4]:[4,fetch(n)]):[3,5];case 2:return[4,o.sent().blob()];case 3:return[2,o.sent()];case 4:for(i=[],s=atob(n.split(",")[1]),a=0;a<s.length;a+=512){for(u=s.slice(a,a+512),c=new Array(u.length),l=0;l<u.length;l++)c[l]=u.charCodeAt(l);i.push(new Uint8Array(c))}return[2,new Blob(i,{type:r})];case 5:return[2,null]}}))}))},e.prototype.save=function(e,t){return void 0===t&&(t="".concat(Date.now())),(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a=this;return(0,o.b)(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(n){var r=function(e,t,n,r){return void 0===r&&(r=0),"".concat(lr(e,t)).concat(n,".").concat(r)}(a.dbname,a.collectionName,t),i=new FileReader;i.onload=function(){n({blobId:r,data:i.result,type:e.type})},i.readAsDataURL(e)}))];case 1:return n=o.sent(),r=n.blobId,i=n.data,s=n.type,[4,this.store.set({key:r,value:{data:i,type:s}})];case 2:return o.sent(),[2,r]}}))}))},e.prototype.remove=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this.store.remove(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n=this;return(0,o.b)(this,(function(r){switch(r.label){case 0:return e=lr(this.dbname,this.collectionName),[4,this.store.getAllKeys()];case 1:return t=r.sent(),[4,Promise.all(t.filter((function(t){return t.startsWith(e)})).map((function(e){return(0,o._)(n,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this.store.remove(e)];case 1:return[2,t.sent()]}}))}))})))];case 2:return r.sent(),[2]}}))}))},e}();!function(e){e[e.COMMIT=0]="COMMIT",e[e.WRITE=1]="WRITE",e[e.ERROR=2]="ERROR"}(er||(er={})),function(e){e.PENDING="pending",e.PERSISTENT="persistent",e.VOLATILE="volatile"}(tr||(tr={})),function(e){e[e.NO_CACHE=0]="NO_CACHE",e[e.DEFAULT=1]="DEFAULT",e[e.PERSISTENT=2]="PERSISTENT"}(nr||(nr={}));var hr,fr,pr=[tr.PENDING,tr.VOLATILE],_r={},vr=function(){function e(e){var t=e.dbname,n=e.limit,r=void 0===n?256:n;return _r[t]||(this.dbname=t,this._items=[],this._limit=r,_r[t]=this),_r[t]}return e.get=function(e){return _r[e]},Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.find=function(e,t,n){return void 0===n&&(n=nr.DEFAULT),(0,o._)(this,void 0,void 0,(function(){var r,i;return(0,o.b)(this,(function(o){switch(o.label){case 0:return(r=this.get(t))?[3,2]:[4,e.get(t)];case 1:return(i=o.sent())&&(r={key:t,value:i,state:n===nr.PERSISTENT?tr.PERSISTENT:tr.VOLATILE},this.put(r)),[3,3];case 2:n===nr.PERSISTENT&&(r.state=tr.PERSISTENT),o.label=3;case 3:return[2,r]}}))}))},e.prototype.get=function(e,t){void 0===t&&(t=nr.DEFAULT);var n=this._items.map((function(e){return e.key})).indexOf(e);if(n>-1){var r=this._items[n];return t===nr.PERSISTENT&&(r.state=tr.PERSISTENT),t!==nr.NO_CACHE&&this.put(r),r}return null},e.prototype.put=function(e){var t,n;if(this._limit>0){var r=this._items.map((function(e){return e.key})).indexOf(e.key);if(r>-1)pr.includes(this._items[r].state)&&pr.includes(e.state)?(this._items.splice(r,1),this._items.push(e)):(this._items[r].state=e.state,this._items[r].value=e.value);else{this._items.push(e);var i=this._items.filter((function(e){return e.state===tr.VOLATILE})),s=i.length-this._limit;if(s>0){var a=[];try{for(var u=(0,o.s)(this._items),c=u.next();!c.done;c=u.next()){var l=c.value;l.state===tr.VOLATILE&&s>0?s--:a.push(l)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}this._items=a}}}},e.prototype.remove=function(e){var t=this._items.map((function(e){return e.key})).indexOf(e);t>-1&&this._items.splice(t,1)},e.prototype.clearByCondition=function(e){this._items=this._items.filter((function(t){return!e(t)}))},e.prototype.clear=function(e){void 0===e&&(e=!1),this._items=e?[]:this._items.filter((function(e){return e.state!==tr.VOLATILE}))},e}(),mr=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.store;this._requests=[],this._onCommit=new Map,this._onWrite=new Map,this._onError=new Map,this.dbname=t,this.collectionName=n,this.metadataKey=function(e,t){return"".concat(ar(e,t),"/trans.metadata")}(t,n),this.recordsetKey=function(e,t){return"".concat(ar(e,t),"/trans.recordset")}(t,n),this._store=r}return Object.defineProperty(e.prototype,"generation",{get:function(){return this._metadata?this._metadata.generation:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requestCount",{get:function(){return this._requests.length},enumerable:!1,configurable:!0}),e.prototype._getReducedRecordset=function(e){return void 0===e&&(e=[]),(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._store.get(this.recordsetKey)];case 1:return(t=n.sent()||[]).push.apply(t,(0,o.o)([],(0,o.p)(e),!1)),[2,this._reduceRecordSet(t)]}}))}))},e.prototype._reduceRecordSet=function(e){for(var t=[],n={},r=e.length-1;r>=0;r--){for(var i=e[r],o=[],s=i.requests.length-1;s>=0;s--){var a=i.requests[s],u=a.data;n[u.key]||(o.unshift(a),n[u.key]=!0)}o.length>0&&(i.requests=o,t.unshift(i))}return t},e.prototype._applyRecord=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,l,d;return(0,o.b)(this,(function(h){switch(h.label){case 0:n=vr.get(this.dbname),r=t.generation,i=t.requests,s=null,h.label=1;case 1:return h.trys.push([1,3,,4]),[4,this._store.setMany(i.map((function(e){return(0,o.g)((0,o.g)({},e.data),{generation:r})})))];case 2:for(a=h.sent(),u=0;u<i.length;u++)a[u]instanceof Error&&(s||(s=a[u]),c=i[u].data,n.put((0,o.g)((0,o.g)({},c),{state:tr.PERSISTENT})));return[3,4];case 3:return l=h.sent(),s=l,[3,4];case 4:return s?[3,6]:(d=e.filter((function(e){return e.generation!==r})),[4,this._store.set({key:this.recordsetKey,value:d})]);case 5:return h.sent(),this._onWrite.forEach((function(e){e(i.map((function(e){return e.data})))})),[3,7];case 6:this._onError.forEach((function(e){s&&e(s)})),h.label=7;case 7:return[2]}}))}))},e.prototype.init=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return e=this,[4,this._store.get(this.metadataKey)];case 1:return e._metadata=c.sent()||{generation:1},[4,this._getReducedRecordset()];case 2:t=c.sent(),c.label=3;case 3:c.trys.push([3,8,9,10]),n=(0,o.s)(t),r=n.next(),c.label=4;case 4:return r.done?[3,7]:(i=r.value,[4,this._applyRecord(t,i)]);case 5:c.sent(),c.label=6;case 6:return r=n.next(),[3,4];case 7:return[3,10];case 8:return s=c.sent(),a={error:s},[3,10];case 9:try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(a)throw a.error}return[7];case 10:return[2]}}))}))},e.prototype.on=function(e,t,n){switch(e){case er.COMMIT:this._onCommit.set(t,n);break;case er.WRITE:this._onWrite.set(t,n);break;case er.ERROR:this._onError.set(t,n)}},e.prototype.requestWrite=function(e,t){this._requests.push({data:e,options:t}),vr.get(this.dbname).put((0,o.g)({state:tr.PENDING},e))},e.prototype.requestMultipleWrite=function(e,t){var n,r,i=vr.get(this.dbname);try{for(var s=(0,o.s)(e),a=s.next();!a.done;a=s.next()){var u=a.value;this._requests.push({data:u,options:t}),i.put((0,o.g)({state:tr.PENDING},u))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return vr.get(this.dbname).clearByCondition((function(e){return e.state===tr.PENDING})),this._requests=[],[2]}))}))},e.prototype.commit=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u,c,l,d,h,f=this;return(0,o.b)(this,(function(p){switch(p.label){case 0:if(!((e=this._requests).length>0))return[3,4];for(t=[],n={},u=e.length-1;u>=0;u--)r=e[u],l=r.data,n[l.key]||(n[l.key]=!0,t.unshift(r));return i={generation:this.generation,requests:t},[4,this._getReducedRecordset([i])];case 1:return s=p.sent(),[4,this._store.set({key:this.recordsetKey,value:s})];case 2:return p.sent(),this._metadata.generation++,[4,this._store.set({key:this.metadataKey,value:this._metadata})];case 3:for(p.sent(),a=vr.get(this.dbname),u=0;u<t.length;u++)c=t[u],l=c.data,d=c.options,a.put((0,o.g)((0,o.g)({},l),{state:d&&d.persistent?tr.PERSISTENT:tr.VOLATILE}));this._requests=[],this._onCommit.forEach((function(t){t(e.map((function(e){return e.data})))})),h=Hn.get(this.dbname),setTimeout((function(){try{f._applyRecord(s,i)}catch(e){f._onError.forEach((function(t){return t(e)}))}}),h.transactionApplyDelay),p.label=4;case 4:return[2]}}))}))},e}(),gr=function(){function e(e){var t=e.blockId,n=e.keyName,r=e.items,i=void 0===r?[]:r,s=e.limit;this.blockId=t,this.keyName=n,this.limit=s,this._items=(0,o.o)([],(0,o.p)(i),!1)}return e.createFromCacheItem=function(t){return t?new e(t.value):null},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){return{blockId:this.blockId,keyName:this.keyName,limit:this.limit,items:this._items}},e.prototype.getItemByKey=function(e){var t=this,n=this._items.find((function(n){var r=n[t.keyName];return e===r}));return null!=n?n:null},e.prototype.has=function(e){var t=this;return this._items.map((function(e){return e[t.keyName]})).includes(e)},e.prototype.add=function(e){var t=this,n=this._items.map((function(e){return e[t.keyName]})).indexOf(e[this.keyName]);return n<0?this._items.length<this.limit&&(this._items.push(e),!0):(this._items[n]=e,!0)},e.prototype.remove=function(e){for(var t in this._items)if(this._items[t][this.keyName]===e)return this._items.splice(parseInt(t),1),!0;return!1},e.prototype.clear=function(){this._items=[]},e}(),yr=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.metadata,i=e.hashFunction,o=void 0===i?Kn:i,s=e.transaction,a=e.store;this.dbname=t,this.collectionName=n,this.hashFunction=o,this.metadata=r,this._transaction=s,this._store=a}return Object.defineProperty(e.prototype,"keyName",{get:function(){return this.metadata.keyName},enumerable:!1,configurable:!0}),e.prototype.createBlockId=function(e,t){return void 0===t&&(t=this.metadata.blockLevel),n=this.dbname,r=this.collectionName,i=t,o="".concat(function(e,t,n){var r=n.base*Math.pow(n.multiplier,t)+n.constant;return(n.hashFunction||Kn)(e,r)}(e,t,{hashFunction:this.hashFunction,base:this.metadata.blockHashBase,multiplier:this.metadata.blockHashMultiplier,constant:this.metadata.blockHashConstant})),"".concat(cr(n,r)).concat(i,".").concat(o);var n,r,i,o},e.prototype._findBlock=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s;return(0,o.b)(this,(function(o){switch(o.label){case 0:t=vr.get(this.dbname),n=this.metadata.blockLevel,o.label=1;case 1:return n>0?(r=this.createBlockId(e,n),[4,t.find(this._store,r)]):[3,4];case 2:if((i=o.sent())&&(null==(s=gr.createFromCacheItem(i))?void 0:s.getItemByKey(e)))return[2,s];o.label=3;case 3:return n--,[3,1];case 4:return[2,null]}}))}))},e.prototype.getFromBlock=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return[2,(t=n.sent())?t.getItemByKey(e):null]}}))}))},e.prototype.putToBlock=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a;return(0,o.b)(this,(function(o){switch(o.label){case 0:return n=Hn.get(this.dbname),r=this.createBlockId(e),i=Math.floor(this._store.itemSizeLimit/n.itemSizeLimit),[4,vr.get(this.dbname).find(this._store,r)];case 1:return s=o.sent(),(null==(a=s?gr.createFromCacheItem(s):new gr({blockId:r,keyName:this.keyName,items:[],limit:i}))?void 0:a.add(t))?(this._transaction.requestWrite({key:a.blockId,value:a.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.removeFromBlock=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._findBlock(e)];case 1:return(t=n.sent())&&t.remove(e)?(this._transaction.requestWrite({key:t.blockId,value:t.serialize()}),[2,!0]):[2,!1]}}))}))},e.prototype.clearAllBlocks=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return e=cr(this.dbname,this.collectionName),[4,this._store.getAllKeys()];case 1:return t=r.sent(),n=t.filter((function(t){return t.startsWith(e)})),[4,this._store.removeMany(n)];case 2:return r.sent(),[4,this._transaction.clear()];case 3:return r.sent(),vr.get(this.dbname).clearByCondition((function(t){return t.key.startsWith(e)})),[2]}}))}))},e}(),br={},Er=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.fields,o=e.transaction,s=e.store,a=this;this._origin=[],this._table=[];var u=function(e,t,n){return"".concat(ar(e,t),"/index.").concat(n)}(t,n,i.join(">"));return br[u]||(this.dbname=t,this.collectionName=n,this.keyName=r,this.fields=i,this.indexerKey=u,this._transaction=o,this._store=s,this._transaction.on(er.COMMIT,this.indexerKey,(function(){return a.commit()})),this._transaction.on(er.ERROR,this.indexerKey,(function(){return a.abort()}))),br[u]}return e.createKey=function(e){return e.join(">")},e.parseKey=function(e){return e.split(">")},e.clearIndexerMap=function(){for(var e in br)delete br[e]},e.prototype._addItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=(0,o.p)(this.indexOf(n),2),i=r[0];return r[1]?!this._table[i].keys.includes(t)&&(this._table[i].keys.push(t),!0):(this._table.splice(i,0,{columnValues:n,keys:[t]}),!0)},e.prototype._removeItem=function(e){var t=e[this.keyName],n=this.getColumnValues(e),r=(0,o.p)(this.indexOf(n),2),i=r[0];if(r[1]){var s=this._table[i].keys.indexOf(t);if(s>-1)return this._table[i].keys.splice(s,1),0===this._table[i].keys.length&&this._table.splice(i,1),!0}return!1},Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),e.prototype.getColumnValues=function(e){var t,n,r,i,s=[];try{for(var a=(0,o.s)(this.fields),u=a.next();!u.done;u=a.next()){var c=u.value;if("-"===c[0]&&(c=c.slice(1)),r=e[c],void 0,i=typeof r,null!==r&&"undefined"!==i&&"boolean"!==i&&"number"!==i&&"string"!==i)throw Bn.indexTypesNotMatch;s.push(e[c])}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return s},e.prototype.diff=function(e,t){for(var n in this.fields){var r="-"===this.fields[n][0]?-1:1,i=Wn(e[n],t[n]);if(0!==i)return r*i}return 0},e.prototype.indexOf=function(e){if(this._table.length>0){for(var t=0,n=this._table.length-1;t<=n;){var r=Math.floor((t+n)/2),i=this.diff(e,this._table[r].columnValues);if(i>0)t=r+1;else{if(!(i<0))return[r,!0];n=r-1}}return[t,!1]}return[0,!1]},e.prototype.ensure=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u,c,l,d,h,f,p,_,v,m;return(0,o.b)(this,(function(g){switch(g.label){case 0:return[4,(e=vr.get(this.dbname)).find(this._store,this.indexerKey,nr.PERSISTENT)];case 1:return(t=g.sent())?[3,11]:(n=cr(this.dbname,this.collectionName),[4,this._store.getAllKeys()]);case 2:r=g.sent(),g.label=3;case 3:g.trys.push([3,8,9,10]),i=(0,o.s)(r),s=i.next(),g.label=4;case 4:return s.done?[3,7]:(a=s.value).startsWith(n)?[4,e.find(this._store,a,nr.NO_CACHE)]:[3,6];case 5:if(u=g.sent(),c=gr.createFromCacheItem(u))try{for(v=void 0,l=(0,o.s)(c.items),d=l.next();!d.done;d=l.next())h=d.value,this._addItem(h)}catch(e){v={error:e}}finally{try{d&&!d.done&&(m=l.return)&&m.call(l)}finally{if(v)throw v.error}}g.label=6;case 6:return s=i.next(),[3,4];case 7:return[3,10];case 8:return f=g.sent(),p={error:f},[3,10];case 9:try{s&&!s.done&&(_=i.return)&&_.call(i)}finally{if(p)throw p.error}return[7];case 10:return this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[3,12];case 11:this._origin=t.value,this._table=Gn(this._origin),g.label=12;case 12:return br[this.indexerKey]=this,[2]}}))}))},e.prototype.drop=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return vr.get(this.dbname).remove(this.indexerKey),[4,this._store.remove(this.indexerKey)];case 1:return e.sent(),delete br[this.indexerKey],[2]}}))}))},e.prototype.addItem=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return this._addItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.removeItem=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return this._removeItem(e)&&this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return this._table=[],this._transaction.requestWrite({key:this.indexerKey,value:this._table},{persistent:!0}),[2]}))}))},e.prototype.commit=function(){this._origin=this._table,this._table=Gn(this._origin)},e.prototype.abort=function(){this._table=Gn(this._origin)},e}(),wr=function(){return"undefined"!=typeof document&&"undefined"!=typeof navigator&&"ReactNative"!==navigator.product},Cr=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))};!function(e){e[e.PROCESSING=0]="PROCESSING",e[e.DONE=1]="DONE"}(hr||(hr={})),function(e){e.NEWNODE="newnode",e.REMOVENODE="removenode",e.CLAIM_HOST="claimhost",e.SYNC_HOST="synchost",e.REQUEST_LOCK="requestlock",e.ACQUIRE_LOCK="acquirelock",e.RELEASE_LOCK="releaselock"}(fr||(fr={}));var Tr,Ar={},Sr=function(){function e(e,t){void 0===t&&(t={});var n=this;return this._state=hr.PROCESSING,this._queue=[],this._activationQueue=[],Ar[e]&&!t.forceCreate||(this.nodeId=Cr(),this.key=e,wr()&&(t.startAsInvisible?this.registerNode():"visible"===document.visibilityState?this.claimHost():this.registerNode(),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&n.claimHost()})),window.addEventListener("message",(function(e){var t,r,i=e.data,s=i.nodeId,a=i.requestId,u=i.key,c=i.op,l=i.data;if(s!==n.nodeId&&u===n.key)switch(c){case fr.NEWNODE:n._sendSync();break;case fr.CLAIM_HOST:n._sendSync(),n._hostId=s;break;case fr.SYNC_HOST:if(!n.isInSync){n._activationTimeout&&clearTimeout(n._activationTimeout);var d=l,h=d.currentItemRequestId,f=d.queue,p=function(e){n._queue.findIndex((function(t){return t.requestId===e.requestId}))<0&&n._requestLock({nodeId:e.nodeId,requestId:e.requestId,key:n.key,op:fr.REQUEST_LOCK,ts:e.ts})};try{for(var _=(0,o.s)(f),v=_.next();!v.done;v=_.next())p(v.value)}catch(e){t={error:e}}finally{try{v&&!v.done&&(r=_.return)&&r.call(_)}finally{if(t)throw t.error}}n._currentItem=n._queue.find((function(e){return e.requestId===h})),n._completeSync()}break;case fr.REMOVENODE:n._queue=n._queue.filter((function(e){return e.nodeId!==i.nodeId})),n._currentItem&&n._currentItem.nodeId===i.nodeId&&(n._currentItem=void 0,n._acquire(n._queue[0]));break;case fr.REQUEST_LOCK:n._requestLock(i);break;case fr.ACQUIRE_LOCK:var m=n._queue.find((function(e){return e.requestId===a}));n._acquire(m);break;case fr.RELEASE_LOCK:n._release(a)}})),window.addEventListener("beforeunload",(function(){n._send(fr.REMOVENODE)}))),Ar[e]=this),Ar[e]}return Object.defineProperty(e.prototype,"locked",{get:function(){return!!this._currentItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHost",{get:function(){return this._hostId===this.nodeId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInSync",{get:function(){return this._state==hr.DONE},enumerable:!1,configurable:!0}),e.prototype._send=function(e,t){var n;void 0===t&&(t={});var r={nodeId:this.nodeId,requestId:null!==(n=null==t?void 0:t.requestId)&&void 0!==n?n:Cr(),key:this.key,op:e,data:t.data,ts:Date.now()};return wr()&&window.postMessage(r,"*"),r},e.prototype._acquire=function(e){e?(this._currentItem=e,this._currentItem.onAcquired&&this._currentItem.onAcquired(e.requestId)):this._currentItem=void 0},e.prototype._release=function(e){if(this._currentItem&&this._currentItem.requestId===e){var t=this._currentItem;this._currentItem=void 0,t.nodeId===this.nodeId&&this._send(fr.RELEASE_LOCK,{requestId:t.requestId});var n=this._queue.findIndex((function(t){return t.requestId===e}));n>-1&&this._queue.splice(n,1),t.onReleased&&t.onReleased(e)}},e.prototype._requestLock=function(e){var t=this;return new Promise((function(n){var r={nodeId:e.nodeId,requestId:e.requestId,ts:e.ts,onAcquired:function(e){t.isHost&&t._send(fr.ACQUIRE_LOCK,{requestId:e}),n()},onReleased:function(){t._acquire(t._queue[0])}},i=!1;for(var o in t._queue)if(t._queue[o].ts>r.ts){t._queue.splice(parseInt(o),0,r),i=!0;break}i||t._queue.push(r),t._currentItem||t._acquire(t._queue[0])}))},e.prototype._sendSync=function(){var e;this.isHost&&this._send(fr.SYNC_HOST,{data:{currentItemRequestId:null===(e=this._currentItem)||void 0===e?void 0:e.requestId,queue:this._queue.map((function(e){return{nodeId:e.nodeId,requestId:e.requestId,ts:e.ts}}))}})},e.prototype._waitUntilSyncCompleted=function(){return(0,o._)(this,void 0,void 0,(function(){var e=this;return(0,o.b)(this,(function(t){return this.isHost&&!this.isInSync?[2,new Promise((function(t){e._activationQueue.push(t)}))]:[2]}))}))},e.prototype._waitSync=function(){var e=this;this.isInSync||(this._activationTimeout=setTimeout((function(){e._completeSync()}),8))},e.prototype._completeSync=function(){this.isInSync||(this._state=hr.DONE,this._activationQueue.forEach((function(e){return e()})),this._activationQueue=[])},e.prototype.registerNode=function(){this._send(fr.NEWNODE),this._waitSync()},e.prototype.claimHost=function(){this._hostId=this.nodeId,this._send(fr.CLAIM_HOST),this._waitSync()},e.prototype.lock=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._waitUntilSyncCompleted()];case 1:return t.sent(),e=this._send(fr.REQUEST_LOCK),[4,this._requestLock(e)];case 2:return t.sent(),[2]}}))}))},e.prototype.unlock=function(){var e;(null===(e=this._currentItem)||void 0===e?void 0:e.requestId)&&this._release(this._currentItem.requestId)},e}(),Ir=function(){function e(e){var t=e.dbname,n=e.collectionName,r=e.keyName,i=e.keyHash,s=e.indexes,a=e.store,u=this;this._state=Vn.INIT,this._indexers=[],this.dbname=t,this.name=n,this.keyName=r,this.indexes=(0,o.o)([[r]],(0,o.p)(s.filter((function(e){return Er.createKey(e)!==u.keyName}))),!1),this._keyHash=i,this._store=a,this._mutex=new Sr(function(e,t){return"".concat(ar(e,t),".lock")}(t,n)),this._blobContainer=new dr({dbname:t,collectionName:n,store:a}),this._transaction=new mr({dbname:t,collectionName:n,store:a})}return e.metadataOf=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return r=ur(e,t),[4,n.get(r)];case 1:return[2,i.sent()]}}))}))},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return this._state===Vn.READY},enumerable:!1,configurable:!0}),e.prototype.init=function(){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c,l,d,h,f,p,_,v=this;return(0,o.b)(this,(function(m){switch(m.label){case 0:return[4,this._mutex.lock()];case 1:m.sent(),m.label=2;case 2:return m.trys.push([2,9,,10]),t=Hn.get(this.dbname),[4,e.metadataOf(this.dbname,this.name,this._store)];case 3:return n=m.sent(),this._metadata=n||{keyName:this.keyName,blockLevel:1,blockHashBase:t.blockHashBase,blockHashMultiplier:t.blockHashMultiplier,blockHashConstant:t.blockHashConstant,indexes:this.indexes},[4,this._transaction.init()];case 4:m.sent(),this._blockManager=new yr({dbname:this.dbname,collectionName:this.name,hashFunction:this._keyHash,metadata:this._metadata,transaction:this._transaction,store:this._store}),r=(0,o.o)([],(0,o.p)(this.indexes),!1),i=[],s=r.map((function(e){return Er.createKey(e)})),a=n?n.indexes.map((function(e){return Er.createKey(e)})):[];try{for(u=(0,o.s)(a),c=u.next();!c.done;c=u.next())l=c.value,s.includes(l)||i.push(Er.parseKey(l))}catch(e){p={error:e}}finally{try{c&&!c.done&&(_=u.return)&&_.call(u)}finally{if(p)throw p.error}}return(d=[]).push.apply(d,(0,o.o)([],(0,o.p)(r.map((function(e){var t=new Er({dbname:v.dbname,collectionName:v.name,keyName:v.keyName,fields:e,transaction:v._transaction,store:v._store});return v._indexers.push(t),t.ensure()}))),!1)),d.push.apply(d,(0,o.o)([],(0,o.p)(i.map((function(e){return new Er({dbname:v.dbname,collectionName:v.name,keyName:v.keyName,fields:e,transaction:v._transaction,store:v._store}).drop()}))),!1)),[4,Promise.all(d)];case 5:return m.sent(),[4,this._transaction.commit()];case 6:return m.sent(),s.sort().join(",")===a.sort().join(",")?[3,8]:(h=ur(this.dbname,this.name),this._metadata.indexes=r,[4,this._store.set({key:h,value:this._metadata})]);case 7:m.sent(),m.label=8;case 8:return this._state=Vn.READY,this._mutex.unlock(),[3,10];case 9:throw f=m.sent(),this._mutex.unlock(),f;case 10:return[2]}}))}))},e.prototype.close=function(){this._state=Vn.CLOSED},e.prototype._hasPropertyOfKeyName=function(e){var t=e[this.keyName];return"string"==typeof t&&!!t},e.prototype._getIndexerBy=function(e){var t,n;void 0===e&&(e=null),e||(e=[this.keyName]);var r=Er.createKey(e);try{for(var i=(0,o.s)(this._indexers),s=i.next();!s.done;s=i.next()){var a=s.value;if(r===Er.createKey(a.fields))return a}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}throw Bn.indexTableIsRequired},e.prototype._upgradeBlockLevel=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return e=ur(this.dbname,this.name),this._metadata.blockLevel++,[4,this._store.set({key:e,value:this._metadata})];case 1:return t.sent(),[2]}}))}))},e.prototype._requestInsert=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return u.sent()?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return u.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return u.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:u.sent(),u.label=5;case 5:u.trys.push([5,10,11,12]),n=(0,o.s)(this._indexers),r=n.next(),u.label=6;case 6:return r.done?[3,9]:[4,r.value.addItem(e)];case 7:u.sent(),u.label=8;case 8:return r=n.next(),[3,6];case 9:return[3,12];case 10:return i=u.sent(),s={error:i},[3,12];case 11:try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}return[7];case 12:return[3,14];case 13:throw Bn.collectionInsertDuplicate;case 14:return[2]}}))}))},e.prototype._requestUpsert=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c,l,d,h,f,p;return(0,o.b)(this,(function(_){switch(_.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=_.sent())?[3,13]:[4,this._blockManager.putToBlock(t,e)];case 2:return _.sent()?[3,5]:[4,this._upgradeBlockLevel()];case 3:return _.sent(),[4,this._blockManager.putToBlock(t,e)];case 4:_.sent(),_.label=5;case 5:_.trys.push([5,10,11,12]),r=(0,o.s)(this._indexers),i=r.next(),_.label=6;case 6:return i.done?[3,9]:[4,(c=i.value).addItem(e)];case 7:_.sent(),_.label=8;case 8:return i=r.next(),[3,6];case 9:return[3,12];case 10:return s=_.sent(),d={error:s},[3,12];case 11:try{i&&!i.done&&(h=r.return)&&h.call(r)}finally{if(d)throw d.error}return[7];case 12:return[3,23];case 13:return[4,this._blockManager.putToBlock(t,e)];case 14:_.sent(),_.label=15;case 15:_.trys.push([15,21,22,23]),a=(0,o.s)(this._indexers),u=a.next(),_.label=16;case 16:return u.done?[3,20]:0===(c=u.value).diff(c.getColumnValues(n),c.getColumnValues(e))?[3,19]:[4,c.removeItem(n)];case 17:return _.sent(),[4,c.addItem(e)];case 18:_.sent(),_.label=19;case 19:return u=a.next(),[3,16];case 20:return[3,23];case 21:return l=_.sent(),f={error:l},[3,23];case 22:try{u&&!u.done&&(p=a.return)&&p.call(a)}finally{if(f)throw f.error}return[7];case 23:return[2]}}))}))},e.prototype._requestUpdate=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return t=e[this.keyName],[4,this._blockManager.getFromBlock(t)];case 1:return(n=l.sent())?[4,this._blockManager.putToBlock(t,e)]:[3,11];case 2:l.sent(),l.label=3;case 3:l.trys.push([3,9,10,11]),r=(0,o.s)(this._indexers),i=r.next(),l.label=4;case 4:return i.done?[3,8]:0===(s=i.value).diff(s.getColumnValues(n),s.getColumnValues(e))?[3,7]:[4,s.removeItem(n)];case 5:return l.sent(),[4,s.addItem(e)];case 6:l.sent(),l.label=7;case 7:return i=r.next(),[3,4];case 8:return[3,11];case 9:return a=l.sent(),u={error:a},[3,11];case 10:try{i&&!i.done&&(c=r.return)&&c.call(r)}finally{if(u)throw u.error}return[7];case 11:return[2]}}))}))},e.prototype._requestRemove=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:return[4,this._blockManager.getFromBlock(e)];case 1:return(t=u.sent())?[4,this._blockManager.removeFromBlock(e)]:[3,10];case 2:u.sent(),u.label=3;case 3:u.trys.push([3,8,9,10]),n=(0,o.s)(this._indexers),r=n.next(),u.label=4;case 4:return r.done?[3,7]:[4,r.value.removeItem(t)];case 5:u.sent(),u.label=6;case 6:return r=n.next(),[3,4];case 7:return[3,10];case 8:return i=u.sent(),s={error:i},[3,10];case 9:try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}return[7];case 10:return[2]}}))}))},e.prototype._requestClear=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i;return(0,o.b)(this,(function(s){switch(s.label){case 0:return[4,this._blockManager.clearAllBlocks()];case 1:s.sent(),s.label=2;case 2:s.trys.push([2,7,8,9]),e=(0,o.s)(this._indexers),t=e.next(),s.label=3;case 3:return t.done?[3,6]:[4,t.value.clear()];case 4:s.sent(),s.label=5;case 5:return t=e.next(),[3,3];case 6:return[3,9];case 7:return n=s.sent(),r={error:n},[3,9];case 8:try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(r)throw r.error}return[7];case 9:return[2]}}))}))},e.prototype.getByKey=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,6];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this._blockManager.getFromBlock(e)];case 3:return t=r.sent(),this._mutex.unlock(),[2,Gn(t)];case 4:throw n=r.sent(),this._mutex.unlock(),n;case 5:return[3,7];case 6:throw Bn.collectionNotReady;case 7:return[2]}}))}))},e.prototype.query=function(e){if(void 0===e&&(e={}),this.isReady)return new or({condition:e.where,mutex:this._mutex,blockManager:this._blockManager,indexer:this._getIndexerBy(e.index),backward:!!e.backward});throw Bn.collectionNotReady},e.prototype.insertOne=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw Bn.collectionKeyNotGiven;return[4,this._requestInsert(Gn(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Bn.collectionNotReady;case 9:return[2]}}))}))},e.prototype.insertMany=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c=this;return(0,o.b)(this,(function(l){switch(l.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:l.sent(),l.label=2;case 2:if(l.trys.push([2,12,,14]),e.some((function(e){return!c._hasPropertyOfKeyName(e)})))throw Bn.collectionKeyNotGiven;l.label=3;case 3:l.trys.push([3,8,9,10]),t=(0,o.s)(e),n=t.next(),l.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestInsert(Gn(r))]);case 5:l.sent(),l.label=6;case 6:return n=t.next(),[3,4];case 7:return[3,10];case 8:return i=l.sent(),a={error:i},[3,10];case 9:try{n&&!n.done&&(u=t.return)&&u.call(t)}finally{if(a)throw a.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return l.sent(),this._mutex.unlock(),[2,e];case 12:return s=l.sent(),[4,this._transaction.clear()];case 13:throw l.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw Bn.collectionNotReady;case 16:return[2]}}))}))},e.prototype.upsertOne=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw Bn.collectionKeyNotGiven;return[4,this._requestUpsert(Gn(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Bn.collectionNotReady;case 9:return[2]}}))}))},e.prototype.upsertMany=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c=this;return(0,o.b)(this,(function(l){switch(l.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:l.sent(),l.label=2;case 2:if(l.trys.push([2,12,,14]),e.some((function(e){return!c._hasPropertyOfKeyName(e)})))throw Bn.collectionKeyNotGiven;l.label=3;case 3:l.trys.push([3,8,9,10]),t=(0,o.s)(e),n=t.next(),l.label=4;case 4:return n.done?[3,7]:(r=n.value,[4,this._requestUpsert(Gn(r))]);case 5:l.sent(),l.label=6;case 6:return n=t.next(),[3,4];case 7:return[3,10];case 8:return i=l.sent(),a={error:i},[3,10];case 9:try{n&&!n.done&&(u=t.return)&&u.call(t)}finally{if(a)throw a.error}return[7];case 10:return[4,this._transaction.commit()];case 11:return l.sent(),this._mutex.unlock(),[2,e];case 12:return s=l.sent(),[4,this._transaction.clear()];case 13:throw l.sent(),this._mutex.unlock(),s;case 14:return[3,16];case 15:throw Bn.collectionNotReady;case 16:return[2]}}))}))},e.prototype.update=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:if(n.trys.push([2,5,,7]),!this._hasPropertyOfKeyName(e))throw Bn.collectionKeyNotGiven;return[4,this._requestUpdate(Gn(e))];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[2,e];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Bn.collectionNotReady;case 9:return[2]}}))}))},e.prototype.updateIf=function(e,t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a,u,c,l,d,h,f,p,_,v,m=this;return(0,o.b)(this,(function(g){switch(g.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,16];case 1:g.sent(),g.label=2;case 2:return g.trys.push([2,13,,15]),n=e.where,r=void 0===n?{}:n,i=e.index,s=void 0===i?null:i,a=e.backward,u=void 0!==a&&a,c=[],[4,new ir({condition:r,blockManager:this._blockManager,backward:u,indexer:this._getIndexerBy(s)}).each((function(e){return(0,o._)(m,void 0,void 0,(function(){var n,i;return(0,o.b)(this,(function(o){if(e.error)throw e.stop(),e.error;if(e.hasNext){if(n=e.nextValue,Zn(r,n)&&t.set){if("function"!=typeof t.set)for(i in t.set)n[i]=t.set[i];else t.set(n);c.push(n)}e.next()}else e.stop();return[2]}))}))}))];case 3:g.sent(),g.label=4;case 4:g.trys.push([4,9,10,11]),l=(0,o.s)(c),d=l.next(),g.label=5;case 5:return d.done?[3,8]:(h=d.value,[4,this._requestUpdate(Gn(h))]);case 6:g.sent(),g.label=7;case 7:return d=l.next(),[3,5];case 8:return[3,11];case 9:return f=g.sent(),_={error:f},[3,11];case 10:try{d&&!d.done&&(v=l.return)&&v.call(l)}finally{if(_)throw _.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return g.sent(),this._mutex.unlock(),[2,c];case 13:return p=g.sent(),[4,this._transaction.clear()];case 14:throw g.sent(),this._mutex.unlock(),p;case 15:return[3,17];case 16:throw this._transaction.clear(),Bn.collectionNotReady;case 17:return[2]}}))}))},e.prototype.remove=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),[4,this._requestRemove(e)];case 3:return n.sent(),[4,this._transaction.commit()];case 4:return n.sent(),this._mutex.unlock(),[3,7];case 5:return t=n.sent(),[4,this._transaction.clear()];case 6:throw n.sent(),this._mutex.unlock(),t;case 7:return[3,9];case 8:throw Bn.collectionNotReady;case 9:return[2]}}))}))},e.prototype.removeIf=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c,l,d,h,f,p,_,v=this;return(0,o.b)(this,(function(m){switch(m.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,15];case 1:m.sent(),m.label=2;case 2:return m.trys.push([2,13,,14]),t=e.where,n=void 0===t?{}:t,r=e.index,i=void 0===r?null:r,s=e.backward,a=void 0!==s&&s,u=[],[4,new ir({condition:n,blockManager:this._blockManager,backward:a,indexer:this._getIndexerBy(i)}).each((function(e){return(0,o._)(v,void 0,void 0,(function(){var t,r;return(0,o.b)(this,(function(i){if(e.error)throw e.stop(),e.error;return e.hasNext?(t=e.nextValue,Zn(n,t)&&(r=t[this.keyName],u.push(r)),e.next()):e.stop(),[2]}))}))}))];case 3:m.sent(),m.label=4;case 4:m.trys.push([4,9,10,11]),c=(0,o.s)(u),l=c.next(),m.label=5;case 5:return l.done?[3,8]:(d=l.value,[4,this._requestRemove(d)]);case 6:m.sent(),m.label=7;case 7:return l=c.next(),[3,5];case 8:return[3,11];case 9:return h=m.sent(),p={error:h},[3,11];case 10:try{l&&!l.done&&(_=c.return)&&_.call(c)}finally{if(p)throw p.error}return[7];case 11:return[4,this._transaction.commit()];case 12:return m.sent(),this._mutex.unlock(),[2,u];case 13:throw f=m.sent(),this._mutex.unlock(),f;case 14:return[3,16];case 15:throw this._transaction.clear(),Bn.collectionNotReady;case 16:return[2]}}))}))},e.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return this.isReady?[4,this._mutex.lock()]:[3,8];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,5,,7]),[4,this._requestClear()];case 3:return t.sent(),[4,this._transaction.commit()];case 4:return t.sent(),this._mutex.unlock(),[3,7];case 5:return e=t.sent(),[4,this._transaction.clear()];case 6:throw t.sent(),this._mutex.unlock(),e;case 7:return[3,9];case 8:throw Bn.collectionNotReady;case 9:return[2]}}))}))},e.prototype.getBlob=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.get(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.saveBlob=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._blobContainer.save(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.removeBlob=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._blobContainer.remove(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.removeAllBlobs=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._blobContainer.clear()];case 1:return e.sent(),[2]}}))}))},e}(),Nr="[NESTDB]",kr=!0,xr=function(){function e(){}return e.off=function(){kr=!1},e.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];kr&&console.log.apply(console,(0,o.o)(["".concat(Nr,"[LOG]")],(0,o.p)(e),!1))},e.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];kr&&console.warn.apply(console,(0,o.o)(["".concat(Nr,"[WARNING]")],(0,o.p)(e),!1))},e.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];kr&&console.error.apply(console,(0,o.o)(["".concat(Nr,"[ERROR]")],(0,o.p)(e),!1))},e}(),Or=[{},{a:700400,n:"error"}],Mr=function(){function e(e){var t,n,r;this.encryption=null!==(t=e.encryption)&&void 0!==t?t:o.aJ,this.itemSizeLimit=null!==(n=e.itemSizeLimit)&&void 0!==n?n:4194304,this.metadataBuffer=null!==(r=e.metadataBuffer)&&void 0!==r?r:256}return Object.defineProperty(e.prototype,"_encryptionCheckKey",{get:function(){return"".concat(this.dbname,".encrypt")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_reservedKeys",{get:function(){return[this._encryptionCheckKey]},enumerable:!1,configurable:!0}),e.prototype._getRawKey=function(e,t){return void 0===t&&(t=""),"".concat(e).concat(t)},e.prototype._generateShardPostfixArray=function(e){return void 0===e&&(e=1),(0,o.o)([],(0,o.p)(Array(e).keys()),!1)},e.prototype._shardify=function(e){var t=this,n=e.key,r=e.value,i=JSON.stringify(this.encryption.encrypt(r)),o=Math.ceil(i.length/this.adjustedItemSizeLimit);return this._generateShardPostfixArray(o).map((function(e){var r={key:t._getRawKey(n,".".concat(e)),data:i.substring(e*t.adjustedItemSizeLimit,(e+1)*t.adjustedItemSizeLimit)};return 0===e&&(r.metadata={shards:o}),r}))},e.prototype._resetIfEncryptionChanged=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u,c,l=this;return(0,o.b)(this,(function(o){switch(o.label){case 0:return[4,this.get(this._encryptionCheckKey)];case 1:if(e=o.sent(),t={encrypted:Or.map((function(e){var t;return null===(t=l.encryption)||void 0===t?void 0:t.encrypt(e)}))},!(e&&e.encrypted&&Array.isArray(e.encrypted)))return[3,6];for(i in n=e.encrypted,r=[],n)r.push(i);s=0,o.label=2;case 2:return s<r.length?(i=r[s])in n?(a=i,u=JSON.stringify(e.encrypted[a]),c=JSON.stringify(t.encrypted[a]),u===c?[3,4]:(xr.warning("Encryption algorithm has changed. Stored data would be cleared."),[4,this.clear()])):[3,4]:[3,5];case 3:return o.sent(),[3,5];case 4:return s++,[3,2];case 5:return[3,8];case 6:return[4,this.clear()];case 7:o.sent(),o.label=8;case 8:return[4,this.set({key:this._encryptionCheckKey,value:t})];case 9:return o.sent(),[2]}}))}))},Object.defineProperty(e.prototype,"adjustedItemSizeLimit",{get:function(){return Math.max(this.itemSizeLimit-this.metadataBuffer,4)},enumerable:!1,configurable:!0}),e.prototype.usage=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return e=0,[4,this._getAllRawKeys()];case 1:t=l.sent(),l.label=2;case 2:l.trys.push([2,7,8,9]),n=(0,o.s)(t),r=n.next(),l.label=3;case 3:return r.done?[3,6]:(i=r.value,[4,this._getRaw(i)]);case 4:(s=l.sent())&&(e+=JSON.stringify(s).length),l.label=5;case 5:return r=n.next(),[3,3];case 6:return[3,9];case 7:return a=l.sent(),u={error:a},[3,9];case 8:try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(u)throw u.error}return[7];case 9:return[2,e]}}))}))},e.prototype.getAllKeys=function(){return(0,o._)(this,void 0,void 0,(function(){var e=this;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._getAllRawKeys()];case 1:return[2,t.sent().filter((function(e){return e.endsWith(".0")})).map((function(e){return e.replace(/\.0$/,"")})).filter((function(t){return!e._reservedKeys.includes(t)}))]}}))}))},e.prototype.get=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u=this;return(0,o.b)(this,(function(c){switch(c.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:if(!(n=c.sent()))return[3,7];c.label=2;case 2:return c.trys.push([2,6,,7]),r=n.data,(null==(i=n.metadata)?void 0:i.shards)&&i.shards>1?[4,Promise.all(this._generateShardPostfixArray(null==i?void 0:i.shards).map((function(t){return(0,o._)(u,void 0,void 0,(function(){var n,i;return(0,o.b)(this,(function(o){switch(o.label){case 0:return t>0?(n=this._getRawKey(e,".".concat(t)),[4,this._getRaw(n)]):[3,2];case 1:if(!(i=o.sent()))throw Bn.storeBrokenIntegrity;return[2,i.data];case 2:return[2,r]}}))}))})))]:[3,4];case 3:return a=c.sent(),[3,5];case 4:a=[r],c.label=5;case 5:return s=a,[2,this.encryption.decrypt(JSON.parse(s.join("")))];case 6:return c.sent(),[2,null];case 7:return[2,null]}}))}))},e.prototype.set=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return t=this._shardify(e),[4,this._setRaw(t)];case 1:return n.sent(),[2,(0,o.g)({},e.value)]}}))}))},e.prototype.setMany=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n=this;return(0,o.b)(this,(function(r){switch(r.label){case 0:return t=[],[4,this._setRaw(t.concat.apply(t,(0,o.o)([],(0,o.p)(e.map((function(e){return n._shardify(e)}))),!1)))];case 1:return r.sent(),[2,e.map((function(e){return e.value}))]}}))}))},e.prototype.remove=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i=this;return(0,o.b)(this,(function(o){switch(o.label){case 0:return t=this._getRawKey(e,".0"),[4,this._getRaw(t)];case 1:return(n=o.sent())?(r=n.metadata,[4,this._removeRaw(this._generateShardPostfixArray(null==r?void 0:r.shards).map((function(t){return i._getRawKey(e,".".concat(t))})))]):[3,3];case 2:return o.sent(),[2,!0];case 3:return[2,!1]}}))}))},e.prototype.removeMany=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c,l,d=this;return(0,o.b)(this,(function(h){switch(h.label){case 0:t=[],n=function(e){var n,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return n=r._getRawKey(e,".0"),[4,r._getRaw(n)];case 1:return(i=a.sent())&&(s=i.metadata,t.push.apply(t,(0,o.o)([],(0,o.p)(r._generateShardPostfixArray(null==s?void 0:s.shards).map((function(t){return d._getRawKey(e,".".concat(t))}))),!1))),[2]}}))},r=this,h.label=1;case 1:h.trys.push([1,6,7,8]),i=(0,o.s)(e),s=i.next(),h.label=2;case 2:return s.done?[3,5]:(a=s.value,[5,n(a)]);case 3:h.sent(),h.label=4;case 4:return s=i.next(),[3,2];case 5:return[3,8];case 6:return u=h.sent(),c={error:u},[3,8];case 7:try{s&&!s.done&&(l=i.return)&&l.call(i)}finally{if(c)throw c.error}return[7];case 8:return t.length>0?[4,this._removeRaw(t)]:[3,10];case 9:h.sent(),h.label=10;case 10:return[2,e]}}))}))},e}(),Rr={},Dr=function(e){function t(t){void 0===t&&(t={});var n,r=this;r=e.call(this,(0,o.g)((0,o.g)({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:4194304}))||this;var i=t.delay,s=void 0===i?1:i;return r.delay=s,r.observer={},r}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"rawData",{get:function(){return Rr[this.dbname]},set:function(e){Rr[this.dbname]=e},enumerable:!1,configurable:!0}),t.prototype._getAllRawKeys=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){if(Rr[this.dbname])return[2,Object.keys(Rr[this.dbname])];throw Bn.storeNotAvailable}))}))},t.prototype._getRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return Rr[this.dbname]?[4,Qn(this.delay)]:[3,2];case 1:return t.sent(),[2,Rr[this.dbname][e]?(0,o.g)({key:e},Rr[this.dbname][e]):null];case 2:throw Bn.storeNotAvailable}}))}))},t.prototype._setRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u,c;return(0,o.b)(this,(function(l){switch(l.label){case 0:return Rr[this.dbname]?[4,Qn(this.delay)]:[3,2];case 1:l.sent();try{for(t=(0,o.s)(e),n=t.next();!n.done;n=t.next())r=n.value,i=r.key,s=r.data,a=r.metadata,Rr[this.dbname][i]=Object.freeze({data:s,metadata:a})}catch(e){u={error:e}}finally{try{n&&!n.done&&(c=t.return)&&c.call(t)}finally{if(u)throw u.error}}return[3,3];case 2:throw Bn.storeNotAvailable;case 3:return[2]}}))}))},t.prototype._removeRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s;return(0,o.b)(this,(function(a){switch(a.label){case 0:return Rr[this.dbname]?[4,Qn(this.delay)]:[3,2];case 1:a.sent();try{for(t=(0,o.s)(e),n=t.next();!n.done;n=t.next())r=n.value,Rr[this.dbname][r]&&delete Rr[this.dbname][r]}catch(e){i={error:e}}finally{try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(i)throw i.error}}return[3,3];case 2:throw Bn.storeNotAvailable;case 3:return[2]}}))}))},t.prototype.observe=function(e,t,n){var r=this;this.observer[e]||(this.observer[e]={}),t.forEach((function(t){return r.observer[e][t]=n}))},t.prototype.checkAvailability=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2]}))}))},t.prototype.init=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return this.dbname=e,Rr[this.dbname]||(Rr[this.dbname]={}),[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2]}}))}))},t.prototype.set=function(t){return(0,o._)(this,void 0,void 0,(function(){var n,r;return(0,o.b)(this,(function(i){if((n=this.observer[t.key])&&"function"==typeof n.set&&(r=n.set()))throw r;return[2,e.prototype.set.call(this,t)]}))}))},t.prototype.setMany=function(t){return(0,o._)(this,void 0,void 0,(function(){var n,r,i,s,a,u,c;return(0,o.b)(this,(function(l){try{for(n=(0,o.s)(t),r=n.next();!r.done;r=n.next())if(i=r.value,(s=this.observer[i.key])&&"function"==typeof s.set&&(a=s.set()))throw a}catch(e){u={error:e}}finally{try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(u)throw u.error}}return[2,e.prototype.setMany.call(this,t)]}))}))},t.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,Qn(this.delay)];case 1:return e.sent(),Rr[this.dbname]={},[2]}}))}))},t}(Mr),Ur="NestDBStore";!function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.OPENING=1]="OPENING",e[e.OPEN=2]="OPEN",e[e.CLOSED=3]="CLOSED"}(Tr||(Tr={}));var Lr,Pr=function(e){function t(t){void 0===t&&(t={});var n,r=this;return(r=e.call(this,(0,o.g)((0,o.g)({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:104857600}))||this)._storeName=Ur,r._state=Tr.UNINITIALIZED,r._openJobQueue=[],r._window="undefined"!=typeof window?window:void 0,r._indexedDb=r._window?r._window.indexedDB||r._window.mozIndexedDB||r._window.webkitIndexedDB||r._window.msIndexedDB:void 0,r}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype._openDatabase=function(e){var t=this;return new Promise((function(n,r){if(t._indexedDb){t._state=Tr.OPENING;var i=t._indexedDb.open(e);i.addEventListener("upgradeneeded",(function(e){e.target.result.createObjectStore(Ur,{keyPath:"key"})})),i.addEventListener("success",(function(r){t._state=Tr.OPEN,t._database=r.target.result,t._openJobQueue.forEach((function(e){return e()})),t._openJobQueue=[],t._database.onclose=function(){t._database=void 0,t._state=Tr.OPENING,setTimeout((function(){t._openDatabase(e)}),5)},n(t._database)})),i.addEventListener("error",(function(e){t._state=Tr.UNINITIALIZED,r(e.target.error)}))}else r(Bn.storeNotAvailable)}))},t.prototype._getObjectStore=function(e){return(0,o._)(this,void 0,void 0,(function(){var t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this._database?[2,this._database.transaction(this._storeName,e).objectStore(this._storeName)]:[3,1];case 1:switch(this._state){case Tr.UNINITIALIZED:case Tr.OPEN:return[3,2];case Tr.OPENING:case Tr.CLOSED:return[3,3]}return[3,4];case 2:throw Bn.storeNotInitialized;case 3:return[2,new Promise((function(n){t._openJobQueue.push((function(){return n(t._getObjectStore(e))}))}))];case 4:return[4,this._getObjectStore(e)];case 5:return[2,n.sent()]}}))}))},t.prototype._getAllRawKeys=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return e=t.sent(),[4,new Promise((function(t,n){var r=e.getAllKeys();r.addEventListener("success",(function(e){t(e.target.result)})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 2:return[2,t.sent()]}}))}))},t.prototype._getRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._getObjectStore("readonly")];case 1:return t=n.sent(),[4,new Promise((function(n,r){var i=t.get(e);i.addEventListener("success",(function(e){var t;n(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.result)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))];case 2:return[2,n.sent()]}}))}))},t.prototype._setRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:return t=n.sent(),[4,Promise.all(e.map((function(e){return new Promise((function(n,r){var i=t.put(e);i.addEventListener("success",(function(e){n(e.target.result)})),i.addEventListener("error",(function(){r("Failed to write.")}))}))})))];case 2:return n.sent(),[2]}}))}))},t.prototype._removeRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:return t=n.sent(),[4,Promise.all(e.map((function(e){return new Promise((function(n,r){var i=t.delete(e);i.addEventListener("success",(function(){return n(e)})),i.addEventListener("error",(function(e){return r(e.target.error)}))}))})))];case 2:return n.sent(),[2]}}))}))},t.prototype._triggerDatabaseClose=function(){this._database&&this._database.onclose&&this._database.onclose(new Event("dummy"))},t.prototype.checkAvailability=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:if(!((null==(e="undefined"!=typeof window?window:null)?void 0:e.indexedDB)||(null==e?void 0:e.mozIndexedDB)||(null==e?void 0:e.webkitIndexedDB)||(null==e?void 0:e.msIndexedDB)))return[3,6];if(this._indexedDb=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,!this._window||!wr())return[3,4];if(!(wr()&&navigator.userAgent&&navigator.userAgent.includes("Edge/")))return[3,1];if(!this._window.indexedDB&&(e.PointerEvent||e.MSPointerEvent))throw Bn.storeNotAvailableInPrivateBrowsing;return[3,3];case 1:return[4,new Promise((function(e,n){if(t._indexedDb)try{var r=t._indexedDb.open("_testMozilla");r.onerror=function(){return n(Bn.storeNotAvailableInPrivateBrowsing)},r.onsuccess=function(r){if(r.target.result.close(),t._indexedDb){var i=t._indexedDb.deleteDatabase("_testMozilla");i.onerror=function(){return e()},i.onsuccess=function(){return e()}}else n(Bn.storeNotAvailable)}}catch(e){n(Bn.storeNotAvailableInPrivateBrowsing)}else n(Bn.storeNotAvailable)}))];case 2:n.sent(),n.label=3;case 3:return[3,5];case 4:throw Bn.storeNotAvailable;case 5:return[3,7];case 6:throw Bn.storeNotAvailable;case 7:return[2]}}))}))},t.prototype.init=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return this.dbname=e,[4,this.checkAvailability()];case 1:return t.sent(),[4,this._openDatabase(e)];case 2:return t.sent(),[4,this._resetIfEncryptionChanged()];case 3:return t.sent(),[2]}}))}))},t.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._getObjectStore("readwrite")];case 1:return e=t.sent(),[4,new Promise((function(t,n){var r=e.clear();r.addEventListener("success",(function(){return t()})),r.addEventListener("error",(function(e){return n(e.target.error)}))}))];case 2:return[2,t.sent()]}}))}))},t}(Mr),Fr=function(e){function t(t){var n=this,r=t.AsyncStorage,i=t.itemSizeLimit,s=void 0===i?6291456:i,a=(0,o.aK)(t,["AsyncStorage","itemSizeLimit"]);return(n=e.call(this,(0,o.g)((0,o.g)({},a),{itemSizeLimit:s}))||this)._asyncStorage=r,n}return(0,o.c)(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return(0,o._)(this,void 0,void 0,(function(){var e=this;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._asyncStorage.getAllKeys()];case 1:return[2,t.sent().filter((function(t){return e._isBelonging(t)})).map((function(t){return t.substring("".concat(e.dbname,"/").length)}))]}}))}))},t.prototype._getRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._asyncStorage.getItem(this._getActualKey(e))];case 1:return[2,(t=n.sent())?JSON.parse(t):null]}}))}))},t.prototype._setRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:t=[];try{for(n=(0,o.s)(e),r=n.next();!r.done;r=n.next())i=r.value,s=i.key,i.data.length<=this.adjustedItemSizeLimit&&t.push([this._getActualKey(s),JSON.stringify(i)])}catch(e){a={error:e}}finally{try{r&&!r.done&&(u=n.return)&&u.call(n)}finally{if(a)throw a.error}}return[4,this._asyncStorage.multiSet(t)];case 1:return c.sent(),[2]}}))}))},t.prototype._removeRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._asyncStorage.multiRemove(e.map((function(e){return t._getActualKey(e)})))];case 1:return n.sent(),[2]}}))}))},t.prototype.checkAvailability=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){if(!this._asyncStorage)throw Bn.storeNotAvailable;return[2]}))}))},t.prototype.init=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2]}}))}))},t.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[2]}}))}))},t}(Mr);!function(e){function t(t){var n,r=this;return(r=e.call(this,(0,o.g)((0,o.g)({},t),{itemSizeLimit:null!==(n=t.itemSizeLimit)&&void 0!==n?n:6291456}))||this)._mmkv=t.MMKV,r}(0,o.c)(t,e),t.prototype._isBelonging=function(e){return e.startsWith("".concat(this.dbname,"/"))},t.prototype._getActualKey=function(e){return"".concat(this.dbname,"/").concat(e)},t.prototype._getAllRawKeys=function(){return(0,o._)(this,void 0,void 0,(function(){var e=this;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._mmkv.getAllKeys()];case 1:return[2,t.sent().filter((function(t){return e._isBelonging(t)})).map((function(t){return t.substring("".concat(e.dbname,"/").length)}))]}}))}))},t.prototype._getRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this._mmkv.getString(this._getActualKey(e))];case 1:return[2,(t=n.sent())?JSON.parse(t):null]}}))}))},t.prototype._setRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){try{for(t=(0,o.s)(e),n=t.next();!n.done;n=t.next())r=n.value,i=r.key,r.data.length<=this.adjustedItemSizeLimit&&this._mmkv.set(this._getActualKey(i),JSON.stringify(r))}catch(e){s={error:e}}finally{try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}}return[2]}))}))},t.prototype._removeRaw=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s;return(0,o.b)(this,(function(a){try{for(t=(0,o.s)(e),n=t.next();!n.done;n=t.next())r=n.value,this._mmkv.delete(this._getActualKey(r))}catch(e){i={error:e}}finally{try{n&&!n.done&&(s=t.return)&&s.call(t)}finally{if(i)throw i.error}}return[2]}))}))},t.prototype.checkAvailability=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){if(!this._mmkv)throw Bn.storeNotAvailable;return[2]}))}))},t.prototype.init=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return this.dbname=e,[4,this._resetIfEncryptionChanged()];case 1:return t.sent(),[2]}}))}))},t.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){var e;return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this.getAllKeys()];case 1:return e=t.sent(),[4,this.removeMany(e)];case 2:return t.sent(),[2]}}))}))}}(Mr),function(e){e.INIT="INIT",e.OPENING="OPENING",e.OPENED="OPENED",e.CLOSED="CLOSED"}(Lr||(Lr={}));var jr,qr=function(){function e(e){var t=e.name,n=e.version,r=e.store,i=e.config;this.name=t,this._version=n,this._state=Lr.INIT,this._config=i||new Hn({dbname:t}),this._store=r,this._event={success:Yn,error:Yn,storeReplaced:Yn,upgrade:Jn},this._collections=new Map,this._globalMutex=new Sr("".concat(this.name,".lock")),this._config.disableLogger&&xr.off(),new vr({dbname:t,limit:this._config.cacheLimit})}return Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),e.prototype.estimateUsage=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,(t=this._store,(0,o._)(void 0,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,t.usage()];case 1:return[2,e.sent()]}}))})))];case 1:return[2,e.sent()]}var t}))}))},e.prototype.commitSchema=function(e){return(0,o._)(this,void 0,void 0,(function(){var t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this._state!==Lr.OPENING?[3,2]:[4,Promise.all(e.map((function(e){return(0,o._)(t,void 0,void 0,(function(){var t,n,r,i,s;return(0,o.b)(this,(function(o){switch(o.label){case 0:return t=e.collectionName,n=e.keyName,r=e.index,i=void 0===r?[]:r,this._collections.has(t)||this._collections.set(t,new Ir({dbname:this.name,collectionName:t,keyName:n,indexes:i,store:this._store})),(s=this._collections.get(t))?[4,s.init()]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))})))];case 1:return n.sent(),[3,3];case 2:throw Bn.databaseSchemaNotOnUpgrade;case 3:return[2]}}))}))},e.prototype.open=function(){var e;return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s=this;return(0,o.b)(this,(function(a){switch(a.label){case 0:return[4,this._globalMutex.lock()];case 1:if(a.sent(),this._state===Lr.OPENED)return[3,12];this._state=Lr.OPENING,a.label=2;case 2:return a.trys.push([2,5,,12]),[4,this._store.init(this.name)];case 3:return a.sent(),u=this.name,t="".concat(sr(u),".metadata"),n={version:0,collectionNames:[]},[4,this._store.get(t)];case 4:return r=null!==(e=a.sent())&&void 0!==e?e:n,[2,new Promise((function(e,n){var i=function(e){r.version<s._version?s._event.upgrade(r.version,(function(n){return(0,o._)(s,void 0,void 0,(function(){var i;return(0,o.b)(this,(function(o){switch(o.label){case 0:if(n)return[3,5];r.version++,r.collectionNames=Array.from(this._collections.keys()),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._store.set({key:t,value:r})];case 2:return o.sent(),e({continued:!0}),[3,4];case 3:return i=o.sent(),e({continued:!1,err:i}),[3,4];case 4:return[3,6];case 5:e({continued:!1,err:n}),o.label=6;case 6:return[2]}}))}))})):e({continued:!1})},a=function(t){var u=t.continued,c=void 0!==u&&u,l=t.err,d=void 0===l?null:l;if(c)setTimeout((function(){return i(a)}),10);else if(d)xr.error(d.message),s._globalMutex.unlock(),s._event.error(d),n(d);else{var h=[];r.collectionNames.forEach((function(e){var t=s._collections.get(e);t&&t.state===Vn.READY||h.push((0,o._)(s,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return[4,Ir.metadataOf(this.name,e,this._store)];case 1:return(t=r.sent())?(n=new Ir({dbname:this.name,collectionName:e,keyName:t.keyName,indexes:t.indexes,store:this._store}),this._collections.set(e,n),[4,n.init()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))})))})),Promise.all(h).then((function(){s._state=Lr.OPENED,s._globalMutex.unlock(),s._event.success(),e()})).catch((function(e){xr.error(e.message),s._globalMutex.unlock(),s._event.error(e),n(e)}))}};i(a)}))];case 5:switch((i=a.sent()).code){case Sn.STORE_NOT_AVAILABLE_IN_PRIVATE_BROWSING:return[3,6];case Sn.STORE_NOT_AVAILABLE:return[3,8]}return[3,10];case 6:return xr.warning("Access to the local storage is not allowed. Switched to MemoryStore automatically."),this._store=new Dr({}),this._globalMutex.unlock(),this._event.error(i),this._event.storeReplaced(this._store),[4,this.open()];case 7:return a.sent(),[3,11];case 8:return xr.warning("IndexedDB is not available in this environment. Switched to MemoryStore automatically. Consider using other store to save data persistently (e.g. AsyncStorage)."),this._store=new Dr({}),this._globalMutex.unlock(),this._event.error(i),this._event.storeReplaced(this._store),[4,this.open()];case 9:return a.sent(),[3,11];case 10:throw xr.error(i.message),this._globalMutex.unlock(),this._event.error(i),i;case 11:return[3,12];case 12:return[2]}var u}))}))},e.prototype.close=function(){this._collections.forEach((function(e){return e.close()})),this._state=Lr.CLOSED},e.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,Promise.all(Array.from(this._collections.values()).map((function(e){return e.clear()})))];case 1:return e.sent(),[2]}}))}))},e.prototype.reset=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.close(),(e=vr.get(this.name))&&e.clearByCondition((function(e){return e.key.startsWith(sr(t.name))})),[4,this._store.clear()];case 1:return n.sent(),[2]}}))}))},e.prototype.on=function(e,t){this._event[e]=t},e.prototype.off=function(e){"function"==typeof this._event[e]&&(this._event[e]="upgrade"===e?Jn:Yn)},e.prototype.collection=function(e){var t=this._collections.get(e);if(t)return t;throw Bn.collectionNotReady},e}(),Hr=function(){function e(e){var t,n,r,i;this.messageTypeFilter=null!==(t=null==e?void 0:e.messageTypeFilter)&&void 0!==t?t:o.al.ALL,this.customTypesFilter=null!==(n=null==e?void 0:e.customTypesFilter)&&void 0!==n?n:null,this.senderUserIdsFilter=null!==(r=null==e?void 0:e.senderUserIdsFilter)&&void 0!==r?r:null,this.replyType=null!==(i=null==e?void 0:e.replyType)&&void 0!==i?i:o.at.NONE}return e.prototype.clone=function(){var t=new e,n=JSON.parse(JSON.stringify(this));return Object.keys(n).forEach((function(e){t[e]=n[e]})),t},e.prototype.match=function(e){switch(this.messageTypeFilter){case o.al.USER:if(e.messageType!==o.ac.USER)return!1;break;case o.al.FILE:if(e.messageType!==o.ac.FILE)return!1;break;case o.al.ADMIN:if(e.messageType!==o.ac.ADMIN)return!1}if(this.customTypesFilter&&this.customTypesFilter.length>0&&!this.customTypesFilter.includes("*")&&!this.customTypesFilter.includes(e.customType))return!1;if(this.senderUserIdsFilter&&this.senderUserIdsFilter.length>0){if(!(e instanceof D))return!1;if(!this.senderUserIdsFilter.includes(e.sender.userId))return!1}if(e instanceof R)switch(this.replyType){case o.at.NONE:if(e.parentMessageId>0)return!1;break;case o.at.ONLY_REPLY_TO_CHANNEL:if(e instanceof D&&e.parentMessageId>0&&!e.replyToChannel)return!1}return!0},e}();!function(e){e.CHANNEL_LATEST="channel_latest",e.NEWEST_CHILD_MESSAGE="newest_child_message"}(jr||(jr={}));var Vr,Br=function(e){switch(e){case jr.CHANNEL_LATEST:return["channelUrl","-createdAt","-messageId"];case jr.NEWEST_CHILD_MESSAGE:return["channelUrl","-parentMessageId","-createdAt","-messageId"]}},zr=function(){return["channelUrl","-createdAt","-notificationId"]},Gr=(0,o.g)((0,o.g)({},Ee),{scheduledAt:void 0}),Wr=function(e){return Ae(e)&&(0,o.a)("number",e.scheduledAt,!0)},Kr=(0,o.g)((0,o.g)({},ge),{scheduledAt:0,file:void 0,fileUrl:void 0,fileName:void 0,mimeType:void 0,fileSize:void 0,thumbnailSizes:void 0,requireAuth:!1}),Qr=function(e){return ye(e)&&(0,o.a)("number",e.scheduledAt)&&((0,o.i)(e.file)||(0,o.a)("string",e.fileUrl))&&(0,o.a)("string",e.fileName,!0)&&(0,o.a)("string",e.mimeType,!0)&&(0,o.a)("number",e.fileSize,!0)&&(null===e.thumbnailSizes||void 0===e.thumbnailSizes||e.thumbnailSizes.every((function(e){return(0,o.a)("object",e)&&e.maxWidth>0&&e.maxHeight>0})))},Zr="UnsentMessage",Yr="reqId",$r={},Xr=function(e){function t(t){var n=e.call(this,t)||this;return n._mutex=new Sr("unsendmessagecache.lock"),$r[t]=n,n}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return o.V.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),$r[e]&&!n||($r[e]=new t(e)),$r[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb,t=null==e?void 0:e.collection(Zr);if(!t)throw o.r.databaseError;return t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){if(e.messageId>0)throw o.r.invalidParameters;var t,n=(0,o.g)({},e.serialize());return e instanceof q?(e.messageParams&&(n.messageParams=be(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(n.scheduledInfo.scheduledMessageParams=(t=e.scheduledInfo.scheduledMessageParams,(0,o.g)((0,o.g)({},be(t)),{scheduledAt:t.scheduledAt})))):e instanceof K?(e.messageParams&&(n.messageParams=Ne(e.messageParams)),e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(n.scheduledInfo.scheduledMessageParams=function(e){return(0,o.g)((0,o.g)({},Ne(e)),{scheduledAt:e.scheduledAt})}(e.scheduledInfo.scheduledMessageParams))):e instanceof V&&e.messageParams&&(n.messageParams=function(e){return(0,o.e)({fileInfoList:e.fileInfoList,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption})}(e.messageParams)),n},t.prototype._deserialize=function(e){return e=(0,o.g)((0,o.g)({},e),{messageId:parseInt(e.messageId)}),si.of(this._iid).buildMessageFromSerializedData(e)},t.prototype._deserializeWithMessageCreateParams=function(e){var t,n,r;return(0,o._)(this,void 0,void 0,(function(){var i,s,a,u,c,l,d=this;return(0,o.b)(this,(function(h){switch(h.label){case 0:return i=si.of(this._iid),s=this._deserialize(e),e.messageParams?s instanceof q?(u=e.messageParams,s.messageParams=i.buildUserMessageCreateParamsFromSerializedData(u,s),[3,6]):[3,1]:[3,6];case 1:return s instanceof K?(u=e.messageParams).fileKey&&"string"==typeof u.fileKey&&Ie(null!==(t=u.fileType)&&void 0!==t?t:"")?(a=u,[4,this.collection.getBlob(u.fileKey)]):[3,3]:[3,4];case 2:a.file=null!==(n=h.sent())&&void 0!==n?n:void 0,h.label=3;case 3:return s.messageParams=i.buildFileMessageCreateParamsFromSerializedData(u,s),[3,6];case 4:return s instanceof V&&(u=e.messageParams)&&u.fileInfoList?(s.messageParams=i.buildMultipleFilesMessageCreateParamsFromSerializedData(u,s),[4,Promise.all(s.messageParams.fileInfoList.map((function(e){return(0,o._)(d,void 0,void 0,(function(){var t,n,r,i,s;return(0,o.b)(this,(function(o){switch(o.label){case 0:return"string"==typeof(null===(n=e._uploadedMetaData)||void 0===n?void 0:n.fileKey)&&Ie(null!==(i=null===(r=e._uploadedMetaData)||void 0===r?void 0:r.fileType)&&void 0!==i?i:"")?(t=e,[4,this.collection.getBlob(e._uploadedMetaData.fileKey)]):[3,2];case 1:t.file=null!==(s=o.sent())&&void 0!==s?s:void 0,o.label=2;case 2:return[2]}}))}))})))]):[3,6];case 5:h.sent(),h.label=6;case 6:return s.scheduledInfo&&e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams?s instanceof q?(c=e.scheduledInfo.scheduledMessageParams,s.scheduledInfo.scheduledMessageParams=i.buildScheduledUserMessageCreateParamsFromSerializedData(c,s),[3,10]):[3,7]:[3,10];case 7:return s instanceof K?(c=e.scheduledInfo.scheduledMessageParams).fileKey&&"string"==typeof c.fileKey&&"string"==typeof c.fileType&&Ie(c.fileType)?(l=c,[4,this.collection.getBlob(c.fileKey)]):[3,9]:[3,10];case 8:l.file=null!==(r=h.sent())&&void 0!==r?r:void 0,h.label=9;case 9:s.scheduledInfo.scheduledMessageParams=i.buildScheduledFileMessageCreateParamsFromSerializedData(c,s),h.label=10;case 10:return[2,s]}}))}))},t.prototype._getFileInfoBlobKey=function(e,t){return"".concat(e,".").concat(t)},t.prototype.get=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return[2,this._deserializeWithMessageCreateParams(t)];n.label=2;case 2:return[2,void 0]}}))}))},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.filter,r=void 0===n?new Hr:n,i=e.order,s=void 0===i?jr.CHANNEL_LATEST:i,a=e.sendingStatus,u=e.backward,c=void 0!==u&&u,l=e.parentMessageId;return(0,o._)(this,void 0,void 0,(function(){var e,n,i,u,d=this;return(0,o.b)(this,(function(h){switch(h.label){case 0:return this.localCacheEnabled?(e=Br(s),n={"/where":function(e){return!!(s!==jr.NEWEST_CHILD_MESSAGE||l&&0!==e.parentMessageId&&e.parentMessageId===l)&&r.match(d._deserialize(e))}},t&&(n.channelUrl=t),a&&(n.sendingStatus=a),i={where:n,index:e,backward:c},[4,this.collection.query(i)]):[3,3];case 1:return[4,h.sent().fetch({})];case 2:return u=h.sent(),[2,Promise.all(u.map((function(e){return(0,o._)(d,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return[4,this._deserializeWithMessageCreateParams(e)];case 1:return[2,t.sent()]}}))}))})))];case 3:return[2,[]]}}))}))},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new Hr),(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this.fetch({filter:t,order:jr.NEWEST_CHILD_MESSAGE,channelUrl:e.channelUrl,backward:!1,parentMessageId:e.messageId})];case 1:return[2,n.sent()]}}))}))},t.prototype.upsert=function(e){return(0,o._)(this,void 0,void 0,(function(){var t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map((function(e){return(0,o._)(t,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return e instanceof K||e instanceof V?[4,this._mutex.lock()]:[3,4];case 1:return n.sent(),[4,this.saveBlob(e)];case 2:return n.sent(),[4,this._mutex.unlock()];case 3:n.sent(),n.label=4;case 4:return t=this._serialize(e),[4,this.collection.upsertOne(t)];case 5:return n.sent(),[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.upsertChildMessages=function(e){return(0,o._)(this,void 0,void 0,(function(){var t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map((function(e){return(0,o._)(t,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return t=[],e.threadInfo&&e.threadInfo.replyCount>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=n.sent(),n.label=2;case 2:return t.length>0?(t.forEach((function(t){return t.applyParentMessage(e)})),[4,this.upsert(t)]):[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:if(!this.localCacheEnabled)return[3,8];u.label=1;case 1:u.trys.push([1,6,7,8]),t=(0,o.s)(e),n=t.next(),u.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove(r)]);case 3:u.sent(),u.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return i=u.sent(),s={error:i},[3,8];case 7:try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},t.prototype.removeMessagesOfChannel=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(t){switch(t.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e}})]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.saveBlob=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i=this;return(0,o.b)(this,(function(s){switch(s.label){case 0:return e instanceof K?e.messageParams&&(r=e.messageParams).file&&Se(r.file)?[4,this.collection.saveBlob(r.file,e.reqId)]:[3,2]:[3,5];case 1:n=s.sent(),r.fileKey=n,r.fileType=Ce.BLOB,s.label=2;case 2:return e.scheduledInfo&&e.scheduledInfo.scheduledMessageParams&&(t=e.scheduledInfo.scheduledMessageParams).file&&Se(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,4];case 3:n=s.sent(),t.fileKey=n,t.fileType=Ce.BLOB,s.label=4;case 4:return[3,7];case 5:return e instanceof V&&(r=e.messageParams)&&r.fileInfoList&&Array.isArray(r.fileInfoList)?[4,Promise.all(r.fileInfoList.map((function(t,n){return(0,o._)(i,void 0,void 0,(function(){var r;return(0,o.b)(this,(function(i){switch(i.label){case 0:return t.file&&Se(t.file)?[4,this.collection.saveBlob(t.file,this._getFileInfoBlobKey(e.reqId,n))]:[3,2];case 1:r=i.sent(),t._uploadedMetaData||(t._uploadedMetaData={}),t._uploadedMetaData.fileKey=r,t._uploadedMetaData.fileType=Ce.BLOB,i.label=2;case 2:return[2]}}))}))})))]:[3,7];case 6:s.sent(),s.label=7;case 7:return[2]}}))}))},t}(o.aa),Jr={},ei=function(e){function t(t){var n=e.call(this,t)||this;return Jr[t]=n,n}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return o.V.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return o.V.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return Xr.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),Jr[e]&&!n||(Jr[e]=new t(e)),Jr[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return(0,o.t)(!!e).throw(o.r.databaseError),e.collection(fn)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return(0,o.g)((0,o.g)({},e.serialize()),{messageId:"".concat(e.messageId)})},t.prototype._deserialize=function(e){return e=(0,o.g)((0,o.g)({},e),{messageId:parseInt(e.messageId)}),si.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey("".concat(e))]:[3,2];case 1:if(t=n.sent())return[2,this._deserialize(t)];n.label=2;case 2:return[2,void 0]}}))}))},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.token,r=e.limit,i=void 0===r?100:r,s=e.filter,a=void 0===s?new Hr:s,u=e.order,c=void 0===u?jr.CHANNEL_LATEST:u,l=e.backward,d=void 0!==l&&l,h=e.parentMessageId,f=e.isPollOnly,p=void 0!==f&&f,_=e.exactMatch,v=void 0!==_&&_,m=e.inclusive,g=void 0===m||m;return(0,o._)(this,void 0,void 0,(function(){var e,r,s,u=this;return(0,o.b)(this,(function(l){switch(l.label){case 0:return this.localCacheEnabled?(e=Br(c),r={where:{channelUrl:t,"/where":function(e){if(n)switch(c){case jr.CHANNEL_LATEST:if(v&&e.createdAt!==n)return!1;if(d){if(g&&e.createdAt<n||!g&&e.createdAt<=n)return!1}else if(g&&e.createdAt>n||!g&&e.createdAt>=n)return!1;break;case jr.NEWEST_CHILD_MESSAGE:if(!h||0===e.parentMessageId||e.parentMessageId!==h)return!1}return!(p&&!e._poll)&&a.match(u._deserialize(e))}},index:e,backward:d},[4,this.collection.query(r)]):[3,3];case 1:return[4,l.sent().fetch({limit:null!=i?i:void 0})];case 2:return s=l.sent(),[2,Promise.all(s.map((function(e){return(0,o._)(u,void 0,void 0,(function(){return(0,o.b)(this,(function(t){return[2,this._deserialize(e)]}))}))})))];case 3:return[2,[]]}}))}))},t.prototype.getAllChildMessages=function(e,t){return void 0===t&&(t=new Hr),(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,this.fetch({channelUrl:e.channelUrl,token:Date.now(),limit:null,backward:!1,filter:t,order:jr.NEWEST_CHILD_MESSAGE,parentMessageId:e.messageId})];case 1:return[2,n.sent()]}}))}))},t.prototype.upsert=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n=this;return(0,o.b)(this,(function(r){switch(r.label){case 0:return this.localCacheEnabled?[4,this.saveBlobs(e)]:[3,5];case 1:return r.sent(),t=e.map((function(e){return n._serialize(e)})),[4,this.collection.upsertMany(t)];case 2:return r.sent(),[4,this.upsertChildMessages(e)];case 3:return r.sent(),[4,this._unsentMessageCache.upsertChildMessages(e)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))},t.prototype.upsertChildMessages=function(e){return(0,o._)(this,void 0,void 0,(function(){var t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,Promise.all(e.map((function(e){return(0,o._)(t,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return t=[],(null===(n=e.threadInfo)||void 0===n?void 0:n.replyCount)&&e.threadInfo.replyCount>0?[4,this.getAllChildMessages(e)]:[3,2];case 1:t=r.sent(),r.label=2;case 2:return t.length>0?(t.forEach((function(t){return t.applyParentMessage(e)})),[4,this.upsert(t)]):[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))})))]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:if(!this.localCacheEnabled)return[3,8];u.label=1;case 1:u.trys.push([1,6,7,8]),t=(0,o.s)(e),n=t.next(),u.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove("".concat(r))]);case 3:u.sent(),u.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return i=u.sent(),s={error:i},[3,8];case 7:try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},t.prototype.removeMessagesOfChannel=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:Br(jr.CHANNEL_LATEST)})]:[3,6];case 1:return n.sent(),[4,(t=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))},t.prototype.removeUnderOffset=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":t}},index:Br(jr.CHANNEL_LATEST)})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.countBetween=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i=this;return(0,o.b)(this,(function(o){switch(o.label){case 0:return this.localCacheEnabled?(r=Br(jr.CHANNEL_LATEST),[4,this.collection.query({where:{channelUrl:e,"/where":function(e){var r=i._deserialize(e);return n.includes(r.createdAt)&&t.match(r)}},index:r}).count()]):[3,2];case 1:return[2,o.sent()];case 2:return[2,0]}}))}))},t.prototype.saveBlobs=function(e){return(0,o._)(this,void 0,void 0,(function(){var t=this;return(0,o.b)(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return(0,o._)(t,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return e instanceof K&&e.messageParams&&(t=e.messageParams).file&&Se(t.file)?[4,this.collection.saveBlob(t.file,e.reqId)]:[3,2];case 1:n=r.sent(),t.fileKey=n,r.label=2;case 2:return[2]}}))}))})))];case 1:return n.sent(),[2]}}))}))},t.prototype._getGroupChannelPreferenceSize=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(o){switch(o.label){case 0:return t=0,[4,(n=this._cacheContext.preference).get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 1:return r=o.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 2:return i=o.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 3:return s=o.sent(),[4,n.get("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 4:return a=o.sent(),r&&(t+=JSON.stringify(r).length),i&&(t+=JSON.stringify(i).length),s&&(t+=JSON.stringify(s).length),a&&(t+=JSON.stringify(a).length),[2,t]}}))}))},t}(o.aa),ti={},ni=function(e){function t(t){var n=e.call(this,t)||this;return ti[t]=n,n}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"_sdkState",{get:function(){return o.V.of(this._iid).sdkState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return o.V.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),t.of=function(e,n){return void 0===n&&(n=!1),ti[e]&&!n||(ti[e]=new t(e)),ti[e]},Object.defineProperty(t.prototype,"collection",{get:function(){var e=this._cacheContext.nestdb;return(0,o.t)(!!e).throw(o.r.databaseError),e.collection(_n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localCacheEnabled",{get:function(){return this._cacheContext.localCacheEnabled&&!!this.collection},enumerable:!1,configurable:!0}),t.prototype._serialize=function(e){return(0,o.g)({},e.serialize())},t.prototype._deserialize=function(e){return si.of(this._iid).buildMessageFromSerializedData(e)},t.prototype.get=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.getByKey(e)]:[3,2];case 1:if(t=n.sent())return[2,this._deserialize(t)];n.label=2;case 2:return[2,void 0]}}))}))},t.prototype.fetch=function(e){var t=e.channelUrl,n=e.token,r=e.limit,i=void 0===r?100:r,s=e.filter,a=void 0===s?new Hr:s,u=e.backward,c=void 0!==u&&u,l=e.exactMatch,d=void 0!==l&&l,h=e.inclusive,f=void 0===h||h;return(0,o._)(this,void 0,void 0,(function(){var e,r=this;return(0,o.b)(this,(function(o){switch(o.label){case 0:return this.localCacheEnabled?(e={where:{channelUrl:t,"/where":function(e){if(n){if(d&&e.createdAt!==n)return!1;if(c){if(f&&e.createdAt<n||!f&&e.createdAt<=n)return!1}else if(f&&e.createdAt>n||!f&&e.createdAt>=n)return!1}return a.match(r._deserialize(e))}},index:["channelUrl","-createdAt","-notificationId"],backward:c},[4,this.collection.query(e)]):[3,3];case 1:return[4,o.sent().fetch({limit:null!=i?i:void 0})];case 2:return[2,o.sent().map((function(e){return r._deserialize(e)}))];case 3:return[2,[]]}}))}))},t.prototype.upsert=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n=this;return(0,o.b)(this,(function(r){switch(r.label){case 0:return this.localCacheEnabled?(t=e.map((function(e){return n._serialize(e)})),[4,this.collection.upsertMany(t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.remove=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n,r,i,s,a;return(0,o.b)(this,(function(u){switch(u.label){case 0:if(!this.localCacheEnabled)return[3,8];u.label=1;case 1:u.trys.push([1,6,7,8]),t=(0,o.s)(e),n=t.next(),u.label=2;case 2:return n.done?[3,5]:(r=n.value,[4,this.collection.remove(r)]);case 3:u.sent(),u.label=4;case 4:return n=t.next(),[3,2];case 5:return[3,8];case 6:return i=u.sent(),s={error:i},[3,8];case 7:try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}return[7];case 8:return[2]}}))}))},t.prototype.markAsReadByTimestamp=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,messageStatus:M.SENT,createdAt:{"<":t}}},{set:{messageStatus:M.READ}})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.markAsReadByMessageIds=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.updateIf({where:{channelUrl:e,notificationId:{"/in":t},messageStatus:M.SENT}},{set:{messageStatus:M.READ}})]:[3,2];case 1:return[2,n.sent().length];case 2:return[2,0]}}))}))},t.prototype.removeMessagesOfChannel=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e},index:["channelUrl","-createdAt","-notificationId"]})]:[3,6];case 1:return n.sent(),[4,(t=this._cacheContext.preference).remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync"))];case 2:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/sync.meta"))];case 3:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs"))];case 4:return n.sent(),[4,t.remove("sendbird:".concat(this._sdkState.userId,"@groupchannel/").concat(e,"/message/changelogs.meta"))];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))},t.prototype.removeUnderOffset=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(n){switch(n.label){case 0:return this.localCacheEnabled?[4,this.collection.removeIf({where:{channelUrl:e,createdAt:{"<":t}},index:Br(jr.CHANNEL_LATEST)})]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return this.localCacheEnabled?[4,this.collection.clear()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.countBetween=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){var r,i=this;return(0,o.b)(this,(function(o){switch(o.label){case 0:return this.localCacheEnabled?(r=["channelUrl","-createdAt","-notificationId"],[4,this.collection.query({where:{channelUrl:e,"/where":function(e){var r=i._deserialize(e);return n.includes(r.createdAt)&&t.match(r)}},index:r}).count()]):[3,2];case 1:return[2,o.sent()];case 2:return[2,0]}}))}))},t}(o.aa),ri={},ii=function(e){function t(t){var n=e.call(this,t)||this;return n._observers=new Map,n._dispatcherContext=n._dispatcher.on((function(e){return(0,o._)(n,void 0,void 0,(function(){var t,n,r,i,s,a,u,c,l,d,h,f,p,_,v,m,g,y,b,E=this;return(0,o.b)(this,(function(w){switch(w.label){case 0:return e instanceof o.ai?(t=e.messages,b=e.source,a=e.isWebSocketEventComing,n=t.filter((function(e){return e instanceof R&&e.channelType!==o.C.OPEN&&e.messageId>0})),r=t.filter((function(e){return e instanceof R&&e.channelType!==o.C.OPEN&&0===e.messageId})),i=t.filter((function(e){return e instanceof z})),n.length>0?[4,(0,o.z)((function(){return(0,o._)(E,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert(n)];case 1:return e.sent(),[4,this._unsentMessageCache.remove(n.map((function(e){return e instanceof D?e.reqId:null})).filter((function(e){return null!==e})))];case 2:return e.sent(),[2]}}))}))}))]:[3,2]):[3,7];case 1:w.sent(),a||this._broadcastUpdateEvent(n,b),w.label=2;case 2:return r.length>0?[4,(0,o.z)((function(){return(0,o._)(E,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._unsentMessageCache.upsert(r)];case 1:return e.sent(),[2]}}))}))}))]:[3,4];case 3:w.sent(),a||this._broadcastUpdateEvent(r,b),w.label=4;case 4:return i.length>0?[4,(0,o.z)((function(){return(0,o._)(E,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._notificationCache.upsert(i)];case 1:return e.sent(),[2]}}))}))}))]:[3,6];case 5:w.sent(),a||this._broadcastUpdateEvent(i,b),w.label=6;case 6:return[3,24];case 7:return e instanceof o.aQ?(s=e.messageIds,b=e.source,a=e.isWebSocketEventComing,u=s.filter((function(e){return"number"==typeof e})),c=s.filter((function(e){return"string"==typeof e})),[4,(0,o.z)((function(){return(0,o._)(E,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return u.length>0?[4,this._messageCache.remove(u)]:[3,2];case 1:e.sent(),e.label=2;case 2:return c.length>0?[4,this._notificationCache.remove(c)]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))}))]):[3,9];case 8:return w.sent(),a||this._broadcastRemoveEvent(s,b),[3,24];case 9:return e instanceof o.aP?(l=e.reqId,b=e.source,[4,(0,o.z)((function(){return(0,o._)(E,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._unsentMessageCache.remove([l])];case 1:return e.sent(),[2]}}))}))}))]):[3,11];case 10:return w.sent(),this._broadcastRemoveUnsentEvent(l,b),[3,24];case 11:return e instanceof o.aO?(d=e.polls,b=e.source,this._cacheContext.localCacheEnabled?(h=d.map((function(e){return e.messageId})),[4,Promise.all(h.map((function(e){return E._messageCache.get(e)})))]):[3,14]):[3,15];case 12:return(f=w.sent().filter((function(e){return e}))).length>0&&d.forEach((function(e){var t=f.find((function(t){return t.messageId===e.messageId}));t&&t.applyPoll(e)})),[4,(0,o.z)((function(){return(0,o._)(E,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert(f)];case 1:return[2,e.sent()]}}))}))}))];case 13:w.sent(),w.label=14;case 14:return this._broadcastPollChangeLogEvent(d,b),[3,24];case 15:return e instanceof o.aN?(p=e.event,b=e.source,[4,this._messageCache.get(p.messageId)]):[3,19];case 16:return(_=w.sent())&&_.isUserMessage()&&_.poll&&_.poll.applyPollUpdateEvent(p)?[4,(0,o.z)((function(){return(0,o._)(E,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert([_])];case 1:return[2,e.sent()]}}))}))}))]:[3,18];case 17:w.sent(),w.label=18;case 18:return this._broadcastPollUpdateEvent(p,b),[3,24];case 19:return e instanceof o.aG?(v=e.event,b=e.source,[4,this._messageCache.get(v.messageId)]):[3,23];case 20:return(m=w.sent())&&m.isUserMessage()&&m.poll&&m.poll.applyPollVoteEvent(v)?[4,(0,o.z)((function(){return(0,o._)(E,void 0,void 0,(function(){return(0,o.b)(this,(function(e){switch(e.label){case 0:return[4,this._messageCache.upsert([m])];case 1:return[2,e.sent()]}}))}))}))]:[3,22];case 21:w.sent(),w.label=22;case 22:return this._broadcastPollVoteEvent(v,b),[3,24];case 23:e instanceof o.aL?(g=e.event,b=e.source,g.messageId>0&&this._broadcastReactionUpdateEvent(g,b)):e instanceof o.aM&&(y=e.event,b=e.source,this._broadcastThreadUpdateEvent(y,b)),w.label=24;case 24:return[2]}}))}))})),n}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"_cacheContext",{get:function(){return o.V.of(this._iid).cacheContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_dispatcher",{get:function(){return o.V.of(this._iid).dispatcher},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_messageCache",{get:function(){return ei.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_unsentMessageCache",{get:function(){return Xr.of(this._iid)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_notificationCache",{get:function(){return ni.of(this._iid)},enumerable:!1,configurable:!0}),t.of=function(e,n){var r;return void 0===n&&(n=!1),ri[e]&&!n||(ri[e]&&(null===(r=ri[e]._dispatcherContext)||void 0===r||r.close()),ri[e]=new t(e)),ri[e]},t.prototype._broadcastUpdateEvent=function(e,t){var n,r;try{for(var i=(0,o.s)(this._observers.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.onUpdate&&a.onUpdate(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastPollChangeLogEvent=function(e,t){var n,r;try{for(var i=(0,o.s)(this._observers.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.onPollChangeLogUpdate&&a.onPollChangeLogUpdate(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastPollUpdateEvent=function(e,t){var n,r;try{for(var i=(0,o.s)(this._observers.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.onPollUpdate&&a.onPollUpdate(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastPollVoteEvent=function(e,t){var n,r;try{for(var i=(0,o.s)(this._observers.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.onPollVote&&a.onPollVote(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastRemoveEvent=function(e,t){var n,r;try{for(var i=(0,o.s)(this._observers.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.onRemove&&a.onRemove(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastRemoveUnsentEvent=function(e,t){var n,r;try{for(var i=(0,o.s)(this._observers.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.onRemoveUnsent&&a.onRemoveUnsent(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastReactionUpdateEvent=function(e,t){var n,r;try{for(var i=(0,o.s)(this._observers.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.onReactionUpdate&&a.onReactionUpdate(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype._broadcastThreadUpdateEvent=function(e,t){var n,r;try{for(var i=(0,o.s)(this._observers.values()),s=i.next();!s.done;s=i.next()){var a=s.value;a.onThreadInfoUpdate&&a.onThreadInfoUpdate(e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.subscribe=function(e,t){this._observers.set(e,t)},t.prototype.unsubscribe=function(e){this._observers.delete(e)},t.prototype.unsubscribeAll=function(){this._observers.clear()},t}(o.aa),oi={},si=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,o=t.onlineDetector,s=t.cacheContext;this._iid=e,this._sdkState=n,this._requestQueue=i,this._dispatcher=r,this._cacheContext=s,ei.of(e),Xr.of(e),ii.of(e),this.fileMessageQueue=new te(e,{sdkState:n,dispatcher:r,requestQueue:i,onlineDetector:o,cacheContext:s}),oi[e]=this}return e.of=function(e){return oi[e]},e.prototype.buildMessageFromSerializedData=function(e){var t=(0,o.y)(e);if(t.notificationId)return new z(this._iid,z.payloadify(t));switch(t.messageType){case o.ac.USER:return new q(this._iid,q.payloadify(t));case o.ac.FILE:return V._isMultipleFilesMessageSerializedData(t)?new V(this._iid,V.payloadify(t)):new K(this._iid,K.payloadify(t));case o.ac.ADMIN:return new P(this._iid,P.payloadify(t))}throw o.r.invalidParameters},e.prototype.buildUserMessageCreateParamsFromSerializedData=function(e,t){return(0,o.e)((0,o.u)({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,message:t.message,translationTargetLanguages:Object.keys(t.translations),pollId:e.pollId}))},e.prototype.buildFileMessageCreateParamsFromSerializedData=function(e,t){var n;return(0,o.e)((0,o.u)({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,file:e.file,fileKey:e.fileKey,fileUrl:t.plainUrl,fileName:t.name,fileSize:t.size,mimeType:t.type,thumbnailSizes:null===(n=t.thumbnails)||void 0===n?void 0:n.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),fileType:e.fileType,requireAuth:t.requireAuth}))},e.prototype.buildMultipleFilesMessageCreateParamsFromSerializedData=function(e,t){var n=this;return(0,o.e)({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,fileInfoList:e.fileInfoList.map((function(e){return new Q(n._iid,e)}))})},e.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(e,t){return(0,o.g)((0,o.g)({},this.buildUserMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(e,t){return(0,o.g)((0,o.g)({},this.buildFileMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildSenderFromSerializedData=function(e){var t=(0,o.y)(e);return new g(this._iid,g.payloadify(t))},e.prototype.getMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return t=new se(e),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(ae).message]}}))}))},e.prototype.getScheduledMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){switch(n.label){case 0:return t=new he(e),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(fe).message]}}))}))},e.prototype.getMessagesByMessageId=function(e,t,n,r,i){return void 0===i&&(i=o.Z.REQUEST_MESSAGE),(0,o._)(this,void 0,void 0,(function(){var s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return s=new ue((0,o.g)((0,o.g)({channelType:t,channelUrl:e,token:String(n)},ne),r)),[4,this._requestQueue.send(s)];case 1:return a=c.sent(),u=a.as(ce).messages,this._dispatcher.dispatch(new o.ai({messages:u,source:i})),[2,u]}}))}))},e.prototype.getMessagesByTimestamp=function(e,t,n,r,i){return void 0===i&&(i=o.Z.REQUEST_MESSAGE),(0,o._)(this,void 0,void 0,(function(){var s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return s=new ue((0,o.g)((0,o.g)({channelType:t,channelUrl:e,timestamp:n},ne),r)),[4,this._requestQueue.send(s)];case 1:return a=c.sent(),u=a.as(ce).messages,this._dispatcher.dispatch(new o.ai({messages:u,source:i})),[2,u]}}))}))},e.prototype._getMessagesByTimestampForCollection=function(e,t,n,r,i,s,a){return void 0===i&&(i=o.Z.REQUEST_MESSAGE),(0,o._)(this,void 0,void 0,(function(){var u,c,l,d,h,f;return(0,o.b)(this,(function(p){switch(p.label){case 0:return u=new ue((0,o.g)((0,o.g)((0,o.g)({channelType:t,channelUrl:e,timestamp:n},ne),r),{checkingHasNext:s,checkingContinuousMessages:a})),[4,this._requestQueue.send(u)];case 1:return c=p.sent(),l=c.as(ce),d=l.messages,h=l.isContinuousMessages,f=l.hasNext,this._dispatcher.dispatch(new o.ai({messages:d,source:i})),[2,{messages:d,isContinuousMessages:h,hasNext:f}]}}))}))},e.prototype.getThreadedMessagesByTimestamp=function(e,t,n,r){return void 0===r&&(r=o.Z.REQUEST_THREADED_MESSAGE),(0,o._)(this,void 0,void 0,(function(){var i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return i=new ue((0,o.g)((0,o.g)((0,o.g)({channelUrl:e.channelUrl,channelType:e.channelType,timestamp:t},U),n),{replyType:o.at.ALL,parentMessageId:e.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(i)];case 1:return s=c.sent(),a=s.as(ce).messages,(u=a.slice(1)).forEach((function(t){t.parentMessage=e})),this._dispatcher.dispatch(new o.ai({messages:u,source:r})),[2,{parentMessage:a[0],threadedMessages:u}]}}))}))},e.prototype.getMessageChangelogs=function(e,t,n,r,i){return void 0===i&&(i=o.Z.REQUEST_MESSAGE_CHANGELOGS),(0,o._)(this,void 0,void 0,(function(){var s,a,u,c,l,d,h,f;return(0,o.b)(this,(function(p){switch(p.label){case 0:return s=new le((0,o.e)((0,o.u)((0,o.g)((0,o.g)({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null},ie),r)))),[4,this._requestQueue.send(s)];case 1:return a=p.sent(),u=a.as(de),c=u.updatedMessages,l=u.deletedMessagesInfo,d=u.hasMore,h=u.nextToken,f=l.map((function(e){return e.messageId})),c.length>0&&this._dispatcher.dispatch(new o.ai({messages:c,source:i})),f.length>0&&this._dispatcher.dispatch(new o.aQ({messageIds:f,source:i})),[2,{updatedMessages:c,deletedMessageIds:f,hasMore:d,token:h}]}}))}))},e}(),ai=function(e){function t(t,n){var r=e.call(this,t)||this;r.targetMessageId=0;var i=n.thread_info,s=n.parent_message_id,a=n.channel_url,u=n.channel_type;return i&&(0,o.a)("object",i)&&(0,o.a)("number",s)&&(0,o.a)("string",a)&&(0,o.a)("string",u)&&(r.threadInfo=new c(t,i),r.targetMessageId=s,r.channelUrl=a,r.channelType=u),r}return(0,o.c)(t,e),t}(o.aa),ui={channelUrl:"",channelType:o.C.BASE,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},ci=function(e){function t(t){var n=t.channelCustomType,r=t.keyword,i=t.limit,s=t.reverse,a=t.exactMatch,u=t.channelUrl,c=t.order,l=t.messageTimestampFrom,d=t.messageTimestampTo,h=t.advancedQuery,f=t.targetFields,p=t.nextToken,_=e.call(this)||this;return _.method=o.A.GET,_.path="".concat(o.aR,"/messages"),_.params={custom_type:n,query:r,limit:i,reverse:s,exact_match:a,channel_url:u,message_ts_from:l,message_ts_to:d,sort_field:c,advanced_query:h,target_fields:f,after:p},_}return(0,o.c)(t,e),t}(o.f),li=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.messages=n.results.map((function(e){return W(t,e)})),r.hasNext=n.has_next,r.nextToken=n.end_cursor,r.totalCount=n.total_count,r}return(0,o.c)(t,e),t}(o.h);!function(e){e.SCORE="score",e.TIMESTAMP="ts"}(Vr||(Vr={}));var di=function(e){function t(t,n){var r,i,o,s,a,u,c,l,d,h=this;return(h=e.call(this,t,n)||this).keyword="",h.reverse=!1,h.exactMatch=!1,h.channelUrl="",h.channelCustomType="",h.messageTimestampFrom=null,h.messageTimestampTo=null,h.order=Vr.SCORE,h.advancedQuery=!1,h.targetFields=null,h._nextToken="",h.totalCount=-1,h.keyword=n.keyword,h.reverse=null!==(r=n.reverse)&&void 0!==r&&r,h.exactMatch=null!==(i=n.exactMatch)&&void 0!==i&&i,h.channelUrl=null!==(o=n.channelUrl)&&void 0!==o?o:"",h.channelCustomType=null!==(s=n.channelCustomType)&&void 0!==s?s:"",h.messageTimestampFrom=null!==(a=n.messageTimestampFrom)&&void 0!==a?a:null,h.messageTimestampTo=null!==(u=n.messageTimestampTo)&&void 0!==u?u:null,h.order=null!==(c=n.order)&&void 0!==c?c:Vr.SCORE,h.advancedQuery=null!==(l=n.advancedQuery)&&void 0!==l&&l,h.targetFields=null!==(d=n.targetFields)&&void 0!==d?d:null,h}return(0,o.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,o.a)("string",this.keyword)&&this.keyword.length>0&&(0,o.a)("boolean",this.reverse)&&(0,o.a)("boolean",this.exactMatch)&&(0,o.a)("string",this.channelUrl)&&(0,o.a)("string",this.channelCustomType)&&((0,o.a)("number",this.messageTimestampFrom)||null===this.messageTimestampFrom)&&((0,o.a)("number",this.messageTimestampTo)||null===this.messageTimestampTo)&&(0,o.T)(Vr,this.order)&&(0,o.a)("boolean",this.advancedQuery)&&(0,o.O)("string",this.targetFields,!0)},t.prototype.next=function(){return(0,o._)(this,void 0,void 0,(function(){var e,t,n,r,i,s,a,u;return(0,o.b)(this,(function(c){switch(c.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=o.V.of(this._iid).requestQueue,t=new ci((0,o.u)((0,o.g)((0,o.g)({},this),{nextToken:this._nextToken?this._nextToken:null}))),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=c.sent(),r=n.as(li),i=r.messages,s=r.hasNext,a=r.nextToken,u=r.totalCount,this._nextToken=a,this._hasNext=s,this._isLoading=!1,this.totalCount=u,[2,i];case 2:return[2,[]];case 3:throw o.r.queryInProgress;case 4:return[3,6];case 5:throw o.r.invalidParameters;case 6:return[2]}}))}))},t}(o.aI),hi={channelUrl:"",scheduledMessageId:0},fi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="message",t}return(0,o.c)(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,o=n.sessionManager,s=n.requestQueue,a=n.logger,u=n.onlineDetector,c=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:o,requestQueue:s,logger:a,onlineDetector:u,cacheContext:c}),this._manager=new si(t,{sdkState:r,dispatcher:i,requestQueue:s,onlineDetector:u,cacheContext:c})},t.prototype.buildMessageFromSerializedData=function(e){return this._manager.buildMessageFromSerializedData(e)},t.prototype.buildSenderFromSerializedData=function(e){return this._manager.buildSenderFromSerializedData(e)},t.prototype.getMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){var t,n;return(0,o.b)(this,(function(r){switch(r.label){case 0:return t=(0,o.g)((0,o.g)({},ui),e),(0,o.t)(function(e){return(0,o.a)("string",e.channelUrl)&&(0,o.T)(o.C,e.channelType)&&(0,o.a)("number",e.messageId)&&(0,o.a)("boolean",e.includeReactions,!0)&&(0,o.a)("boolean",e.includeMetaArray,!0)&&(0,o.a)("boolean",e.includeParentMessageInfo,!0)&&(0,o.a)("boolean",e.includeThreadInfo,!0)}(t)).throw(o.r.invalidParameters),[4,this._manager.getMessage(t)];case 1:if((n=r.sent())instanceof R||n instanceof z||null===n)return[2,n];throw"Unknown message type is given."}}))}))},t.prototype.getScheduledMessage=function(e){return(0,o._)(this,void 0,void 0,(function(){var t;return(0,o.b)(this,(function(n){return t=(0,o.g)((0,o.g)({},hi),e),(0,o.t)(function(e){return(0,o.a)("string",e.channelUrl)&&""!==e.channelUrl&&(0,o.a)("number",e.scheduledMessageId)&&e.scheduledMessageId>0}(t)).throw(o.r.invalidParameters),[2,this._manager.getScheduledMessage(t)]}))}))},t}(o.aS)},4445:function(e,t,n){n.d(t,{A:function(){return f},D:function(){return _},G:function(){return r},P:function(){return i},R:function(){return v},S:function(){return o},U:function(){return m},a:function(){return c},b:function(){return p},c:function(){return d},g:function(){return l}});var r,i,o,s,a=n(9851),u=n(8777);(s=r||(r={})).LATEST_LAST_MESSAGE="latest_last_message",s.CHRONOLOGICAL="chronological",s.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",s.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical",function(e){e.CHRONOLOGICAL="chronological",e.CHANNEL_NAME_ALPHABETICAL="channel_name_alphabetical",e.METADATA_VALUE_ALPHABETICAL="metadata_value_alphabetical"}(i||(i={})),function(e){e.CREATED_AT="created_at",e.SCHEDULED_AT="scheduled_at"}(o||(o={}));var c,l=function(e){switch(e){case r.LATEST_LAST_MESSAGE:return["-lastMessageUpdatedAt","-createdAt","syncIndex"];case r.CHRONOLOGICAL:return["-createdAt","syncIndex"];case r.CHANNEL_NAME_ALPHABETICAL:return["name"];default:return["-lastMessageUpdatedAt","-createdAt","syncIndex"]}},d=function(e){function t(t){var n=t.message,r=e.call(this)||this;return r.message=n,r}return(0,a.c)(t,e),t}(a.b0),h={},f=function(){function e(e,t){var n=t.localCacheEnabled,r=t.enableAutoResend,i=t.dispatcher,o=t.sdkState,s=t.logger,u=this;this._iid=e,h[e]=this,this._localCacheEnabled=n,this._enableAutoResend=r,this._isProcessingAutoResend=!1,this._autoResendQueue=[],this._dispatcher=i,this._logger=s,this._sdkState=o,this._localCacheEnabled&&i.on((function(e){if(e instanceof a.B)switch(e.stateType){case a.D.CONNECTED:u._isProcessingAutoResend||u.processAutoResendRegisteredPendingMessages().then((function(){return u._processNextAutoResend()}));break;case a.D.INTERNAL_DISCONNECTED:case a.D.EXTERNAL_DISCONNECTED:u._isProcessingAutoResend=!1}}))}return e.of=function(e){return h[e]},e.prototype.processNonAutoResendRegisteredPendingMessages=function(){return(0,a._)(this,void 0,void 0,(function(){var e,t,n,r,i,o;return(0,a.b)(this,(function(s){switch(s.label){case 0:return this._enableAutoResend?[4,this._fetchAllCachedPendingMessages()]:[2];case 1:e=s.sent();try{for(t=(0,a.s)(e),n=t.next();!n.done;n=t.next())0===(r=n.value).errorCode&&(this._logger.debug("cached pending message is not auto-resend registered. changing its sending status to failed: ",r.reqId),r.sendingStatus=a.aj.FAILED,r.errorCode=a.ah.ACK_TIMEOUT,this._dispatcher.dispatch(new a.ai({messages:[r],source:a.Z.LOCAL_MESSAGE_FAILED})))}catch(e){i={error:e}}finally{try{n&&!n.done&&(o=t.return)&&o.call(t)}finally{if(i)throw i.error}}return[2]}}))}))},e.prototype.processAutoResendRegisteredPendingMessages=function(){return(0,a._)(this,void 0,void 0,(function(){var e,t,n,r,i,o,s,u;return(0,a.b)(this,(function(c){switch(c.label){case 0:return[4,this._fetchAllCachedPendingMessages()];case 1:e=c.sent();try{for(t=(0,a.s)(e),n=t.next();!n.done;n=t.next())r=n.value,this._enableAutoResend&&r.errorCode&&(0,a.aF)(r.errorCode)&&(i=(new Date).getTime(),o=r.createdAt+2592e5,this._enableAutoResend&&i<=o?this._autoResendQueue.map((function(e){return e.reqId})).indexOf(r.reqId)<0&&this._autoResendQueue.push(r):(this._logger.debug("auto-resend registered pending messaged expired. expiration date: ",new Date(o).toLocaleString()),r.sendingStatus=a.aj.FAILED,this._dispatcher.dispatch(new a.ai({messages:[r],source:a.Z.LOCAL_MESSAGE_FAILED}))))}catch(e){s={error:e}}finally{try{n&&!n.done&&(u=t.return)&&u.call(t)}finally{if(s)throw s.error}}return[2]}}))}))},e.prototype.completeCurrentAndProcessNextAutoResend=function(e){if(this._localCacheEnabled&&this._enableAutoResend&&(e.sendingStatus===a.aj.SUCCEEDED||e.sendingStatus===a.aj.FAILED&&!(0,a.aF)(e.errorCode))){var t=this.indexOf(e);t>=0&&this._autoResendQueue.splice(t,1),0===t&&this._processNextAutoResend()}},e.prototype._fetchAllCachedPendingMessages=function(){return(0,a._)(this,void 0,void 0,(function(){var e,t;return(0,a.b)(this,(function(n){switch(n.label){case 0:return e=u.u.of(this._iid),(t=new u.H).replyType=a.at.ALL,[4,e.fetch({sendingStatus:a.aj.PENDING,backward:!0,filter:t})];case 1:return[2,n.sent()]}}))}))},e.prototype.indexOf=function(e){return this._autoResendQueue.length>0?this._autoResendQueue.map((function(e){return e.reqId})).indexOf(e.reqId):-1},e.prototype._isNotInQueue=function(e){return-1===this._autoResendQueue.map((function(e){return e.reqId})).indexOf(e.reqId)},e.prototype._processNextAutoResend=function(){return(0,a._)(this,void 0,void 0,(function(){var e;return(0,a.b)(this,(function(t){if(this._localCacheEnabled&&this._enableAutoResend&&"foreground"===this._sdkState.appState)try{this._autoResendQueue.length>0?(this._isProcessingAutoResend||(this._logger.debug("auto-resend queue started."),this._isProcessingAutoResend=!0),e=this._autoResendQueue[0],this._dispatcher.dispatch(new d({message:e})),this._logger.debug("processing auto-resend for message request id: ",e.reqId)):(this._logger.debug("auto-resend queue finished."),this._isProcessingAutoResend=!1)}catch(e){this._logger.warn("process auto-resend error: ",e),this._isProcessingAutoResend=!1}return[2]}))}))},e}();!function(e){e[e.USER_BLOCK=20001]="USER_BLOCK",e[e.USER_UNBLOCK=2e4]="USER_UNBLOCK",e[e.FRIEND_DISCOVERED=20900]="FRIEND_DISCOVERED"}(c||(c={}));var p=function(){function e(e){this.category=e.cat,this.data=e.data}return e.getDataAsUserBlockEvent=function(e,t){var n=t.data,r=n.blocker,i=n.blockee;return{blocker:new a.U(e,r),blockee:new a.U(e,i)}},e.getDataAsFriendDiscoveredEvent=function(e,t){var n=t.data.friend_discoveries;return{friendDiscoveries:Array.isArray(n)?n.map((function(t){return new a.U(e,t)})):[]}},e}(),_=function(e){function t(t,n){var r=n.userId,i=e.call(this)||this;return i._iid=t,i.userId=r,i}return(0,a.c)(t,e),t}(a.b0),v=function(e){function t(){return e.call(this)||this}return(0,a.c)(t,e),t}(a.b0),m=function(e){function t(t,n,r){var i=e.call(this,t,"USEV",r)||this;return i.event=new p(r),i}return(0,a.c)(t,e),t}(a.W)},3818:function(e,t,n){n.d(t,{B:function(){return i}});var r=n(9851),i=function(){this.onUserMuted=r.av,this.onUserUnmuted=r.av,this.onUserBanned=r.av,this.onUserUnbanned=r.av,this.onChannelChanged=r.av,this.onChannelDeleted=r.av,this.onChannelFrozen=r.av,this.onChannelUnfrozen=r.av,this.onOperatorUpdated=r.av,this.onChannelMemberCountChanged=r.av,this.onMetaDataCreated=r.av,this.onMetaDataUpdated=r.av,this.onMetaDataDeleted=r.av,this.onMetaCounterCreated=r.av,this.onMetaCounterUpdated=r.av,this.onMetaCounterDeleted=r.av,this.onMessageReceived=r.av,this.onMessageUpdated=r.av,this.onMessageDeleted=r.av,this.onMentionReceived=r.av,this.onReactionUpdated=r.av,this.onThreadInfoUpdated=r.av}},9345:function(e,t,n){n.r(t);var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{},i="URLSearchParams"in r,o="Symbol"in r&&"iterator"in Symbol,s="FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in r,u="ArrayBuffer"in r;if(u)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&c.indexOf(Object.prototype.toString.call(e))>-1};function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function h(e){return"string"!=typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function _(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function v(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=v(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:s&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:i&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():u&&s&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):u&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=_(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return _(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(s)return this.blob().then(m);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e,t,n,r,i,o=_(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,n=v(t=new FileReader),i=(r=/charset=([A-Za-z0-9_-]+)/.exec(e.type))?r[1]:"utf-8",t.readAsText(e,i),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}p.prototype.append=function(e,t){e=d(e),t=h(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},p.prototype.delete=function(e){delete this.map[d(e)]},p.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},p.prototype.set=function(e,t){this.map[d(e)]=h(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),f(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),f(e)},o&&(p.prototype[Symbol.iterator]=p.prototype.entries);var b=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function E(e,t){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,o=(t=t||{}).body;if(e instanceof E){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(i=(n=t.method||this.method||"GET").toUpperCase(),b.indexOf(i)>-1?i:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in r)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var s=/([?&])_=[^&]*/;s.test(this.url)?this.url=this.url.replace(s,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function C(e,t){if(!(this instanceof C))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},y.call(E.prototype),y.call(C.prototype),C.prototype.clone=function(){return new C(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},C.error=function(){var e=new C(null,{status:200,statusText:""});return e.status=0,e.type="error",e};var T=[301,302,303,307,308];C.redirect=function(e,t){if(-1===T.indexOf(t))throw new RangeError("Invalid status code");return new C(null,{status:t,headers:{location:e}})};var A=r.DOMException;try{new A}catch(r){(A=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),A.prototype.constructor=A}function S(e,t){return new Promise((function(n,i){var o=new E(e,t);if(o.signal&&o.signal.aborted)return i(new A("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}if(a.onload=function(){var e,t,r={statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e})).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();try{t.append(r,i)}catch(e){console.warn("Response "+e.message)}}})),t)};o.url.startsWith("file://")&&(a.status<200||a.status>599)?r.status=200:r.status=a.status,r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;setTimeout((function(){n(new C(i,r))}),0)},a.onerror=function(){setTimeout((function(){i(new TypeError("Network request failed"))}),0)},a.ontimeout=function(){setTimeout((function(){i(new TypeError("Network request timed out"))}),0)},a.onabort=function(){setTimeout((function(){i(new A("Aborted","AbortError"))}),0)},a.open(o.method,function(e){try{return""===e&&r.location.href?r.location.href:e}catch(t){return e}}(o.url),!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&(s?a.responseType="blob":u&&(a.responseType="arraybuffer")),t&&"object"==typeof t.headers&&!(t.headers instanceof p||r.Headers&&t.headers instanceof r.Headers)){var l=[];Object.getOwnPropertyNames(t.headers).forEach((function(e){l.push(d(e)),a.setRequestHeader(e,h(t.headers[e]))})),o.headers.forEach((function(e,t){-1===l.indexOf(t)&&a.setRequestHeader(t,e)}))}else o.headers.forEach((function(e,t){a.setRequestHeader(t,e)}));o.signal&&(o.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",c)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}S.polyfill=!0,r.fetch||(r.fetch=S,r.Headers=p,r.Request=E,r.Response=C),("undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{fetch:null}).fetch=S},2217:function(e,t,n){n.d(t,{A:function(){return h},B:function(){return d},C:function(){return c},M:function(){return v},O:function(){return l},P:function(){return m},R:function(){return p},T:function(){return _},U:function(){return f},a:function(){return r}});var r,i,o=n(9851),s=n(8777),a=function(e,t){this.pollId=0,this.messageId=0,this.pollId=t.poll.id,this.messageId=t.poll.message_id,this._iid=e,this._payload=t};(i=r||(r={}))[i.NONE=0]="NONE",i[i.CHANNEL_ENTER=10102]="CHANNEL_ENTER",i[i.CHANNEL_EXIT=10103]="CHANNEL_EXIT",i[i.USER_CHANNEL_MUTE=10201]="USER_CHANNEL_MUTE",i[i.USER_CHANNEL_UNMUTE=10200]="USER_CHANNEL_UNMUTE",i[i.USER_CHANNEL_BAN=10601]="USER_CHANNEL_BAN",i[i.USER_CHANNEL_UNBAN=10600]="USER_CHANNEL_UNBAN",i[i.CHANNEL_FREEZE=10701]="CHANNEL_FREEZE",i[i.CHANNEL_UNFREEZE=10700]="CHANNEL_UNFREEZE",i[i.TYPING_START=10900]="TYPING_START",i[i.TYPING_END=10901]="TYPING_END",i[i.CHANNEL_JOIN=1e4]="CHANNEL_JOIN",i[i.CHANNEL_LEAVE=10001]="CHANNEL_LEAVE",i[i.CHANNEL_OPERATOR_UPDATE=10002]="CHANNEL_OPERATOR_UPDATE",i[i.CHANNEL_INVITE=10020]="CHANNEL_INVITE",i[i.CHANNEL_ACCEPT_INVITE=10021]="CHANNEL_ACCEPT_INVITE",i[i.CHANNEL_DECLINE_INVITE=10022]="CHANNEL_DECLINE_INVITE",i[i.CHANNEL_PROP_CHANGED=11e3]="CHANNEL_PROP_CHANGED",i[i.CHANNEL_DELETED=12e3]="CHANNEL_DELETED",i[i.CHANNEL_META_DATA_CHANGED=11100]="CHANNEL_META_DATA_CHANGED",i[i.CHANNEL_META_COUNTERS_CHANGED=11200]="CHANNEL_META_COUNTERS_CHANGED",i[i.CHANNEL_HIDE=13e3]="CHANNEL_HIDE",i[i.CHANNEL_UNHIDE=13001]="CHANNEL_UNHIDE",i[i.PINNED_MESSAGE_CHANGED=11300]="PINNED_MESSAGE_CHANGED";var u=function(){function e(e){var t;this.channelUrl=e.channel_url,this.channelType=e.channel_type,this.category=e.cat,this.data=null!==(t=e.data)&&void 0!==t?t:{},this.ts=e.ts}return Object.defineProperty(e.prototype,"isGroupChannelEvent",{get:function(){return this.channelType===o.C.GROUP},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpenChannelEvent",{get:function(){return this.channelType===o.C.OPEN},enumerable:!1,configurable:!0}),e}(),c=function(e){function t(t,n,r){var i=e.call(this,t,"SYEV",r)||this;return i.event=new u(r),i}return(0,o.c)(t,e),t}(o.W),l=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this,s=r.data.operators,a=void 0===s?[]:s;return i.operators=a.map((function(e){return new o.U(i._iid,e)})),i}return(0,o.c)(t,e),t}(c),d=function(e){function t(t,n){var r=e.call(this,t)||this;return r._logger=n.logger,r._sdkState=n.sdkState,r._sessionManager=n.sessionManager,r._requestQueue=n.requestQueue,r._dispatcher=n.dispatcher,r._cacheContext=n.cacheContext,r._channelType=n.channelType,r}return(0,o.c)(t,e),Object.defineProperty(t.prototype,"_messageBroadcast",{get:function(){return s.aA.of(this._iid)},enumerable:!1,configurable:!0}),t.prototype.subscribeMessageEvent=function(e,t){this._messageBroadcast.subscribe(e,t)},t.prototype.unsubscribeMessageEvent=function(e){this._messageBroadcast.unsubscribe(e)},t.prototype.getMessageFromCache=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,null]}))}))},t.prototype.getExactlyMatchingMessagesForTokenFromCache=function(e,t,n){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,[]]}))}))},t.prototype.getMessagesFromCache=function(e,t,n,r,i,s){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,[]]}))}))},t.prototype.getPollMessagesFromCache=function(e,t,n,r){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,[]]}))}))},t.prototype.getCachedMessageCountBetween=function(e,t,n,r){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,0]}))}))},t.prototype.getUnsentMessagesFromCache=function(e,t){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2,[]]}))}))},t.prototype.removeFailedMessageFromCache=function(e){return(0,o._)(this,void 0,void 0,(function(){return(0,o.b)(this,(function(e){return[2]}))}))},t}(o.aa),h=function(e){function t(t,n,r){var i,a,u,c,l=this;(l=e.call(this,t,"ADMM",r)||this).message=new s.aB(t,r);var d=o.V.of(t).sdkState;return l.isMentioned=(0,o.ap)(l.message.mentionType,null!==(u=null!==(i=l.message.mentionedUserIds)&&void 0!==i?i:null===(a=l.message.mentionedUsers)||void 0===a?void 0:a.map((function(e){return e.userId})))&&void 0!==u?u:[],d.userId),l.forceUpdateLastMessage=null!==(c=r.force_update_last_message)&&void 0!==c&&c,l}return(0,o.c)(t,e),t}(o.W),f=function(e){function t(t,n,r){var i,a,u,c,l,d=this;(d=e.call(this,t,"AEDI",r)||this).message=new s.aB(t,r);var h=o.V.of(t).sdkState;return d.mentionCountChange=(0,o.az)({mentionType:null===(i=r.old_values)||void 0===i?void 0:i.mention_type,mentionedUserIds:null!==(u=null===(a=r.old_values)||void 0===a?void 0:a.mentioned_user_ids)&&void 0!==u?u:[]},(0,o.u)({mentionType:d.message.mentionType,mentionedUserIds:null!==(c=d.message.mentionedUserIds)&&void 0!==c?c:null===(l=d.message.mentionedUsers)||void 0===l?void 0:l.map((function(e){return e.userId}))}),h.userId),d}return(0,o.c)(t,e),t}(o.W),p=function(e){function t(t,n,r){var i=e.call(this,t,"MRCT",r)||this;return i.channelUrl=r.channel_url,i.channelType=r.channel_type,i.event=new s.aC(r),i}return(0,o.c)(t,e),t}(o.W),_=function(e){function t(t,n,r){var i=e.call(this,t,"MTHD",r)||this;return i.event=new s.aD(t,r),i}return(0,o.c)(t,e),t}(o.W),v=function(e){function t(t,n,r){var i=e.call(this,t,"MCNT",r)||this;return i.groupChannelMemberCounts=r.group_channels.map((function(e){return{channelUrl:e.channel_url,memberCount:e.member_count,joinedMemberCount:e.joined_member_count,updatedAt:e.ts}})),i.openChannelMemberCounts=r.open_channels.map((function(e){return{channelUrl:e.channel_url,participantCount:e.participant_count,updatedAt:e.ts}})),i}return(0,o.c)(t,e),t}(o.W),m=function(e){function t(t,n,r){var i=e.call(this,t,"PEDI",r)||this;return i.event=new a(t,r),i.status=(0,o.bd)(r.poll.status)||r.poll.status,i.channelUrl=r.channel_url,i.channelType=r.channel_type,i}return(0,o.c)(t,e),t}(o.W)},9851:function(e,t,n){n.d(t,{$:function(){return q},A:function(){return ae},B:function(){return _i},C:function(){return V},D:function(){return di},E:function(){return ne},F:function(){return Bi},G:function(){return fi},H:function(){return Fi},I:function(){return ji},J:function(){return bi},K:function(){return Re},L:function(){return H},M:function(){return Qe},N:function(){return b},O:function(){return N},P:function(){return m},Q:function(){return j},R:function(){return _},S:function(){return U},T:function(){return S},U:function(){return Pi},V:function(){return So},W:function(){return De},X:function(){return v},Y:function(){return g},Z:function(){return Co},_:function(){return a},a:function(){return A},a3:function(){return B},a9:function(){return le},aA:function(){return K},aB:function(){return qo},aC:function(){return ye},aD:function(){return Go},aE:function(){return Ci},aF:function(){return O},aG:function(){return Po},aH:function(){return as},aI:function(){return Bo},aJ:function(){return L},aK:function(){return s},aL:function(){return Mo},aM:function(){return Ro},aN:function(){return Lo},aO:function(){return Uo},aP:function(){return Do},aQ:function(){return Oo},aR:function(){return _e},aS:function(){return Io},aU:function(){return es},aV:function(){return ts},aW:function(){return is},aX:function(){return os},aY:function(){return ns},aZ:function(){return rs},aa:function(){return Ai},ab:function(){return T},ac:function(){return G},ad:function(){return Ri},ae:function(){return Q},af:function(){return Ce},ag:function(){return Te},ah:function(){return h},ai:function(){return xo},aj:function(){return $},ak:function(){return x},al:function(){return W},am:function(){return Vo},an:function(){return Y},ao:function(){return Ue},ap:function(){return Se},aq:function(){return $e},ar:function(){return Qi},as:function(){return Ye},at:function(){return Z},au:function(){return de},av:function(){return Je},aw:function(){return zo},ax:function(){return Ae},ay:function(){return ve},az:function(){return Ie},b:function(){return u},b0:function(){return ie},b1:function(){return go},b2:function(){return ke},b3:function(){return be},b5:function(){return z},b6:function(){return R},b7:function(){return he},b8:function(){return k},b9:function(){return Fo},ba:function(){return Ge},bb:function(){return ko},bc:function(){return Yi},bd:function(){return jo},be:function(){return pe},bf:function(){return fe},bh:function(){return Le},bi:function(){return He},c:function(){return i},d:function(){return ce},e:function(){return oe},f:function(){return xe},g:function(){return o},h:function(){return Oe},i:function(){return M},j:function(){return ge},k:function(){return me},l:function(){return Ee},m:function(){return ee},n:function(){return We},o:function(){return d},p:function(){return l},q:function(){return ui},r:function(){return E},s:function(){return c},t:function(){return Ui},u:function(){return se},v:function(){return f},w:function(){return ls},x:function(){return fs},y:function(){return Di},z:function(){return zi}});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function u(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function d(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var h,f="4.10.7",p=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return f},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:function(){return e.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),e}();!function(e){e[e.STAT_LOG_NOT_ALLOWED=400108]="STAT_LOG_NOT_ALLOWED",e[e.NON_AUTHORIZED=400108]="NON_AUTHORIZED",e[e.INVALID_TOKEN=400111]="INVALID_TOKEN",e[e.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",e[e.USER_AUTH_DEACTIVATED=400300]="USER_AUTH_DEACTIVATED",e[e.USER_AUTH_DELETED_OR_NOT_FOUND=400301]="USER_AUTH_DELETED_OR_NOT_FOUND",e[e.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",e[e.APPLICATION_NOT_FOUND=400304]="APPLICATION_NOT_FOUND",e[e.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",e[e.SESSION_REVOKED=400310]="SESSION_REVOKED",e[e.INVALID_SESSION_TYPE=400312]="INVALID_SESSION_TYPE",e[e.STAT_UPLOAD_NOT_ALLOWED=403200]="STAT_UPLOAD_NOT_ALLOWED",e[e.NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE=400940]="NOT_SUPPORTED_PINNED_MESSAGE_IN_REVIEW_MESSAGE",e[e.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",e[e.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",e[e.INVALID_FORM_KEY=400111]="INVALID_FORM_KEY",e[e.INVALID_REQUIRED_FORM_VALUE=400105]="INVALID_REQUIRED_FORM_VALUE",e[e.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",e[e.NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE=901500]="NOT_SUPPORTED_FEATURE_IN_IN_REVIEW_MESSAGE",e[e.ERR_DUPLICATED_DATA=400202]="ERR_DUPLICATED_DATA",e[e.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",e[e.LOST_INSTANCE=700100]="LOST_INSTANCE",e[e.CONNECTION_RENEW=700102]="CONNECTION_RENEW",e[e.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",e[e.INVALID_COMMAND=700700]="INVALID_COMMAND",e[e.XMLHTTPREQUEST_NOT_SUPPORTED=700800]="XMLHTTPREQUEST_NOT_SUPPORTED",e[e.UNKNOWN_ERROR=77e4]="UNKNOWN_ERROR",e[e.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",e[e.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",e[e.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",e[e.INVALID_PARAMETER=800110]="INVALID_PARAMETER",e[e.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",e[e.NETWORK_ERROR=800120]="NETWORK_ERROR",e[e.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",e[e.MALFORMED_DATA=800130]="MALFORMED_DATA",e[e.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",e[e.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",e[e.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",e[e.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",e[e.ACK_TIMEOUT=800180]="ACK_TIMEOUT",e[e.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",e[e.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",e[e.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",e[e.REQUEST_FAILED=800220]="REQUEST_FAILED",e[e.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",e[e.REQUEST_CANCELED=800240]="REQUEST_CANCELED",e[e.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",e[e.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",e[e.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",e[e.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",e[e.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED",e[e.COLLECTION_DISPOSED=800600]="COLLECTION_DISPOSED",e[e.DATABASE_ERROR=800700]="DATABASE_ERROR"}(h||(h={}));var _,v,m,g,y,b=function(e){return!(e instanceof E&&!e.shouldThrowOutside)},E=function(e){function t(n){var r=n.code,i=void 0===r?0:r,o=n.message,s=void 0===o?"":o,a=e.call(this,s)||this;return a.shouldThrowOutside=!1,a._detail="",a.name="SendbirdError",a.code=i,Object.setPrototypeOf(a,t.prototype),a}return i(t,e),Object.defineProperty(t.prototype,"detail",{get:function(){return this._detail},enumerable:!1,configurable:!0}),t.prototype.setDetail=function(e){this._detail=e},Object.defineProperty(t.prototype,"isInvalidTokenError",{get:function(){return this.code===h.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiredError",{get:function(){return this.isSessionTokenExpiredError||this.isSessionKeyExpiredError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===h.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===h.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionInvalidatedError",{get:function(){return this.isSessionRevokedError||this.isUserAuthDeactivedError||this.isUserAuthDeletedOrNotFoundError},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionRevokedError",{get:function(){return this.code===h.SESSION_REVOKED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeactivedError",{get:function(){return this.code===h.USER_AUTH_DEACTIVATED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserAuthDeletedOrNotFoundError",{get:function(){return this.code===h.USER_AUTH_DELETED_OR_NOT_FOUND},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNetworkError",{get:function(){return this.code===h.NETWORK_ERROR||this.code===h.NETWORK_ROUTING_ERROR},enumerable:!1,configurable:!0}),Object.defineProperty(t,"debugModeRequired",{get:function(){return new t({code:h.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"lostInstance",{get:function(){return new t({code:h.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidCommand",{get:function(){return new t({code:h.INVALID_COMMAND,message:"Cannot send invalid command."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"unknown",{get:function(){return new t({code:h.UNKNOWN_ERROR,message:"Unknown error occurred."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRenew",{get:function(){return new t({code:h.CONNECTION_RENEW,message:"Connection restarts."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidConnectionStateTransition",{get:function(){return new t({code:h.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"xmlHttpRequestNotSupported",{get:function(){return new t({code:h.XMLHTTPREQUEST_NOT_SUPPORTED,message:"Cannot upload file. XMLHttpRequest is not defined in this environment."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionRequired",{get:function(){return new t({code:h.CONNECTION_REQUIRED,message:"Connection is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionCanceled",{get:function(){return new t({code:h.CONNECTION_CANCELED,message:"Connection is canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"invalidParameters",{get:function(){return new t({code:h.INVALID_PARAMETER,message:"Invalid parameters."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"notSupportedError",{get:function(){return new t({code:h.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"channelTypeNotSupportedError",{get:function(){return new t({code:h.NOT_SUPPORTED_ERROR,message:"Called method is not supported in the current channel's channel type."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"networkError",{get:function(){return new t({code:h.NETWORK_ERROR,message:"There was a network error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"markAsReadAllRateLimitExceeded",{get:function(){return new t({code:h.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"queryInProgress",{get:function(){return new t({code:h.QUERY_IN_PROGRESS,message:"Query in progress."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"noAckTimeout",{get:function(){return new t({code:h.ACK_TIMEOUT,message:"Command received no ack."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"loginTimeout",{get:function(){return new t({code:h.LOGIN_TIMEOUT,message:"Connection timeout."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"connectionClosed",{get:function(){return new t({code:h.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestFailed",{get:function(){return new t({code:h.REQUEST_FAILED,message:"Request failed."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"alreadyConnectedAsAnotherUser",{get:function(){return new t({code:h.REQUEST_FAILED,message:"Already logged in as a different user. Call disconnect() first."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileUploadCanceled",{get:function(){return new t({code:h.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"requestCanceled",{get:function(){return new t({code:h.REQUEST_CANCELED,message:"Request has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRefreshFailed",{get:function(){return new t({code:h.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"sessionTokenRequestFailed",{get:function(){return new t({code:h.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"databaseError",{get:function(){return new t({code:h.DATABASE_ERROR,message:"Database error."})},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fileSizeLimitExceededError",{get:function(){return new t({code:h.FILE_SIZE_LIMIT_EXCEEDED,message:"File size exceeds the file size limit."})},enumerable:!1,configurable:!0}),t.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this},t}(Error),w=[h.CONNECTION_REQUIRED,h.NETWORK_ERROR,h.ACK_TIMEOUT,h.WEBSOCKET_CONNECTION_CLOSED,h.WEBSOCKET_CONNECTION_FAILED,h.FILE_UPLOAD_CANCEL_FAILED,h.REQUEST_CANCELED,h.INTERNAL_SERVER_ERROR,h.RATE_LIMIT_EXCEEDED,h.UNKNOWN_SERVER_ERROR],C=[h.WEBSOCKET_CONNECTION_CLOSED,h.WEBSOCKET_CONNECTION_FAILED,h.CONNECTION_REQUIRED],T=function(e,t){if(e!==t){var n=o({},e),r=o({},t);return!(n.hasOwnProperty("messageId")&&r.hasOwnProperty("messageId")&&n.messageId!==r.messageId||n.hasOwnProperty("reqId")&&r.hasOwnProperty("reqId")&&n.reqId!==r.reqId||(n.hasOwnProperty("messageId")&&delete n.messageId,n.hasOwnProperty("reqId")&&delete n.reqId,r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,JSON.stringify(n)!==JSON.stringify(r)))}return!0},A=function(e,t,n){return void 0===n&&(n=!1),!(!n||!D(t))||("string"!=typeof e?"object"==typeof e?S(e,t):I(e,t):typeof t===e)},S=function(e,t,n){return void 0===n&&(n=!1),!(!n||!D(t))||Object.values(e).includes(t)},I=function(e,t){return t instanceof e},N=function(e,t,n){return void 0===n&&(n=!1),!(!n||!D(t))||Array.isArray(t)&&t.every((function(t){return A(e,t)}))},k=function(e,t){return void 0===t&&(t=!1),!(!t||!D(e))||"number"==typeof e&&13===e.toString().length},x=function(e){return e>0&&w.indexOf(e)>=0},O=function(e){return e>0&&C.indexOf(e)>=0},M=function(e,t){if(void 0===t&&(t=!1),t&&D(e))return!0;var n="object"==typeof e&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type;if(!n){if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File}return n},R=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=d([],l(e),!1).sort(),r=d([],l(t),!1).sort(),i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0},D=function(e){return null==e},U=function(){function e(e){var t=void 0===e?{}:e,n=t.useMemberInfoInMessage,r=void 0===n||n,i=t.typingIndicatorInvalidateTime,o=void 0===i?1e4:i,s=t.typingIndicatorThrottle,a=void 0===s?1e3:s,u=t.websocketResponseTimeout,c=void 0===u?1e4:u,l=t.websocketPayloadDecompression,d=void 0===l||l,h=t.sessionTokenRefreshTimeout,f=void 0===h?60:h;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=r,this._typingIndicatorInvalidateTime=o,this._typingIndicatorThrottle=a,this._websocketResponseTimeout=c,this._sessionTokenRefreshTimeout=f,this.websocketPayloadDecompression=d}return Object.defineProperty(e.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage},set:function(e){A("boolean",e)&&(this._useMemberInfoInMessage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime},set:function(e){A("number",e)&&(this._typingIndicatorInvalidateTime=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle},set:function(e){A("number",e)&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout},set:function(e){A("number",e)&&e>=5e3&&e<=3e4&&(this._websocketResponseTimeout=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout},set:function(e){A("number",e)&&(e<60?e=60:e>1800&&(e=1800),this._sessionTokenRefreshTimeout=e)},enumerable:!1,configurable:!0}),e}(),L={encrypt:function(e){return e},decrypt:function(e){return e}},P=function(){function e(e){var t=e.store;this._preference=new Map,this._store=t}return e.prototype._savePreferenceKeys=function(){return a(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this._store.set({key:this._keysAddress,value:d([],l(this._preference.keys()),!1)})];case 1:return e.sent(),[2]}}))}))},e.prototype.init=function(e,t){var n;return void 0===t&&(t=1),a(this,void 0,void 0,(function(){var r,i,o,s,a,l,d,h,f,p;return u(this,(function(u){switch(u.label){case 0:return this._version=t,this._keysAddress=e,r="".concat(e,".metadata.version"),[4,this._store.get(r)];case 1:return i=u.sent(),[4,this._store.get(e)];case 2:return o=null!==(n=u.sent())&&void 0!==n?n:[],!i||i.version<this._version?[4,this._resetPreferenceData(o,r)]:[3,4];case 3:return u.sent(),[3,11];case 4:u.trys.push([4,9,10,11]),s=c(o),a=s.next(),u.label=5;case 5:return a.done?[3,8]:(l=a.value,[4,this._store.get(l)]);case 6:(d=u.sent())&&this._preference.set(l,d),u.label=7;case 7:return a=s.next(),[3,5];case 8:return[3,11];case 9:return h=u.sent(),f={error:h},[3,11];case 10:try{a&&!a.done&&(p=s.return)&&p.call(s)}finally{if(f)throw f.error}return[7];case 11:return[2]}}))}))},e.prototype._resetPreferenceData=function(e,t){return a(this,void 0,void 0,(function(){return u(this,(function(n){switch(n.label){case 0:return this._preference=new Map,[4,this._store.removeMany(e)];case 1:return n.sent(),[4,this._store.set({key:t,value:{version:this._version}})];case 2:return n.sent(),[2]}}))}))},e.prototype.get=function(e){return a(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this._preference.get(e)]}))}))},e.prototype.set=function(e,t){return a(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return n=!this._preference.has(e),[4,this._store.set({key:e,value:t})];case 1:return r.sent(),this._preference.set(e,t),n?[4,this._savePreferenceKeys()]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.remove=function(e){return a(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this._store.remove(e)];case 1:return t.sent(),this._preference.delete(e),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2]}}))}))},e.prototype.clear=function(){return a(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this._store.removeMany(d([],l(this._preference.keys()),!1))];case 1:return e.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return e.sent(),[2]}}))}))},e}(),F=function(){function e(e){var t=e.encryption,n=e.store,r=e.localCacheEnabled,i=e.localCacheConfig;this.store=n,this.preference=new P({store:n}),this.encryption=null!=t?t:L,this.localCacheEnabled=r,this.localCacheConfig=i}return e.prototype.replaceStore=function(e){this.store=e,this.preference=new P({store:e})},e}();!function(e){e.SUCCESS="success",e.PENDING="pending",e.ERROR="error"}(_||(_={})),function(e){e.DEFAULT="default",e.ALL="all",e.MENTION_ONLY="mention_only",e.OFF="off"}(v||(v={})),function(e){e.FCM="gcm",e.APNS="apns",e.UNKNOWN="unknown"}(m||(m={})),function(e){e.ALTERNATIVE="alternative",e.DEFAULT="default"}(g||(g={})),function(e){e.CUSTOM="custom",e.MESSAGE_COLLECTION_ACCESSED_AT="messagecollection_accessed_at"}(y||(y={}));var j,q=function(){function e(e){var t=e.channel,n=e.cachedMessageCount;this._cachedMessageCount=0,this._channel=t,this._cachedMessageCount=n}return Object.defineProperty(e.prototype,"channel",{get:function(){return this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedMessageCount",{get:function(){return this._cachedMessageCount},enumerable:!1,configurable:!0}),e}(),H=function(){function e(e){var t=void 0===e?{}:e,n=t.maxSize,r=void 0===n?256:n,i=t.clearOrder,o=void 0===i?y.MESSAGE_COLLECTION_ACCESSED_AT:i,s=t.customClearOrderComparator,a=t.enableAutoResend,u=void 0===a||a;this._clearOrderComparatorUseMessageCollectionAccessedAt=function(e,t){return e.channel.messageCollectionLastAccessedAt===t.channel.messageCollectionLastAccessedAt?e.channel.lastMessage&&!t.channel.lastMessage?1:!e.channel.lastMessage&&t.channel.lastMessage?-1:e.channel.lastMessage||t.channel.lastMessage?e.channel.lastMessage.createdAt-t.channel.lastMessage.createdAt:0:e.channel.messageCollectionLastAccessedAt>t.channel.messageCollectionLastAccessedAt?1:-1},this._maxSize=Math.max(r,64),s?(this._clearOrder=o,this._customClearOrderComparator=s):this._clearOrder=y.MESSAGE_COLLECTION_ACCESSED_AT,this._enableAutoResend=u}return Object.defineProperty(e.prototype,"maxSize",{get:function(){return this._maxSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrder",{get:function(){return this._clearOrder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearOrderComparator",{get:function(){var e;return this._clearOrder===y.MESSAGE_COLLECTION_ACCESSED_AT?this._clearOrderComparatorUseMessageCollectionAccessedAt:null!==(e=this._customClearOrderComparator)&&void 0!==e?e:this._clearOrderComparatorUseMessageCollectionAccessedAt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableAutoResend",{get:function(){return this._enableAutoResend},enumerable:!1,configurable:!0}),e}();!function(e){e.FEED="feed",e.CHAT="chat"}(j||(j={}));var V,B,z,G,W,K,Q,Z,Y,$,X,J=function(){function e(){this.isRefreshing=!1}return Object.defineProperty(e.prototype,"hasSession",{get:function(){return!!this.sessionKey},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.authToken=void 0,this.sessionKey=void 0,this.services=[]},e.prototype.hasLessServiceScopeThan=function(e){var t;return!this.sessionKey||!(null===(t=this.services)||void 0===t?void 0:t.includes(j.CHAT))||e.includes(j.CHAT)},e}(),ee=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},te=function(){function e(e){var t=e.container;this._container={},this._container=t,this.key=ee()}return e.prototype._register=function(e,t,n){var r;return e in this._container||(this._container[e]=new Map),null===(r=this._container[e])||void 0===r||r.set(this.key,{occurence:t,handler:n}),this},e.prototype.on=function(e,t){return this._register(e,-1,t)},e.prototype.once=function(e,t){return this._register(e,1,t)},e.prototype.close=function(){var e;for(var t in this._container)null===(e=this._container[t])||void 0===e||e.delete(this.key)},e}(),ne=function(){function e(){this._container={}}return e.prototype.on=function(e,t){return new te({container:this._container}).on(e,t)},e.prototype.once=function(e,t){return new te({container:this._container}).once(e,t)},e.prototype.dispatch=function(e,t){var n,r,i=this._container[e];if(i){var o=[];try{for(var s=c(i.keys()),a=s.next();!a.done;a=s.next()){var u=a.value,l=i.get(u);l.handler(t),l.occurence>0&&(l.occurence--,0===l.occurence&&o.push(u))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}o.forEach((function(e){return i.delete(e)}))}},e}(),re=function(){function e(){this._dispatcher=new ne}return e.prototype.on=function(e){return this._dispatcher.on("event",e)},e.prototype.once=function(e){return this._dispatcher.once("event",e)},e.prototype.dispatch=function(e){this._dispatcher.dispatch("event",e)},e}(),ie=function(){},oe=function(e){var t={};return e&&Object.keys(e).forEach((function(n){void 0===e[n]||Number.isNaN(e[n])||null===e[n]||(t[n]=e[n])})),t},se=function(e){if(null!=e){if("object"==typeof e){if(Array.isArray(e)){var t=d([],l(e),!1);for(var n in t)t[n]=se(t[n]);return t}for(var r in e)null===e[r]&&delete e[r];return e}return e}};!function(e){e.BASE="base",e.GROUP="group",e.OPEN="open",e.FEED="feed"}(V||(V={})),function(e){e.OPERATOR="operator",e.NONE="none"}(B||(B={})),function(e){e.MUTED="muted",e.UNMUTED="unmuted"}(z||(z={})),function(e){e.BASE="base",e.USER="user",e.FILE="file",e.ADMIN="admin"}(G||(G={})),function(e){e.ALL="",e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(W||(W={})),function(e){e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(K||(K={})),function(e){e.USERS="users",e.CHANNEL="channel"}(Q||(Q={})),function(e){e.ALL="all",e.NONE="none",e.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel"}(Z||(Z={})),function(e){e.DEFAULT="default",e.SUPPRESS="suppress"}(Y||(Y={})),function(e){e.PENDING="pending",e.SCHEDULED="scheduled",e.SUCCEEDED="succeeded",e.FAILED="failed",e.CANCELED="canceled"}($||($={})),function(e){e.INREVIEW="InReview",e.APPROVED="Approved"}(X||(X={}));var ae,ue="v3",ce="/".concat(ue,"/users"),le="/".concat(ue,"/storage/file"),de="/".concat(ue,"/group_channels"),he="/".concat(ue,"/sdk/group_channels"),fe="/".concat(ue,"/open_channels"),pe="/".concat(ue,"/sdk/open_channels"),_e="/".concat(ue,"/search"),ve="/".concat(ue,"/report"),me="/".concat(ue,"/emojis"),ge="/".concat(ue,"/emoji_categories"),ye="/".concat(ue,"/polls"),be="/".concat(ue,"/scheduled_messages"),Ee="/".concat(ue,"/sdk/ui_kit/configuration"),we="/".concat(ue,"/sdk/statistics"),Ce=("/".concat(ue,"/notifications"),function(e,t){return"/".concat(ue,"/group_channels/").concat(e,"/messages/").concat(t,"/submit_forms")}),Te=function(e){switch(e){case V.FEED:case V.GROUP:return de;case V.OPEN:return fe;default:return null}},Ae=function(e){switch(e){case V.GROUP:return"".concat(ve,"/group_channels");case V.OPEN:return"".concat(ve,"/open_channels");default:return null}},Se=function(e,t,n){var r,i;switch(e){case Q.CHANNEL:return!0;case Q.USERS:if(t)try{for(var o=c(t),s=o.next();!s.done;s=o.next())if(s.value===n)return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}}return!1},Ie=function(e,t,n){var r,i,o,s,a=Se(null!==(r=e.mentionType)&&void 0!==r?r:null,null!==(i=e.mentionedUserIds)&&void 0!==i?i:[],n),u=Se(null!==(o=t.mentionType)&&void 0!==o?o:null,null!==(s=t.mentionedUserIds)&&void 0!==s?s:[],n);return!a&&u?1:a&&!u?-1:0},Ne=function(e,t,n){var r,i=t||new FormData;for(var o in e)if(e.hasOwnProperty(o)){var s=e[o],a=n?"".concat(n,"[").concat(o,"]"):o;M(s)?i.append(a,s,null!==(r=s.name)&&void 0!==r?r:"filename"):"object"!=typeof s||null===s||Array.isArray(s)||s instanceof Blob?i.append(a,String(s)):i=Ne(s,i,a)}return i};!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(ae||(ae={}));var ke,xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.params={},t.requireAuth=!0,t.headers={},t.requestId=ee(),t}return i(t,e),t.prototype.encodeParams=function(e){var t=this;return null==e||""===e?encodeURIComponent(""):Array.isArray(e)?e.map((function(e){return t.encodeParams(e)})).join(","):"object"==typeof e?encodeURIComponent(JSON.stringify(e)):encodeURIComponent(String(e))},Object.defineProperty(t.prototype,"query",{get:function(){var e=this,t=oe(this.params);return"?".concat(Object.keys(t).map((function(n){return"".concat(encodeURIComponent(n),"=").concat(e.encodeParams(t[n]))})).join("&"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){var e=oe(this.params);return Object.keys(e).some((function(t){return M(e[t])}))?Ne(e):JSON.stringify(e)},enumerable:!1,configurable:!0}),t}(ie),Oe=function(e){function t(t,n){var r=e.call(this)||this;return r._iid=t,r._payload=n,r}return i(t,e),Object.defineProperty(t.prototype,"payload",{get:function(){return o({},this._payload)},enumerable:!1,configurable:!0}),t.prototype.as=function(e){return new e(this._iid,this.payload)},t}(ie),Me=function(e){function t(t){var n=e.call(this)||this;return n.requestId=t,n}return i(t,e),t}(ie),Re=function(e){function t(t){var n=t.expires_in,r=t.reason,i=void 0===r?h.SESSION_KEY_EXPIRED:r,o=e.call(this)||this;switch(o.expiresIn=null!=n?n:0,i){case h.SESSION_KEY_EXPIRED:case h.SESSION_TOKEN_EXPIRED:case h.SESSION_REVOKED:case h.USER_AUTH_DEACTIVATED:case h.USER_AUTH_DELETED_OR_NOT_FOUND:o.error=new E({code:i})}return o}return i(t,e),Object.defineProperty(t.prototype,"invalidateSessionToken",{get:function(){var e;return!!(null===(e=this.error)||void 0===e?void 0:e.isSessionTokenExpiredError)},enumerable:!1,configurable:!0}),t}(ie),De=function(e){function t(t,n,r,i){void 0===i&&(i="");var o,s=this;return(s=e.call(this)||this)._iid=t,s.code=n,s.payload=r,s.requestId=null!==(o=r.req_id)&&void 0!==o?o:i,s}return i(t,e),t.createFromRawMessage=function(e,n){var r=n.substring(0,4),i={};try{i=JSON.parse(n.substring(4))}catch(e){r="NOOP"}finally{return new t(e,r,i)}},t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},t.prototype.as=function(e){return new e(this._iid,this.code,this.payload)},t}(ie),Ue=function(e){function t(t){var n,r=t.code,i=t.ackRequired,o=t.payload,s=void 0===o?{}:o,a=this;return(a=e.call(this)||this).code=r,a.payload=s,a.requestId=null!==(n=a.payload.req_id)&&void 0!==n?n:ee(),a.ackRequired=i,a.payload.req_id=a.requestId,a}return i(t,e),t.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},t}(ie),Le=function(e){function t(t){var n=t.userId,r=t.authToken,i=t.services,o=void 0===i?[j.CHAT]:i,s=t.expiringSession,a=void 0===s||s,u=e.call(this)||this;return u.path="".concat(ce,"/").concat(n,"/session_key"),u.method=ae.POST,u.params=oe({token:r,services:o,expiring_session:!!a}),u.requireAuth=!1,u}return i(t,e),t}(xe),Pe=function(e){function t(t){var n=t.authToken,r=t.expiringSession,i=void 0===r||r,o=t.requestId,s=void 0===o?void 0:o;return e.call(this,{code:"LOGI",payload:{token:n,expiring_session:i?1:0,req_id:s},ackRequired:!0})||this}return i(t,e),t}(Ue),Fe=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=n.key,o=n.expires_at,s=n.services;return r.key=i,r.expiresAt=o,r.services=s,r}return i(t,e),t}(Oe),je=function(e){function t(t,n,r){var i,o=this;return(o=e.call(this,t,"LOGI",r)||this).error=null,o.newKey=null,o.newKey=null!==(i=r.new_key)&&void 0!==i?i:null,o.error=r.error?new E(r):null,o}return i(t,e),t}(De),qe=function(e){function t(t){var n=e.call(this)||this;return n.statLog=t,n}return i(t,e),t}(ie),He=function(e){function t(t){var n=t.request,r=t.deferred,i=t.error,o=void 0===i?E.requestFailed:i,s=e.call(this)||this;return s.request=n,s.deferred=r,s.error=o,s}return i(t,e),t}(ie);!function(e){e.FEATURE_LOCALCACHE="feature:local_cache",e.FEATURE_LOCALCACHE_EVENT="feature:local_cache_event",e.NOTIFICATION="noti:stats",e.WEBSOCKET_CONNECT="ws:connect",e.API_RESULT="api:result"}(ke||(ke={}));var Ve,Be,ze,Ge=function(){function e(e){var t=e.type,n=e.data,r=e.ts,i=void 0===r?Date.now():r;this.type=t,this.createdAt=i,this.data=n}return e.payloadify=function(e){return oe({stat_type:e.type,ts:e.createdAt,data:oe(e.data)})},e}(),We=function(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"==navigator.product},Ke=function(){return!("undefined"==typeof navigator||!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Windows Phone/i.test(navigator.userAgent))};!function(e){e.CHAT="chat",e.CALLS="calls",e.DESK="desk",e.LIVE="live",e.UIKIT_CHAT="uikit-chat",e.UIKIT_LIVE="uikit-live"}(Ve||(Ve={})),function(e){e.ANDROID="android",e.IOS="ios",e.JS="js",e.UNREAL="unreal",e.UNITY="unity",e.REACT_NATIVE="react-native",e.FLUTTER="flutter"}(Be||(Be={})),function(e){e.ANDROID="android",e.IOS="ios",e.WEB="web",e.MOBILE_WEB="mobile_web",e.WINDOWS="windows"}(ze||(ze={}));var Qe="^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",Ze=function(){function e(){}return e.sendbirdSdkUserAgentWithExtension=function(e){var t=We()?Be.REACT_NATIVE:Be.JS,n={main_sdk_info:"chat/".concat(t,"/").concat(p.SDK_VERSION),device_os_platform:Ke()?"mobile-web":"web",os_version:p.OS_VERSION};if(e){var r=e.sendbirdExtensions,i=e.deviceOS,s=e.customData,a=void 0===s?{}:s;i.version&&(n.os_version=i.version),i.platform&&(n.device_os_platform=i.platform),r.length>0&&(n.extension_sdk_info=r.map((function(e){var t=e.product,n=e.platform,r=e.version;return"".concat(t,"/").concat(n,"/").concat(r)})).join(",")),Object.keys(n).forEach((function(e){return delete a[e]})),Object.keys(a).length>0&&(n=o(o({},n),a))}return Object.entries(n).map((function(e){var t=l(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(r)})).join("&")},e.userAgentWithExtension=function(e){var t=We()?"reactnative":"JS",n=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",r=e.sb_uikit?"u".concat(e.sb_uikit):"",i=e["device-os-platform"]?"o".concat(e["device-os-platform"]):Ke()?"omobile-web":"oweb";return"".concat(t,"/c").concat(p.SDK_VERSION,"/").concat(n,"/").concat(r,"/").concat(i)},e}(),Ye=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=function(e){n(e)}}))},$e=function(e){function t(t){var n=e.call(this)||this;return n.requestId=t.requestId,n}return i(t,e),t}(ie),Xe=function(){function e(e,t){var n=t.session,r=t.sdkState,i=t.dispatcher,o=t.logger,s=t.useFetchCompat,a=void 0!==s&&s,u=this;this._abortControl=new Map,this._shouldImportFetchCompat=!1,this._iid=e,this._session=n,this._sdkState=r,this._dispatcher=i,this._dispatcher.on((function(e){e instanceof Me&&u.cancel(e.requestId)})),this._logger=o,this._shouldImportFetchCompat=a}return e.prototype._createHeader=function(e,t){var n=this._sdkState,r=n.appId,i=n.appVersion,s=n.sendbirdRuntimeEnvironment,a=o(o({},e.headers),{SendBird:"JS,".concat(p.OS_VERSION,",").concat(p.SDK_VERSION,",").concat(r).concat(i?",".concat(i):""),"SB-User-Agent":Ze.userAgentWithExtension(this._sdkState.extensions),"Request-Sent-Timestamp":Date.now().toString(),"SB-SDK-User-Agent":Ze.sendbirdSdkUserAgentWithExtension(s)});return t||(a["Content-Type"]="application/json; charset=utf-8"),e.requireAuth&&this._session.hasSession&&(a["Session-Key"]=this._session.sessionKey),this._session&&this._session.authToken&&(a["App-Id"]=r,a["Access-Token"]=this._session.authToken),a},e.prototype._statLogApiResult=function(e,t,n){this._dispatcher.dispatch(new qe(new Ge({type:ke.API_RESULT,data:{endpoint:e.path,method:e.method,success:!n,latency:Date.now()-t,error_code:null==n?void 0:n.code,error_description:null==n?void 0:n.message}})))},e.prototype.send=function(e){return a(this,void 0,void 0,(function(){var t,r,i,o,s,a,c,l,d,f,p,_,v,m,g,y,b,w,C,T;return u(this,(function(u){switch(u.label){case 0:t=e.path,r=e.method,i=e.uploadProgressHandler,o=![ae.GET,ae.DELETE].includes(r),s=this._sdkState.api,a="".concat(s.host).concat(t).concat(o?"":e.query),c=o?e.payload:null,l=this._createHeader(e,c instanceof FormData?c:void 0),d=new AbortController,f=d.signal,this._abortControl.set(e.requestId,d),p=Date.now(),u.label=1;case 1:return u.trys.push([1,13,,14]),i?[4,n.e(96).then(n.bind(n,3762))]:[3,6];case 2:_=u.sent().xmlHttpRequest,u.label=3;case 3:return u.trys.push([3,5,,6]),[4,_(this._iid,{requestId:e.requestId,method:e.method,url:a,headers:l,data:null!=c?c:void 0,uploadProgressHandler:i})];case 4:return v=u.sent(),this._logger.debug("receive api response",e.requestId),this._statLogApiResult(e,p),[2,v];case 5:if(!((m=u.sent())instanceof E&&m.code===h.XMLHTTPREQUEST_NOT_SUPPORTED))throw m;return this._logger.debug("XMLHttpRequest is not available in this environment. progressHandler is ignored."),[3,6];case 6:return this._shouldImportFetchCompat&&(this._shouldImportFetchCompat=!1,("undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||{fetch:null}).fetch=null),"undefined"!=typeof AbortController?[3,8]:[4,n.e(96).then(n.bind(n,5122))];case 7:u.sent(),u.label=8;case 8:return"function"==typeof fetch?[3,10]:[4,n.e(96).then(n.bind(n,9345))];case 9:u.sent(),u.label=10;case 10:return[4,fetch(a,{method:r,body:c,headers:l,signal:f})];case 11:return[4,(g=u.sent()).json()];case 12:if(y=u.sent(),g.ok||g.redirected)return this._logger.debug("receive api response",e.requestId),this._statLogApiResult(e,p),[2,new Oe(this._iid,y)];if(y){if((b=new E(y)).isSessionExpiredError){if(this._dispatcher.dispatch(new Re({reason:b.code})),!(e instanceof Le))return w=new Ye,this._dispatcher.dispatch(new He({request:e,deferred:w,error:b})),[2,w.promise];throw b}throw b.isSessionInvalidatedError?(this._dispatcher.dispatch(new Re({reason:b.code})),b):b}throw E.requestFailed;case 13:throw C=u.sent(),this._statLogApiResult(e,p,C),C instanceof E?(this._logger.debug("fail api request",C),C):"AbortError"===(null==C?void 0:C.name)?E.requestCanceled:(T=E.networkError,this._logger.debug("fail api request",T),T);case 14:return[2]}}))}))},e.prototype.cancel=function(e){this._abortControl.has(e)&&(this._abortControl.get(e).abort(),this._abortControl.delete(e)),this._dispatcher.dispatch(new $e({requestId:e}))},e.prototype.cancelAll=function(){var e,t;try{for(var n=c(this._abortControl.values()),r=n.next();!r.done;r=n.next())r.value.abort()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._abortControl.clear(),this._dispatcher.dispatch(new $e({}))},e}(),Je=function(){};function et(e){let t=e.length;for(;--t>=0;)e[t]=0}const tt=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),nt=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),rt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),it=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ot=new Array(576);et(ot);const st=new Array(60);et(st);const at=new Array(512);et(at);const ut=new Array(256);et(ut);const ct=new Array(29);et(ct);const lt=new Array(30);function dt(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let ht,ft,pt;function _t(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}et(lt);const vt=e=>e<256?at[e]:at[256+(e>>>7)],mt=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},gt=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,mt(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},yt=(e,t,n)=>{gt(e,n[2*t],n[2*t+1])},bt=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Et=(e,t,n)=>{const r=new Array(16);let i,o,s=0;for(i=1;i<=15;i++)s=s+n[i-1]<<1,r[i]=s;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=bt(r[t]++,t))}},wt=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Ct=e=>{e.bi_valid>8?mt(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Tt=(e,t,n,r)=>{const i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]},At=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Tt(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Tt(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},St=(e,t,n)=>{let r,i,o,s,a=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+a++],r+=(255&e.pending_buf[e.sym_buf+a++])<<8,i=e.pending_buf[e.sym_buf+a++],0===r?yt(e,i,t):(o=ut[i],yt(e,o+256+1,t),s=tt[o],0!==s&&(i-=ct[o],gt(e,i,s)),r--,o=vt(r),yt(e,o,n),s=nt[o],0!==s&&(r-=lt[o],gt(e,r,s)))}while(a<e.sym_next);yt(e,256,t)},It=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems;let s,a,u,c=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<o;s++)0!==n[2*s]?(e.heap[++e.heap_len]=c=s,e.depth[s]=0):n[2*s+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,n[2*u]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[2*u+1]);for(t.max_code=c,s=e.heap_len>>1;s>=1;s--)At(e,n,s);u=o;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],At(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,n[2*u]=n[2*s]+n[2*a],e.depth[u]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,n[2*s+1]=n[2*a+1]=u,e.heap[1]=u++,At(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,u=t.stat_desc.max_length;let c,l,d,h,f,p,_=0;for(h=0;h<=15;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)l=e.heap[c],h=n[2*n[2*l+1]+1]+1,h>u&&(h=u,_++),n[2*l+1]=h,l>r||(e.bl_count[h]++,f=0,l>=a&&(f=s[l-a]),p=n[2*l],e.opt_len+=p*(h+f),o&&(e.static_len+=p*(i[2*l+1]+f)));if(0!==_){do{for(h=u-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[u]--,_-=2}while(_>0);for(h=u;0!==h;h--)for(l=e.bl_count[h];0!==l;)d=e.heap[--c],d>r||(n[2*d+1]!==h&&(e.opt_len+=(h-n[2*d+1])*n[2*d],n[2*d+1]=h),l--)}})(e,t),Et(n,c,e.bl_count)},Nt=(e,t,n)=>{let r,i,o=-1,s=t[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=t[2*(r+1)+1],++a<u&&i===s||(a<c?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=i,0===s?(u=138,c=3):i===s?(u=6,c=3):(u=7,c=4))},kt=(e,t,n)=>{let r,i,o=-1,s=t[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),r=0;r<=n;r++)if(i=s,s=t[2*(r+1)+1],!(++a<u&&i===s)){if(a<c)do{yt(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(yt(e,i,e.bl_tree),a--),yt(e,16,e.bl_tree),gt(e,a-3,2)):a<=10?(yt(e,17,e.bl_tree),gt(e,a-3,3)):(yt(e,18,e.bl_tree),gt(e,a-11,7));a=0,o=i,0===s?(u=138,c=3):i===s?(u=6,c=3):(u=7,c=4)}};let xt=!1;const Ot=(e,t,n,r)=>{gt(e,0+(r?1:0),3),Ct(e),mt(e,n),mt(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var Mt={_tr_init:e=>{xt||((()=>{let e,t,n,r,i;const o=new Array(16);for(n=0,r=0;r<28;r++)for(ct[r]=n,e=0;e<1<<tt[r];e++)ut[n++]=r;for(ut[n-1]=r,i=0,r=0;r<16;r++)for(lt[r]=i,e=0;e<1<<nt[r];e++)at[i++]=r;for(i>>=7;r<30;r++)for(lt[r]=i<<7,e=0;e<1<<nt[r]-7;e++)at[256+i++]=r;for(t=0;t<=15;t++)o[t]=0;for(e=0;e<=143;)ot[2*e+1]=8,e++,o[8]++;for(;e<=255;)ot[2*e+1]=9,e++,o[9]++;for(;e<=279;)ot[2*e+1]=7,e++,o[7]++;for(;e<=287;)ot[2*e+1]=8,e++,o[8]++;for(Et(ot,287,o),e=0;e<30;e++)st[2*e+1]=5,st[2*e]=bt(e,5);ht=new dt(ot,tt,257,286,15),ft=new dt(st,nt,0,30,15),pt=new dt(new Array(0),rt,0,19,7)})(),xt=!0),e.l_desc=new _t(e.dyn_ltree,ht),e.d_desc=new _t(e.dyn_dtree,ft),e.bl_desc=new _t(e.bl_tree,pt),e.bi_buf=0,e.bi_valid=0,wt(e)},_tr_stored_block:Ot,_tr_flush_block:(e,t,n,r)=>{let i,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),It(e,e.l_desc),It(e,e.d_desc),s=(e=>{let t;for(Nt(e,e.dyn_ltree,e.l_desc.max_code),Nt(e,e.dyn_dtree,e.d_desc.max_code),It(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*it[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?Ot(e,t,n,r):4===e.strategy||o===i?(gt(e,2+(r?1:0),3),St(e,ot,st)):(gt(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(gt(e,t-257,5),gt(e,n-1,5),gt(e,r-4,4),i=0;i<r;i++)gt(e,e.bl_tree[2*it[i]+1],3);kt(e,e.dyn_ltree,t-1),kt(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),St(e,e.dyn_ltree,e.dyn_dtree)),wt(e),r&&Ct(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(ut[n]+256+1)]++,e.dyn_dtree[2*vt(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{gt(e,2,3),yt(e,256,ot),(e=>{16===e.bi_valid?(mt(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},Rt=(e,t,n,r)=>{let i=65535&e,o=e>>>16&65535,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{i=i+t[r++]|0,o=o+i|0}while(--s);i%=65521,o%=65521}return i|o<<16};const Dt=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var Ut=(e,t,n,r)=>{const i=Dt,o=r+n;e^=-1;for(let n=r;n<o;n++)e=e>>>8^i[255&(e^t[n])];return~e},Lt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Pt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ft,_tr_stored_block:jt,_tr_flush_block:qt,_tr_tally:Ht,_tr_align:Vt}=Mt,{Z_NO_FLUSH:Bt,Z_PARTIAL_FLUSH:zt,Z_FULL_FLUSH:Gt,Z_FINISH:Wt,Z_BLOCK:Kt,Z_OK:Qt,Z_STREAM_END:Zt,Z_STREAM_ERROR:Yt,Z_DATA_ERROR:$t,Z_BUF_ERROR:Xt,Z_DEFAULT_COMPRESSION:Jt,Z_FILTERED:en,Z_HUFFMAN_ONLY:tn,Z_RLE:nn,Z_FIXED:rn,Z_DEFAULT_STRATEGY:on,Z_UNKNOWN:sn,Z_DEFLATED:an}=Pt,un=258,cn=262,ln=42,dn=113,hn=666,fn=(e,t)=>(e.msg=Lt[t],t),pn=e=>2*e-(e>4?9:0),_n=e=>{let t=e.length;for(;--t>=0;)e[t]=0},vn=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let mn=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const gn=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},yn=(e,t)=>{qt(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,gn(e.strm)},bn=(e,t)=>{e.pending_buf[e.pending++]=t},En=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},wn=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=Rt(e.adler,t,i,n):2===e.state.wrap&&(e.adler=Ut(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},Cn=(e,t)=>{let n,r,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match;const u=e.strstart>e.w_size-cn?e.strstart-(e.w_size-cn):0,c=e.window,l=e.w_mask,d=e.prev,h=e.strstart+un;let f=c[o+s-1],p=c[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,c[n+s]===p&&c[n+s-1]===f&&c[n]===c[o]&&c[++n]===c[o+1]){o+=2,n++;do{}while(c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<h);if(r=un-(h-o),o=h-un,r>s){if(e.match_start=t,s=r,r>=a)break;f=c[o+s-1],p=c[o+s]}}}while((t=d[t&l])>u&&0!=--i);return s<=e.lookahead?s:e.lookahead},Tn=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-cn)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),vn(e),r+=t),0===e.strm.avail_in)break;if(n=wn(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=mn(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=mn(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<cn&&0!==e.strm.avail_in)},An=(e,t)=>{let n,r,i,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,a=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<o&&(0===n&&t!==Wt||t===Bt||n!==r+e.strm.avail_in))break;s=t===Wt&&n===r+e.strm.avail_in?1:0,jt(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,gn(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(wn(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===s);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==Bt&&t!==Wt&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(wn(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,o=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=o||(r||t===Wt)&&t!==Bt&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,s=t===Wt&&0===e.strm.avail_in&&n===r?1:0,jt(e,e.block_start,n,s),e.block_start+=n,gn(e.strm)),s?3:1)},Sn=(e,t)=>{let n,r;for(;;){if(e.lookahead<cn){if(Tn(e),e.lookahead<cn&&t===Bt)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=mn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-cn&&(e.match_length=Cn(e,n)),e.match_length>=3)if(r=Ht(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=mn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=mn(e,e.ins_h,e.window[e.strstart+1]);else r=Ht(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(yn(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Wt?(yn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(yn(e,!1),0===e.strm.avail_out)?1:2},In=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<cn){if(Tn(e),e.lookahead<cn&&t===Bt)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=mn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-cn&&(e.match_length=Cn(e,n),e.match_length<=5&&(e.strategy===en||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=Ht(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=mn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(yn(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=Ht(e,0,e.window[e.strstart-1]),r&&yn(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Ht(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Wt?(yn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(yn(e,!1),0===e.strm.avail_out)?1:2};function Nn(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const kn=[new Nn(0,0,0,0,An),new Nn(4,4,8,4,Sn),new Nn(4,5,16,8,Sn),new Nn(4,6,32,32,Sn),new Nn(4,4,16,16,In),new Nn(8,16,32,32,In),new Nn(8,16,128,128,In),new Nn(8,32,128,256,In),new Nn(32,128,258,1024,In),new Nn(32,258,258,4096,In)];function xn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=an,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),_n(this.dyn_ltree),_n(this.dyn_dtree),_n(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),_n(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),_n(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const On=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==ln&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==dn&&t.status!==hn?1:0},Mn=e=>{if(On(e))return fn(e,Yt);e.total_in=e.total_out=0,e.data_type=sn;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?ln:dn,e.adler=2===t.wrap?0:1,t.last_flush=-2,Ft(t),Qt},Rn=e=>{const t=Mn(e);var n;return t===Qt&&((n=e.state).window_size=2*n.w_size,_n(n.head),n.max_lazy_match=kn[n.level].max_lazy,n.good_match=kn[n.level].good_length,n.nice_match=kn[n.level].nice_length,n.max_chain_length=kn[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},Dn=(e,t,n,r,i,o)=>{if(!e)return Yt;let s=1;if(t===Jt&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),i<1||i>9||n!==an||r<8||r>15||t<0||t>9||o<0||o>rn||8===r&&1!==s)return fn(e,Yt);8===r&&(r=9);const a=new xn;return e.state=a,a.strm=e,a.status=ln,a.wrap=s,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=o,a.method=n,Rn(e)};var Un={deflateInit:(e,t)=>Dn(e,t,an,15,8,on),deflateInit2:Dn,deflateReset:Rn,deflateResetKeep:Mn,deflateSetHeader:(e,t)=>On(e)||2!==e.state.wrap?Yt:(e.state.gzhead=t,Qt),deflate:(e,t)=>{if(On(e)||t>Kt||t<0)return e?fn(e,Yt):Yt;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===hn&&t!==Wt)return fn(e,0===e.avail_out?Xt:Yt);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(gn(e),0===e.avail_out)return n.last_flush=-1,Qt}else if(0===e.avail_in&&pn(t)<=pn(r)&&t!==Wt)return fn(e,Xt);if(n.status===hn&&0!==e.avail_in)return fn(e,Xt);if(n.status===ln&&0===n.wrap&&(n.status=dn),n.status===ln){let t=an+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=tn||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,En(n,t),0!==n.strstart&&(En(n,e.adler>>>16),En(n,65535&e.adler)),e.adler=1,n.status=dn,gn(e),0!==n.pending)return n.last_flush=-1,Qt}if(57===n.status)if(e.adler=0,bn(n,31),bn(n,139),bn(n,8),n.gzhead)bn(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),bn(n,255&n.gzhead.time),bn(n,n.gzhead.time>>8&255),bn(n,n.gzhead.time>>16&255),bn(n,n.gzhead.time>>24&255),bn(n,9===n.level?2:n.strategy>=tn||n.level<2?4:0),bn(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(bn(n,255&n.gzhead.extra.length),bn(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Ut(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(bn(n,0),bn(n,0),bn(n,0),bn(n,0),bn(n,0),bn(n,9===n.level?2:n.strategy>=tn||n.level<2?4:0),bn(n,3),n.status=dn,gn(e),0!==n.pending)return n.last_flush=-1,Qt;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=Ut(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,gn(e),0!==n.pending)return n.last_flush=-1,Qt;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=Ut(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=Ut(e.adler,n.pending_buf,n.pending-r,r)),gn(e),0!==n.pending)return n.last_flush=-1,Qt;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,bn(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=Ut(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=Ut(e.adler,n.pending_buf,n.pending-r,r)),gn(e),0!==n.pending)return n.last_flush=-1,Qt;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,bn(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=Ut(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(gn(e),0!==n.pending))return n.last_flush=-1,Qt;bn(n,255&e.adler),bn(n,e.adler>>8&255),e.adler=0}if(n.status=dn,gn(e),0!==n.pending)return n.last_flush=-1,Qt}if(0!==e.avail_in||0!==n.lookahead||t!==Bt&&n.status!==hn){let r=0===n.level?An(n,t):n.strategy===tn?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(Tn(e),0===e.lookahead)){if(t===Bt)return 1;break}if(e.match_length=0,n=Ht(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(yn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Wt?(yn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(yn(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===nn?((e,t)=>{let n,r,i,o;const s=e.window;for(;;){if(e.lookahead<=un){if(Tn(e),e.lookahead<=un&&t===Bt)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=s[i],r===s[++i]&&r===s[++i]&&r===s[++i])){o=e.strstart+un;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);e.match_length=un-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Ht(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Ht(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(yn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Wt?(yn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(yn(e,!1),0===e.strm.avail_out)?1:2})(n,t):kn[n.level].func(n,t);if(3!==r&&4!==r||(n.status=hn),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),Qt;if(2===r&&(t===zt?Vt(n):t!==Kt&&(jt(n,0,0,!1),t===Gt&&(_n(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),gn(e),0===e.avail_out))return n.last_flush=-1,Qt}return t!==Wt?Qt:n.wrap<=0?Zt:(2===n.wrap?(bn(n,255&e.adler),bn(n,e.adler>>8&255),bn(n,e.adler>>16&255),bn(n,e.adler>>24&255),bn(n,255&e.total_in),bn(n,e.total_in>>8&255),bn(n,e.total_in>>16&255),bn(n,e.total_in>>24&255)):(En(n,e.adler>>>16),En(n,65535&e.adler)),gn(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Qt:Zt)},deflateEnd:e=>{if(On(e))return Yt;const t=e.state.status;return e.state=null,t===dn?fn(e,$t):Qt},deflateSetDictionary:(e,t)=>{let n=t.length;if(On(e))return Yt;const r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==ln||r.lookahead)return Yt;if(1===i&&(e.adler=Rt(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(_n(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Tn(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=mn(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,Tn(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,r.wrap=i,Qt},deflateInfo:"pako deflate (from Nodeca project)"};const Ln=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Pn={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)Ln(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,i=e.length;t<i;t++){let i=e[t];n.set(i,r),r+=i.length}return n}};let Fn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){Fn=!1}const jn=new Uint8Array(256);for(let e=0;e<256;e++)jn[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;jn[254]=jn[254]=1;var qn={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,o,s=e.length,a=0;for(i=0;i<s;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<s&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),o=0,i=0;o<a;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<s&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const o=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){o[i++]=t;continue}let s=jn[t];if(s>4)o[i++]=65533,r+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&r<n;)t=t<<6|63&e[r++],s--;s>1?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Fn)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(o,i)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+jn[e[n]]>t?n:t}},Hn=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Vn=Object.prototype.toString,{Z_NO_FLUSH:Bn,Z_SYNC_FLUSH:zn,Z_FULL_FLUSH:Gn,Z_FINISH:Wn,Z_OK:Kn,Z_STREAM_END:Qn,Z_DEFAULT_COMPRESSION:Zn,Z_DEFAULT_STRATEGY:Yn,Z_DEFLATED:$n}=Pt;function Xn(e){this.options=Pn.assign({level:Zn,method:$n,chunkSize:16384,windowBits:15,memLevel:8,strategy:Yn},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Hn,this.strm.avail_out=0;let n=Un.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Kn)throw new Error(Lt[n]);if(t.header&&Un.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?qn.string2buf(t.dictionary):"[object ArrayBuffer]"===Vn.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=Un.deflateSetDictionary(this.strm,e),n!==Kn)throw new Error(Lt[n]);this._dict_set=!0}}function Jn(e,t){const n=new Xn(t);if(n.push(e,!0),n.err)throw n.msg||Lt[n.err];return n.result}Xn.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?Wn:Bn,"string"==typeof e?n.input=qn.string2buf(e):"[object ArrayBuffer]"===Vn.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(o===zn||o===Gn)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=Un.deflate(n,o),i===Qn)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=Un.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Kn;if(0!==n.avail_out){if(o>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Xn.prototype.onData=function(e){this.chunks.push(e)},Xn.prototype.onEnd=function(e){e===Kn&&(this.result=Pn.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var er={Deflate:Xn,deflate:Jn,deflateRaw:function(e,t){return(t=t||{}).raw=!0,Jn(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,Jn(e,t)},constants:Pt};const tr=16209;var nr=function(e,t){let n,r,i,o,s,a,u,c,l,d,h,f,p,_,v,m,g,y,b,E,w,C,T,A;const S=e.state;n=e.next_in,T=e.input,r=n+(e.avail_in-5),i=e.next_out,A=e.output,o=i-(t-e.avail_out),s=i+(e.avail_out-257),a=S.dmax,u=S.wsize,c=S.whave,l=S.wnext,d=S.window,h=S.hold,f=S.bits,p=S.lencode,_=S.distcode,v=(1<<S.lenbits)-1,m=(1<<S.distbits)-1;e:do{f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),g=p[h&v];t:for(;;){if(y=g>>>24,h>>>=y,f-=y,y=g>>>16&255,0===y)A[i++]=65535&g;else{if(!(16&y)){if(!(64&y)){g=p[(65535&g)+(h&(1<<y)-1)];continue t}if(32&y){S.mode=16191;break e}e.msg="invalid literal/length code",S.mode=tr;break e}b=65535&g,y&=15,y&&(f<y&&(h+=T[n++]<<f,f+=8),b+=h&(1<<y)-1,h>>>=y,f-=y),f<15&&(h+=T[n++]<<f,f+=8,h+=T[n++]<<f,f+=8),g=_[h&m];n:for(;;){if(y=g>>>24,h>>>=y,f-=y,y=g>>>16&255,!(16&y)){if(!(64&y)){g=_[(65535&g)+(h&(1<<y)-1)];continue n}e.msg="invalid distance code",S.mode=tr;break e}if(E=65535&g,y&=15,f<y&&(h+=T[n++]<<f,f+=8,f<y&&(h+=T[n++]<<f,f+=8)),E+=h&(1<<y)-1,E>a){e.msg="invalid distance too far back",S.mode=tr;break e}if(h>>>=y,f-=y,y=i-o,E>y){if(y=E-y,y>c&&S.sane){e.msg="invalid distance too far back",S.mode=tr;break e}if(w=0,C=d,0===l){if(w+=u-y,y<b){b-=y;do{A[i++]=d[w++]}while(--y);w=i-E,C=A}}else if(l<y){if(w+=u+l-y,y-=l,y<b){b-=y;do{A[i++]=d[w++]}while(--y);if(w=0,l<b){y=l,b-=y;do{A[i++]=d[w++]}while(--y);w=i-E,C=A}}}else if(w+=l-y,y<b){b-=y;do{A[i++]=d[w++]}while(--y);w=i-E,C=A}for(;b>2;)A[i++]=C[w++],A[i++]=C[w++],A[i++]=C[w++],b-=3;b&&(A[i++]=C[w++],b>1&&(A[i++]=C[w++]))}else{w=i-E;do{A[i++]=A[w++],A[i++]=A[w++],A[i++]=A[w++],b-=3}while(b>2);b&&(A[i++]=A[w++],b>1&&(A[i++]=A[w++]))}break}}break}}while(n<r&&i<s);b=f>>3,n-=b,f-=b<<3,h&=(1<<f)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<s?s-i+257:257-(i-s),S.hold=h,S.bits=f};const rr=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ir=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),or=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),sr=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ar=(e,t,n,r,i,o,s,a)=>{const u=a.bits;let c,l,d,h,f,p,_=0,v=0,m=0,g=0,y=0,b=0,E=0,w=0,C=0,T=0,A=null;const S=new Uint16Array(16),I=new Uint16Array(16);let N,k,x,O=null;for(_=0;_<=15;_++)S[_]=0;for(v=0;v<r;v++)S[t[n+v]]++;for(y=u,g=15;g>=1&&0===S[g];g--);if(y>g&&(y=g),0===g)return i[o++]=20971520,i[o++]=20971520,a.bits=1,0;for(m=1;m<g&&0===S[m];m++);for(y<m&&(y=m),w=1,_=1;_<=15;_++)if(w<<=1,w-=S[_],w<0)return-1;if(w>0&&(0===e||1!==g))return-1;for(I[1]=0,_=1;_<15;_++)I[_+1]=I[_]+S[_];for(v=0;v<r;v++)0!==t[n+v]&&(s[I[t[n+v]]++]=v);if(0===e?(A=O=s,p=20):1===e?(A=rr,O=ir,p=257):(A=or,O=sr,p=0),T=0,v=0,_=m,f=o,b=y,E=0,d=-1,C=1<<y,h=C-1,1===e&&C>852||2===e&&C>592)return 1;for(;;){N=_-E,s[v]+1<p?(k=0,x=s[v]):s[v]>=p?(k=O[s[v]-p],x=A[s[v]-p]):(k=96,x=0),c=1<<_-E,l=1<<b,m=l;do{l-=c,i[f+(T>>E)+l]=N<<24|k<<16|x}while(0!==l);for(c=1<<_-1;T&c;)c>>=1;if(0!==c?(T&=c-1,T+=c):T=0,v++,0==--S[_]){if(_===g)break;_=t[n+s[v]]}if(_>y&&(T&h)!==d){for(0===E&&(E=y),f+=m,b=_-E,w=1<<b;b+E<g&&(w-=S[b+E],!(w<=0));)b++,w<<=1;if(C+=1<<b,1===e&&C>852||2===e&&C>592)return 1;d=T&h,i[d]=y<<24|b<<16|f-o}}return 0!==T&&(i[f+T]=_-E<<24|64<<16),a.bits=y,0};const{Z_FINISH:ur,Z_BLOCK:cr,Z_TREES:lr,Z_OK:dr,Z_STREAM_END:hr,Z_NEED_DICT:fr,Z_STREAM_ERROR:pr,Z_DATA_ERROR:_r,Z_MEM_ERROR:vr,Z_BUF_ERROR:mr,Z_DEFLATED:gr}=Pt,yr=16180,br=16190,Er=16191,wr=16192,Cr=16194,Tr=16199,Ar=16200,Sr=16206,Ir=16209,Nr=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function kr(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const xr=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<yr||t.mode>16211?1:0},Or=e=>{if(xr(e))return pr;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=yr,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,dr},Mr=e=>{if(xr(e))return pr;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Or(e)},Rr=(e,t)=>{let n;if(xr(e))return pr;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?pr:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,Mr(e))},Dr=(e,t)=>{if(!e)return pr;const n=new kr;e.state=n,n.strm=e,n.window=null,n.mode=yr;const r=Rr(e,t);return r!==dr&&(e.state=null),r};let Ur,Lr,Pr=!0;const Fr=e=>{if(Pr){Ur=new Int32Array(512),Lr=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ar(1,e.lens,0,288,Ur,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ar(2,e.lens,0,32,Lr,0,e.work,{bits:5}),Pr=!1}e.lencode=Ur,e.lenbits=9,e.distcode=Lr,e.distbits=5},jr=(e,t,n,r)=>{let i;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>r&&(i=r),o.window.set(t.subarray(n-r,n-r+i),o.wnext),(r-=i)?(o.window.set(t.subarray(n-r,n),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var qr={inflateReset:Mr,inflateReset2:Rr,inflateResetKeep:Or,inflateInit:e=>Dr(e,15),inflateInit2:Dr,inflate:(e,t)=>{let n,r,i,o,s,a,u,c,l,d,h,f,p,_,v,m,g,y,b,E,w,C,T=0;const A=new Uint8Array(4);let S,I;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(xr(e)||!e.output||!e.input&&0!==e.avail_in)return pr;n=e.state,n.mode===Er&&(n.mode=wr),s=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,r=e.input,a=e.avail_in,c=n.hold,l=n.bits,d=a,h=u,C=dr;e:for(;;)switch(n.mode){case yr:if(0===n.wrap){n.mode=wr;break}for(;l<16;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if(2&n.wrap&&35615===c){0===n.wbits&&(n.wbits=15),n.check=0,A[0]=255&c,A[1]=c>>>8&255,n.check=Ut(n.check,A,2,0),c=0,l=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=Ir;break}if((15&c)!==gr){e.msg="unknown compression method",n.mode=Ir;break}if(c>>>=4,l-=4,w=8+(15&c),0===n.wbits&&(n.wbits=w),w>15||w>n.wbits){e.msg="invalid window size",n.mode=Ir;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&c?16189:Er,c=0,l=0;break;case 16181:for(;l<16;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if(n.flags=c,(255&n.flags)!==gr){e.msg="unknown compression method",n.mode=Ir;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Ir;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&4&n.wrap&&(A[0]=255&c,A[1]=c>>>8&255,n.check=Ut(n.check,A,2,0)),c=0,l=0,n.mode=16182;case 16182:for(;l<32;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}n.head&&(n.head.time=c),512&n.flags&&4&n.wrap&&(A[0]=255&c,A[1]=c>>>8&255,A[2]=c>>>16&255,A[3]=c>>>24&255,n.check=Ut(n.check,A,4,0)),c=0,l=0,n.mode=16183;case 16183:for(;l<16;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&4&n.wrap&&(A[0]=255&c,A[1]=c>>>8&255,n.check=Ut(n.check,A,2,0)),c=0,l=0,n.mode=16184;case 16184:if(1024&n.flags){for(;l<16;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&4&n.wrap&&(A[0]=255&c,A[1]=c>>>8&255,n.check=Ut(n.check,A,2,0)),c=0,l=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>a&&(f=a),f&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(o,o+f),w)),512&n.flags&&4&n.wrap&&(n.check=Ut(n.check,r,f,o)),a-=f,o+=f,n.length-=f),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===a)break e;f=0;do{w=r[o+f++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w))}while(w&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=Ut(n.check,r,f,o)),a-=f,o+=f,w)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===a)break e;f=0;do{w=r[o+f++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w))}while(w&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=Ut(n.check,r,f,o)),a-=f,o+=f,w)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;l<16;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if(4&n.wrap&&c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Ir;break}c=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Er;break;case 16189:for(;l<32;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}e.adler=n.check=Nr(c),c=0,l=0,n.mode=br;case br:if(0===n.havedict)return e.next_out=s,e.avail_out=u,e.next_in=o,e.avail_in=a,n.hold=c,n.bits=l,fr;e.adler=n.check=1,n.mode=Er;case Er:if(t===cr||t===lr)break e;case wr:if(n.last){c>>>=7&l,l-=7&l,n.mode=Sr;break}for(;l<3;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}switch(n.last=1&c,c>>>=1,l-=1,3&c){case 0:n.mode=16193;break;case 1:if(Fr(n),n.mode=Tr,t===lr){c>>>=2,l-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=Ir}c>>>=2,l-=2;break;case 16193:for(c>>>=7&l,l-=7&l;l<32;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Ir;break}if(n.length=65535&c,c=0,l=0,n.mode=Cr,t===lr)break e;case Cr:n.mode=16195;case 16195:if(f=n.length,f){if(f>a&&(f=a),f>u&&(f=u),0===f)break e;i.set(r.subarray(o,o+f),s),a-=f,o+=f,u-=f,s+=f,n.length-=f;break}n.mode=Er;break;case 16196:for(;l<14;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if(n.nlen=257+(31&c),c>>>=5,l-=5,n.ndist=1+(31&c),c>>>=5,l-=5,n.ncode=4+(15&c),c>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Ir;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;l<3;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}n.lens[N[n.have++]]=7&c,c>>>=3,l-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},C=ar(0,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,C){e.msg="invalid code lengths set",n.mode=Ir;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;T=n.lencode[c&(1<<n.lenbits)-1],v=T>>>24,m=T>>>16&255,g=65535&T,!(v<=l);){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if(g<16)c>>>=v,l-=v,n.lens[n.have++]=g;else{if(16===g){for(I=v+2;l<I;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if(c>>>=v,l-=v,0===n.have){e.msg="invalid bit length repeat",n.mode=Ir;break}w=n.lens[n.have-1],f=3+(3&c),c>>>=2,l-=2}else if(17===g){for(I=v+3;l<I;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}c>>>=v,l-=v,w=0,f=3+(7&c),c>>>=3,l-=3}else{for(I=v+7;l<I;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}c>>>=v,l-=v,w=0,f=11+(127&c),c>>>=7,l-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Ir;break}for(;f--;)n.lens[n.have++]=w}}if(n.mode===Ir)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Ir;break}if(n.lenbits=9,S={bits:n.lenbits},C=ar(1,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,C){e.msg="invalid literal/lengths set",n.mode=Ir;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},C=ar(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,C){e.msg="invalid distances set",n.mode=Ir;break}if(n.mode=Tr,t===lr)break e;case Tr:n.mode=Ar;case Ar:if(a>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=o,e.avail_in=a,n.hold=c,n.bits=l,nr(e,h),s=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,r=e.input,a=e.avail_in,c=n.hold,l=n.bits,n.mode===Er&&(n.back=-1);break}for(n.back=0;T=n.lencode[c&(1<<n.lenbits)-1],v=T>>>24,m=T>>>16&255,g=65535&T,!(v<=l);){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if(m&&!(240&m)){for(y=v,b=m,E=g;T=n.lencode[E+((c&(1<<y+b)-1)>>y)],v=T>>>24,m=T>>>16&255,g=65535&T,!(y+v<=l);){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}c>>>=y,l-=y,n.back+=y}if(c>>>=v,l-=v,n.back+=v,n.length=g,0===m){n.mode=16205;break}if(32&m){n.back=-1,n.mode=Er;break}if(64&m){e.msg="invalid literal/length code",n.mode=Ir;break}n.extra=15&m,n.mode=16201;case 16201:if(n.extra){for(I=n.extra;l<I;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;T=n.distcode[c&(1<<n.distbits)-1],v=T>>>24,m=T>>>16&255,g=65535&T,!(v<=l);){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if(!(240&m)){for(y=v,b=m,E=g;T=n.distcode[E+((c&(1<<y+b)-1)>>y)],v=T>>>24,m=T>>>16&255,g=65535&T,!(y+v<=l);){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}c>>>=y,l-=y,n.back+=y}if(c>>>=v,l-=v,n.back+=v,64&m){e.msg="invalid distance code",n.mode=Ir;break}n.offset=g,n.extra=15&m,n.mode=16203;case 16203:if(n.extra){for(I=n.extra;l<I;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Ir;break}n.mode=16204;case 16204:if(0===u)break e;if(f=h-u,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Ir;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),_=n.window}else _=i,p=s-n.offset,f=n.length;f>u&&(f=u),u-=f,n.length-=f;do{i[s++]=_[p++]}while(--f);0===n.length&&(n.mode=Ar);break;case 16205:if(0===u)break e;i[s++]=n.length,u--,n.mode=Ar;break;case Sr:if(n.wrap){for(;l<32;){if(0===a)break e;a--,c|=r[o++]<<l,l+=8}if(h-=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?Ut(n.check,i,h,s-h):Rt(n.check,i,h,s-h)),h=u,4&n.wrap&&(n.flags?c:Nr(c))!==n.check){e.msg="incorrect data check",n.mode=Ir;break}c=0,l=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;l<32;){if(0===a)break e;a--,c+=r[o++]<<l,l+=8}if(4&n.wrap&&c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Ir;break}c=0,l=0}n.mode=16208;case 16208:C=hr;break e;case Ir:C=_r;break e;case 16210:return vr;default:return pr}return e.next_out=s,e.avail_out=u,e.next_in=o,e.avail_in=a,n.hold=c,n.bits=l,(n.wsize||h!==e.avail_out&&n.mode<Ir&&(n.mode<Sr||t!==ur))&&jr(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?Ut(n.check,i,h,e.next_out-h):Rt(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Er?128:0)+(n.mode===Tr||n.mode===Cr?256:0),(0===d&&0===h||t===ur)&&C===dr&&(C=mr),C},inflateEnd:e=>{if(xr(e))return pr;let t=e.state;return t.window&&(t.window=null),e.state=null,dr},inflateGetHeader:(e,t)=>{if(xr(e))return pr;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,dr):pr},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,o;return xr(e)?pr:(r=e.state,0!==r.wrap&&r.mode!==br?pr:r.mode===br&&(i=1,i=Rt(i,t,n,0),i!==r.check)?_r:(o=jr(e,t,n,n),o?(r.mode=16210,vr):(r.havedict=1,dr)))},inflateInfo:"pako inflate (from Nodeca project)"},Hr=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Vr=Object.prototype.toString,{Z_NO_FLUSH:Br,Z_FINISH:zr,Z_OK:Gr,Z_STREAM_END:Wr,Z_NEED_DICT:Kr,Z_STREAM_ERROR:Qr,Z_DATA_ERROR:Zr,Z_MEM_ERROR:Yr}=Pt;function $r(e){this.options=Pn.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Hn,this.strm.avail_out=0;let n=qr.inflateInit2(this.strm,t.windowBits);if(n!==Gr)throw new Error(Lt[n]);if(this.header=new Hr,qr.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=qn.string2buf(t.dictionary):"[object ArrayBuffer]"===Vr.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=qr.inflateSetDictionary(this.strm,t.dictionary),n!==Gr)))throw new Error(Lt[n])}function Xr(e,t){const n=new $r(t);if(n.push(e),n.err)throw n.msg||Lt[n.err];return n.result}$r.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=t===~~t?t:!0===t?zr:Br,"[object ArrayBuffer]"===Vr.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),o=qr.inflate(n,s),o===Kr&&i&&(o=qr.inflateSetDictionary(n,i),o===Gr?o=qr.inflate(n,s):o===Zr&&(o=Kr));n.avail_in>0&&o===Wr&&n.state.wrap>0&&0!==e[n.next_in];)qr.inflateReset(n),o=qr.inflate(n,s);switch(o){case Qr:case Zr:case Kr:case Yr:return this.onEnd(o),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||o===Wr))if("string"===this.options.to){let e=qn.utf8border(n.output,n.next_out),t=n.next_out-e,i=qn.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(o!==Gr||0!==a){if(o===Wr)return o=qr.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},$r.prototype.onData=function(e){this.chunks.push(e)},$r.prototype.onEnd=function(e){e===Gr&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Pn.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Jr={Inflate:$r,inflate:Xr,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Xr(e,t)},ungzip:Xr,constants:Pt};const{Deflate:ei,deflate:ti,deflateRaw:ni,gzip:ri}=er,{Inflate:ii,inflate:oi,inflateRaw:si,ungzip:ai}=Jr;var ui,ci={Deflate:ei,deflate:ti,deflateRaw:ni,gzip:ri,Inflate:ii,inflate:oi,inflateRaw:si,ungzip:ai,constants:Pt},li=function(e){return a(void 0,void 0,void 0,(function(){var t;return u(this,(function(n){return t=ci.ungzip(e),[2,String.fromCharCode.apply(null,t)]}))}))};!function(e){e.CONNECTING="CONNECTING",e.OPEN="OPEN",e.CLOSED="CLOSED"}(ui||(ui={}));var di,hi=function(e){function t(t,n){var r=n.sdkState,i=n.dispatcher,o=n.logger,s=e.call(this)||this;return s.lastActive=0,s._iid=t,s._sdkState=r,s._dispatcher=i,s._logger=o,s}return i(t,e),Object.defineProperty(t.prototype,"isOpen",{get:function(){return this.connectionState===ui.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return ui.CONNECTING;case 1:return ui.OPEN}return ui.CLOSED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ws",{get:function(){var e;return null!==(e=this._ws)&&void 0!==e?e:null},enumerable:!1,configurable:!0}),t.prototype._handleMessage=function(e){var t=this;e.split("\n").forEach((function(e){if(e){var n=De.createFromRawMessage(t._iid,e);if(t._logger.debug("receive websocket event",n),"LOGI"===n.code)t.dispatch("message",n);else if("PONG"===n.code)t.dispatch("pong");else if("EXPR"===n.code){if(n.payload){var r=new Re(n.payload);r.expiresIn>=0&&t._dispatcher.dispatch(r)}}else"NOOP"===n.code||t.dispatch("message",n)}}))},t.prototype.connect=function(e,t){var n=this;void 0===t&&(t=""),this._ws=new WebSocket(e,encodeURIComponent(t)),this._ws.onopen=function(){n._logger.debug("websocket open"),n.dispatch("open")},this._ws.onmessage=function(e){return a(n,void 0,void 0,(function(){var t,n,r,i,o=this;return u(this,(function(s){switch(s.label){case 0:return(null===(i=this._sdkState.websocket)||void 0===i?void 0:i.compression)?e.data instanceof Blob?((t=new FileReader).readAsArrayBuffer(e.data),t.onloadend=function(){return a(o,void 0,void 0,(function(){var e,n;return u(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,li(t.result)];case 1:return e=r.sent(),this._handleMessage(e),[3,3];case 2:return n=r.sent(),this.error(n),[3,3];case 3:return[2]}}))}))},[3,7]):[3,1]:[3,8];case 1:if(!(e.data instanceof ArrayBuffer))return[3,6];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,li(new Uint8Array(e.data))];case 3:return n=s.sent(),this._handleMessage(n),[3,5];case 4:return r=s.sent(),this.error(r),[3,5];case 5:return[3,7];case 6:"string"==typeof e.data&&this._handleMessage(e.data),s.label=7;case 7:return[3,9];case 8:this._handleMessage(e.data),s.label=9;case 9:return[2]}}))}))},this._ws.onerror=function(){n._logger.debug("websocket error"),n.dispatch("error",E.networkError)},this._ws.onclose=function(){n._logger.debug("websocket close"),n.dispatch("close")},this.lastActive=Date.now()},t.prototype.disconnect=function(){var e=this;return new Promise((function(t){e._logger.debug("websocket disconnect"),e._ws?(e._ws.onopen=Je,e._ws.onmessage=Je,e._ws.onerror=Je,e.connectionState!==ui.CLOSED?(e._ws.onclose=function(){e.dispatch("close"),t()},e._ws.close(),e._ws=void 0):t()):t()}))},t.prototype.send=function(e){if(!this._ws)throw E.connectionClosed;"PING"!==e.code?this.dispatch("ping-refresh"):this._logger.debug("send ping",e),this._ws.send(e.convertToMessage())},t.prototype.error=function(e){this._logger.debug("websocket error",e),this.dispatch("error",e)},t}(ne),fi=function(e){function t(t){var n=t.all,r=t.feed,i=t.custom_types,o=t.ts,s=e.call(this)||this;return s.all=n,s.feed=r,s.customTypes=i,s.ts=o,s}return i(t,e),t}(ie),pi=function(){function e(e,t){var n=t.session,r=t.sdkState,i=t.dispatcher,o=t.logger,s=t.useFetchCompat,a=void 0!==s&&s,u=this;this._ackStateMap=new Map,this._sdkState=r,this._dispatcher=i,this._logger=o,this.apiClient=new Xe(e,{session:n,sdkState:r,dispatcher:i,logger:o,useFetchCompat:a}),this.websocketClient=new hi(e,{sdkState:r,dispatcher:i,logger:o}),this.websocketClient.on("message",(function(e){if(e.payload.unread_cnt&&u._dispatcher.dispatch(new fi(e.payload.unread_cnt)),e.requestId){if(u._ackStateMap.has(e.requestId)){var t=u._ackStateMap.get(e.requestId);"EROR"!==e.code?t.resolve(e):t.reject(new E({code:e.payload.code,message:e.payload.message}))}}else u._dispatcher.dispatch(e)})).on("close",(function(){u._ackStateMap.forEach((function(e){e.reject(E.connectionClosed)})),u._ackStateMap.clear()}))}return e.prototype._sendApiRequest=function(e){return a(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.apiClient.send(e)];case 1:return[2,t.sent()]}}))}))},e.prototype._sendWebsocketRequest=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i=this;return u(this,(function(o){if(!this._sdkState.websocket)throw E.connectionRequired;if(t=new Ye,e.ackRequired){r=function(r,o){i._ackStateMap.has(e.requestId)&&(i._ackStateMap.delete(e.requestId),n&&(clearTimeout(n),n=null),r?(i._logger.debug("fail websocket request",e.requestId,r),t.reject(r)):(i._logger.debug("receive websocket ack",e.requestId,e),i._logger.debug("receive websocket ack",o),t.resolve(o)))};try{n=setTimeout((function(){return r(E.noAckTimeout)}),this._sdkState.websocket.responseTimeout),this._ackStateMap.set(e.requestId,{resolve:function(e){return r(void 0,e)},reject:function(e){return r(e)}}),this.websocketClient.send(e)}catch(e){r(e)}}else try{this.websocketClient.send(e),t.resolve()}catch(e){t.reject(e)}return[2,t.promise]}))}))},e.prototype.send=function(e){return a(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return e instanceof xe?[4,this._sendApiRequest(e)]:[3,2];case 1:case 3:return[2,t.sent()];case 2:return e instanceof Ue?[4,this._sendWebsocketRequest(e)]:[3,4];case 4:throw E.invalidParameters}}))}))},e.prototype.cancel=function(e){this.apiClient.cancel(e)},e.prototype.cancelAll=function(){this.apiClient.cancelAll()},e}();!function(e){e[e.NONE=0]="NONE",e[e.INITIALIZED=1]="INITIALIZED",e[e.CONNECTING=2]="CONNECTING",e[e.CONNECTED=3]="CONNECTED",e[e.RECONNECTING=4]="RECONNECTING",e[e.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",e[e.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",e[e.LOGOUT=7]="LOGOUT"}(di||(di={}));var _i=function(e){function t(t){var n=t.stateType,r=e.call(this)||this;return r.stateType=n,r}return i(t,e),t}(ie),vi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(ie),mi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(ie),gi=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(ie),yi=function(){function e(e){var t,n,r,i;this.isEnabled=null!==(t=e.enabled)&&void 0!==t&&t,this.feedChannels=null!==(n=e.feed_channels)&&void 0!==n?n:{},this.templateListToken=null!==(r=e.template_list_token)&&void 0!==r?r:null,this.settingsUpdatedAt=null!==(i=e.settings_updated_at)&&void 0!==i?i:0}return e.payloadify=function(e){return oe(se({enabled:e.isEnabled,feed_channels:e.feedChannels,template_list_token:e.templateListToken,settings_updated_at:e.settingsUpdatedAt}))},e}(),bi=function(e){return"sendbird@".concat(e,"/changelog_include_chat_notifications")},Ei=function(){function e(e){var t;this.lastUpdatedAt=null!==(t=e.last_updated_at)&&void 0!==t?t:0}return e.payloadify=function(e){return oe(se({last_updated_at:e.lastUpdatedAt}))},e}(),wi=1048576,Ci=5,Ti=function(){function e(e){var t,n,r,i,o;void 0===e&&(e={}),this.emojiHash=e.emoji_hash||"",this.uploadSizeLimit=e.file_upload_size_limit?e.file_upload_size_limit*wi:Number.MAX_SAFE_INTEGER,this.useReaction=!!e.use_reaction,this.applicationAttributes=null!==(t=e.application_attributes)&&void 0!==t?t:[],this.premiumFeatureList=null!==(n=e.premium_feature_list)&&void 0!==n?n:[],this.deviceTokenCache=this.applicationAttributes.includes("sdk_device_token_cache"),this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history"),this.multipleFilesMessageFileCountLimit=null!==(r=e.multiple_file_send_max_size)&&void 0!==r?r:5,this.allowSdkStatsUpload=null===(i=e.allow_sdk_log_ingestion)||void 0===i||i,this.uikitConfigInfo=new Ei(null!==(o=e.uikit_config)&&void 0!==o?o:{}),this.notificationInfo=e.notifications?new yi(e.notifications):null}return e.payloadify=function(e){return oe(se({emoji_hash:e.emojiHash,file_upload_size_limit:e.uploadSizeLimit/wi,application_attributes:e.applicationAttributes,premium_feature_list:e.premiumFeatureList,use_reaction:e.useReaction,allow_sdk_log_ingestion:e.allowSdkStatsUpload,uikit_config:e.uikitConfigInfo?Ei.payloadify(e.uikitConfigInfo):null,notifications:e.notificationInfo?yi.payloadify(e.notificationInfo):null}))},e}(),Ai=function(){function e(e){this._iid="",this._iid=e}return e.payloadify=function(e){return{}},e}(),Si=function(e){function t(t){var n=t.userId,r=t.metadata,i=e.call(this)||this;return i.method=ae.POST,i.path="".concat(ce,"/").concat(n,"/metadata"),i.params={metadata:r},i}return i(t,e),t}(xe),Ii=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metaData=n,r}return i(t,e),t}(Oe),Ni=function(e){function t(t){var n=t.userId,r=t.metadata,i=t.upsert,o=e.call(this)||this;return o.method=ae.PUT,o.path="".concat(ce,"/").concat(n,"/metadata"),o.params={metadata:r,upsert:i},o}return i(t,e),t}(xe),ki=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.metadata=n,r}return i(t,e),t}(Oe),xi=function(e){function t(t){var n=t.userId,r=t.metadataKey,i=e.call(this)||this;return i.method=ae.DELETE,i.path="".concat(ce,"/").concat(n,"/metadata/").concat(r),i}return i(t,e),t}(xe);!function(e){i((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(Oe);var Oi=function(e){function t(t){var n=t.userId,r=e.call(this)||this;return r.method=ae.DELETE,r.path="".concat(ce,"/").concat(n,"/metadata"),r}return i(t,e),t}(xe);!function(e){i((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(Oe);var Mi,Ri=function(e,t){var n=JSON.parse(JSON.stringify(e));return n._iid&&delete n._iid,t&&t(n),n},Di=function(e,t){var n=JSON.parse(JSON.stringify(e));return t&&t(n),n},Ui=function(e){return{do:function(t){e||t()},throw:function(t){if(!e)throw t}}};!function(e){e.ONLINE="online",e.OFFLINE="offline",e.NON_AVAILABLE="nonavailable"}(Mi||(Mi={}));var Li,Pi=function(e){function t(t,n){var r,i,o,s,a,u,c,h,f,p,_,v,m=this;return(m=e.call(this,t)||this).userId=null!==(i=null!==(r=n.guest_id)&&void 0!==r?r:n.user_id)&&void 0!==i?i:"",m.nickname=null!==(s=null!==(o=n.nickname)&&void 0!==o?o:n.name)&&void 0!==s?s:"",m.plainProfileUrl=null!==(u=null!==(a=n.profile_url)&&void 0!==a?a:n.image)&&void 0!==u?u:"",m.requireAuth=null!==(c=n.require_auth_for_profile_image)&&void 0!==c&&c,m.metaData=null!==(h=n.metadata)&&void 0!==h?h:{},m.connectionStatus=Mi.NON_AVAILABLE,S(Mi,n.is_online)?m.connectionStatus=n.is_online:A("boolean",n.is_online)&&(m.connectionStatus=n.is_online?Mi.ONLINE:Mi.OFFLINE),m.isActive=null===(f=n.is_active)||void 0===f||f,m.lastSeenAt=null!==(p=n.last_seen_at)&&void 0!==p?p:null,m.preferredLanguages=n.preferred_languages?d([],l(n.preferred_languages),!1):null,m.friendDiscoveryKey=null!==(_=n.friend_discovery_key)&&void 0!==_?_:null,m.friendName=null!==(v=n.friend_name)&&void 0!==v?v:null,m}return i(t,e),t.payloadify=function(t){return oe(se(o(o({},e.payloadify.call(this,t)),{user_id:t.userId,nickname:t.nickname,profile_url:t.plainProfileUrl,require_auth_for_profile_image:t.requireAuth,metadata:t.metaData,is_online:t.connectionStatus,is_active:t.isActive,last_seen_at:t.lastSeenAt,preferred_languages:t.preferredLanguages,friend_discovery_key:t.friendDiscoveryKey,friend_name:t.friendName})))},Object.defineProperty(t.prototype,"profileUrl",{get:function(){var e=So.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return Ri(this)},t.prototype._isValidMetaData=function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return A("string",e)}))},t.prototype._applyMetaData=function(e,t){var n=this;void 0===t&&(t=!1),Object.keys(e).forEach((function(r){t?delete n.metaData[r]:n.metaData[r]=e[r]}))},t.prototype.createMetaData=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o,s;return u(this,(function(a){switch(a.label){case 0:return Ui(this._isValidMetaData(e)).throw(E.invalidParameters),t=So.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new Si({userId:n.userId,metadata:e}),[4,r.send(i)];case 1:return o=a.sent(),s=o.as(Ii).metaData,this._applyMetaData(s),[2,this.metaData]}}))}))},t.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),a(this,void 0,void 0,(function(){var n,r,i,o,s,a;return u(this,(function(u){switch(u.label){case 0:return Ui(this._isValidMetaData(e)).throw(E.invalidParameters),n=So.of(this._iid),r=n.sdkState,i=n.requestQueue,o=new Ni({userId:r.userId,metadata:e,upsert:t}),[4,i.send(o)];case 1:return s=u.sent(),a=s.as(ki).metadata,this._applyMetaData(a),[2,this.metaData]}}))}))},t.prototype.deleteMetaData=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o;return u(this,(function(s){switch(s.label){case 0:return Ui(A("string",e)).throw(E.invalidParameters),t=So.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new xi({userId:n.userId,metadataKey:e}),[4,r.send(i)];case 1:return s.sent(),this._applyMetaData(((o={})[e]=!0,o),!0),[2,this.metaData]}}))}))},t.prototype.deleteAllMetaData=function(){return a(this,void 0,void 0,(function(){var e,t,n,r;return u(this,(function(i){switch(i.label){case 0:return e=So.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Oi({userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),this.metaData={},[2]}}))}))},t}(Ai),Fi=function(e){function t(t){var n=t.userProfile,r=e.call(this)||this;return r.userProfile=n,r}return i(t,e),t}(ie),ji=function(){function e(e,t){var n,r,i,o,s,a,u,c,l,d,h,f,p,_;this._iid=e,this.appInfo=new Ti(t),this.user=new Pi(e,t),this.connectedAt=null!==(n=t.login_ts)&&void 0!==n?n:0,this.firstConnectedAt=0,this.pingInterval=null!==(r=t.ping_interval)&&void 0!==r?r:15e3,this.pongTimeout=null!==(i=t.pong_timeout)&&void 0!==i?i:5e3,this.reconnectInterval=null!==(s=null===(o=t.reconnect)||void 0===o?void 0:o.interval)&&void 0!==s?s:3e3,this.reconnectMaxInterval=null!==(u=null===(a=t.reconnect)||void 0===a?void 0:a.max_interval)&&void 0!==u?u:6e4,this.reconnectRetryCount=null!==(l=null===(c=t.reconnect)||void 0===c?void 0:c.retry_cnt)&&void 0!==l?l:5,this.reconnectIntervalMultiple=null!==(h=null===(d=t.reconnect)||void 0===d?void 0:d.mul)&&void 0!==h?h:2,this.maxUnreadCountOnSuperGroup=null!==(f=t.max_unread_cnt_on_super_group)&&void 0!==f?f:100,this.profileImageEncryption=!!t.profile_image_encryption,this.concurrentCallLimit=null!==(p=t.concurrent_call_limit)&&void 0!==p?p:5,this.backOffDelay=null!==(_=t.back_off_delay)&&void 0!==_?_:100}return e.payloadify=function(e){return oe(se(o(o(o({},Pi.payloadify(e.user)),Ti.payloadify(e.appInfo)),{login_ts:e.connectedAt,ping_interval:e.pingInterval,pong_timeout:e.pongTimeout,reconnect:{interval:e.reconnectInterval,max_interval:e.reconnectMaxInterval,retry_cnt:e.reconnectRetryCount,mul:e.reconnectIntervalMultiple},max_unread_cnt_on_super_group:e.maxUnreadCountOnSuperGroup,profile_image_encryption:e.profileImageEncryption,concurrent_call_limit:e.concurrentCallLimit,back_off_delay:e.backOffDelay})))},e.prototype.apply=function(){var e=this.reconnectInterval,t=this.reconnectMaxInterval,n=this.reconnectIntervalMultiple,r=So.of(this._iid);r.sdkState.websocket&&(r.sdkState.websocket.pingInterval=1e3*this.pingInterval,r.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,r.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,r.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(r){return r>0?1e3*Math.min(e*Math.pow(n,r-1),t):10}}),r.appInfo=this.appInfo,r.sessionManager.currentUser=this.user,r.connectedAt=this.connectedAt,this.firstConnectedAt||(r.firstConnectedAt=this.connectedAt),r.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,r.concurrentCallLimit=this.concurrentCallLimit,r.backOffDelay=this.backOffDelay,r.dispatcher.dispatch(new Fi({userProfile:this}))},e}(),qi=function(e){function t(t){var n=t.request,r=void 0===n||n,i=t.features,s=void 0===i?{}:i,a=t.options,u=void 0===a?{}:a,c=e.call(this)||this;return c.request=r,c.features=o({localCache:!0,notification:!0},s),c.options=o({ingestion:!0},u),c}return i(t,e),t}(ie),Hi=function(e){function t(t,n,r){var i,o,s,a,u=this;return(u=e.call(this,t,n,r)||this).error=null,u.services=[],u.userProfile=new ji(t,r),u.deviceTokenLastDeletedAt=null!==(i=r.device_token_last_deleted_at)&&void 0!==i?i:0,u.key=null!==(o=r.key)&&void 0!==o?o:"",u.ekey=null!==(s=r.ekey)&&void 0!==s?s:"",u.error=r.error?new E(r):null,u.services=null!==(a=r.services)&&void 0!==a?a:[],u}return i(t,e),t.asError=function(e){return new t("","LOGI",o({user_id:"",error:!0},e))},t.prototype.applyTo=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return u(this,(function(i){switch(i.label){case 0:return this.error?[3,4]:(t=So.of(e))?(n=t.sessionManager,r=t.dispatcher,[4,n.login(this)]):[3,2];case 1:return i.sent(),this.userProfile.apply(),r.dispatch(new qi({request:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish"),features:{localCache:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_feature_local_cache_log_publish"),notification:this.userProfile.appInfo.applicationAttributes.includes("allow_sdk_noti_stats_log_publish")},options:{ingestion:this.userProfile.appInfo.allowSdkStatsUpload}})),[3,3];case 2:throw E.lostInstance;case 3:return[3,5];case 4:throw this.error;case 5:return[2]}}))}))},t}(De),Vi=function(){function e(){this.type=di.NONE,this.name="none"}return e.prototype.run=function(e){return a(this,void 0,void 0,(function(){return u(this,(function(e){return[2]}))}))},e.prototype.onConnect=function(e,t){return a(this,void 0,void 0,(function(){return u(this,(function(e){return[2]}))}))},e.prototype.onReconnect=function(e,t){return t.resetReconnectCount,a(this,void 0,void 0,(function(){return u(this,(function(e){return[2]}))}))},e.prototype.onDisconnect=function(e,t){return t.error,t.autoReconnect,t.cause,a(this,void 0,void 0,(function(){return u(this,(function(e){return[2]}))}))},e.prototype.onDisconnectWebSocket=function(e,t){return a(this,void 0,void 0,(function(){return u(this,(function(e){return[2]}))}))},e.prototype.onLogout=function(e){return a(this,void 0,void 0,(function(){return u(this,(function(e){return[2]}))}))},e}(),Bi=function(e){return a(void 0,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:if(!((t=n.sent())instanceof E))throw t;return t.throwOutside(),[3,3];case 3:return[2]}}))}))},zi=function(e){return a(void 0,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},Gi=function(e){function t(t){void 0===t&&(t={});var n,r=this;return(r=e.call(this)||this).type=di.LOGOUT,r.name="logout",r._wasPreviouslyConnected=null===(n=t.wasPreviouslyConnected)||void 0===n||n,r}return i(t,e),t.prototype.run=function(e){return a(this,void 0,void 0,(function(){var t,n,r=this;return u(this,(function(i){switch(i.label){case 0:return t=Date.now(),n=e.sdkState.userId,[4,e.logout()];case 1:return i.sent(),[4,e.changeState(new ro,t)];case 2:return i.sent(),this._wasPreviouslyConnected&&Bi((function(){return a(r,void 0,void 0,(function(){return u(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onDisconnected&&e.onDisconnected(n)})),[2]}))}))})),[2]}}))}))},t}(Vi),Wi=function(e){function t(){var t=e.call(this)||this;return t.type=di.EXTERNAL_DISCONNECTED,t.name="externaldisconnected",t}return i(t,e),t.prototype.run=function(e){return a(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,e.disconnect()];case 1:return t.sent(),[2]}}))}))},t.prototype.onConnect=function(e,t){return a(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new eo({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},t.prototype.onReconnect=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new $i,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Gi,t)];case 1:return n.sent(),[2]}}))}))},t}(Vi),Ki=function(e){function t(t){var n=t.autoReconnect,r=e.call(this)||this;return r.type=di.INTERNAL_DISCONNECTED,r.name="internaldisconnected",r._autoReconnect=!1,r._autoReconnect=n,r}return i(t,e),t.prototype.run=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),this._autoReconnect?[4,e.changeState(new $i,t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.onConnect=function(e,t){return a(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new eo({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},t.prototype.onReconnect=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new $i,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Wi,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Gi,t)];case 1:return n.sent(),[2]}}))}))},t}(Vi),Qi=function(e){return a(void 0,void 0,void 0,(function(){return u(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))},Zi=function(){function e(){}return e.prototype.calcTimeout=function(){return 0},e}(),Yi=function(e,t,n){return void 0===n&&(n=new Zi),a(void 0,void 0,void 0,(function(){var r,i,o,s,a,c;return u(this,(function(u){switch(u.label){case 0:r=0,i=null,o=function(e){return i=null!=e?e:new Error("Halted")},s=function(){r=0},u.label=1;case 1:if(!(-1===t||r<t))return[3,9];u.label=2;case 2:return u.trys.push([2,4,,8]),[4,e(o,s)];case 3:if(a=u.sent(),i)throw i;return[2,a];case 4:if(c=u.sent(),i)return[3,6];if(++r===t)throw c;return[4,Qi(n.calcTimeout(r))];case 5:return u.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return[3,1];case 9:throw"It should not happen."}}))}))},$i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=di.RECONNECTING,t.name="reconnecting",t._callbacks=[],t}return i(t,e),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._resetConnect=void 0,this._callbacks.forEach((function(t){return t(e)}))},t.prototype.run=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o,s,c=this;return u(this,(function(l){switch(l.label){case 0:t=Date.now(),n=new Ye,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),Bi((function(){return a(c,void 0,void 0,(function(){return u(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectStarted&&e.onReconnectStarted()})),[2]}))}))})),l.label=1;case 1:return l.trys.push([1,4,,9]),r=e.sdkState.websocket,i=r.reconnectMaxRetry,o=r.reconnectRetryStrategy,[4,Yi((function(t,n){return a(c,void 0,void 0,(function(){var r;return u(this,(function(i){switch(i.label){case 0:this._haltConnect=t,this._resetConnect=n,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.connect()];case 2:return i.sent(),[3,4];case 3:if(r=i.sent(),e.clearLoginTimer(),r instanceof E){if(r.code===h.CONNECTION_CANCELED)return t(r),[2];if(r.isSessionExpiredError||r.isSessionInvalidatedError)return t(r),[2]}throw r;case 4:return[2]}}))}))}),i,o)];case 2:return l.sent(),[4,e.changeState(new Xi,t)];case 3:return l.sent(),this._flushCallbacks(),Bi((function(){return a(c,void 0,void 0,(function(){return u(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectSucceeded&&e.onReconnectSucceeded()})),[2]}))}))})),[3,9];case 4:return s=l.sent(),b(s)?[3,7]:s instanceof E?s.code===h.CONNECTION_CANCELED?[3,6]:[4,e.changeState(new Ki({autoReconnect:!1}),t)]:[3,6];case 5:l.sent(),l.label=6;case 6:return this._flushCallbacks(s),Bi((function(){return a(c,void 0,void 0,(function(){return u(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectFailed&&e.onReconnectFailed()})),[2]}))}))})),[3,8];case 7:throw s;case 8:return[3,9];case 9:return[2,n.promise]}}))}))},t.prototype.onConnect=function(e,t){return a(this,void 0,void 0,(function(){var n;return u(this,(function(r){return n=new Ye,this._halt(E.connectionCanceled),e.cancelConnectForRetry(),this._callbacks.push((function(){var r=Date.now();e.changeState(new eo({authToken:t}),r).then((function(){n.resolve()})).catch((function(e){n.reject(e)}))})),[2,n.promise]}))}))},t.prototype.onReconnect=function(e,t){var n=t.resetReconnectCount,r=void 0!==n&&n;return a(this,void 0,void 0,(function(){var e;return u(this,(function(t){return e=new Ye,this._resetConnect&&r&&this._resetConnect(),this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},t.prototype.onDisconnect=function(e,t){t.error;var n=t.autoReconnect,r=void 0===n||n;return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(E.connectionCanceled),[4,e.changeState(new Ki({autoReconnect:r}),t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(E.connectionCanceled),[4,e.changeState(new Wi,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(E.connectionCanceled),[4,e.changeState(new Gi,t)];case 1:return n.sent(),[2]}}))}))},t}(Vi),Xi=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=di.CONNECTED,t.name="connected",t}return i(t,e),t.prototype.onReconnect=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),[4,e.changeState(new $i,t)];case 2:return n.sent(),[2]}}))}))},t.prototype.onDisconnect=function(e,t){var n=t.autoReconnect;return a(this,void 0,void 0,(function(){var t;return u(this,(function(r){switch(r.label){case 0:return t=Date.now(),[4,e.changeState(new Ki({autoReconnect:n}),t)];case 1:return r.sent(),[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Wi,t)];case 1:return n.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Gi,t)];case 1:return n.sent(),[2]}}))}))},t}(Vi);!function(e){e.ExternalSetBackground="ExternalSetBackground",e.ExternalDisconnectWebSocket="ExternalDisconnectWebSocket"}(Li||(Li={}));var Ji=function(){function e(e,t){var n=t.sdkState,r=t.cacheContext,i=t.connectionHandlers,o=t.sessionManager,s=t.websocketClient,a=t.dispatcher,u=t.logger,c=t.disableWebSocketCloseEventHandling,l=void 0!==c&&c;this._disableWebSocketCloseEventHandling=!1,this._webSocketClosedCause=null,this._logger=u,this._disableWebSocketCloseEventHandling=l,this._context=new ao(e,{sdkState:n,cacheContext:r,connectionHandlers:i,sessionManager:o,websocketClient:s,dispatcher:a,logger:u}),this._sdkState=n,this._sessionManager=o,this._websocketClient=s}return e.prototype._registerEventDispatcher=function(){var e=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh",(function(){e.isConnecting||e.isConnected||(e._logger.debug("try reconnect by session key refresh"),zi((function(){return a(e,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.reconnect()];case 1:return e.sent(),[2]}}))}))})))})),this._websocketEventDispatcherContext=this._websocketClient.on("close",(function(){"foreground"!==e._sdkState.appState||e._webSocketClosedCause||zi((function(){return a(e,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return this._sessionManager.isSessionKeyRefreshing?[3,2]:(this._logger.debug("try reconnect by websocket connection closed"),[4,this.reconnect()]);case 1:return e.sent(),[3,4];case 2:return[4,this.disconnectWebSocket()];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))}))})))},e.prototype._clearEventDispatcher=function(){this._sessionEventDispatcherContext&&(this._sessionEventDispatcherContext.close(),this._sessionEventDispatcherContext=void 0),this._websocketEventDispatcherContext&&(this._websocketEventDispatcherContext.close(),this._websocketEventDispatcherContext=void 0)},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this._context.currentState.type===di.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnecting",{get:function(){var e=this._context.currentState;return e.type===di.CONNECTING||e.type===di.RECONNECTING},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketClient",{get:function(){return this._websocketClient},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=this._context.currentState,this._webSocketClosedCause=null,[4,t.onConnect(this._context,e)];case 1:return n.sent(),this._registerEventDispatcher(),[2]}}))}))},e.prototype.reconnect=function(){return a(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._webSocketClosedCause=null,[4,e.onReconnect(this._context,{})];case 1:return t.sent(),[2]}}))}))},e.prototype.resetAndReconnect=function(){return a(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._webSocketClosedCause=null,[4,e.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return t.sent(),[2]}}))}))},e.prototype.background=function(){return a(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._webSocketClosedCause=Li.ExternalSetBackground,[4,e.onDisconnect(this._context,{autoReconnect:!1,cause:this._webSocketClosedCause})];case 1:return t.sent(),[2]}}))}))},e.prototype.disconnect=function(e){return a(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{error:e,autoReconnect:!0,cause:this._webSocketClosedCause})];case 1:return t.sent(),[2]}}))}))},e.prototype.disconnectWebSocket=function(e){return void 0===e&&(e=!1),a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=this._context.currentState,e&&(this._webSocketClosedCause=Li.ExternalDisconnectWebSocket),[4,t.onDisconnectWebSocket(this._context,{cause:this._webSocketClosedCause})];case 1:return n.sent(),[2]}}))}))},e.prototype.logout=function(){return a(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._clearEventDispatcher(),[4,e.onLogout(this._context)];case 1:return t.sent(),[2]}}))}))},e}(),eo=function(e){function t(t){var n=t.authToken,r=e.call(this)||this;return r.type=di.CONNECTING,r.name="connecting",r._authToken="",r._callbacks=[],r._authToken=n,r}return i(t,e),t.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=void 0)},t.prototype._flushCallbacks=function(e){this._haltConnect=void 0,this._callbacks.forEach((function(t){return t(e)}))},t.prototype.run=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i=this;return u(this,(function(o){switch(o.label){case 0:t=Date.now(),n=new Ye,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),o.label=1;case 1:return o.trys.push([1,4,,10]),[4,Yi((function(t){return a(i,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:this._haltConnect=t,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.connect(this._authToken)];case 2:return r.sent(),[3,4];case 3:if(n=r.sent(),e.clearLoginTimer(),n instanceof E&&n.code===h.CONNECTION_CANCELED)return t(n),[2];throw n;case 4:return[2]}}))}))}),e.sdkState.websocket.connectMaxRetry)];case 2:return o.sent(),[4,e.changeState(new Xi,t)];case 3:return o.sent(),Bi((function(){return a(i,void 0,void 0,(function(){return u(this,(function(t){return this._flushCallbacks(),e.connectionHandlers.forEach((function(t){t.onConnected&&t.onConnected(e.sdkState.userId)})),[2]}))}))})),[3,10];case 4:return r=o.sent(),b(r)?[3,8]:[4,e.disconnect()];case 5:return o.sent(),r instanceof E?r.code===h.CONNECTION_CANCELED?[3,7]:[4,e.changeState(new ro,t)]:[3,7];case 6:o.sent(),o.label=7;case 7:return Bi((function(){return a(i,void 0,void 0,(function(){return u(this,(function(e){return this._flushCallbacks(r),[2]}))}))})),[3,9];case 8:throw r;case 9:return[3,10];case 10:return[2,n.promise]}}))}))},t.prototype.onConnect=function(e){return a(this,void 0,void 0,(function(){var e;return u(this,(function(t){return e=new Ye,this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},t.prototype.onDisconnect=function(e,t){var n=t.error,r=void 0===n?null:n,i=t.autoReconnect,o=void 0!==i&&i,s=t.cause,c=void 0===s?null:s;return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(null!=r?r:to(c)),e.hasSession?[4,e.changeState(new Ki({autoReconnect:o}),t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new Gi,t)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.onDisconnectWebSocket=function(e,t){return a(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return this._halt(to((null==t?void 0:t.cause)||null)),n=Date.now(),e.hasSession?[4,e.changeState(new Wi,n)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,e.changeState(new Gi,n)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},t.prototype.onLogout=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(E.connectionCanceled),[4,e.changeState(new Gi,t)];case 1:return n.sent(),[2]}}))}))},t}(Vi);function to(e){var t=E.connectionCanceled;if(e){var n=null;switch(e){case Li.ExternalSetBackground:n="Connection has been canceled due to the application having externally moved to background while in ConnectingState.";break;case Li.ExternalDisconnectWebSocket:n="Connection has been canceled because sb.disconnectWebSocket() was called while in ConnectingState."}n&&t.setDetail(n)}return t}var no,ro=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=di.INITIALIZED,t.name="initialized",t}return i(t,e),t.prototype.onConnect=function(e,t){return a(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.changeState(new eo({authToken:t}),n)];case 1:return r.sent(),[2]}}))}))},t.prototype.onLogout=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Gi({wasPreviouslyConnected:!1}),t)];case 1:return n.sent(),[2]}}))}))},t}(Vi),io=function(e){function t(){return e.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this}return i(t,e),t}(Ue),oo=function(){function e(e){var t=e.pingDelegate,n=e.sdkState,r=e.logger;this.pingDelegate=t,this.sdkState=n,this._logger=r}return Object.defineProperty(e.prototype,"isWaiting",{get:function(){return!!this._pingTimeoutTimer},enumerable:!1,configurable:!0}),e.prototype.ping=function(){var e,t=this;if(!this.sdkState.websocket)throw E.connectionRequired;var n=new io;try{var r=null!==(e=this.sdkState.websocket.pongTimeout)&&void 0!==e?e:5e3;this._pingTimeoutTimer=setTimeout((function(){t._logger.debug("pinger.ping() timeout"),t.pingDelegate.error()}),r),this.pingDelegate.send(n),this._logger.debug("pinger.ping()")}catch(e){this._logger.debug("pinger.ping() error",e),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0),this.pingDelegate.error()}return n},e.prototype.pong=function(){this._logger.debug("pinger.pong()"),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},e.prototype.refreshTimer=function(){var e,t=this;if(!this.sdkState.websocket)throw E.connectionRequired;this._logger.debug("pinger.refreshTimer()");var n=null!==(e=this.sdkState.websocket.pingInterval)&&void 0!==e?e:15e3;this.stop(),this._pingTimer=setInterval((function(){t.ping()}),n)},e.prototype.start=function(){this._logger.debug("pinger.start()"),this.refreshTimer(),this.ping()},e.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=void 0),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=void 0)},e}(),so=["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash","multiple_file_send_max_size","notifications"],ao=function(e){function t(t,n){var r,i=n.sdkState,o=n.cacheContext,s=n.connectionHandlers,a=n.sessionManager,u=n.websocketClient,c=n.dispatcher,l=n.logger,d=n.entryState,h=void 0===d?new ro:d,f=this;return(f=e.call(this)||this)._stateUpdatedAt=0,f._connectingAt=0,f._connectionRequestQueue=[],f._iid=t,f.sdkState=i,f.cacheContext=o,f.connectionHandlers=s,f._sessionManager=a,f._websocketClient=u,f._dispatcher=c,f._logger=l,f._currentState=h,(null===(r=f.sdkState.websocket)||void 0===r?void 0:r.pingerDisabled)||(f._pinger=new oo({pingDelegate:{send:function(e){return f._websocketClient.send(e)},error:function(e){return f._websocketClient.error(e)}},sdkState:f.sdkState,logger:l})),f._websocketClient.on("open",(function(){f._tryResolveConnectionRequest()})).on("message",(function(e){"LOGI"===e.code&&(f.clearLoginTimer(),f._dispatcher.dispatch(e.as(Hi)))})).on("ping-refresh",(function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.refreshTimer()})).on("pong",(function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.pong()})).on("error",(function(){var e;return null===(e=f._pinger)||void 0===e?void 0:e.stop()})).on("close",(function(){f._logiProcessingTimer=setTimeout((function(){f._logiProcessingTimer=void 0,f._unresolvedLogi||f._rejectConnectionRequest(E.networkError)}),500)})),f._dispatcher.on((function(e){e instanceof Hi&&(f._unresolvedLogi=e,f._tryResolveConnectionRequest())})),f}return i(t,e),Object.defineProperty(t.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSession",{get:function(){return this._sessionManager.session.hasSession},enumerable:!1,configurable:!0}),t.prototype.changeState=function(e,t){return a(this,void 0,void 0,(function(){return u(this,(function(n){switch(n.label){case 0:return t>=this._stateUpdatedAt?(this._currentState=e,this._stateUpdatedAt=t,this._dispatcher.dispatch(new _i({stateType:e.type})),this._logger.debug("connection state changes to ".concat(e.name)),[4,this._currentState.run(this)]):[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}}))}))},t.prototype._tryResolveConnectionRequest=function(){var e;return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return t=this._unresolvedLogi,this._websocketClient.isOpen&&t?(this._unresolvedLogi=void 0,t.error?[3,2]:[4,t.applyTo(this._iid)]):[3,3];case 1:return n.sent(),this._statLogConnection(),null===(e=this._pinger)||void 0===e||e.start(),this._connectionRequestQueue.forEach((function(e){return e.resolve()})),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.session.authToken=void 0,(t.error.isSessionExpiredError||t.error.isSessionInvalidatedError)&&this._dispatcher.dispatch(new Re({reason:t.error.code})),this._rejectConnectionRequest(t.error),n.label=3;case 3:return[2]}}))}))},t.prototype._rejectConnectionRequest=function(e){var t;if(null===(t=this._pinger)||void 0===t||t.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0){var n=this._connectionRequestQueue;this._connectionRequestQueue=[],n.forEach((function(t){return t.reject(e)})),this._statLogConnection(e)}},t.prototype._url=function(){var e,t=this.sdkState,n=t.appId,r=t.appVersion,i=t.userId,o=t.extensions,s=t.sendbirdRuntimeEnvironment,a=this.cacheContext.localCacheEnabled,u=this._sessionManager.session,c=null===(e=this.sdkState.websocket)||void 0===e?void 0:e.compression,l=!!(null!=o?o:{}).sb_uikit,d=Ze.userAgentWithExtension(o);return"".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent(p.OS_VERSION),"&sv=").concat(encodeURIComponent(p.SDK_VERSION),"&ai=").concat(n).concat(r?"&av=".concat(r):"").concat(u.hasSession?"":"&user_id=".concat(encodeURIComponent(i)),"&pmce=").concat(c?1:0,"&active=1&device_token_types=").concat(encodeURIComponent(["gcm","huawei","apns"].join(",")),"&SB-User-Agent=").concat(d,"&SB-SDK-User-Agent=").concat(encodeURIComponent(Ze.sendbirdSdkUserAgentWithExtension(s)),"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(so))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(a?1:0,"&include_poll_details=1").concat(l?"&uikit_config=1":"")},t.prototype._statLogConnection=function(e){var t;this._dispatcher.dispatch(new qe(new Ge({type:ke.WEBSOCKET_CONNECT,data:{host_url:null===(t=this.sdkState.websocket)||void 0===t?void 0:t.host,success:!e,latency:Date.now()-this._connectingAt,error_code:null==e?void 0:e.code,error_description:null==e?void 0:e.message}})))},t.prototype.connect=function(e){var t;return void 0===e&&(e=""),a(this,void 0,void 0,(function(){var n,r,i,o=this;return u(this,(function(s){return this._logiProcessingTimer&&(clearTimeout(this._logiProcessingTimer),this._logiProcessingTimer=void 0,this._rejectConnectionRequest(E.connectionCanceled)),n=this._url(),r=new Ye,this._connectionRequestQueue.push(r),1===this._connectionRequestQueue.length&&(this._connectingAt=Date.now(),this._loginTimer=setTimeout((function(){o._loginTimer=void 0,o._rejectConnectionRequest(E.loginTimeout)}),null===(t=this.sdkState.websocket)||void 0===t?void 0:t.responseTimeout),i=this._sessionManager.session,e&&(i.authToken=e),this._websocketClient.connect(n,JSON.stringify(i.hasSession?{auth:i.sessionKey}:{token:e}))),[2,r.promise]}))}))},t.prototype.cancelConnectForRetry=function(){this._dispatcher.dispatch(Hi.asError(E.connectionRenew))},t.prototype.disconnect=function(){return a(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this._websocketClient.disconnect()];case 1:return e.sent(),[2]}}))}))},t.prototype.logout=function(){return a(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return this.sdkState.userId=void 0,this._unresolvedLogi=void 0,[4,this._sessionManager.clear()];case 1:return e.sent(),[4,this.disconnect()];case 2:return e.sent(),[2]}}))}))},t.prototype.clearLoginTimer=function(){this._loginTimer&&(clearTimeout(this._loginTimer),this._loginTimer=void 0)},t}(ne),uo=function(e){function t(t){var n=t.appId,r=t.userId,i=t.services,o=void 0===i?[j.CHAT]:i,s=t.includeUIKitConfig,a=void 0!==s&&s,u=t.localCacheEnabled,c=void 0===u||u,l=t.expiringSession,d=void 0===l||l,h=e.call(this)||this;return h.path="".concat(ce,"/").concat(r,"/login"),h.method=ae.POST,h.params={expiring_session:!!d,services:o,include_logi:!0,include_extra_data:String(so),uikit_config:a,use_local_cache:c,app_id:n},h.requireAuth=!1,h}return i(t,e),t}(xe),co=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.logi=new Hi(t,"LOGI",n),r}return i(t,e),t}(Oe);!function(e){e[e.ALL=0]="ALL",e[e.WEBSOCKET=1]="WEBSOCKET",e[e.API=2]="API"}(no||(no={}));var lo,ho=[Le,uo],fo=function(){function e(e,t){var n=t.session,r=t.sdkState,i=t.dispatcher,o=t.logger,s=t.useFetchCompat,a=void 0!==s&&s,u=this;this._currentConnectionStateType=di.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new pi(e,{session:n,sdkState:r,dispatcher:i,logger:o,useFetchCompat:a}),this._session=n,this._logger=o,this._dispatcher=i,this._dispatcher.on((function(e){var t,n,r,i;if(e instanceof _i){var o=e.stateType;switch(u._currentConnectionStateType=o,o){case di.CONNECTED:u._resolveLazyCallQueue();break;case di.INITIALIZED:case di.INTERNAL_DISCONNECTED:case di.EXTERNAL_DISCONNECTED:case di.LOGOUT:u._rejectLazyCallQueue((null===(r=u._session)||void 0===r?void 0:r.hasSession)?E.connectionClosed:E.connectionRequired)}}else if(e instanceof vi)(null===(i=u._session.services)||void 0===i?void 0:i.includes(j.CHAT))||u._resolveLazyCallQueue(no.API);else if(e instanceof mi||e instanceof gi)u._rejectLazyCallQueue(E.connectionClosed);else if(e instanceof He){var s=e.request,a=e.deferred,l=e.error;try{for(var d=c(ho),h=d.next();!h.done;h=d.next())if(s instanceof h.value)return void a.reject(l)}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}u._lazyCallQueue.push({command:s,deferred:a})}}))}return Object.defineProperty(e.prototype,"isReady",{get:function(){return this._currentConnectionStateType===di.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLazyCallActivated",{get:function(){return this._currentConnectionStateType===di.CONNECTING||this._currentConnectionStateType===di.RECONNECTING||this._session.isRefreshing},enumerable:!1,configurable:!0}),e.prototype._classifyLazyCallQueueByScope=function(e){var t,n=[],r=[];switch(e){case no.ALL:t=null;break;case no.WEBSOCKET:t=Ue;break;case no.API:t=xe}var i=!1;return this._lazyCallQueue.forEach((function(e){!t||e.command instanceof t||(i=!0),i?r.push(e):n.push(e)})),[n,r]},e.prototype._resolveLazyCallQueue=function(e){var t=this;void 0===e&&(e=no.ALL);var n=l(this._classifyLazyCallQueueByScope(e),2),r=n[0],i=n[1];this._lazyCallQueue=i,r.forEach((function(e){return a(t,void 0,void 0,(function(){var t,n,r,i,o;return u(this,(function(s){switch(s.label){case 0:t=e.command,n=e.deferred,(r=e.timeout)&&clearTimeout(r),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.send(t)];case 2:return i=s.sent(),n.resolve(i),[3,4];case 3:return o=s.sent(),n.reject(o),[3,4];case 4:return[2]}}))}))}))},e.prototype._rejectLazyCallQueue=function(e,t){var n=this;void 0===t&&(t=no.ALL);var r=l(this._classifyLazyCallQueueByScope(t),2),i=r[0],o=r[1];this._lazyCallQueue=o,i.forEach((function(t){return a(n,void 0,void 0,(function(){var n,r;return u(this,(function(i){return n=t.deferred,r=t.timeout,clearTimeout(r),n.reject(e),[2]}))}))}))},e.prototype.send=function(e){return a(this,void 0,void 0,(function(){var t,n,r=this;return u(this,(function(i){switch(i.label){case 0:return e instanceof Ue?this.isReady?(this._logger.debug("send websocket request",e),[4,this.commandRouter.send(e)]):[3,2]:[3,4];case 1:case 5:return[2,i.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",e),t=new Ye,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw this._logger.debug("fail websocket request"),E.connectionRequired;case 3:case 7:return[3,9];case 4:return e instanceof xe?this._session.hasSession?(this._logger.debug("send api request",e),[4,this.commandRouter.send(e)]):[3,6]:[3,8];case 6:if(this.isLazyCallActivated)return this._logger.debug("wait api request",e),t=new Ye,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw n=E.connectionRequired,this._logger.debug("fail api request",n),n;case 8:throw E.invalidCommand;case 9:return[2]}}))}))},e.prototype.forceSend=function(e){return a(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return this._logger.debug("send forced request",e),e instanceof Ue||e instanceof xe?[4,this.commandRouter.send(e)]:[3,2];case 1:return[2,t.sent()];case 2:throw E.invalidCommand}}))}))},e.prototype.timeout=function(e){this._logger.debug("timeout request",e);var t=this._lazyCallQueue.findIndex((function(t){return t.command.requestId===e}));t>-1&&(this._lazyCallQueue[t].deferred.reject(E.connectionRequired),this._lazyCallQueue.splice(t,1))},e.prototype.cancel=function(e){this._logger.debug("cancel api request",e),this.commandRouter.cancel(e)},e.prototype.cancelAll=function(){this._logger.debug("cancel all api requests"),this.commandRouter.cancelAll()},e}(),po="sendbird@devicetokens",_o=function(){function e(e){var t=e.type,n=e.token;this.type=t,this.token=n}return e.payloadify=function(e){return oe(se({type:e.type,token:e.token}))},e}(),vo=new WeakMap,mo=function(e){function t(t){var n=t._iid,r=t.session,i=t.cacheContext,o=t.sdkState,s=t.dispatcher,a=t.requestQueue,u=t.logger,c=e.call(this)||this;return c._currentConnectionStateType=di.INITIALIZED,c._isRefreshingAuthToken=!1,c.currentUser=null,c.session=r,c._iid=n,c._cacheContext=i,c._sdkState=o,c._dispatcher=s,c._requestQueue=a,c._logger=u,c._deviceTokens=[],c._dispatcher.on((function(e){var t;if(e instanceof _i){var n=e.stateType;c._currentConnectionStateType=n}else e instanceof Re&&c.handler&&!c.isSessionKeyRefreshing&&((null===(t=e.error)||void 0===t?void 0:t.isSessionInvalidatedError)?c.handler.onSessionClosed&&c.handler.onSessionClosed():(e.invalidateSessionToken&&(c.session.authToken=void 0),e.error&&e.error.isSessionExpiredError&&(c._logger.debug("session expired"),c.handler.onSessionExpired&&c.handler.onSessionExpired(),c.refresh().catch((function(e){if(b(e))throw e})))))})),c}return i(t,e),Object.defineProperty(t.prototype,"ekey",{get:function(){return vo.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokens",{get:function(){return this._deviceTokens},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt},enumerable:!1,configurable:!0}),t.prototype.indexOfDeviceToken=function(e,t){return this._deviceTokens.findIndex((function(n){return n.type===e&&n.token===t}))},t.prototype.hasDeviceToken=function(e,t){return this.indexOfDeviceToken(e,t)>=0},t.prototype.createRefreshWebsocketCommand=function(e,t){return new Pe({authToken:e,expiringSession:!0,requestId:t})},t.prototype._refreshSessionKeyByWebSocket=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o;return u(this,(function(s){switch(s.label){case 0:return t=this.createRefreshWebsocketCommand(e),[4,this._requestQueue.forceSend(t)];case 1:if(n=s.sent(),r=n.as(je),i=r.newKey,o=r.error)throw o;return this.session.sessionKey=null!=i?i:this.session.sessionKey,[2]}}))}))},t.prototype._refreshSessionKeyByApi=function(e){return a(this,void 0,void 0,(function(){var t,n=this;return u(this,(function(r){switch(r.label){case 0:return t=new Le({userId:this._sdkState.userId,authToken:e,services:this.session.services,expiringSession:!0}),[4,Yi((function(e){return a(n,void 0,void 0,(function(){var n,r,i,o,s;return u(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(t)];case 1:return n=a.sent(),r=n.as(Fe),i=r.key,o=r.services,this.session.sessionKey=i,this.session.services=o,[3,3];case 2:if(s=a.sent(),!this._isSessionRelatedError(s))throw s;return e(s),[3,3];case 3:return[2]}}))}))}),3)];case 1:return r.sent(),[2]}}))}))},t.prototype._refreshSessionKey=function(e,t){return void 0===t&&(t=!0),a(this,void 0,void 0,(function(){var n,r,i;return u(this,(function(o){switch(o.label){case 0:if(this._currentConnectionStateType!==di.CONNECTED)return[3,11];o.label=1;case 1:return o.trys.push([1,3,,11]),[4,this._refreshSessionKeyByWebSocket(e)];case 2:return o.sent(),this.complete(),[2];case 3:return(n=o.sent())instanceof E&&(n.isSessionTokenExpiredError||n.code===h.APPLICATION_NOT_FOUND)?t?[4,this._receiveNewAuthToken()]:[3,9]:[3,10];case 4:return(i=o.sent())?(this.session.authToken=i,[4,this._refreshSessionKey(this.session.authToken,!1)]):[3,6];case 5:return o.sent(),this.complete(),[3,8];case 6:return[4,this.clear()];case 7:o.sent(),o.label=8;case 8:return[2];case 9:this.session.authToken=void 0,o.label=10;case 10:return[3,11];case 11:return o.trys.push([11,13,,23]),[4,this._refreshSessionKeyByApi(e)];case 12:return o.sent(),this.complete(),[3,23];case 13:return(r=o.sent())instanceof E&&(r.isSessionTokenExpiredError||r.code===h.APPLICATION_NOT_FOUND)?t?[4,this._receiveNewAuthToken()]:[3,19]:[3,21];case 14:return(i=o.sent())?(this.session.authToken=i,[4,this._refreshSessionKeyByApi(this.session.authToken)]):[3,16];case 15:return o.sent(),this.complete(),[3,18];case 16:return[4,this.clear()];case 17:o.sent(),o.label=18;case 18:return[3,20];case 19:throw this.session.authToken=void 0,r;case 20:return[3,22];case 21:throw r;case 22:return[3,23];case 23:return[2]}}))}))},t.prototype._receiveNewAuthToken=function(){var e,t=this,n=new Ye;if(this._isRefreshingAuthToken=!0,this.session.clear(),null===(e=this.handler)||void 0===e?void 0:e.onSessionTokenRequired){var r=null,i=function(){r&&(clearTimeout(r),r=null)},o=function(e){i(),t._isRefreshingAuthToken&&(t._isRefreshingAuthToken=!1,n.resolve(e))},s=function(e){i(),t._isRefreshingAuthToken&&(t._isRefreshingAuthToken=!1,n.reject(e))};r=setTimeout((function(){return s()}),1e3*this._sdkState.sessionTokenRefreshTimeout),Bi((function(){return a(t,void 0,void 0,(function(){var e;return u(this,(function(t){return(null===(e=this.handler)||void 0===e?void 0:e.onSessionTokenRequired)&&this.handler.onSessionTokenRequired(o,s),[2]}))}))}))}else n.resolve(null);return n.promise},t.prototype._isSessionRelatedError=function(e){return e instanceof E&&(e.isSessionExpiredError||e.isSessionInvalidatedError)},Object.defineProperty(t.prototype,"isSessionKeyRefreshing",{get:function(){return this.session.isRefreshing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSessionExpiring",{get:function(){return!!this.handler},enumerable:!1,configurable:!0}),t.prototype.authenticateFeed=function(e,t){var n;return a(this,void 0,void 0,(function(){var r,i,o;return u(this,(function(s){switch(s.label){case 0:return this.session.authToken=t,r=new uo({appId:this._sdkState.appId,userId:e,services:[j.FEED],includeUIKitConfig:!!(null!==(n=this._sdkState.extensions)&&void 0!==n?n:{}).sb_uikit,localCacheEnabled:this._cacheContext.localCacheEnabled,expiringSession:!t||this.isSessionExpiring}),[4,this._requestQueue.commandRouter.send(r)];case 1:return i=s.sent(),(o=i.as(co).logi).error?[3,3]:[4,o.applyTo(this._iid)];case 2:return s.sent(),[3,4];case 3:throw o.error;case 4:return[2]}}))}))},t.prototype.login=function(e){var t;return a(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,l;return u(this,(function(u){switch(u.label){case 0:return n=e.key,r=e.ekey,i=e.services,o=e.userProfile,s=e.deviceTokenLastDeletedAt,a=void 0===s?0:s,this.session.hasLessServiceScopeThan(i)&&(this.session.sessionKey=n,this.session.services=i),vo.set(this,r),this._deviceTokenCacheEnabled=null===(t=null==o?void 0:o.appInfo)||void 0===t?void 0:t.deviceTokenCache,c=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,c.get(po)]:[3,5];case 1:return!(l=u.sent())||l.lastDeletedAt<a?(this._deviceTokens=[],this._deviceTokenLastDeletedAt=a,[4,this.saveDeviceToken()]):[3,3];case 2:return u.sent(),[3,4];case 3:this._deviceTokens=l.tokens.map((function(e){return new _o(_o.payloadify(e))})),this._deviceTokenLastDeletedAt=l.lastDeletedAt,u.label=4;case 4:return[3,7];case 5:return[4,c.remove(po)];case 6:u.sent(),u.label=7;case 7:return[2]}}))}))},t.prototype.complete=function(){var e=this;this.dispatch("refresh"),this._dispatcher.dispatch(new vi),Bi((function(){return a(e,void 0,void 0,(function(){var e;return u(this,(function(t){return this._logger.debug("session refreshed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionRefreshed)&&this.handler.onSessionRefreshed(),[2]}))}))}))},t.prototype.error=function(e){var t=this;Bi((function(){return a(t,void 0,void 0,(function(){var t;return u(this,(function(n){return(null===(t=this.handler)||void 0===t?void 0:t.onSessionError)&&this.handler.onSessionError(e),[2]}))}))}))},t.prototype.close=function(){var e=this;this.dispatch("close"),this._dispatcher.dispatch(new gi),Bi((function(){return a(e,void 0,void 0,(function(){var e;return u(this,(function(t){return this._logger.debug("session closed"),(null===(e=this.handler)||void 0===e?void 0:e.onSessionClosed)&&this.handler.onSessionClosed(),[2]}))}))}))},t.prototype.refresh=function(){return a(this,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:if(!this.isSessionExpiring)return[3,10];if(this.session.isRefreshing)return[3,10];if(this.session.isRefreshing=!0,this.session.authToken)return[3,7];n.label=1;case 1:return n.trys.push([1,6,,7]),[4,this._receiveNewAuthToken()];case 2:return(e=n.sent())?(this._logger.debug("session refreshing.."),this.session.authToken=e,[3,5]):[3,3];case 3:return[4,this.clear()];case 4:return n.sent(),this.session.isRefreshing=!1,[2];case 5:return[3,7];case 6:throw n.sent(),t=E.sessionTokenRequestFailed,this._dispatcher.dispatch(new mi),this.error(t),this.session.isRefreshing=!1,this._logger.debug("refresh auth token error = ",t),t;case 7:return n.trys.push([7,9,,10]),[4,this._refreshSessionKey(this.session.authToken)];case 8:return n.sent(),this.session.isRefreshing=!1,[3,10];case 9:throw n.sent(),this.session.isRefreshing=!1,t=E.sessionTokenRefreshFailed,this._dispatcher.dispatch(new mi),this.error(t),t;case 10:return[2]}}))}))},t.prototype.setDeviceToken=function(e,t){return!!(this._deviceTokenCacheEnabled&&this.indexOfDeviceToken(e,t)<0)&&(this._deviceTokens.push(new _o({type:e,token:t})),!0)},t.prototype.unsetDeviceToken=function(e,t){if(this._deviceTokenCacheEnabled){var n=this.indexOfDeviceToken(e,t);n>=0&&this._deviceTokens.splice(n,1)}},t.prototype.unsetDeviceTokens=function(e){this._deviceTokenCacheEnabled&&(this._deviceTokens=e?this._deviceTokens.filter((function(t){return t.type!==e})):[])},t.prototype.setDeviceTokenDeletedAt=function(e){e>0&&(this._deviceTokenLastDeletedAt=e)},t.prototype.saveDeviceToken=function(){return a(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set(po,{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.clear=function(){return a(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return this.currentUser=null,this.session.clear(),this.close(),vo.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))},t}(ne),go=function(e){function t(t){var n,r,i,o,s=t.type,a=t.data,u=t.ts,c=void 0===u?Date.now():u,l=e.call(this,{type:s,data:a,ts:c})||this;return l.date=new Date(c),l.key="".concat((n=l.date,r=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getDate()).padStart(2,"0"),"".concat(r).concat(i).concat(o)),"_").concat(s),l}return i(t,e),t}(Ge),yo=function(e){function t(t){var n=t.deviceId,r=t.statLogs,i=e.call(this)||this;return i.method=ae.POST,i.path="".concat(we),i.params={device_id:n,log_entries:r.map((function(e){return Ge.payloadify(e)}))},i}return i(t,e),t}(xe),bo=function(e,t){var n,r;if(null!==e&&null!==t){var i=Object.keys(e),o=Object.keys(t),s=d([],l(new Set(d(d([],l(i),!1),l(o),!1))),!1),a={};try{for(var u=c(s),h=u.next();!h.done;h=u.next()){var f=h.value,p=typeof e[f],_=typeof t[f];"undefined"===p?a[f]=t[f]:"undefined"===_?a[f]=e[f]:p!==_?a[f]=t[f]:"object"===p&&e[f]&&t[f]?a[f]=bo(e[f],t[f]):a[f]=t[f]}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return a}return t};!function(e){e[e.PENDING=0]="PENDING",e[e.COLLECT_ONLY=1]="COLLECT_ONLY",e[e.ENABLED=2]="ENABLED",e[e.DISABLED=3]="DISABLED"}(lo||(lo={}));var Eo,wo=function(e){function t(t){var n=t.cacheContext,r=t.requestQueue,i=t.dispatcher,o=t.baseLimit,s=void 0===o?100:o,a=t.maxLimit,u=void 0===a?1e3:a,c=t.minLimit,l=void 0===c?10:c,d=e.call(this)||this;return d.queue=[],d.flushWaitQueue=[],d.enabledState=lo.PENDING,d.isFlushing=!1,d.generation=1,d.lastFlushedAt=Date.now(),d._collectRequestStat=!0,d._collectFeatureLocalCacheStat=!0,d._collectionNotificationStat=!0,d.deviceId=ee(),d.cacheContext=n,d.requestQueue=r,d.dispatcher=i,d.baseLimit=s,d.limit=s,d.maxLimit=u,d.minLimit=l,d}return i(t,e),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this.enabledState===lo.ENABLED},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isReadyToFlush",{get:function(){return this.queue.length>=this.limit||Date.now()-this.lastFlushedAt>=108e5&&this.queue.length>=this.minLimit},enumerable:!1,configurable:!0}),t.prototype._arrangeStat=function(){var e=d([],l(this.queue),!1);this._collectRequestStat||(e=e.filter((function(e){return e.type!==ke.API_RESULT&&e.type!==ke.WEBSOCKET_CONNECT}))),this._collectFeatureLocalCacheStat||(e=e.filter((function(e){return e.type!==ke.FEATURE_LOCALCACHE&&e.type!==ke.FEATURE_LOCALCACHE_EVENT}))),this._collectionNotificationStat||(e=e.filter((function(e){return e.type!==ke.NOTIFICATION}))),this.queue=e},t.prototype._save=function(){return a(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return this.isEnabled?(e=d(d([],l(this.queue),!1),l(this.flushWaitQueue),!1),[4,this.cacheContext.preference.set(this.key,{deviceId:this.deviceId,statLogs:e.map((function(e){return Ge.payloadify(e)})),generation:this.generation++,lastFlushedAt:this.lastFlushedAt})]):[3,2];case 1:t.sent(),this.dispatch("save",e),t.label=2;case 2:return[2]}}))}))},t.prototype._flush=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,i;return u(this,(function(o){switch(o.label){case 0:if(!this.isEnabled)return[3,10];if(this.isFlushing)return[3,10];this.isFlushing=!0,o.label=1;case 1:return o.trys.push([1,5,9,10]),this._arrangeStat(),e=this.queue.filter((function(e){if(e instanceof go){var t=new Date,n=l([e.date.getFullYear(),t.getFullYear()],2),r=n[0],i=n[1];if(r<i)return!0;if(r===i){var o=l([e.date.getMonth(),t.getMonth()],2),s=o[0],a=o[1];if(s<a)return!0;if(s===a){var u=l([e.date.getDate(),t.getDate()],2);return u[0]<u[1]}}}return!1})),t=this.queue.filter((function(e){return!(e instanceof go)})),(n=d(d([],l(e),!1),l(t),!1).slice(0,Math.min(this.limit,this.maxLimit))).length>0?(r=new yo({deviceId:this.deviceId,statLogs:n}),[4,this.requestQueue.send(r)]):[3,4];case 2:return o.sent(),this.dispatch("flush",n),this.queue=d(d([],l(e),!1),l(t),!1).slice(n.length).concat(this.flushWaitQueue),this.flushWaitQueue=[],this.limit=this.baseLimit,this.lastFlushedAt=Date.now(),[4,this._save()];case 3:o.sent(),o.label=4;case 4:return[3,10];case 5:return(i=o.sent())instanceof E?i.code!==h.STAT_LOG_NOT_ALLOWED?[3,7]:[4,this.clear()]:[3,8];case 6:return o.sent(),this.enabledState=lo.DISABLED,[3,8];case 7:i.code===h.STAT_UPLOAD_NOT_ALLOWED&&(this.enabledState=lo.COLLECT_ONLY),o.label=8;case 8:return this.limit=this.limit+20,[3,10];case 9:return this.isFlushing=!1,[7];case 10:return[2]}}))}))},t.prototype.init=function(e){return a(this,void 0,void 0,(function(){var t,n,r=this;return u(this,(function(i){switch(i.label){case 0:return this.key=e,[4,this.cacheContext.preference.get(this.key)];case 1:return(t=i.sent())?(this.deviceId=t.deviceId,this.queue=t.statLogs.map((function(e){var t;return e.stat_type===ke.FEATURE_LOCALCACHE_EVENT&&(e.data=o({message_init_policy:"",starting_point:0},e.data)),e.stat_type===ke.NOTIFICATION&&(e.data=oe(o(o({},e.data),{message_id:null!==(t=e.data.notificationId)&&void 0!==t?t:e.data.message_id,notificationId:void 0}))),new Ge({type:e.stat_type,ts:e.ts,data:e.data})})),this.generation=t.generation,this.lastFlushedAt=t.lastFlushedAt,this.isReadyToFlush?(n=Math.min(Math.floor(18e4*Math.random()),100),[4,Qi(n)]):[3,4]):[3,4];case 2:return i.sent(),[4,this._flush()];case 3:i.sent(),i.label=4;case 4:return this.commandEventContext||(this.commandEventContext=this.dispatcher.on((function(e){if(e instanceof qe){var t=e.statLog;r.put(t)}else if(e instanceof qi){var n=e.request,i=e.features,o=e.options;r._collectRequestStat=n,r._collectFeatureLocalCacheStat=null==i?void 0:i.localCache,r._collectionNotificationStat=null==i?void 0:i.notification,r._arrangeStat(),r._collectRequestStat||r._collectFeatureLocalCacheStat||r._collectionNotificationStat?r.enabledState=o.ingestion?lo.ENABLED:lo.COLLECT_ONLY:r.enabledState=lo.DISABLED,r.isEnabled?r.isReadyToFlush&&r._flush():r.clear()}}))),[2]}}))}))},t.prototype.put=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return u(this,(function(i){switch(i.label){case 0:if(this.enabledState===lo.DISABLED)return[3,3];if(t=this.isFlushing?this.flushWaitQueue:this.queue,e instanceof go)this._collectFeatureLocalCacheStat&&(n=l(this.queue.filter((function(t){return t instanceof go&&t.key===e.key})),1),(r=n[0])?r.data=bo(r.data,e.data):t.push(e));else switch(e.type){case ke.API_RESULT:case ke.WEBSOCKET_CONNECT:this._collectRequestStat&&t.push(e);break;case ke.FEATURE_LOCALCACHE:case ke.FEATURE_LOCALCACHE_EVENT:this._collectFeatureLocalCacheStat&&t.push(e);break;case ke.NOTIFICATION:this._collectionNotificationStat&&t.push(e)}return[4,this._save()];case 1:return i.sent(),this.isReadyToFlush?[4,this._flush()]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))},t.prototype.clear=function(){return a(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return this.queue=[],this.flushWaitQueue=[],this.generation=1,[4,this._save()];case 1:return e.sent(),[2]}}))}))},t.prototype.close=function(){this.commandEventContext&&(this.commandEventContext.close(),this.commandEventContext=void 0)},t}(ne);!function(e){e[e.NONE=0]="NONE",e[e.VERBOSE=1]="VERBOSE",e[e.DEBUG=2]="DEBUG",e[e.INFO=3]="INFO",e[e.WARN=4]="WARN",e[e.ERROR=5]="ERROR"}(Eo||(Eo={}));var Co,To=function(){function e(){this.level=Eo.WARN}return e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Eo.VERBOSE&&console.log.apply(console,d(["[verbose]"],l(e),!1))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Eo.DEBUG&&console.log.apply(console,d(["[debug]"],l(e),!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Eo.INFO&&console.log.apply(console,d(["[info]"],l(e),!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Eo.WARN&&console.warn.apply(console,d(["[warn]"],l(e),!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=Eo.ERROR&&console.error.apply(console,d(["[error]"],l(e),!1))},e}(),Ao={},So=function(){function e(e,t){var n,r,i,o,s,a,u,c,l,d;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map,!Ao[e]){Ao[e]=this;var h=null!==(n=t.options)&&void 0!==n?n:new U,f=this.sdkState={appId:t.appId,appVersion:null!==(r=t.appVersion)&&void 0!==r?r:"",appState:"foreground",userId:void 0,extensions:{},api:{host:null!==(i=t.apiHost)&&void 0!==i?i:"https://api-".concat(t.appId,".sendbird.com")},websocket:{host:null!==(o=t.websocketHost)&&void 0!==o?o:"wss://ws-".concat(t.appId,".sendbird.com"),pingerDisabled:!!t.noPingpong,pingInterval:void 0,pongTimeout:void 0,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new Zi,responseTimeout:h.websocketResponseTimeout},sessionTokenRefreshTimeout:h.sessionTokenRefreshTimeout};this.appInfo=void 0,this.subscribedUnreadMessageCount={all:0,feed:0,customTypes:{},ts:0};var _=this.logger=new To;this.logger.level=null!==(s=t.logLevel)&&void 0!==s?s:Eo.WARN,this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map;var v=this.cacheContext=new F({encryption:t.encryption,store:t.store,localCacheEnabled:null!==(a=t.localCacheEnabled)&&void 0!==a&&a,localCacheConfig:null!==(u=t.localCacheConfig)&&void 0!==u?u:new H});this.debugMode=null!==(c=t.debugMode)&&void 0!==c&&c,this.maxSuperGroupChannelUnreadCount=p.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=h.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=h.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=h.typingIndicatorThrottle,this.concurrentCallLimit=void 0,this.backOffDelay=void 0;var m=this.dispatcher=new re,g=new J;this.requestQueue=new fo(e,{session:g,sdkState:f,dispatcher:m,logger:_,useFetchCompat:t.useFetchCompat}),this.sessionManager=new mo({_iid:e,session:g,cacheContext:v,sdkState:f,dispatcher:m,requestQueue:this.requestQueue,logger:_}),this.connectionManager=new Ji(e,{sdkState:f,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:m,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:null!==(l=t.disableWebSocketCloseEventHandling)&&void 0!==l&&l,logger:_}),this.statLogCollector=new wo({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:m}),this.appStateToggleEnabled=null===(d=t.appStateToggleEnabled)||void 0===d||d}return Ao[e]}return e.of=function(e){if(Ao[e])return Ao[e];throw E.lostInstance},e.clear=function(e){Ao[e]&&delete Ao[e]},e.prototype.hasExtension=function(e){return this.sdkState.extensions&&this.sdkState.extensions[e]},e}(),Io=function(){function e(){}return e.prototype.init=function(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,o=t.requestQueue,s=t.logger;t.onlineDetector;var a=t.cacheContext;this._iid=e,this._cacheContext=a,this._sdkState=n,this._dispatcher=r,this._sessionManager=i,this._requestQueue=o,this._logger=s},e}();!function(e){e.UNKNOWN="UNKNOWN",e.EVENT_CHANNEL_CREATED="EVENT_CHANNEL_CREATED",e.EVENT_CHANNEL_UPDATED="EVENT_CHANNEL_UPDATED",e.EVENT_CHANNEL_DELETED="EVENT_CHANNEL_DELETED",e.EVENT_CHANNEL_READ="EVENT_CHANNEL_READ",e.EVENT_CHANNEL_DELIVERED="EVENT_CHANNEL_DELIVERED",e.EVENT_CHANNEL_INVITED="EVENT_CHANNEL_INVITED",e.EVENT_CHANNEL_JOINED="EVENT_CHANNEL_JOINED",e.EVENT_CHANNEL_LEFT="EVENT_CHANNEL_LEFT",e.EVENT_CHANNEL_ACCEPTED_INVITE="EVENT_CHANNEL_ACCEPTED_INVITE",e.EVENT_CHANNEL_DECLINED_INVITE="EVENT_CHANNEL_DECLINED_INVITE",e.EVENT_CHANNEL_OPERATOR_UPDATED="EVENT_CHANNEL_OPERATOR_UPDATED",e.EVENT_CHANNEL_BANNED="EVENT_CHANNEL_BANNED",e.EVENT_CHANNEL_UNBANNED="EVENT_CHANNEL_UNBANNED",e.EVENT_CHANNEL_MUTED="EVENT_CHANNEL_MUTED",e.EVENT_CHANNEL_UNMUTED="EVENT_CHANNEL_UNMUTED",e.EVENT_CHANNEL_FROZEN="EVENT_CHANNEL_FROZEN",e.EVENT_CHANNEL_UNFROZEN="EVENT_CHANNEL_UNFROZEN",e.EVENT_CHANNEL_HIDDEN="EVENT_CHANNEL_HIDDEN",e.EVENT_CHANNEL_UNHIDDEN="EVENT_CHANNEL_UNHIDDEN",e.EVENT_CHANNEL_RESET_HISTORY="EVENT_CHANNEL_RESET_HISTORY",e.EVENT_CHANNEL_TYPING_STATUS_UPDATE="EVENT_CHANNEL_TYPING_STATUS_UPDATE",e.EVENT_CHANNEL_MEMBER_COUNT_UPDATED="EVENT_CHANNEL_MEMBER_COUNT_UPDATED",e.EVENT_CHANNEL_METADATA_CREATED="EVENT_CHANNEL_METADATA_CREATED",e.EVENT_CHANNEL_METADATA_UPDATED="EVENT_CHANNEL_METADATA_UPDATED",e.EVENT_CHANNEL_METADATA_DELETED="EVENT_CHANNEL_METADATA_DELETED",e.EVENT_CHANNEL_METACOUNTER_CREATED="EVENT_CHANNEL_METACOUNTER_CREATED",e.EVENT_CHANNEL_METACOUNTER_UPDATED="EVENT_CHANNEL_METACOUNTER_UPDATED",e.EVENT_CHANNEL_METACOUNTER_DELETED="EVENT_CHANNEL_METACOUNTER_DELETED",e.EVENT_MESSAGE_SENT="EVENT_MESSAGE_SENT",e.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",e.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",e.EVENT_PINNED_MESSAGE_UPDATED="EVENT_PINNED_MESSAGE_UPDATED",e.REQUEST_CHANNEL="REQUEST_CHANNEL",e.REQUEST_CHANNEL_CHANGELOGS="REQUEST_CHANNEL_CHANGELOGS",e.REFRESH_CHANNEL="REFRESH_CHANNEL",e.CHANNEL_LASTACCESSEDAT_UPDATED="CHANNEL_LASTACCESSEDAT_UPDATED",e.SYNC_CHANNEL_BACKGROUND="SYNC_CHANNEL_BACKGROUND",e.SYNC_CHANNEL_CHANGELOGS="SYNC_CHANNEL_CHANGELOGS",e.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",e.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",e.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",e.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",e.EVENT_MESSAGE_FEEDBACK_ADDED="EVENT_MESSAGE_FEEDBACK_ADDED",e.EVENT_MESSAGE_FEEDBACK_UPDATED="EVENT_MESSAGE_FEEDBACK_UPDATED",e.EVENT_MESSAGE_FEEDBACK_DELETED="EVENT_MESSAGE_FEEDBACK_DELETED",e.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",e.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",e.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",e.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",e.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",e.REQUEST_MESSAGE="REQUEST_MESSAGE",e.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",e.EVENT_POLL_VOTED="EVENT_POLL_VOTED",e.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",e.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",e.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",e.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",e.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",e.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",e.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",e.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",e.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",e.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",e.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED"}(Co||(Co={}));o({},Co);var No,ko=function(e){return e.startsWith("EVENT_")||e.startsWith("LOCAL_MESSAGE_")||e===Co.SYNC_MESSAGE_FILL||e===Co.SYNC_MESSAGE_CHANGELOGS||e===Co.SYNC_POLL_CHANGELOGS},xo=function(e){function t(t){var n=t.messages,r=t.source,i=t.isWebSocketEventComing,o=void 0!==i&&i,s=e.call(this)||this;return s.messages=n,s.source=r,s.isWebSocketEventComing=o,s}return i(t,e),t}(ie),Oo=function(e){function t(t){var n=t.messageIds,r=t.source,i=t.isWebSocketEventComing,o=void 0!==i&&i,s=e.call(this)||this;return s.messageIds=n,s.source=r,s.isWebSocketEventComing=o,s}return i(t,e),t}(ie),Mo=function(e){function t(t){var n=t.event,r=t.source,i=t.isWebSocketEventComing,o=void 0!==i&&i,s=e.call(this)||this;return s.event=n,s.source=r,s.isWebSocketEventComing=o,s}return i(t,e),t}(ie),Ro=function(e){function t(t){var n=t.event,r=t.source,i=t.isWebSocketEventComing,o=void 0!==i&&i,s=e.call(this)||this;return s.event=n,s.source=r,s.isWebSocketEventComing=o,s}return i(t,e),t}(ie),Do=function(e){function t(t){var n=t.reqId,r=t.source,i=e.call(this)||this;return i.reqId=n,i.source=r,i}return i(t,e),t}(ie),Uo=function(e){function t(t){var n=t.polls,r=t.source,i=e.call(this)||this;return i.polls=n,i.source=r,i}return i(t,e),t}(ie),Lo=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i}return i(t,e),t}(ie),Po=function(e){function t(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i}return i(t,e),t}(ie);!function(e){e.OPEN="open",e.CLOSED="closed"}(No||(No={}));var Fo="removed",jo=function(e){switch(e){case"open":return No.OPEN;case"closed":return No.CLOSED;default:return null}},qo=function(e){return!e||!!e.text&&A("string",e.text)},Ho=function(e){function t(t,n){var r,i,o,s,a,u,c,l=this;return(l=e.call(this,t)||this).pollId=0,l.id=0,l.text=null,l.voteCount=0,l.createdBy=null,l.createdAt=0,l.updatedAt=0,l._lastVotedAt=0,l.pollId=null!==(r=n.poll_id)&&void 0!==r?r:0,l.id=null!==(i=n.id)&&void 0!==i?i:0,l.text=null!==(o=n.text)&&void 0!==o?o:null,l.voteCount=null!==(s=n.vote_count)&&void 0!==s?s:0,l.createdBy=null!==(a=n.created_by)&&void 0!==a?a:null,l.createdAt=null!==(u=n.created_at)&&void 0!==u?u:0,l.updatedAt=null!==(c=n.updated_at)&&void 0!==c?c:0,l}return i(t,e),t.payloadify=function(t){return oe(se(o(o({},e.payloadify.call(this,t)),{vote_count:t.voteCount,poll_id:t.pollId,text:t.text,created_at:t.createdAt,id:t.id,created_by:t.createdBy,updated_at:t.updatedAt})))},t}(Ai),Vo=function(e){function t(t,n){var r,i,o,s,a,u,c,l,d,h,f,p,_,v=this;return(v=e.call(this,t)||this).id=0,v.title=null,v.createdAt=0,v.updatedAt=0,v.closeAt=-1,v.status=No.CLOSED,v.messageId=0,v.data=null,v.voterCount=-1,v.options=[],v.createdBy=null,v.allowUserSuggestion=!1,v.allowMultipleVotes=!1,v.votedPollOptionIds=[],v.id=null!==(r=n.id)&&void 0!==r?r:0,v.title=null!==(i=n.title)&&void 0!==i?i:null,v.createdAt=null!==(o=n.created_at)&&void 0!==o?o:0,v.updatedAt=null!==(s=n.updated_at)&&void 0!==s?s:0,v.closeAt=null!==(a=n.close_at)&&void 0!==a?a:-1,v.status=null!==(u=jo(n.status))&&void 0!==u?u:No.CLOSED,v.messageId=null!==(c=n.message_id)&&void 0!==c?c:0,v.data=null!==(l=n.data)&&void 0!==l?l:null,v.voterCount=null!==(d=n.voter_count)&&void 0!==d?d:-1,v.options=n.options?n.options.map((function(e){return new Ho(v._iid,e)})):[],v.createdBy=null!==(h=n.created_by)&&void 0!==h?h:null,v.allowUserSuggestion=null!==(f=n.allow_user_suggestion)&&void 0!==f&&f,v.allowMultipleVotes=null!==(p=n.allow_multiple_votes)&&void 0!==p&&p,v.votedPollOptionIds=null!==(_=n.voted_option_ids)&&void 0!==_?_:[],v}return i(t,e),t.prototype._applyPollUpdatePayload=function(e){var t,n,r,i,o,s,a,u,c=this;this.title=null!==(t=e.title)&&void 0!==t?t:this.title,this.updatedAt=null!==(n=e.updated_at)&&void 0!==n?n:this.updatedAt,this.closeAt=null!==(r=e.close_at)&&void 0!==r?r:this.closeAt,this.status=null!==(i=jo(e.status))&&void 0!==i?i:this.status,this.data=null!==(o=e.data)&&void 0!==o?o:this.data,this.voterCount=null!==(s=e.voter_count)&&void 0!==s?s:this.voterCount,e.options&&(this.options=e.options.map((function(e){return new Ho(c._iid,e)})),this.votedPollOptionIds=e.options.filter((function(e){return e.vote_count>0})).map((function(e){return e.id}))),this.allowUserSuggestion=null!==(a=e.allow_user_suggestion)&&void 0!==a?a:this.allowUserSuggestion,this.allowMultipleVotes=null!==(u=e.allow_multiple_votes)&&void 0!==u?u:this.allowMultipleVotes},t.payloadify=function(t){return oe(se(o(o({},e.payloadify.call(this,t)),{id:t.id,title:t.title,created_at:t.createdAt,updated_at:t.updatedAt,close_at:t.closeAt,status:t.status,message_id:t.messageId,data:t.data,voter_count:t.voterCount,options:t.options.map((function(e){return Ho.payloadify(e)})),created_by:t.createdBy,allow_user_suggestion:t.allowUserSuggestion,allow_multiple_votes:t.allowMultipleVotes,voted_option_ids:t.votedPollOptionIds})))},t.prototype.applyPollUpdateEvent=function(e){var t=e._payload.poll;return!(!t||this.id!==t.id||t.updated_at<this.updatedAt||(this._applyPollUpdatePayload(t),0))},t.prototype.applyPollVoteEvent=function(e){if(this.id!==e.pollId)return!1;var t=this.options,n=t.map((function(e){return e.id})),r=e._payload,i=Math.floor(r.ts/1e3);return r.updated_vote_counts.forEach((function(e){var r=n.indexOf(e.option_id);if(r>-1){var o=t[r];i>=o._lastVotedAt&&(o.voteCount=e.vote_count,o._lastVotedAt=i)}})),r.req_id&&r.voted_option_ids&&(this.votedPollOptionIds=r.voted_option_ids),"number"==typeof r.voter_count&&(this.voterCount=r.voter_count),!0},t.prototype.serialize=function(){return Ri(this)},t}(Ai),Bo=function(){function e(e,t){var n;this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=e,this.limit=null!==(n=t.limit)&&void 0!==n?n:20}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),e.prototype._validate=function(){return A("number",this.limit)&&this.limit>0},e}(),zo=function(e){function t(t,n,r,i){var o=e.call(this,t,i)||this;return o.channelUrl=n,o.channelType=r,o}return i(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&A("string",this.channelUrl)&&S(V,this.channelType)},t}(Bo),Go=function(e){this.pollId=0,this.messageId=0,this.pollId=e.poll_id,this.messageId=e.message_id,this._payload=e},Wo=function(e){function t(t){var n=t.title,r=t.optionTexts,i=t.data,o=t.allowUserSuggestion,s=t.allowMultipleVotes,a=t.closeAt,u=e.call(this)||this;return u.method=ae.POST,u.path=ye,u.params={title:n,options:r,data:i,allow_user_suggestion:o,allow_multiple_votes:s,close_at:a},u}return i(t,e),t}(xe),Ko=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new Vo(t,n),r}return i(t,e),t}(Oe),Qo=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,o=e.call(this)||this;return o.method=ae.GET,o.path="".concat(ye,"/").concat(encodeURIComponent(i)),o.params={channel_url:n,channel_type:r},o}return i(t,e),t}(xe),Zo=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.poll=new Vo(t,n),r}return i(t,e),t}(Oe),Yo=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,o=t.pollOptionId,s=e.call(this)||this;return s.method=ae.GET,s.path="".concat(ye,"/").concat(encodeURIComponent(i),"/options/").concat(encodeURIComponent(o)),s.params={channel_url:n,channel_type:r},s}return i(t,e),t}(xe),$o=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.pollOption=new Ho(t,n),r}return i(t,e),t}(Oe),Xo=function(e){function t(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,o=t.token,s=e.call(this)||this;return s.method=ae.GET,s.path="".concat(Te(n),"/").concat(encodeURIComponent(r),"/polls/changelogs"),s.params=oe({change_ts:i,token:o}),s}return i(t,e),t}(xe),Jo=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.updatedPolls=n.updated.map((function(e){return function(e,t){return new Vo(e,t)}(t,e)})),r.deletedPollIds=n.deleted.map((function(e){return e})),r.hasMore=n.has_more,r.nextToken=n.next,r}return i(t,e),t}(Oe),es={title:"",optionTexts:[],data:void 0,allowUserSuggestion:void 0,allowMultipleVotes:void 0,closeAt:-1},ts=function(e){return A("string",e.title)&&(t=e.optionTexts,N("string",t)&&t.every((function(e){return""!==e.trim()})))&&qo(e.data)&&A("boolean",e.allowUserSuggestion,!0)&&A("boolean",e.allowMultipleVotes,!0)&&A("number",e.closeAt,!0);var t},ns={channelUrl:"",channelType:V.BASE,pollId:0,pollOptionId:0},rs=function(e){return A("string",e.channelUrl)&&""!==e.channelUrl&&S(V,e.channelType)&&A("number",e.pollId)&&e.pollId>0&&A("number",e.pollOptionId)&&e.pollOptionId>0},is={channelUrl:"",channelType:V.BASE,pollId:0},os=function(e){return A("string",e.channelUrl)&&""!==e.channelUrl&&S(V,e.channelType)&&A("number",e.pollId)},ss={},as=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,o=t.requestQueue,s=t.logger;this._iid=e,this._sdkState=n,this._sessionManager=i,this._requestQueue=o,this._dispatcher=r,this._logger=s,ss[e]=this}return e.of=function(e){return ss[e]},e.prototype.buildPollFromSerializedData=function(e){var t=Di(e);return new Vo(this._iid,Vo.payloadify(t))},e.prototype.get=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return Ui(os(e)).throw(E.invalidParameters),t=new Qo(o({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(Zo).poll]}}))}))},e.prototype.create=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return Ui(ts(e)).throw(E.invalidParameters),t=new Wo(o({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as(Ko).poll]}}))}))},e.prototype.getOption=function(e){return a(this,void 0,void 0,(function(){var t;return u(this,(function(n){switch(n.label){case 0:return Ui(rs(e)).throw(E.invalidParameters),t=new Yo(o({},e)),[4,this._requestQueue.send(t)];case 1:return[2,n.sent().as($o).pollOption]}}))}))},e.prototype.getPollChangeLogs=function(e,t,n,r){return void 0===r&&(r=Co.SYNC_POLL_CHANGELOGS),a(this,void 0,void 0,(function(){var i,o,s,a,c,l,d;return u(this,(function(u){switch(u.label){case 0:return i=new Xo(se({channelType:t,channelUrl:e,timestamp:"number"==typeof n?n:null,token:"string"==typeof n?n:null})),[4,this._requestQueue.send(i)];case 1:return o=u.sent(),s=o.as(Jo),a=s.updatedPolls,c=s.deletedPollIds,l=s.hasMore,d=s.nextToken,a.length>0&&this._dispatcher.dispatch(new Uo({polls:a,source:r})),[2,{updatedPolls:a,deletedPollIds:c,hasMore:l,token:d}]}}))}))},e}(),us=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.token,o=t.limit,s=e.call(this)||this;return s.method=ae.GET,s.path=ye,s.params={channel_url:n,channel_type:r,token:i,limit:o},s}return i(t,e),t}(xe),cs=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).polls=(null!==(r=n.polls)&&void 0!==r?r:[]).map((function(e){return new Vo(t,e)})),i.token=n.next,i}return i(t,e),t}(Oe),ls=function(e){function t(t,n){return e.call(this,t,n.channelUrl,n.channelType,n)||this}return i(t,e),t.prototype.next=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,i,s;return u(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=So.of(this._iid).requestQueue,t=new us(o(o({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=a.sent(),r=n.as(cs),i=r.polls,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw E.queryInProgress;case 4:return[3,6];case 5:throw E.invalidParameters;case 6:return[2]}}))}))},t}(zo),ds=function(e){function t(t){var n=t.channelUrl,r=t.channelType,i=t.pollId,o=t.pollOptionId,s=t.token,a=t.limit,u=e.call(this)||this;return u.method=ae.GET,u.path="".concat(ye,"/").concat(encodeURIComponent(i),"/options/").concat(encodeURIComponent(o),"/voters"),u.params={channel_url:n,channel_type:r,token:s,limit:a},u}return i(t,e),t}(xe),hs=function(e){function t(t,n){var r,i=this;return(i=e.call(this,t,n)||this).voters=(null!==(r=n.voters)&&void 0!==r?r:[]).map((function(e){return new Pi(t,e)})),i.token=n.next,i}return i(t,e),t}(Oe),fs=function(e){function t(t,n){var r=e.call(this,t,n.channelUrl,n.channelType,n)||this;return r.pollId=n.pollId,r.pollOptionId=n.pollOptionId,r}return i(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&A("number",this.pollId)&&A("number",this.pollOptionId)},t.prototype.next=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,i,s;return u(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=So.of(this._iid).requestQueue,t=new ds(o(o({},this),{pollId:this.pollId,pollOptionId:this.pollOptionId,token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=a.sent(),r=n.as(hs),i=r.voters,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,i];case 2:return[2,[]];case 3:throw E.queryInProgress;case 4:return[3,6];case 5:throw E.invalidParameters;case 6:return[2]}}))}))},t}(zo)},5360:function(e,t,n){n.d(t,{Kq:function(){return I},ew:function(){return O}});var r,i=n(9851),o=n(8777),s=n(2217),a=n(3818),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._channels=new Map,t._enteredChannelUrls=[],t}return(0,i.c)(t,e),Object.defineProperty(t.prototype,"enteredChannels",{get:function(){var e=this;return this._enteredChannelUrls.map((function(t){return e._channels.get(t)})).filter((function(e){return!!e}))},enumerable:!1,configurable:!0}),t.prototype.isEnteredChannel=function(e){return this._enteredChannelUrls.includes(e)},t.prototype.enter=function(e){this._enteredChannelUrls.indexOf(e)<0&&this._enteredChannelUrls.push(e)},t.prototype.exit=function(e){var t=this._enteredChannelUrls.indexOf(e);t>=0&&this._enteredChannelUrls.splice(t,1)},t.prototype.exitAll=function(){this._enteredChannelUrls=[]},t.prototype.get=function(e){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){return[2,this._channels.get(e)]}))}))},t.prototype.upsert=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n=this;return(0,i.b)(this,(function(r){return t=[],e.forEach((function(e){if(n._channels.has(e.url)){var r=n._channels.get(e.url);Object.assign(r,e),t.push(r)}else n._channels.set(e.url,e),t.push(e)})),[2,t]}))}))},t.prototype.remove=function(e){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){return this._channels.delete(e),this.exit(e),[2]}))}))},t.prototype.clear=function(){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._channels.clear(),this._enteredChannelUrls=[],[2]}))}))},t}(i.aa),c={channelUrl:void 0,name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0,isEphemeral:void 0},l=function(e){function t(t){var n=t.channelUrl,r=t.isInternalCall,o=e.call(this)||this;return o.method=i.A.GET,o.path="".concat(r?i.be:i.bf,"/").concat(encodeURIComponent(n)),o}return(0,i.c)(t,e),t}(i.f),d=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new S(t,n),r}return(0,i.c)(t,e),t}(i.h),h=function(e){function t(t){var n=this,r=t.channelUrl,o=t.coverUrlOrImage,s=t.name,a=t.data,u=t.customType,c=t.operatorUserIds,l=t.isEphemeral;return(n=e.call(this)||this).method=i.A.POST,n.path=i.bf,n.params=(0,i.e)((0,i.u)({channel_url:r,cover_url:(0,i.a)("string",o)?o:null,cover_file:(0,i.i)(o)?o:null,name:s,data:a,custom_type:u,operators:c,is_ephemeral:l})),n}return(0,i.c)(t,e),t}(i.f);r=i.h,(0,i.c)((function(e,t){var n=r.call(this,e,t)||this;return n.channel=new S(e,t),n}),r);var f=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"ENTR",payload:{channel_url:n},ackRequired:!0})||this}return(0,i.c)(t,e),t}(i.ao),p=function(e){function t(t,n,r){var o,s,a=this;return a=e.call(this,t,"SYEV",r)||this,r.data&&(a.participantCount=null!==(o=r.data.participant_count)&&void 0!==o?o:0,a.user=new i.U(t,r.data),a.ts=null!==(s=r.data.edge_ts)&&void 0!==s?s:0),a}return(0,i.c)(t,e),t}(s.C),_=function(e){function t(t){var n=t.channelUrl;return e.call(this,{code:"EXIT",payload:{channel_url:n},ackRequired:!0})||this}return(0,i.c)(t,e),t}(i.ao),v=function(e){function t(t,n,r){var o,s,a=this;return a=e.call(this,t,"EXIT",r)||this,r.data&&(a.participantCount=null!==(o=r.data.participant_count)&&void 0!==o?o:0,a.user=new i.U(t,r.data),a.ts=null!==(s=r.data.edge_ts)&&void 0!==s?s:0),a}return(0,i.c)(t,e),t}(s.C),m={},g=function(e){function t(t,n){var r=e.call(this,t,(0,i.g)((0,i.g)({},n),{channelType:i.C.OPEN}))||this;return r.subscribeChannelEvent=i.av,r.unsubscribeChannelEvent=i.av,r.refreshChannel=function(){return(0,i._)(r,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return[2,(0,i.av)()]}))}))},r._openChannelCache=new u(t),r._openChannelHandlers=new Map,r._dispatcher.on((function(e){var t,n;if(e instanceof i.W)r._handleEvent(e).catch((function(e){if((0,i.N)(e))throw e}));else if(e instanceof i.B&&e.stateType===i.D.CONNECTED){var o=r._openChannelCache.enteredChannels;try{for(var s=(0,i.s)(o),a=s.next();!a.done;a=s.next())a.value.enter()}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}})),m[t]||(m[t]=r),r}return(0,i.c)(t,e),t.of=function(e){return m[e]},t.prototype.buildOpenChannelFromSerializedData=function(e){var t=(0,i.y)(e);return new S(this._iid,S.payloadify(t))},t.prototype.getChannelFromCache=function(e){var t;return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(n){switch(n.label){case 0:return[4,this._openChannelCache.get(e)];case 1:return[2,null!==(t=n.sent())&&void 0!==t?t:null]}}))}))},t.prototype.upsertChannelsToCache=function(e){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){switch(t.label){case 0:return[4,this._openChannelCache.upsert(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.removeChannelsFromCache=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o,s,a;return(0,i.b)(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),t=(0,i.s)(e),n=t.next(),u.label=1;case 1:return n.done?[3,4]:(r=n.value,[4,this._openChannelCache.remove(r)]);case 2:u.sent(),u.label=3;case 3:return n=t.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),s={error:o},[3,7];case 6:try{n&&!n.done&&(a=t.return)&&a.call(t)}finally{if(s)throw s.error}return[7];case 7:return[2]}}))}))},t.prototype.setEnteredToCache=function(e){this._openChannelCache.enter(e.url)},t.prototype.setExitedToCache=function(e){this._openChannelCache.exit(e.url)},t.prototype._handleEvent=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,a,u,c,l,d,h,f,_,m,g,y,b,E,w,C,T,A,S,I,N,k,x,O,M,R,D,U,L,P,F,j,q,H,V,B,z,G,W,K,Q,Z,Y,$,X,J,ee,te,ne,re,ie,oe,se,ae,ue,ce,le,de,he,fe,pe,_e,ve,me,ge,ye,be=this;return(0,i.b)(this,(function(Ee){switch(Ee.label){case 0:switch(Ee.trys.push([0,57,,58]),e.code){case"MESG":case"FILE":case"ADMM":case"BRDM":return[3,1];case"MEDI":case"FEDI":case"AEDI":return[3,4];case"DELM":return[3,7];case"MRCT":return[3,10];case"MTHD":return[3,13];case"MCNT":return[3,16];case"PEDI":return[3,27];case"VOTE":return[3,30];case"SYEV":return[3,33]}return[3,56];case 1:return a=null,"MESG"===e.code?a=e.as(o.a7):"FILE"===e.code?a=e.as(o.a8):"ADMM"!==e.code&&"BRDM"!=e.code||(a=e.as(s.A)),a?(t=a.message,n=a.isMentioned,t.channelType!==i.C.OPEN?[3,3]:[4,this.getChannel(t.channelUrl,!0)]):[3,3];case 2:r=Ee.sent(),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){var e,o,s,a,u;return(0,i.b)(this,(function(c){try{for(e=(0,i.s)(this._openChannelHandlers.values()),o=e.next();!o.done;o=e.next())s=o.value,this._openChannelCache.isEnteredChannel(r.url)&&(s.onMessageReceived&&s.onMessageReceived(r,t),n&&s.onMentionReceived&&s.onMentionReceived(r,t))}catch(e){a={error:e}}finally{try{o&&!o.done&&(u=e.return)&&u.call(e)}finally{if(a)throw a.error}}return[2]}))}))})),Ee.label=3;case 3:return[3,56];case 4:return a=null,"MEDI"===e.code?a=e.as(o.a5):"FEDI"===e.code?a=e.as(o.a6):"AEDI"===e.code&&(a=e.as(s.U)),a?(u=a.message,c=a.mentionCountChange,u.channelType!==i.C.OPEN?[3,6]:[4,this.getChannel(u.channelUrl,!0)]):[3,6];case 5:l=Ee.sent(),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.b)(this,(function(s){try{for(e=(0,i.s)(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(l.url)&&(n.onMessageUpdated&&n.onMessageUpdated(l,u),c>0&&n.onMentionReceived&&n.onMentionReceived(l,u))}catch(e){r={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ee.label=6;case 6:return[3,56];case 7:return d=e.as(o.a3),L=d.channelUrl,P=d.channelType,h=d.messageId,P!==i.C.OPEN?[3,9]:[4,this.getChannel(L,!0)];case 8:f=Ee.sent(),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.b)(this,(function(s){try{for(e=(0,i.s)(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(f.url)&&n.onMessageDeleted&&n.onMessageDeleted(f,h)}catch(e){r={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ee.label=9;case 9:return[3,56];case 10:return _=e.as(s.R),L=_.channelUrl,P=_.channelType,m=_.event,P!==i.C.OPEN?[3,12]:[4,this.getChannel(L,!0)];case 11:g=Ee.sent(),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.b)(this,(function(s){try{for(e=(0,i.s)(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(g.url)&&n.onReactionUpdated&&n.onReactionUpdated(g,m)}catch(e){r={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ee.label=12;case 12:return[3,56];case 13:return(y=e.as(s.T).event).channelType!==i.C.OPEN?[3,15]:[4,this.getChannel(y.channelUrl,!0)];case 14:b=Ee.sent(),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.b)(this,(function(s){try{for(e=(0,i.s)(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())n=t.value,this._openChannelCache.isEnteredChannel(b.url)&&n.onThreadInfoUpdated&&n.onThreadInfoUpdated(b,y)}catch(e){r={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ee.label=15;case 15:return[3,56];case 16:E=e.as(s.M).openChannelMemberCounts,w=[],Ee.label=17;case 17:Ee.trys.push([17,22,23,24]),C=(0,i.s)(E),T=C.next(),Ee.label=18;case 18:return T.done?[3,21]:(A=T.value,L=A.channelUrl,W=A.participantCount,S=A.updatedAt,[4,this.getChannelFromCache(L)]);case 19:(I=Ee.sent())&&I._updateParticipantCount(W,S)&&w.push(I),Ee.label=20;case 20:return T=C.next(),[3,18];case 21:return[3,24];case 22:return N=Ee.sent(),ge={error:N},[3,24];case 23:try{T&&!T.done&&(ye=C.return)&&ye.call(C)}finally{if(ge)throw ge.error}return[7];case 24:return w.length>0?[4,this.upsertChannelsToCache(w)]:[3,26];case 25:k=Ee.sent(),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.b)(this,(function(s){try{for(e=(0,i.s)(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onChannelMemberCountChanged&&n.onChannelMemberCountChanged(k)}catch(e){r={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ee.label=26;case 26:return[3,56];case 27:return x=e.as(s.P),O=x.event,M=x.status,L=x.channelUrl,P=x.channelType,L&&P===i.C.OPEN?[4,this.getChannel(L,!0)]:[3,29];case 28:R=Ee.sent(),this._dispatcher.dispatch(new i.aN({event:O,source:i.Z.EVENT_POLL_UPDATED})),(0,i.F)(M===i.b9?function(){return(0,i._)(be,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.b)(this,(function(s){try{for(e=(0,i.s)(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollDeleted&&n.onPollDeleted(R,O.pollId)}catch(e){r={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(r)throw r.error}}return[2]}))}))}:function(){return(0,i._)(be,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.b)(this,(function(s){try{for(e=(0,i.s)(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollUpdated&&n.onPollUpdated(R,O)}catch(e){r={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(r)throw r.error}}return[2]}))}))}),Ee.label=29;case 29:return[3,56];case 30:return D=e.as(o.a1),U=D.event,L=D.channelUrl,P=D.channelType,L&&P===i.C.OPEN?[4,this.getChannel(L,!0)]:[3,32];case 31:F=Ee.sent(),this._dispatcher.dispatch(new i.aG({event:U,source:i.Z.EVENT_POLL_VOTED})),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.b)(this,(function(s){try{for(e=(0,i.s)(this._openChannelHandlers.values()),t=e.next();!t.done;t=e.next())(n=t.value).onPollVoted&&n.onPollVoted(F,U)}catch(e){r={error:e}}finally{try{t&&!t.done&&(o=e.return)&&o.call(e)}finally{if(r)throw r.error}}return[2]}))}))})),Ee.label=32;case 32:return[3,56];case 33:if(!(j=e.as(s.C).event).isOpenChannelEvent)return[3,55];switch(j.category){case s.a.CHANNEL_ENTER:return[3,34];case s.a.CHANNEL_EXIT:return[3,36];case s.a.CHANNEL_OPERATOR_UPDATE:return[3,38];case s.a.USER_CHANNEL_MUTE:case s.a.USER_CHANNEL_UNMUTE:return[3,40];case s.a.USER_CHANNEL_BAN:case s.a.USER_CHANNEL_UNBAN:return[3,42];case s.a.CHANNEL_FREEZE:case s.a.CHANNEL_UNFREEZE:return[3,44];case s.a.CHANNEL_DELETED:return[3,46];case s.a.CHANNEL_PROP_CHANGED:return[3,49];case s.a.CHANNEL_META_DATA_CHANGED:return[3,51];case s.a.CHANNEL_META_COUNTERS_CHANGED:return[3,53]}return[3,55];case 34:return[4,this.getChannel(j.channelUrl,!0)];case 35:return q=Ee.sent(),H=e.as(p),W=H.participantCount,V=H.user,B=q._updateParticipantCount(W,j.ts),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onUserEntered&&e.onUserEntered(q,V),B&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(q)})),[2]}))}))})),[3,55];case 36:return[4,this.getChannel(j.channelUrl,!0)];case 37:return z=Ee.sent(),G=e.as(v),W=G.participantCount,K=G.user,Q=z._updateParticipantCount(W,j.ts),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onUserExited&&e.onUserExited(z,K),Q&&e.onChannelParticipantCountChanged&&e.onChannelParticipantCountChanged(z)})),[2]}))}))})),[3,55];case 38:return[4,this.getChannel(j.channelUrl,!0)];case 39:return Z=Ee.sent(),Y=e.as(s.O).operators,Z.operators=Y,this.upsertChannelsToCache([Z]),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onOperatorUpdated&&e.onOperatorUpdated(Z,Y)})),[2]}))}))})),[3,55];case 40:return[4,this.getChannel(j.channelUrl,!0)];case 41:return $=Ee.sent(),X=j.category===s.a.USER_CHANNEL_MUTE,J=e.as(X?o.$:o.a0).user,(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){X?e.onUserMuted&&e.onUserMuted($,J):e.onUserUnmuted&&e.onUserUnmuted($,J)})),[2]}))}))})),[3,55];case 42:return[4,this.getChannel(j.channelUrl,!0)];case 43:return ee=Ee.sent(),te=j.category===s.a.USER_CHANNEL_BAN,ne=e.as(te?o._:o.Z).user,(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){te?e.onUserBanned&&e.onUserBanned(ee,ne):e.onUserUnbanned&&e.onUserUnbanned(ee,ne)})),[2]}))}))})),[3,55];case 44:return[4,this.getChannel(j.channelUrl,!0)];case 45:return re=Ee.sent(),ie=e.as(o.Y).freeze,re.isFrozen=ie,this.upsertChannelsToCache([re]),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){ie?e.onChannelFrozen&&e.onChannelFrozen(re):e.onChannelUnfrozen&&e.onChannelUnfrozen(re)})),[2]}))}))})),[3,55];case 46:return[4,this.getChannel(j.channelUrl,!0)];case 47:return oe=Ee.sent(),[4,this.removeChannelsFromCache([oe.url])];case 48:return Ee.sent(),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onChannelDeleted&&e.onChannelDeleted(oe.url,oe.channelType)})),[2]}))}))})),[3,55];case 49:return[4,this.getChannelWithoutCache(j.channelUrl,!0)];case 50:return se=Ee.sent(),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){e.onChannelChanged&&e.onChannelChanged(se)})),[2]}))}))})),[3,55];case 51:return[4,this.getChannel(j.channelUrl,!0)];case 52:return ae=Ee.sent(),ue=e.as(o.X),ce=ue.created,le=ue.updated,de=ue.deleted,ce&&ae._upsertCachedMetaData(ce,j.ts),le&&ae._upsertCachedMetaData(le,j.ts),de&&ae._removeFromCachedMetaData(de,j.ts),(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){ce&&e.onMetaDataCreated&&e.onMetaDataCreated(ae,ce),le&&e.onMetaDataUpdated&&e.onMetaDataUpdated(ae,le),de&&e.onMetaDataDeleted&&e.onMetaDataDeleted(ae,de)})),[2]}))}))})),[3,55];case 53:return[4,this.getChannel(j.channelUrl,!0)];case 54:return he=Ee.sent(),fe=e.as(o.W),pe=fe.created,_e=fe.updated,ve=fe.deleted,(0,i.F)((function(){return(0,i._)(be,void 0,void 0,(function(){return(0,i.b)(this,(function(e){return this._openChannelHandlers.forEach((function(e){pe&&e.onMetaCounterCreated&&e.onMetaCounterCreated(he,pe),_e&&e.onMetaCounterUpdated&&e.onMetaCounterUpdated(he,_e),ve&&e.onMetaCounterDeleted&&e.onMetaCounterDeleted(he,ve)})),[2]}))}))})),[3,55];case 55:return[3,56];case 56:return[3,58];case 57:if(me=Ee.sent(),(0,i.N)(me))throw me;return[3,58];case 58:return[2]}}))}))},t.prototype.addHandler=function(e,t){this._openChannelHandlers.set(e,t)},t.prototype.removeHandler=function(e){this._openChannelHandlers.delete(e)},t.prototype.clearHandler=function(){this._openChannelHandlers.clear()},t.prototype.getChannel=function(e,t){return(0,i._)(this,void 0,void 0,(function(){var t;return(0,i.b)(this,(function(n){switch(n.label){case 0:(0,i.t)((0,i.a)("string",e)).throw(i.r.invalidParameters),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.getChannelFromCache(e)];case 2:return(t=n.sent())?[2,t]:[3,4];case 3:return n.sent(),[3,4];case 4:return[4,this.getChannelWithoutCache(e)];case 5:return[2,n.sent()]}}))}))},t.prototype.getChannelWithoutCache=function(e,t){return void 0===t&&(t=!1),(0,i._)(this,void 0,void 0,(function(){var n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return(0,i.t)((0,i.a)("string",e)).throw(i.r.invalidParameters),n=new l({channelUrl:e,isInternalCall:t}),[4,this._requestQueue.send(n)];case 1:return r=s.sent(),o=r.as(d).channel,[4,this.upsertChannelsToCache([o])];case 2:return[2,s.sent()[0]]}}))}))},t.prototype.createChannel=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o;return(0,i.b)(this,(function(s){switch(s.label){case 0:return t=(0,i.g)((0,i.g)({},c),e),(0,i.t)(function(e){return(0,i.O)("string",e.operatorUserIds,!0)&&((0,i.a)("string",e.coverUrlOrImage,!0)||(0,i.i)(e.coverUrlOrImage,!0))&&(0,i.a)("string",e.name,!0)&&(0,i.a)("string",e.data,!0)&&(0,i.a)("string",e.customType,!0)&&((0,i.a)("string",e.channelUrl)&&/^\w+$/.test(e.channelUrl)||null===e.channelUrl||void 0===e.channelUrl)&&(0,i.a)("boolean",e.isEphemeral,!0)}(t)).throw(i.r.invalidParameters),n=new h(t),[4,this._requestQueue.send(n)];case 1:return r=s.sent(),o=r.as(d).channel,this.upsertChannelsToCache([o]),[2,o]}}))}))},t}(s.B),y={name:void 0,coverUrlOrImage:void 0,data:void 0,customType:void 0,operatorUserIds:void 0},b=function(e){function t(t){var n=this,r=t.channelUrl,o=t.token,s=t.limit;return(n=e.call(this)||this).method=i.A.GET,n.path="".concat(i.bf,"/").concat(encodeURIComponent(r),"/participants"),n.params={token:o,limit:s},n}return(0,i.c)(t,e),t}(i.f),E=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.participants=[];var i=n.next,s=n.participants;return r.token=i,r.participants=s.map((function(e){return new o.P(t,e)})),r}return(0,i.c)(t,e),t}(i.h),w=function(e){function t(t,n,r){return e.call(this,t,n,i.C.OPEN,r)||this}return(0,i.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)},t.prototype.next=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r,o,s;return(0,i.b)(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=i.V.of(this._iid).requestQueue,t=new b((0,i.g)((0,i.g)({},this),{token:this._token})),[4,e.send(t)]):[3,2]:[3,5];case 1:return n=a.sent(),r=n.as(E),o=r.participants,s=r.token,this._token=s,this._hasNext=!!s,this._isLoading=!1,[2,o];case 2:return[2,[]];case 3:throw i.r.queryInProgress;case 4:return[3,6];case 5:throw i.r.invalidParameters;case 6:return[2]}}))}))},t}(i.aw),C=function(e){function t(t){var n=this,r=t.channelUrl,o=t.coverUrlOrImage,s=t.name,a=t.data,u=t.customType,c=t.operatorUserIds;return(n=e.call(this)||this).method=i.A.PUT,n.path="".concat(i.bf,"/").concat(encodeURIComponent(r)),n.params=(0,i.e)((0,i.u)({cover_url:(0,i.a)("string",o)?o:null,cover_file:(0,i.i)(o)?o:null,name:s,data:a,custom_type:u,operators:c})),n}return(0,i.c)(t,e),t}(i.f),T=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.channel=new S(t,n),r}return(0,i.c)(t,e),t}(i.h),A=function(e){function t(t){var n=this,r=t.channelUrl;return(n=e.call(this)||this).method=i.A.DELETE,n.path="".concat(i.bf,"/").concat(encodeURIComponent(r)),n}return(0,i.c)(t,e),t}(i.f);!function(e){(0,i.c)((function(t,n){return e.call(this,t,n)||this}),e)}(i.h);var S=function(e){function t(t,n){var r,o=this;return(o=e.call(this,t,n)||this)._lastParticipantCountUpdated=0,o.participantCount=0,o.operators=[],o.channelType=i.C.OPEN,o.participantCount=null!==(r=n.participant_count)&&void 0!==r?r:0,o.operators=Array.isArray(n.operators)?n.operators.map((function(e){return new i.U(t,e)})):[],o}return(0,i.c)(t,e),t.payloadify=function(e){return(0,i.e)((0,i.u)((0,i.g)((0,i.g)({},o.x.payloadify(e)),{participant_count:e.participantCount,operators:e.operators.map((function(e){return i.U.payloadify(e)}))})))},t.prototype.serialize=function(){return(0,i.ad)(this)},t.prototype.isOperator=function(e){return e instanceof i.U?this.isOperator(e.userId):this.operators.some((function(t){return t.userId===e}))},t.prototype._updateParticipantCount=function(e,t){return t>this._lastParticipantCountUpdated&&(this.participantCount=e,this._lastParticipantCountUpdated=t,!0)},t.prototype.createParticipantListQuery=function(e){return new w(this._iid,this.url,e)},t.prototype.refresh=function(){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(e){switch(e.label){case 0:return[4,g.of(this._iid).getChannelWithoutCache(this.url)];case 1:return[2,e.sent()]}}))}))},t.prototype.enter=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r,o,s;return(0,i.b)(this,(function(a){switch(a.label){case 0:return e=i.V.of(this._iid).requestQueue,t=new f({channelUrl:this.url}),[4,e.send(t)];case 1:return n=a.sent(),r=n.as(p),o=r.participantCount,s=r.ts,this._updateParticipantCount(o,s),g.of(this._iid).setEnteredToCache(this),[2]}}))}))},t.prototype.exit=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r,s,a;return(0,i.b)(this,(function(u){switch(u.label){case 0:return e=i.V.of(this._iid).requestQueue,t=new _({channelUrl:this.url}),[4,e.send(t)];case 1:return n=u.sent(),r=n.as(v),s=r.participantCount,a=r.ts,this._updateParticipantCount(s,a),g.of(this._iid).setExitedToCache(this),o.ab.of(this._iid).fileMessageQueue.cancel(this),[2]}}))}))},t.prototype.updateChannel=function(e){return(0,i._)(this,void 0,void 0,(function(){var t,n,r,o,s;return(0,i.b)(this,(function(a){switch(a.label){case 0:return t=(0,i.g)((0,i.g)({},y),e),(0,i.t)(function(e){return(0,i.O)("string",e.operatorUserIds,!0)&&((0,i.a)("string",e.coverUrlOrImage,!0)||(0,i.i)(e.coverUrlOrImage,!0))&&(0,i.a)("string",e.name,!0)&&(0,i.a)("string",e.data,!0)&&(0,i.a)("string",e.customType,!0)}(t)).throw(i.r.invalidParameters),n=i.V.of(this._iid).requestQueue,r=new C((0,i.g)({channelUrl:this.url},t)),[4,n.send(r)];case 1:return o=a.sent(),s=o.as(T).channel,this._update(s),[4,g.of(this._iid).upsertChannelsToCache([s])];case 2:return a.sent(),[2,this]}}))}))},t.prototype.updateChannelWithOperatorUserIds=function(e,t,n,r,o){return(0,i._)(this,void 0,void 0,(function(){var s;return(0,i.b)(this,(function(a){return s=(0,i.g)((0,i.g)({},y),{name:e,coverUrlOrImage:t,data:n,operatorUserIds:r,customType:o}),[2,this.updateChannel(s)]}))}))},t.prototype.delete=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t;return(0,i.b)(this,(function(n){switch(n.label){case 0:return e=i.V.of(this._iid).requestQueue,t=new A({channelUrl:this.url}),[4,e.send(t)];case 1:return n.sent(),[4,g.of(this._iid).removeChannelsFromCache([this.url])];case 2:return n.sent(),[2]}}))}))},t.prototype.sendUserMessage=function(t){return(0,i.t)(!t.isPinnedMessage).throw(i.r.notSupportedError),e.prototype.sendUserMessage.call(this,t)},t.prototype.sendFileMessage=function(t){return(0,i.t)(!t.isPinnedMessage).throw(i.r.notSupportedError),e.prototype.sendFileMessage.call(this,t)},t}(o.x),I=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return Object.keys(t).forEach((function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})),n}return(0,i.c)(t,e),t}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onUserEntered=i.av,t.onUserExited=i.av,t.onChannelParticipantCountChanged=i.av,t.onPollUpdated=i.av,t.onPollVoted=i.av,t.onPollDeleted=i.av,t}return(0,i.c)(t,e),t}(a.B)),N=function(e){function t(t){var n=this,r=t.token,o=t.limit,s=t.nameKeyword,a=t.urlKeyword,u=t.customTypes,c=t.includeFrozen,l=t.includeMetaData;return(n=e.call(this)||this).method=i.A.GET,n.path=i.bf,n.params=(0,i.e)({token:r,limit:o,name_contains:s,url_contains:a,custom_types:u,show_frozen:c,show_metadata:l}),n}return(0,i.c)(t,e),t}(i.f),k=function(e){function t(t,n){var r=e.call(this,t,n)||this;r.channels=[];var i=n.next,o=n.channels,s=n.ts;return r.token=i,o&&o.length>0&&(r.channels=o.map((function(e){return new S(t,e)}))),r.ts="number"==typeof s?s:null,r}return(0,i.c)(t,e),t}(i.h),x=function(e){function t(t,n){var r,i,o,s,a,u=this;return(u=e.call(this,t,n)||this).includeFrozen=!0,u.includeMetaData=!0,u.nameKeyword=null,u.urlKeyword=null,u.customTypes=null,u.includeFrozen=null===(r=n.includeFrozen)||void 0===r||r,u.includeMetaData=null===(i=n.includeMetaData)||void 0===i||i,u.nameKeyword=null!==(o=n.nameKeyword)&&void 0!==o?o:null,u.urlKeyword=null!==(s=n.urlKeyword)&&void 0!==s?s:null,u.customTypes=null!==(a=n.customTypes)&&void 0!==a?a:null,u}return(0,i.c)(t,e),t.prototype._validate=function(){return e.prototype._validate.call(this)&&(0,i.a)("boolean",this.includeFrozen)&&(0,i.a)("boolean",this.includeMetaData)&&(0,i.a)("string",this.nameKeyword,!0)&&(0,i.a)("string",this.urlKeyword,!0)&&(0,i.O)("string",this.customTypes,!0)},t.prototype.next=function(){return(0,i._)(this,void 0,void 0,(function(){var e,t,n,r,o,s;return(0,i.b)(this,(function(a){switch(a.label){case 0:return this._validate()?this._isLoading?[3,4]:this._hasNext?(this._isLoading=!0,e=i.V.of(this._iid).requestQueue,t=new N((0,i.u)((0,i.g)((0,i.g)({},this),{token:this._token}))),[4,e.send(t)]):[3,3]:[3,6];case 1:return n=a.sent(),r=n.as(k),o=r.channels,s=r.token,this._token=s,this._hasNext=!!s,[4,g.of(this._iid).upsertChannelsToCache(o)];case 2:return a.sent(),this._isLoading=!1,[2,o];case 3:return[2,[]];case 4:throw i.r.queryInProgress;case 5:return[3,7];case 6:throw i.r.invalidParameters;case 7:return[2]}}))}))},t}(i.aI),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="openChannel",t}return(0,i.c)(t,e),t.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,o=n.sessionManager,s=n.requestQueue,a=n.logger,u=n.onlineDetector,c=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:o,requestQueue:s,logger:a,onlineDetector:u,cacheContext:c}),this._manager=new g(t,{sdkState:r,dispatcher:i,requestQueue:s,logger:a,cacheContext:c,sessionManager:o})},t.prototype.createOpenChannelListQuery=function(e){return void 0===e&&(e={}),new x(this._iid,e)},t.prototype.addOpenChannelHandler=function(e,t){this._manager.addHandler(e,t)},t.prototype.removeOpenChannelHandler=function(e){this._manager.removeHandler(e)},t.prototype.removeAllOpenChannelHandlers=function(){this._manager.clearHandler()},t.prototype.buildOpenChannelFromSerializedData=function(e){return this._manager.buildOpenChannelFromSerializedData(e)},t.prototype.getChannel=function(e){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){return[2,this._manager.getChannel(e)]}))}))},t.prototype.getChannelWithoutCache=function(e){return(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){return[2,this._manager.getChannelWithoutCache(e)]}))}))},t.prototype.createChannel=function(e){return void 0===e&&(e={}),(0,i._)(this,void 0,void 0,(function(){return(0,i.b)(this,(function(t){return[2,this._manager.createChannel(e)]}))}))},t.prototype.createChannelWithOperatorUserIds=function(e,t,n,r,o){return(0,i._)(this,void 0,void 0,(function(){var s;return(0,i.b)(this,(function(a){return(s=(0,i.g)({},c)).name=e,s.coverUrlOrImage=t,s.data=n,s.operatorUserIds=r,s.customType=o,[2,this._manager.createChannel(s)]}))}))},t}(i.aS)},4763:function(e,t,n){function r(e,t){switch(e){case 0:return function(){return t.apply(this,arguments)};case 1:return function(e){return t.apply(this,arguments)};case 2:return function(e,n){return t.apply(this,arguments)};case 3:return function(e,n,r){return t.apply(this,arguments)};case 4:return function(e,n,r,i){return t.apply(this,arguments)};case 5:return function(e,n,r,i,o){return t.apply(this,arguments)};case 6:return function(e,n,r,i,o,s){return t.apply(this,arguments)};case 7:return function(e,n,r,i,o,s,a){return t.apply(this,arguments)};case 8:return function(e,n,r,i,o,s,a,u){return t.apply(this,arguments)};case 9:return function(e,n,r,i,o,s,a,u,c){return t.apply(this,arguments)};case 10:return function(e,n,r,i,o,s,a,u,c,l){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function i(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}function o(e){return function t(n){return 0===arguments.length||i(n)?t:e.apply(this,arguments)}}function s(e){return function t(n,r){switch(arguments.length){case 0:return t;case 1:return i(n)?t:o((function(t){return e(n,t)}));default:return i(n)&&i(r)?t:i(n)?o((function(t){return e(t,r)})):i(r)?o((function(t){return e(n,t)})):e(n,r)}}}function a(e,t,n){return function(){for(var o=[],s=0,u=e,c=0,l=!1;c<t.length||s<arguments.length;){var d;c<t.length&&(!i(t[c])||s>=arguments.length)?d=t[c]:(d=arguments[s],s+=1),o[c]=d,i(d)?l=!0:u-=1,c+=1}return!l&&u<=0?n.apply(this,o):r(Math.max(0,u),a(e,o,n))}}n.d(t,{A:function(){return u}});var u=s((function(e,t){return 1===e?o(t):r(e,a(e,[],t))}))},2573:function(e,t,n){n.d(t,{Mz:function(){return h}});function r(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}var i=e=>Array.isArray(e)?e:[e];function o(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){const n=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${n}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var s="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}},a=0,u=1;function c(){return{s:a,v:void 0,o:null,p:null}}function l(e,t={}){let n=c();const{resultEqualityCheck:r}=t;let i,o=0;function a(){let t=n;const{length:a}=arguments;for(let e=0,n=a;e<n;e++){const n=arguments[e];if("function"==typeof n||"object"==typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=c(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=c(),e.set(n,t)):t=r}}const l=t;let d;if(t.s===u?d=t.v:(d=e.apply(null,arguments),o++),l.s=u,r){const e=i?.deref?.()??i;null!=e&&r(e,d)&&(d=e,0!==o&&o--);i="object"==typeof d&&null!==d||"function"==typeof d?new s(d):d}return l.v=d,d}return a.clearCache=()=>{n=c(),a.resetResultsCount()},a.resultsCount=()=>o,a.resetResultsCount=()=>{o=0},a}function d(e,...t){const n="function"==typeof e?{memoize:e,memoizeOptions:t}:e,s=(...e)=>{let t,s=0,a=0,u={},c=e.pop();"object"==typeof c&&(u=c,c=e.pop()),r(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const d={...n,...u},{memoize:h,memoizeOptions:f=[],argsMemoize:p=l,argsMemoizeOptions:_=[],devModeChecks:v={}}=d,m=i(f),g=i(_),y=o(e),b=h((function(){return s++,c.apply(null,arguments)}),...m);const E=p((function(){a++;const e=function(e,t){const n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}(y,arguments);return t=b.apply(null,e),t}),...g);return Object.assign(E,{resultFunc:c,memoizedResultFunc:b,dependencies:y,dependencyRecomputations:()=>a,resetDependencyRecomputations:()=>{a=0},lastResult:()=>t,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:h,argsMemoize:p})};return Object.assign(s,{withTypes:()=>s}),s}var h=d(l),f=Object.assign(((e,t=h)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const n=Object.keys(e);return t(n.map((t=>e[t])),((...e)=>e.reduce(((e,t,r)=>(e[n[r]]=t,e)),{})))}),{withTypes:()=>f})},3031:function(e,t,n){n.d(t,{io:function(){return Se}});var r={};n.r(r),n.d(r,{Decoder:function(){return ge},Encoder:function(){return ve},PacketType:function(){return _e},protocol:function(){return pe}});const i=Object.create(null);i.open="0",i.close="1",i.ping="2",i.pong="3",i.message="4",i.upgrade="5",i.noop="6";const o=Object.create(null);Object.keys(i).forEach((e=>{o[i[e]]=e}));const s={type:"error",data:"parser error"},a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),u="function"==typeof ArrayBuffer,c=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,l=({type:e,data:t},n,r)=>a&&t instanceof Blob?n?r(t):d(t,r):u&&(t instanceof ArrayBuffer||c(t))?n?r(t):d(new Blob([t]),r):r(i[e]+(t||"")),d=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function h(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let f;const p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<64;e++)_[p.charCodeAt(e)]=e;const v="function"==typeof ArrayBuffer,m=(e,t)=>{if("string"!=typeof e)return{type:"message",data:y(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:g(e.substring(1),t)};return o[n]?e.length>1?{type:o[n],data:e.substring(1)}:{type:o[n]}:s},g=(e,t)=>{if(v){const n=(e=>{let t,n,r,i,o,s=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);const c=new ArrayBuffer(s),l=new Uint8Array(c);for(t=0;t<a;t+=4)n=_[e.charCodeAt(t)],r=_[e.charCodeAt(t+1)],i=_[e.charCodeAt(t+2)],o=_[e.charCodeAt(t+3)],l[u++]=n<<2|r>>4,l[u++]=(15&r)<<4|i>>2,l[u++]=(3&i)<<6|63&o;return c})(e);return y(n,t)}return{base64:!0,data:e}},y=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,b=String.fromCharCode(30);function E(){return new TransformStream({transform(e,t){!function(e,t){a&&e.data instanceof Blob?e.data.arrayBuffer().then(h).then(t):u&&(e.data instanceof ArrayBuffer||c(e.data))?t(h(e.data)):l(e,!1,(e=>{f||(f=new TextEncoder),t(f.encode(e))}))}(e,(n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const e=new DataView(i.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{i=new Uint8Array(9);const e=new DataView(i.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!=typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(n)}))}})}let w;function C(e){return e.reduce(((e,t)=>e+t.length),0)}function T(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function A(e){if(e)return function(e){for(var t in A.prototype)e[t]=A.prototype[t];return e}(e)}A.prototype.on=A.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},A.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},A.prototype.off=A.prototype.removeListener=A.prototype.removeAllListeners=A.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},A.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},A.prototype.emitReserved=A.prototype.emit,A.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},A.prototype.hasListeners=function(e){return!!this.listeners(e).length};const S="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function I(e,...t){return t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})}const N=S.setTimeout,k=S.clearTimeout;function x(e,t){t.useNativeTimers?(e.setTimeoutFn=N.bind(S),e.clearTimeoutFn=k.bind(S)):(e.setTimeoutFn=S.setTimeout.bind(S),e.clearTimeoutFn=S.clearTimeout.bind(S))}class O extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class M extends A{constructor(e){super(),this.writable=!1,x(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new O(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=m(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}const R="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),D=64,U={};let L,P=0,F=0;function j(e){let t="";do{t=R[e%D]+t,e=Math.floor(e/D)}while(e>0);return t}function q(){const e=j(+new Date);return e!==L?(P=0,L=e):e+"."+j(P++)}for(;F<D;F++)U[R[F]]=F;let H=!1;try{H="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}const V=H;function B(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||V))return new XMLHttpRequest}catch(e){}if(!t)try{return new(S[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function z(){}const G=null!=new B({xdomain:!1}).responseType;class W extends A{constructor(e,t){super(),x(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=I(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const n=this.xhr=new B(t);try{n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof n.status?n.status:0)}),0))},n.send(this.data)}catch(e){return void this.setTimeoutFn((()=>{this.onError(e)}),0)}"undefined"!=typeof document&&(this.index=W.requestsCount++,W.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=z,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete W.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(W.requestsCount=0,W.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",K);else if("function"==typeof addEventListener){addEventListener("onpagehide"in S?"pagehide":"unload",K,!1)}function K(){for(let e in W.requests)W.requests.hasOwnProperty(e)&&W.requests[e].abort()}const Q="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Z=S.WebSocket||S.MozWebSocket,Y="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const $={websocket:class extends M{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=Y?{}:I(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=Y?new Z(e,t,n):t?new Z(e,t):new Z(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;l(n,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(e){}r&&Q((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=q()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!Z}},webtransport:class extends M{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{this.onClose()})).catch((e=>{this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{const t=function(e,t){w||(w=new TextDecoder);const n=[];let r=0,i=-1,o=!1;return new TransformStream({transform(a,u){for(n.push(a);;){if(0===r){if(C(n)<1)break;const e=T(n,1);o=!(128&~e[0]),i=127&e[0],r=i<126?3:126===i?1:2}else if(1===r){if(C(n)<2)break;const e=T(n,2);i=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(C(n)<8)break;const e=T(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),o=t.getUint32(0);if(o>Math.pow(2,21)-1){u.enqueue(s);break}i=o*Math.pow(2,32)+t.getUint32(4),r=3}else{if(C(n)<i)break;const e=T(n,i);u.enqueue(m(o?e:w.decode(e),t)),r=0}if(0===i||i>e){u.enqueue(s);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=E();r.readable.pipeTo(e.writable),this.writer=r.writable.getWriter();const i=()=>{n.read().then((({done:e,value:t})=>{e||(this.onPacket(t),i())})).catch((e=>{}))};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(o).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this.writer.write(n).then((()=>{r&&Q((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}},polling:class extends M{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port}const t=e&&e.forceBase64;this.supportsBinary=G&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(b),r=[];for(let e=0;e<n.length;e++){const i=m(n[e],t);if(r.push(i),"error"===i.type)break}return r})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach(((e,o)=>{l(e,!1,(e=>{r[o]=e,++i===n&&t(r.join(b))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=q()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new W(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},X=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,J=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ee(e){const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let i=X.exec(e||""),o={},s=14;for(;s--;)o[J[s]]=i[s]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,o.path),o.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,o.query),o}class te extends A{constructor(e,t={}){super(),this.binaryType="arraybuffer",this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=ee(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=ee(t.host).host),x(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let e=0,r=n.length;e<r;e++){let r=n[e].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new $[e](n)}open(){let e;if(this.opts.rememberUpgrade&&te.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),n=!1;te.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;te.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function i(){n||(n=!0,c(),t.close(),t=null)}const o=e=>{const n=new Error("probe error: "+e);n.transport=t.name,i(),this.emitReserved("upgradeError",n)};function s(){o("transport closed")}function a(){o("socket closed")}function u(e){t&&e.name!==t.name&&i()}const c=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",s),this.off("close",a),this.off("upgrading",u)};t.once("open",r),t.once("error",o),t.once("close",s),this.once("close",a),this.once("upgrading",u),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((()=>{n||t.open()}),200):t.open()}onOpen(){if(this.readyState="open",te.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(e+="string"==typeof(t=r)?function(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(t):Math.ceil(1.33*(t.byteLength||t.size))),n>0&&e>this.maxPayload)return this.writeBuffer.slice(0,n);e+=2}var t;return this.writeBuffer}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():e()})):this.upgrading?n():e()),this}onError(e){te.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}te.protocol=4;te.protocol;const ne="function"==typeof ArrayBuffer,re=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,ie=Object.prototype.toString,oe="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===ie.call(Blob),se="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===ie.call(File);function ae(e){return ne&&(e instanceof ArrayBuffer||re(e))||oe&&e instanceof Blob||se&&e instanceof File}function ue(e,t){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(ue(e[t]))return!0;return!1}if(ae(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return ue(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&ue(e[t]))return!0;return!1}function ce(e){const t=[],n=e.data,r=e;return r.data=le(n,t),r.attachments=t.length,{packet:r,buffers:t}}function le(e,t){if(!e)return e;if(ae(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=le(e[r],t);return n}if("object"==typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=le(e[r],t));return n}return e}function de(e,t){return e.data=he(e.data,t),delete e.attachments,e}function he(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=he(e[n],t);else if("object"==typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=he(e[n],t));return e}const fe=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],pe=5;var _e;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(_e||(_e={}));class ve{constructor(e){this.replacer=e}encode(e){return e.type!==_e.EVENT&&e.type!==_e.ACK||!ue(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===_e.EVENT?_e.BINARY_EVENT:_e.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==_e.BINARY_EVENT&&e.type!==_e.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=ce(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function me(e){return"[object Object]"===Object.prototype.toString.call(e)}class ge extends A{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===_e.BINARY_EVENT;n||t.type===_e.BINARY_ACK?(t.type=n?_e.EVENT:_e.ACK,this.reconstructor=new ye(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!ae(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===_e[n.type])throw new Error("unknown packet type "+n.type);if(n.type===_e.BINARY_EVENT||n.type===_e.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!ge.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case _e.CONNECT:return me(t);case _e.DISCONNECT:return void 0===t;case _e.CONNECT_ERROR:return"string"==typeof t||me(t);case _e.EVENT:case _e.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===fe.indexOf(t[0]));case _e.ACK:case _e.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ye{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=de(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function be(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Ee=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class we extends A{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[be(e,"open",this.onopen.bind(this)),be(e,"packet",this.onpacket.bind(this)),be(e,"error",this.onerror.bind(this)),be(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Ee.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const n={type:_e.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,r=t.pop();this._registerAckCallback(e,r),n.id=e}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const i=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,[null,...e])}}emitWithAck(e,...t){const n=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((r,i)=>{t.push(((e,t)=>n?e?i(e):r(t):r(e))),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...r)=>{if(n!==this._queue[0])return;return null!==e?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:_e.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case _e.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case _e.EVENT:case _e.BINARY_EVENT:this.onevent(e);break;case _e.ACK:case _e.BINARY_ACK:this.onack(e);break;case _e.DISCONNECT:this.ondisconnect();break;case _e.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:_e.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:_e.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Ce(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Ce.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=1&Math.floor(10*t)?e+n:e-n}return 0|Math.min(e,this.max)},Ce.prototype.reset=function(){this.attempts=0},Ce.prototype.setMin=function(e){this.ms=e},Ce.prototype.setMax=function(e){this.max=e},Ce.prototype.setJitter=function(e){this.jitter=e};class Te extends A{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,x(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Ce({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||r;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new te(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=be(t,"open",(function(){n.onopen(),e&&e()})),i=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=be(t,"error",i);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn((()=>{r(),i(new Error("timeout")),t.close()}),e);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(be(e,"ping",this.onping.bind(this)),be(e,"data",this.ondata.bind(this)),be(e,"error",this.onerror.bind(this)),be(e,"close",this.onclose.bind(this)),be(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){Q((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new we(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const e of t){if(this.nsps[e].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((()=>{this.clearTimeoutFn(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Ae={};function Se(e,t){"object"==typeof e&&(t=e,e=void 0);const n=function(e,t="",n){let r=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),r=ee(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,i=n.id,o=n.path,s=Ae[i]&&o in Ae[i].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?a=new Te(r,t):(Ae[i]||(Ae[i]=new Te(r,t)),a=Ae[i]),n.query&&!t.query&&(t.query=n.queryKey),a.socket(n.path,t)}Object.assign(Se,{Manager:Te,Socket:we,io:Se,connect:Se})}}]);
//# sourceMappingURL=vendors.2c82518ed063cbbc4023.js.map